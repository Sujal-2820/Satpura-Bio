[{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\filter_lint.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\Button.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\Card.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\FAQAccordion.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\FeatureGrid.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\Footer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\GoogleMapsLocationPicker.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'autocomplete' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"autocomplete"},"fix":{"range":[936,948],"text":""},"desc":"Remove unused variable 'autocomplete'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'onLocationSelect'. Either include it or remove the dependency array. If 'onLocationSelect' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":99,"column":6,"nodeType":"ArrayExpression","endLine":99,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [onLocationSelect]","fix":{"range":[3347,3349],"text":"[onLocationSelect]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react'\nimport { MapPin, X, Navigation } from 'lucide-react'\n\n/**\n * Google Maps Location Picker Component\n * \n * Allows users to select a location using:\n * 1. Google Maps Place Autocomplete (manual input)\n * 2. Browser Geolocation API (live location)\n * \n * @param {Object} props\n * @param {Function} props.onLocationSelect - Callback when location is selected\n * @param {Object} props.initialLocation - Initial location data (optional)\n * @param {boolean} props.required - Whether location selection is required\n * @param {string} props.label - Label for the location picker\n */\nexport function GoogleMapsLocationPicker({ \n  onLocationSelect, \n  initialLocation = null,\n  required = false,\n  label = 'Select Location'\n}) {\n  const [searchQuery, setSearchQuery] = useState(initialLocation?.address || '')\n  const [selectedLocation, setSelectedLocation] = useState(initialLocation)\n  const [autocomplete, setAutocomplete] = useState(null)\n  const [error, setError] = useState(null)\n  const [isGettingLiveLocation, setIsGettingLiveLocation] = useState(false)\n  \n  const searchInputRef = useRef(null)\n  const autocompleteRef = useRef(null)\n\n  // Initialize Google Maps Autocomplete\n  useEffect(() => {\n    if (!window.google || !searchInputRef.current) return\n\n    try {\n      const autocompleteInstance = new window.google.maps.places.Autocomplete(\n        searchInputRef.current,\n        {\n          types: ['address'],\n          componentRestrictions: { country: 'in' }, // Restrict to India\n          fields: ['formatted_address', 'geometry', 'address_components', 'place_id']\n        }\n      )\n\n      autocompleteInstance.addListener('place_changed', () => {\n        const place = autocompleteInstance.getPlace()\n        \n        if (!place.geometry || !place.geometry.location) {\n          setError('Please select a valid location from the suggestions')\n          return\n        }\n\n        // Extract address components\n        const addressComponents = place.address_components || []\n        let city = ''\n        let state = ''\n        let pincode = ''\n        let address = place.formatted_address || ''\n\n        addressComponents.forEach(component => {\n          const types = component.types\n          \n          if (types.includes('locality') || types.includes('sublocality')) {\n            city = component.long_name\n          } else if (types.includes('administrative_area_level_1')) {\n            state = component.long_name\n          } else if (types.includes('postal_code')) {\n            pincode = component.long_name\n          }\n        })\n\n        const location = {\n          address: address,\n          city: city,\n          state: state,\n          pincode: pincode,\n          coordinates: {\n            lat: place.geometry.location.lat(),\n            lng: place.geometry.location.lng(),\n          },\n          placeId: place.place_id,\n        }\n\n        setSelectedLocation(location)\n        setSearchQuery(address)\n        setError(null)\n\n        // Notify parent component\n        onLocationSelect?.(location)\n      })\n\n      setAutocomplete(autocompleteInstance)\n      autocompleteRef.current = autocompleteInstance\n    } catch (err) {\n      console.error('Error initializing Google Maps:', err)\n      setError('Failed to load Google Maps. Please refresh the page.')\n    }\n  }, [])\n\n  // Handle Live Location using Browser Geolocation API\n  const handleLiveLocation = () => {\n    if (!navigator.geolocation) {\n      setError('Geolocation is not supported by your browser')\n      return\n    }\n\n    setIsGettingLiveLocation(true)\n    setError(null)\n\n    navigator.geolocation.getCurrentPosition(\n      async (position) => {\n        try {\n          const lat = position.coords.latitude\n          const lng = position.coords.longitude\n\n          // Use Google Maps Geocoding API to get address from coordinates\n          if (!window.google) {\n            setError('Google Maps API not loaded. Please refresh the page.')\n            setIsGettingLiveLocation(false)\n            return\n          }\n\n          const geocoder = new window.google.maps.Geocoder()\n          geocoder.geocode(\n            { location: { lat, lng } },\n            (results, status) => {\n              setIsGettingLiveLocation(false)\n              \n              if (status === 'OK' && results[0]) {\n                const place = results[0]\n                const addressComponents = place.address_components || []\n                let city = ''\n                let state = ''\n                let pincode = ''\n                const address = place.formatted_address || ''\n\n                addressComponents.forEach(component => {\n                  const types = component.types\n                  if (types.includes('locality') || types.includes('sublocality')) {\n                    city = component.long_name\n                  } else if (types.includes('administrative_area_level_1')) {\n                    state = component.long_name\n                  } else if (types.includes('postal_code')) {\n                    pincode = component.long_name\n                  }\n                })\n\n                const location = {\n                  address: address,\n                  city: city,\n                  state: state,\n                  pincode: pincode,\n                  coordinates: {\n                    lat: lat,\n                    lng: lng,\n                  },\n                }\n\n                setSelectedLocation(location)\n                setSearchQuery(address)\n                setError(null)\n                onLocationSelect?.(location)\n              } else {\n                setError('Could not find address for your location. Please try searching manually.')\n              }\n            }\n          )\n        } catch (err) {\n          setIsGettingLiveLocation(false)\n          setError('Failed to get your location. Please try searching manually.')\n          console.error('Error getting live location:', err)\n        }\n      },\n      (error) => {\n        setIsGettingLiveLocation(false)\n        switch (error.code) {\n          case error.PERMISSION_DENIED:\n            setError('Location access denied. Please allow location access or search manually.')\n            break\n          case error.POSITION_UNAVAILABLE:\n            setError('Location unavailable. Please try searching manually.')\n            break\n          case error.TIMEOUT:\n            setError('Location request timed out. Please try again or search manually.')\n            break\n          default:\n            setError('Error getting your location. Please try searching manually.')\n            break\n        }\n      },\n      {\n        enableHighAccuracy: true,\n        timeout: 10000,\n        maximumAge: 0,\n      }\n    )\n  }\n\n  const handleClear = () => {\n    setSelectedLocation(null)\n    setSearchQuery('')\n    if (searchInputRef.current) {\n      searchInputRef.current.value = ''\n    }\n    onLocationSelect?.(null)\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <label className=\"text-xs font-semibold text-gray-700 flex items-center gap-2\">\n        <MapPin className=\"h-4 w-4\" />\n        {label} {required && <span className=\"text-red-500\">*</span>}\n      </label>\n\n      <div className=\"space-y-2\">\n        <div className=\"relative\">\n          <input\n            ref={searchInputRef}\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Search for your address or use live location...\"\n            className={`w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 pl-10 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all ${selectedLocation ? 'pr-32' : 'pr-28'}`}\n            required={required}\n          />\n          <MapPin className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400\" />\n          \n          {/* Clear Button - Only show when location is selected */}\n          {selectedLocation && (\n            <button\n              type=\"button\"\n              onClick={handleClear}\n              className=\"absolute right-28 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500 transition-colors p-1\"\n              title=\"Clear location\"\n            >\n              <X className=\"h-4 w-4\" />\n            </button>\n          )}\n\n          {/* Live Location Button */}\n          <button\n            type=\"button\"\n            onClick={handleLiveLocation}\n            disabled={isGettingLiveLocation}\n            className=\"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1.5 px-3 py-1.5 rounded-lg border border-green-500 bg-green-50 text-green-700 hover:bg-green-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs font-medium whitespace-nowrap\"\n            title=\"Use your current location\"\n          >\n            <Navigation className={`h-3.5 w-3.5 ${isGettingLiveLocation ? 'animate-spin' : ''}`} />\n            <span className=\"hidden sm:inline\">{isGettingLiveLocation ? 'Getting...' : 'Live Location'}</span>\n            <span className=\"sm:hidden\">{isGettingLiveLocation ? '...' : 'Live'}</span>\n          </button>\n        </div>\n\n        {error && (\n          <p className=\"text-xs text-red-600\">{error}</p>\n        )}\n\n        <p className=\"text-xs text-gray-500\">\n          ðŸ’¡ You can either search for an address or click \"Live Location\" to use your current location\n        </p>\n      </div>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\LanguageToggle.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\Navbar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\Trans.jsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render.","line":27,"column":3,"nodeType":"Identifier","endLine":27,"endColumn":12}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react'\nimport { useTranslation } from '../context/TranslationContext'\n\n/**\n * Trans Component\n * \n * Automatically translates its children text content\n * Re-renders when language changes\n * Usage: <Trans>Hello World</Trans>\n * \n * Note: Only works with string children. For dynamic content with variables,\n * split the text and use multiple Trans components: <Trans>Add</Trans> â‚¹{amount} <Trans>more</Trans>\n */\nexport function Trans({ children, forceRefresh = false }) {\n  const { translate, isEnglish, language } = useTranslation()\n\n  const [translatedText, setTranslatedText] = useState(children)\n  const [isTranslating, setIsTranslating] = useState(false)\n  const previousTextRef = useRef(children)\n  const previousLanguageRef = useRef(language)\n\n  // If children is not a string, render it directly without translation\n  if (typeof children !== 'string') {\n    return <>{children}</>\n  }\n\n  useEffect(() => {\n    const text = children.trim()\n\n    // Skip if text and language haven't changed\n    if (text === previousTextRef.current && language === previousLanguageRef.current) {\n      return\n    }\n\n    previousTextRef.current = text\n    previousLanguageRef.current = language\n\n    if (isEnglish || !text) {\n      setTranslatedText(children)\n      setIsTranslating(false)\n      return\n    }\n\n    // Don't translate if it's an entity ID\n    if (/^[A-Z]{2,4}-[\\dA-Z-]+$/i.test(text)) {\n      setTranslatedText(text)\n      setIsTranslating(false)\n      return\n    }\n\n    setIsTranslating(true)\n\n    translate(text, forceRefresh)\n      .then((translated) => {\n        console.log(`[Trans] Translated: \"${text}\" â†’ \"${translated}\"`)\n        setTranslatedText(translated)\n        setIsTranslating(false)\n      })\n      .catch((error) => {\n        console.error('[Trans] Translation error:', error)\n        setTranslatedText(children) // Fallback to original on error\n        setIsTranslating(false)\n      })\n  }, [children, isEnglish, translate, forceRefresh, language])\n\n  // Show original text while translating (or show translated immediately if already cached)\n  return <>{isTranslating && !translatedText ? children : translatedText}</>\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\TransText.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\auth\\OtpVerification.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\components\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\context\\TranslationContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":71,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":71,"endColumn":31}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useEffect, useCallback, useMemo } from 'react'\nimport { getTranslation, getBatchTranslations } from '../utils/translation'\n\nconst TranslationContext = createContext(null)\n\nconst STORAGE_KEY = 'ira_sathi_language'\n\nexport function TranslationProvider({ children }) {\n  const [language, setLanguageState] = useState(() => {\n    // Load from localStorage or default to English\n    try {\n      const saved = localStorage.getItem(STORAGE_KEY)\n      const lang = saved === 'hi' ? 'hi' : 'en'\n      console.log('[TranslationContext] Initial language loaded:', lang, 'from localStorage:', saved)\n      return lang\n    } catch (error) {\n      console.error('[TranslationContext] Error loading language:', error)\n      return 'en'\n    }\n  })\n\n  // Save language preference to localStorage\n  useEffect(() => {\n    try {\n      localStorage.setItem(STORAGE_KEY, language)\n      console.log('[TranslationContext] Language saved to localStorage:', language)\n    } catch (error) {\n      console.error('[TranslationContext] Error saving language preference:', error)\n    }\n  }, [language])\n\n  const setLanguage = useCallback((lang) => {\n    console.log('[TranslationContext] setLanguage called with:', lang)\n    if (lang === 'en' || lang === 'hi') {\n      console.log('[TranslationContext] Setting language to:', lang)\n      setLanguageState(lang)\n    } else {\n      console.warn('[TranslationContext] Invalid language:', lang)\n    }\n  }, [])\n\n  const translate = useCallback(async (text, forceRefresh = false) => {\n    if (language === 'en' || !text) {\n      return text\n    }\n    return await getTranslation(text, language, forceRefresh)\n  }, [language])\n\n  const translateBatch = useCallback(async (texts, forceRefresh = false) => {\n    if (language === 'en' || !texts || texts.length === 0) {\n      return texts\n    }\n    return await getBatchTranslations(texts, language, forceRefresh)\n  }, [language])\n\n  const value = useMemo(\n    () => ({\n      language,\n      setLanguage,\n      translate,\n      translateBatch,\n      isHindi: language === 'hi',\n      isEnglish: language === 'en',\n    }),\n    [language, setLanguage, translate, translateBatch]\n  )\n\n  return <TranslationContext.Provider value={value}>{children}</TranslationContext.Provider>\n}\n\nexport function useTranslation() {\n  const context = useContext(TranslationContext)\n  if (!context) {\n    // Return a no-op implementation if context is not available\n    return {\n      language: 'en',\n      setLanguage: () => {},\n      translate: (text) => Promise.resolve(text),\n      translateBatch: (texts) => Promise.resolve(texts),\n      isHindi: false,\n      isEnglish: true,\n    }\n  }\n  return context\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\hooks\\useTranslatedArray.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\hooks\\useTranslatedText.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\lib\\cn.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\AdminLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\AttributeStockForm.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'category' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"category"},"fix":{"range":[488,501],"text":""},"desc":"Remove unused variable 'category'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'categoryAttributes' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"categoryAttributes"},"fix":{"range":[501,524],"text":""},"desc":"Remove unused variable 'categoryAttributes'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'index' is defined but never used.","line":211,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":211,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"index"},"fix":{"range":[6726,6733],"text":""},"desc":"Remove unused variable 'index'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'id' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":267,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":267,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"id"},"fix":{"range":[8807,8810],"text":""},"desc":"Remove unused variable 'id'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\nimport { X, Package, Plus, Trash2, IndianRupee } from 'lucide-react'\nimport { cn } from '../../../lib/cn'\n\nconst STOCK_UNITS = ['kg', 'L', 'bags', 'units']\n\n/**\n * AttributeStockForm Component\n * \n * A child form that opens dynamically to manage stock quantity for each attribute combination.\n * Allows adding multiple attribute combinations with their respective stock quantities.\n */\nexport function AttributeStockForm({ \n  isOpen, \n  onClose, \n  category, \n  categoryAttributes, \n  attributeStocks = [], \n  onSave,\n  stockUnit = 'kg' \n}) {\n  const [stocks, setStocks] = useState([])\n  const [errors, setErrors] = useState({})\n  const [customAttributes, setCustomAttributes] = useState({}) // Store custom attribute fields per stock entry\n\n  // Initialize stocks from prop or empty array\n  useEffect(() => {\n    if (isOpen) {\n      const initialStocks = attributeStocks.length > 0 ? attributeStocks.map((stock, idx) => ({\n        ...stock,\n        id: stock.id || Date.now() + idx // Ensure each has an ID\n      })) : []\n      setStocks(initialStocks)\n      setErrors({})\n      \n      // Initialize custom attributes from existing stocks\n      const initialCustomAttrs = {}\n      initialStocks.forEach(stock => {\n        if (stock.attributes && Object.keys(stock.attributes).length > 0) {\n          // Convert attributes Map to object if needed\n          const attrsObj = stock.attributes instanceof Map \n            ? Object.fromEntries(stock.attributes)\n            : stock.attributes\n          \n          initialCustomAttrs[stock.id] = Object.keys(attrsObj).map((key, idx) => ({\n            key: `attr_${stock.id}_${idx}`, // Internal key\n            label: key, // Use attribute key as label\n            value: attrsObj[key]\n          }))\n          \n          // Also set attributes in stock with label as key\n          setStocks(prev => prev.map(s => {\n            if (s.id === stock.id) {\n              return { ...s, attributes: attrsObj }\n            }\n            return s\n          }))\n        } else {\n          initialCustomAttrs[stock.id] = []\n        }\n      })\n      setCustomAttributes(initialCustomAttrs)\n    }\n  }, [isOpen, attributeStocks])\n\n  // Add new stock entry\n  const handleAddStock = () => {\n    const newStockId = Date.now()\n    const newStock = {\n      id: newStockId, // Temporary ID for React key\n      attributes: {},\n      actualStock: '',\n      displayStock: '',\n      stockUnit: stockUnit,\n      vendorPrice: '',\n      userPrice: '',\n      batchNumber: '',\n      expiry: '',\n    }\n    setStocks([...stocks, newStock])\n    // Initialize custom attributes for this stock entry\n    setCustomAttributes(prev => ({\n      ...prev,\n      [newStockId]: []\n    }))\n  }\n\n  // Remove stock entry\n  const handleRemoveStock = (id) => {\n    setStocks(stocks.filter(stock => stock.id !== id))\n    // Clear errors for removed stock\n    const newErrors = { ...errors }\n    Object.keys(newErrors).forEach(key => {\n      if (key.startsWith(`${id}_`)) {\n        delete newErrors[key]\n      }\n    })\n    setErrors(newErrors)\n    // Remove custom attributes for this stock\n    setCustomAttributes(prev => {\n      const updated = { ...prev }\n      delete updated[id]\n      return updated\n    })\n  }\n\n  // Update attribute value for a stock entry\n  const handleAttributeChange = (stockId, attributeKey, value) => {\n    setStocks(stocks.map(stock => {\n      if (stock.id === stockId) {\n        const newAttributes = { ...stock.attributes }\n        if (value === '' || value === null) {\n          delete newAttributes[attributeKey]\n        } else {\n          newAttributes[attributeKey] = value\n        }\n        return {\n          ...stock,\n          attributes: newAttributes,\n        }\n      }\n      return stock\n    }))\n    // Clear error when user starts typing\n    const errorKey = `${stockId}_attribute_${attributeKey}`\n    if (errors[errorKey]) {\n      setErrors(prev => {\n        const newErrors = { ...prev }\n        delete newErrors[errorKey]\n        return newErrors\n      })\n    }\n  }\n  \n  // Update custom attribute label\n  const handleCustomAttributeLabelChange = (stockId, attrKey, newLabel) => {\n    setCustomAttributes(prev => {\n      const stockAttrs = prev[stockId] || []\n      const updated = stockAttrs.map(attr => {\n        if (attr.key === attrKey) {\n          // If label changed, migrate the value to new label key\n          const currentStock = stocks.find(s => s.id === stockId)\n          if (currentStock) {\n            const oldLabel = attr.label\n            const oldValue = oldLabel ? currentStock.attributes[oldLabel] : currentStock.attributes[attrKey]\n            \n            if (oldValue && newLabel !== oldLabel) {\n              // Update stock attributes: remove old key, add new label as key\n              setStocks(stocks.map(stock => {\n                if (stock.id === stockId) {\n                  const newAttrs = { ...stock.attributes }\n                  // Remove old keys\n                  if (oldLabel) delete newAttrs[oldLabel]\n                  if (attrKey !== newLabel) delete newAttrs[attrKey]\n                  // Add with new label as key\n                  newAttrs[newLabel] = oldValue\n                  return { ...stock, attributes: newAttrs }\n                }\n                return stock\n              }))\n            } else if (newLabel && !oldLabel) {\n              // First time setting label - migrate from internal key to label\n              const value = currentStock.attributes[attrKey]\n              if (value) {\n                setStocks(stocks.map(stock => {\n                  if (stock.id === stockId) {\n                    const newAttrs = { ...stock.attributes }\n                    delete newAttrs[attrKey]\n                    newAttrs[newLabel] = value\n                    return { ...stock, attributes: newAttrs }\n                  }\n                  return stock\n                }))\n              }\n            }\n          }\n          return { ...attr, label: newLabel }\n        }\n        return attr\n      })\n      return { ...prev, [stockId]: updated }\n    })\n  }\n\n  // Update stock quantity fields\n  const handleStockChange = (stockId, field, value) => {\n    setStocks(stocks.map(stock => {\n      if (stock.id === stockId) {\n        return {\n          ...stock,\n          [field]: value,\n        }\n      }\n      return stock\n    }))\n    // Clear error when user starts typing\n    const errorKey = `${stockId}_${field}`\n    if (errors[errorKey]) {\n      setErrors(prev => {\n        const newErrors = { ...prev }\n        delete newErrors[errorKey]\n        return newErrors\n      })\n    }\n  }\n\n  // Validate form\n  const validate = () => {\n    const newErrors = {}\n    \n    stocks.forEach((stock, index) => {\n      // Validate that at least one attribute is filled (either predefined or custom)\n      const hasAttributes = Object.keys(stock.attributes || {}).some(key => {\n        const value = stock.attributes[key]\n        return value && value.toString().trim() !== ''\n      })\n\n      if (!hasAttributes) {\n        newErrors[`${stock.id}_attributes`] = 'At least one attribute must be filled'\n      }\n\n      // Validate actual stock\n      if (!stock.actualStock || parseFloat(stock.actualStock) < 0) {\n        newErrors[`${stock.id}_actualStock`] = 'Actual quantity is required and cannot be negative'\n      }\n\n      // Validate display stock\n      if (!stock.displayStock || parseFloat(stock.displayStock) < 0) {\n        newErrors[`${stock.id}_displayStock`] = 'Display quantity is required and cannot be negative'\n      }\n\n      // Validate display stock doesn't exceed actual stock\n      if (stock.actualStock && stock.displayStock && \n          parseFloat(stock.displayStock) > parseFloat(stock.actualStock)) {\n        newErrors[`${stock.id}_displayStock`] = 'Display quantity cannot exceed actual quantity'\n      }\n\n      // Validate vendor price\n      if (!stock.vendorPrice || parseFloat(stock.vendorPrice) <= 0) {\n        newErrors[`${stock.id}_vendorPrice`] = 'Vendor price must be greater than 0'\n      }\n\n      // Validate user price\n      if (!stock.userPrice || parseFloat(stock.userPrice) <= 0) {\n        newErrors[`${stock.id}_userPrice`] = 'User price must be greater than 0'\n      }\n\n      // Validate user price is greater than vendor price\n      if (stock.vendorPrice && stock.userPrice && \n          parseFloat(stock.userPrice) <= parseFloat(stock.vendorPrice)) {\n        newErrors[`${stock.id}_userPrice`] = 'User price must be greater than vendor price'\n      }\n    })\n\n    setErrors(newErrors)\n    return Object.keys(newErrors).length === 0\n  }\n\n  // Handle save\n  const handleSave = () => {\n    if (!validate()) {\n      return\n    }\n\n    // Prepare data for saving (remove temporary IDs)\n    const stocksToSave = stocks.map(stock => {\n      const { id, ...stockData } = stock\n      // Build attributes from custom attributes - use label as key, value as value\n      const finalAttributes = {}\n      const customAttrs = customAttributes[stock.id] || []\n      \n      customAttrs.forEach(customAttr => {\n        // Use label as the key (attribute name), get value from stock.attributes\n        if (customAttr.label && customAttr.label.trim() !== '') {\n          const attrKey = customAttr.label.trim()\n          // Try to get value using label first, then fallback to internal key\n          const attrValue = stock.attributes[attrKey] || stock.attributes[customAttr.key]\n          if (attrValue) {\n            // Handle both array (legacy) and string values - convert array to first element\n            let finalValue = ''\n            if (Array.isArray(attrValue)) {\n              finalValue = attrValue.length > 0 ? attrValue[0].toString().trim() : ''\n            } else {\n              finalValue = attrValue.toString().trim()\n            }\n            // Store as key-value pair: label (key) -> value (single string)\n            if (finalValue !== '') {\n              finalAttributes[attrKey] = finalValue\n            }\n          }\n        }\n      })\n      \n      // Also include any attributes that might have been set directly (for backward compatibility)\n      Object.keys(stock.attributes || {}).forEach(key => {\n        // Skip internal keys (starting with 'attr_')\n        if (!key.startsWith('attr_') && stock.attributes[key]) {\n          // Handle both array (legacy) and string values - convert array to first element\n          let finalValue = ''\n          if (Array.isArray(stock.attributes[key])) {\n            finalValue = stock.attributes[key].length > 0 ? stock.attributes[key][0].toString().trim() : ''\n          } else {\n            finalValue = stock.attributes[key].toString().trim()\n          }\n          // Only add if not already in finalAttributes and value is not empty\n          if (finalValue !== '' && !finalAttributes[key]) {\n            finalAttributes[key] = finalValue\n          }\n        }\n      })\n      \n      return {\n        ...stockData,\n        actualStock: parseFloat(stock.actualStock) || 0,\n        displayStock: parseFloat(stock.displayStock) || 0,\n        vendorPrice: parseFloat(stock.vendorPrice) || 0,\n        userPrice: parseFloat(stock.userPrice) || 0,\n        // Use final attributes with proper key-value pairs (label -> value)\n        attributes: finalAttributes,\n      }\n    })\n\n    onSave(stocksToSave)\n    onClose()\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"mt-4 rounded-2xl border border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100/50 p-5\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <div>\n          <h3 className=\"text-lg font-bold text-purple-700\">Manage Stock by Attributes</h3>\n          <p className=\"text-sm text-gray-600 mt-1\">\n            Add stock quantities for different attribute combinations\n          </p>\n        </div>\n        <button\n          type=\"button\"\n          onClick={onClose}\n          className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-red-500 hover:bg-red-50 hover:text-red-700\"\n        >\n          <X className=\"h-4 w-4\" />\n        </button>\n      </div>\n\n        {/* Content */}\n        <div className=\"space-y-6\">\n          {stocks.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <Package className=\"h-16 w-16 mx-auto text-gray-300 mb-4\" />\n              <p className=\"text-base font-semibold text-gray-600 mb-2\">No stock entries yet</p>\n              <p className=\"text-sm text-gray-500 mb-6\">Click \"Add Stock Entry\" to get started</p>\n              <button\n                type=\"button\"\n                onClick={handleAddStock}\n                className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-purple-500 to-purple-600 px-5 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(168,85,247,0.3)] transition-all hover:shadow-[0_6px_20px_rgba(168,85,247,0.4)]\"\n              >\n                <Plus className=\"h-4 w-4\" />\n                Add Stock Entry\n              </button>\n            </div>\n          ) : (\n            <>\n              {stocks.map((stock, index) => (\n                <div\n                  key={stock.id}\n                  className=\"rounded-2xl border border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100/50 p-5\"\n                >\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <h3 className=\"text-lg font-bold text-purple-700\">\n                      Stock Entry #{index + 1}\n                    </h3>\n                    <button\n                      type=\"button\"\n                      onClick={() => handleRemoveStock(stock.id)}\n                      className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-red-300 bg-white text-red-600 transition-all hover:border-red-500 hover:bg-red-50\"\n                      title=\"Remove this stock entry\"\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </button>\n                  </div>\n\n                  {/* Custom Attributes Section - Redesigned with 2-column layout */}\n                  <div className=\"mb-6\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                      <label className=\"block text-sm font-bold text-gray-900\">\n                        Custom Attributes\n                        <span className=\"text-xs font-normal text-gray-500 ml-2\">(Add any attribute field you need)</span>\n                      </label>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          const newAttrKey = `attr_${Date.now()}`\n                          const currentAttrs = customAttributes[stock.id] || []\n                          setCustomAttributes(prev => ({\n                            ...prev,\n                            [stock.id]: [...currentAttrs, { key: newAttrKey, label: '', value: '' }]\n                          }))\n                          // Initialize empty attribute in stock\n                          handleAttributeChange(stock.id, newAttrKey, '')\n                        }}\n                        className=\"inline-flex items-center gap-1.5 rounded-lg border-2 border-purple-400 bg-gradient-to-r from-purple-50 to-purple-100 px-3 py-1.5 text-xs font-bold text-purple-700 transition-all hover:border-purple-500 hover:from-purple-100 hover:to-purple-200 shadow-sm\"\n                      >\n                        <Plus className=\"h-3.5 w-3.5\" />\n                        Add Attribute\n                      </button>\n                    </div>\n                    \n                    {/* Custom Attributes List - 2 Column Grid Layout */}\n                    {(customAttributes[stock.id] || []).length > 0 ? (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4\">\n                        {(customAttributes[stock.id] || []).map((customAttr, attrIndex) => (\n                          <div \n                            key={customAttr.key} \n                            className=\"relative rounded-xl border-2 border-blue-200 bg-gradient-to-br from-blue-50/80 to-indigo-50/60 p-4 shadow-sm hover:shadow-md transition-all hover:border-blue-300\"\n                          >\n                            {/* Attribute Index Badge */}\n                            <div className=\"absolute -top-2 -left-2 w-7 h-7 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white flex items-center justify-center text-xs font-bold shadow-lg\">\n                              {attrIndex + 1}\n                            </div>\n                            \n                            {/* Remove Button */}\n                            <button\n                              type=\"button\"\n                              onClick={() => {\n                                const updated = (customAttributes[stock.id] || []).filter((_, idx) => idx !== attrIndex)\n                                setCustomAttributes(prev => ({\n                                  ...prev,\n                                  [stock.id]: updated\n                                }))\n                                // Remove from stock attributes\n                                const attrKeyToRemove = customAttr.label || customAttr.key\n                                handleAttributeChange(stock.id, attrKeyToRemove, '')\n                              }}\n                              className=\"absolute -top-2 -right-2 w-6 h-6 rounded-full bg-red-500 text-white flex items-center justify-center hover:bg-red-600 transition-colors shadow-md z-10\"\n                              title=\"Remove this attribute\"\n                            >\n                              <X className=\"h-3 w-3\" />\n                            </button>\n                            \n                            <div className=\"space-y-3 pt-1\">\n                              {/* Attribute Name Field */}\n                              <div>\n                                <label className=\"block text-xs font-semibold text-gray-700 mb-1.5\">\n                                  Attribute Name <span className=\"text-red-500\">*</span>\n                                </label>\n                                <input\n                                  type=\"text\"\n                                  placeholder=\"e.g., NPK Ratio, Type, Percentage\"\n                                  value={customAttr.label}\n                                  onChange={(e) => {\n                                    const newLabel = e.target.value\n                                    handleCustomAttributeLabelChange(stock.id, customAttr.key, newLabel)\n                                  }}\n                                  className=\"w-full rounded-lg border-2 border-gray-300 bg-white px-3 py-2.5 text-sm font-medium transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/30\"\n                                />\n                              </div>\n                              \n                              {/* Attribute Value Field - Single Value Only */}\n                              <div>\n                                <label className=\"block text-xs font-semibold text-gray-700 mb-1.5\">\n                                  Attribute Value <span className=\"text-red-500\">*</span>\n                                </label>\n                                \n                                {/* Input for single value */}\n                                <input\n                                  type=\"text\"\n                                  value={(() => {\n                                    const attrKey = customAttr.label || customAttr.key\n                                    const currentValue = stock.attributes[attrKey]\n                                    // Handle both array (legacy) and string values - convert array to first element or empty string\n                                    if (Array.isArray(currentValue)) {\n                                      return currentValue.length > 0 ? currentValue[0] : ''\n                                    }\n                                    return currentValue || ''\n                                  })()}\n                                  onChange={(e) => {\n                                    const attrKey = customAttr.label || customAttr.key\n                                    handleAttributeChange(stock.id, attrKey, e.target.value)\n                                  }}\n                                  placeholder={\n                                    customAttr.label\n                                      ? `Enter ${customAttr.label.toLowerCase()} value`\n                                      : 'Enter attribute value'\n                                  }\n                                  disabled={!customAttr.label}\n                                  className={cn(\n                                    \"w-full rounded-lg border-2 px-3 py-2.5 text-sm font-medium transition-all focus:outline-none focus:ring-2\",\n                                    !customAttr.label \n                                      ? \"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed\"\n                                      : \"border-gray-300 bg-white focus:border-blue-500 focus:ring-blue-500/30\"\n                                  )}\n                                />\n                                \n                                {!customAttr.label && (\n                                  <p className=\"mt-1.5 text-xs text-gray-400 italic\">Please enter attribute name first</p>\n                                )}\n                              </div>\n                              \n                              {/* Preview of Key-Value Pair */}\n                              {(() => {\n                                const attrKey = customAttr.label || customAttr.key\n                                const currentValue = stock.attributes[attrKey]\n                                // Handle both array (legacy) and string values - convert array to first element\n                                let displayValue = ''\n                                if (Array.isArray(currentValue)) {\n                                  displayValue = currentValue.length > 0 ? currentValue[0] : ''\n                                } else if (currentValue) {\n                                  displayValue = currentValue.toString()\n                                }\n                                \n                                return customAttr.label && displayValue ? (\n                                  <div className=\"mt-2 pt-2 border-t border-blue-200\">\n                                    <p className=\"text-xs font-semibold text-gray-600 mb-1\">Preview:</p>\n                                    <div className=\"bg-white rounded-lg px-3 py-2 border border-blue-200\">\n                                      <span className=\"text-xs font-bold text-blue-700\">{customAttr.label}:</span>\n                                      <span className=\"text-xs text-gray-800 font-medium bg-gray-50 px-2 py-0.5 rounded ml-2\">\n                                        {displayValue}\n                                      </span>\n                                    </div>\n                                  </div>\n                                ) : null\n                              })()}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : (\n                      /* Empty State */\n                      <div className=\"text-center py-8 rounded-xl border-2 border-dashed border-gray-300 bg-gray-50 mb-4\">\n                        <Package className=\"h-10 w-10 mx-auto text-gray-400 mb-2\" />\n                        <p className=\"text-sm text-gray-500 font-medium\">No attributes added yet</p>\n                        <p className=\"text-xs text-gray-400 mt-1\">Click \"Add Attribute\" to get started</p>\n                      </div>\n                    )}\n                    \n                    {/* Add Attribute Button at Bottom - Always Visible */}\n                    <div className=\"flex justify-center\">\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          const newAttrKey = `attr_${Date.now()}`\n                          const currentAttrs = customAttributes[stock.id] || []\n                          setCustomAttributes(prev => ({\n                            ...prev,\n                            [stock.id]: [...currentAttrs, { key: newAttrKey, label: '', value: '' }]\n                          }))\n                          // Initialize empty attribute in stock\n                          handleAttributeChange(stock.id, newAttrKey, '')\n                        }}\n                        className=\"inline-flex items-center gap-2 rounded-lg border-2 border-purple-400 bg-gradient-to-r from-purple-50 to-purple-100 px-4 py-2 text-sm font-bold text-purple-700 transition-all hover:border-purple-500 hover:from-purple-100 hover:to-purple-200 shadow-sm\"\n                      >\n                        <Plus className=\"h-4 w-4\" />\n                        Add Another Attribute\n                      </button>\n                    </div>\n                    \n                    {errors[`${stock.id}_attributes`] && (\n                      <div className=\"mt-3 p-2 rounded-lg bg-red-50 border border-red-200\">\n                        <p className=\"text-xs text-red-600 font-medium\">{errors[`${stock.id}_attributes`]}</p>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Stock Quantities */}\n                  <div className=\"grid gap-4 sm:grid-cols-2 mb-4\">\n                    <div>\n                      <label htmlFor={`${stock.id}_actualStock`} className=\"mb-2 block text-sm font-bold text-gray-900\">\n                        Actual Quantity <span className=\"text-red-500\">*</span>\n                        <span className=\"text-xs font-normal text-gray-500 ml-2\">(Internal/Admin use)</span>\n                      </label>\n                      <div className=\"flex gap-2\">\n                        <input\n                          type=\"number\"\n                          id={`${stock.id}_actualStock`}\n                          value={stock.actualStock}\n                          onChange={(e) => handleStockChange(stock.id, 'actualStock', e.target.value)}\n                          placeholder=\"0\"\n                          min=\"0\"\n                          step=\"0.01\"\n                          className={cn(\n                            'flex-1 rounded-xl border px-3 py-2 text-sm transition-all focus:outline-none focus:ring-2 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none',\n                            errors[`${stock.id}_actualStock`]\n                              ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                              : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n                          )}\n                        />\n                        <select\n                          value={stock.stockUnit || stockUnit}\n                          onChange={(e) => handleStockChange(stock.id, 'stockUnit', e.target.value)}\n                          className=\"rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm font-semibold text-gray-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n                        >\n                          {STOCK_UNITS.map((unit) => (\n                            <option key={unit} value={unit}>\n                              {unit}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                      {errors[`${stock.id}_actualStock`] && (\n                        <p className=\"mt-1 text-xs text-red-600\">{errors[`${stock.id}_actualStock`]}</p>\n                      )}\n                    </div>\n\n                    <div>\n                      <label htmlFor={`${stock.id}_displayStock`} className=\"mb-2 block text-sm font-bold text-gray-900\">\n                        Display Quantity <span className=\"text-red-500\">*</span>\n                        <span className=\"text-xs font-normal text-gray-500 ml-2\">(Visible to vendors)</span>\n                      </label>\n                      <div className=\"flex gap-2\">\n                        <input\n                          type=\"number\"\n                          id={`${stock.id}_displayStock`}\n                          value={stock.displayStock}\n                          onChange={(e) => handleStockChange(stock.id, 'displayStock', e.target.value)}\n                          placeholder=\"0\"\n                          min=\"0\"\n                          step=\"0.01\"\n                          className={cn(\n                            'flex-1 rounded-xl border px-3 py-2 text-sm transition-all focus:outline-none focus:ring-2 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none',\n                            errors[`${stock.id}_displayStock`]\n                              ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                              : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n                          )}\n                        />\n                        <select\n                          value={stock.stockUnit || stockUnit}\n                          disabled\n                          className=\"rounded-xl border border-gray-300 bg-gray-100 px-3 py-2 text-sm font-semibold text-gray-500 cursor-not-allowed\"\n                        >\n                          {STOCK_UNITS.map((unit) => (\n                            <option key={unit} value={unit}>\n                              {unit}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                      {errors[`${stock.id}_displayStock`] && (\n                        <p className=\"mt-1 text-xs text-red-600\">{errors[`${stock.id}_displayStock`]}</p>\n                      )}\n                      {stock.displayStock && stock.actualStock && \n                       parseFloat(stock.displayStock) > parseFloat(stock.actualStock) && (\n                        <p className=\"mt-1 text-xs text-yellow-600\">âš ï¸ Display quantity exceeds actual quantity</p>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Pricing */}\n                  <div className=\"grid gap-4 sm:grid-cols-2 mb-4\">\n                    <div>\n                      <label htmlFor={`${stock.id}_vendorPrice`} className=\"mb-2 block text-sm font-bold text-gray-900\">\n                        <IndianRupee className=\"mr-1 inline h-4 w-4\" />\n                        Vendor Price <span className=\"text-red-500\">*</span>\n                      </label>\n                      <input\n                        type=\"number\"\n                        id={`${stock.id}_vendorPrice`}\n                        value={stock.vendorPrice || ''}\n                        onChange={(e) => handleStockChange(stock.id, 'vendorPrice', e.target.value)}\n                        placeholder=\"0.00\"\n                        min=\"0\"\n                        step=\"0.01\"\n                        className={cn(\n                          'w-full rounded-xl border px-3 py-2 text-sm transition-all focus:outline-none focus:ring-2 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none',\n                          errors[`${stock.id}_vendorPrice`]\n                            ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                            : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n                        )}\n                      />\n                      {errors[`${stock.id}_vendorPrice`] && (\n                        <p className=\"mt-1 text-xs text-red-600\">{errors[`${stock.id}_vendorPrice`]}</p>\n                      )}\n                    </div>\n\n                    <div>\n                      <label htmlFor={`${stock.id}_userPrice`} className=\"mb-2 block text-sm font-bold text-gray-900\">\n                        <IndianRupee className=\"mr-1 inline h-4 w-4\" />\n                        User Price <span className=\"text-red-500\">*</span>\n                      </label>\n                      <input\n                        type=\"number\"\n                        id={`${stock.id}_userPrice`}\n                        value={stock.userPrice || ''}\n                        onChange={(e) => handleStockChange(stock.id, 'userPrice', e.target.value)}\n                        placeholder=\"0.00\"\n                        min=\"0\"\n                        step=\"0.01\"\n                        className={cn(\n                          'w-full rounded-xl border px-3 py-2 text-sm transition-all focus:outline-none focus:ring-2 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none',\n                          errors[`${stock.id}_userPrice`]\n                            ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                            : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n                        )}\n                      />\n                      {errors[`${stock.id}_userPrice`] && (\n                        <p className=\"mt-1 text-xs text-red-600\">{errors[`${stock.id}_userPrice`]}</p>\n                      )}\n                      {stock.vendorPrice && stock.userPrice && \n                       parseFloat(stock.userPrice) <= parseFloat(stock.vendorPrice) && (\n                        <p className=\"mt-1 text-xs text-yellow-600\">âš ï¸ User price must be greater than vendor price</p>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Optional Fields */}\n                  <div className=\"grid gap-4 sm:grid-cols-2\">\n                    <div>\n                      <label htmlFor={`${stock.id}_batchNumber`} className=\"mb-2 block text-sm font-bold text-gray-900\">\n                        Batch Number <span className=\"text-xs font-normal text-gray-500\">(Optional)</span>\n                      </label>\n                      <input\n                        type=\"text\"\n                        id={`${stock.id}_batchNumber`}\n                        value={stock.batchNumber || ''}\n                        onChange={(e) => handleStockChange(stock.id, 'batchNumber', e.target.value)}\n                        placeholder=\"e.g., BATCH-2024-001\"\n                        className=\"w-full rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm transition-all focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n                      />\n                    </div>\n                    <div>\n                      <label htmlFor={`${stock.id}_expiry`} className=\"mb-2 block text-sm font-bold text-gray-900\">\n                        Expiry Date <span className=\"text-xs font-normal text-gray-500\">(Optional)</span>\n                      </label>\n                      <input\n                        type=\"date\"\n                        id={`${stock.id}_expiry`}\n                        value={stock.expiry || ''}\n                        onChange={(e) => handleStockChange(stock.id, 'expiry', e.target.value)}\n                        className=\"w-full rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm transition-all focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              ))}\n\n              {/* Add More Button */}\n              <button\n                type=\"button\"\n                onClick={handleAddStock}\n                className=\"w-full rounded-xl border-2 border-dashed border-purple-300 bg-purple-50 px-6 py-4 text-sm font-bold text-purple-700 transition-all hover:border-purple-500 hover:bg-purple-100\"\n              >\n                <Plus className=\"mr-2 inline h-4 w-4\" />\n                Add Another Stock Entry\n              </button>\n            </>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex items-center justify-end gap-3 pt-4 border-t border-purple-200 mt-6\">\n          <button\n            type=\"button\"\n            onClick={onClose}\n            className=\"rounded-xl border border-gray-300 bg-white px-5 py-2 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n          >\n            Cancel\n          </button>\n          <button\n            type=\"button\"\n            onClick={handleSave}\n            className=\"rounded-xl bg-gradient-to-r from-purple-500 to-purple-600 px-5 py-2 text-sm font-bold text-white shadow-[0_4px_15px_rgba(168,85,247,0.3)] transition-all hover:shadow-[0_6px_20px_rgba(168,85,247,0.4)]\"\n          >\n            Save Stock Entries\n          </button>\n        </div>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\CarouselImageUpload.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'title' is assigned a value but never used.","line":16,"column":79,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":84,"suggestions":[{"messageId":"removeVar","data":{"varName":"title"},"fix":{"range":[712,724],"text":""},"desc":"Remove unused variable 'title'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'description' is assigned a value but never used.","line":16,"column":91,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":102,"suggestions":[{"messageId":"removeVar","data":{"varName":"description"},"fix":{"range":[724,742],"text":""},"desc":"Remove unused variable 'description'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react'\r\nimport { Upload, X, Image as ImageIcon, Loader2, AlertCircle, CheckCircle } from 'lucide-react'\r\nimport { CLOUDINARY_CONFIG } from '../config/cloudinary'\r\n\r\n/**\r\n * Carousel Image Upload Component\r\n * Validates landscape aspect ratio (approximately 16:9 or 2:1)\r\n * Shows warning for square/circular images\r\n * Auto-adjusts if close to correct ratio\r\n * Shows preview of how carousel will appear\r\n * \r\n * @param {string} image - Existing image URL\r\n * @param {Function} onChange - Callback when image changes (receives image URL)\r\n * @param {boolean} disabled - Disable upload\r\n */\r\nexport function CarouselImageUpload({ image = '', onChange, disabled = false, title = '', description = '' }) {\r\n  const [uploading, setUploading] = useState(false)\r\n  const [error, setError] = useState(null)\r\n  const [warning, setWarning] = useState(null)\r\n  const [imageUrl, setImageUrl] = useState(image || '')\r\n  const [imageDimensions, setImageDimensions] = useState({ width: 0, height: 0 })\r\n  const [aspectRatio, setAspectRatio] = useState(0)\r\n  const widgetRef = useRef(null)\r\n\r\n  // Load Cloudinary Upload Widget script\r\n  useEffect(() => {\r\n    if (window.cloudinary) {\r\n      return\r\n    }\r\n\r\n    const script = document.createElement('script')\r\n    script.src = 'https://upload-widget.cloudinary.com/global/all.js'\r\n    script.async = true\r\n    script.onload = () => {\r\n      console.log('Cloudinary Upload Widget loaded')\r\n    }\r\n    script.onerror = () => {\r\n      setError('Failed to load Cloudinary Upload Widget. Please refresh the page.')\r\n    }\r\n    document.body.appendChild(script)\r\n\r\n    return () => {\r\n      const existingScript = document.querySelector('script[src*=\"upload-widget.cloudinary.com\"]')\r\n      if (existingScript) {\r\n        existingScript.remove()\r\n      }\r\n    }\r\n  }, [])\r\n\r\n  // Check image dimensions when imageUrl changes\r\n  useEffect(() => {\r\n    if (imageUrl) {\r\n      const img = new Image()\r\n      img.onload = () => {\r\n        const width = img.naturalWidth\r\n        const height = img.naturalHeight\r\n        const ratio = width / height\r\n        \r\n        setImageDimensions({ width, height })\r\n        setAspectRatio(ratio)\r\n        \r\n        // Validate aspect ratio\r\n        // Ideal carousel aspect ratio: ~2:1 (2.0) or 16:9 (1.78)\r\n        // Acceptable range: 1.5 to 2.5 (landscape)\r\n        // Warning for: 0.8 to 1.2 (square-ish)\r\n        // Error for: < 0.8 (portrait/tall) or > 2.5 (too wide)\r\n        \r\n        if (ratio < 0.8) {\r\n          setWarning('Image is too tall (portrait). Please upload a landscape/rectangular image.')\r\n        } else if (ratio >= 0.8 && ratio <= 1.2) {\r\n          setWarning('Image appears to be square. Carousel images should be landscape/rectangular (wider than tall).')\r\n        } else if (ratio > 2.5) {\r\n          setWarning('Image is too wide. Recommended aspect ratio is between 1.5:1 and 2.5:1.')\r\n        } else if (ratio >= 1.5 && ratio <= 2.5) {\r\n          setWarning(null) // Perfect aspect ratio\r\n        } else if (ratio > 1.2 && ratio < 1.5) {\r\n          setWarning('Image aspect ratio is acceptable but not ideal. Recommended: 1.5:1 to 2.5:1 (landscape).')\r\n        }\r\n      }\r\n      img.onerror = () => {\r\n        setError('Failed to load image. Please try uploading again.')\r\n      }\r\n      img.src = imageUrl\r\n    } else {\r\n      setImageDimensions({ width: 0, height: 0 })\r\n      setAspectRatio(0)\r\n      setWarning(null)\r\n    }\r\n  }, [imageUrl])\r\n\r\n  // Update imageUrl when image prop changes\r\n  useEffect(() => {\r\n    setImageUrl(image || '')\r\n  }, [image])\r\n\r\n  const openUploadWidget = () => {\r\n    if (disabled || uploading) return\r\n    if (!window.cloudinary) {\r\n      setError('Cloudinary Upload Widget is not loaded yet. Please wait a moment and try again.')\r\n      return\r\n    }\r\n\r\n    if (!CLOUDINARY_CONFIG.uploadPreset || CLOUDINARY_CONFIG.uploadPreset === 'unsigned') {\r\n      setError('Please configure the Cloudinary upload preset. See CLOUDINARY_SETUP.md for instructions.')\r\n      return\r\n    }\r\n\r\n    setUploading(true)\r\n    setError(null)\r\n    setWarning(null)\r\n\r\n    // Cloudinary Upload Widget options with landscape cropping\r\n    const options = {\r\n      cloudName: CLOUDINARY_CONFIG.cloudName,\r\n      uploadPreset: CLOUDINARY_CONFIG.uploadPreset,\r\n      sources: ['local', 'camera', 'url'],\r\n      multiple: false,\r\n      clientAllowedFormats: ['jpg', 'jpeg', 'png', 'webp'],\r\n      maxFileSize: 5000000, // 5MB\r\n      cropping: true,\r\n      croppingAspectRatio: 2, // 2:1 aspect ratio (landscape)\r\n      croppingDefaultSelectionRatio: 0.9,\r\n      croppingShowDimensions: true,\r\n      folder: 'ira-sathi/carousels',\r\n      transformation: [\r\n        {\r\n          width: 1200,\r\n          height: 600,\r\n          crop: 'limit',\r\n          quality: 'auto:good',\r\n          fetchFormat: 'auto',\r\n        },\r\n      ],\r\n      styles: {\r\n        palette: {\r\n          window: '#FFFFFF',\r\n          windowBorder: '#90A0B3',\r\n          tabIcon: '#0078FF',\r\n          menuIcons: '#5A616A',\r\n          textDark: '#000000',\r\n          textLight: '#FFFFFF',\r\n          link: '#0078FF',\r\n          action: '#FF620C',\r\n          inactiveTabIcon: '#0E2F5A',\r\n          error: '#F44235',\r\n          inProgress: '#0078FF',\r\n          complete: '#20B832',\r\n          sourceBg: '#E4EBF1',\r\n        },\r\n      },\r\n    }\r\n\r\n    const widget = window.cloudinary.createUploadWidget(\r\n      options,\r\n      (error, result) => {\r\n        setUploading(false)\r\n        \r\n        if (error) {\r\n          console.error('Upload error:', error)\r\n          setError(error.message || 'Failed to upload image. Please try again.')\r\n          return\r\n        }\r\n\r\n        if (result && result.event === 'success') {\r\n          const url = result.info.secure_url\r\n          setImageUrl(url)\r\n          onChange(url)\r\n          setError(null)\r\n        }\r\n      }\r\n    )\r\n\r\n    widgetRef.current = widget\r\n    widget.open()\r\n  }\r\n\r\n  const removeImage = () => {\r\n    if (disabled) return\r\n    \r\n    setImageUrl('')\r\n    setImageDimensions({ width: 0, height: 0 })\r\n    setAspectRatio(0)\r\n    setWarning(null)\r\n    setError(null)\r\n    onChange('')\r\n  }\r\n\r\n  const isAcceptableRatio = aspectRatio >= 1.5 && aspectRatio <= 2.5\r\n  const isSquareLike = aspectRatio >= 0.8 && aspectRatio <= 1.2\r\n  const isTooTall = aspectRatio < 0.8\r\n  const isTooWide = aspectRatio > 2.5\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n        <ImageIcon className=\"mr-1 inline h-4 w-4\" />\r\n        Carousel Image (Landscape) *\r\n      </label>\r\n\r\n      {error && (\r\n        <div className=\"rounded-lg bg-red-50 border border-red-200 px-4 py-2 text-sm text-red-700 flex items-start gap-2\">\r\n          <AlertCircle className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\r\n          <span>{error}</span>\r\n        </div>\r\n      )}\r\n\r\n      {warning && (\r\n        <div className={`rounded-lg border px-4 py-2 text-sm flex items-start gap-2 ${\r\n          isSquareLike || isTooTall || isTooWide\r\n            ? 'bg-yellow-50 border-yellow-200 text-yellow-800'\r\n            : 'bg-blue-50 border-blue-200 text-blue-800'\r\n        }`}>\r\n          <AlertCircle className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\r\n          <span>{warning}</span>\r\n        </div>\r\n      )}\r\n\r\n      {imageUrl && aspectRatio > 0 && (\r\n        <div className={`rounded-lg border px-4 py-2 text-sm flex items-center gap-2 ${\r\n          isAcceptableRatio\r\n            ? 'bg-green-50 border-green-200 text-green-800'\r\n            : 'bg-gray-50 border-gray-200 text-gray-700'\r\n        }`}>\r\n          {isAcceptableRatio ? (\r\n            <CheckCircle className=\"h-4 w-4 flex-shrink-0\" />\r\n          ) : (\r\n            <AlertCircle className=\"h-4 w-4 flex-shrink-0\" />\r\n          )}\r\n          <span>\r\n            Image dimensions: {imageDimensions.width} Ã— {imageDimensions.height}px \r\n            {' '}(Aspect ratio: {aspectRatio.toFixed(2)}:1)\r\n            {isAcceptableRatio && ' âœ“ Good for carousel'}\r\n          </span>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"space-y-3\">\r\n        {/* Image Upload Container - Smaller */}\r\n        {imageUrl ? (\r\n          <div className=\"relative\">\r\n            <div className=\"relative rounded-lg border-2 border-gray-300 overflow-hidden bg-gray-50 max-w-md\">\r\n              <img\r\n                src={imageUrl}\r\n                alt=\"Carousel preview\"\r\n                className=\"w-full h-auto object-cover\"\r\n                style={{ \r\n                  aspectRatio: aspectRatio > 0 ? aspectRatio : '2/1',\r\n                  maxHeight: '150px',\r\n                  objectFit: 'cover'\r\n                }}\r\n                onError={(e) => {\r\n                  e.target.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI0U0RThFQiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5Q0EzQUYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5JbWFnZSBub3QgZm91bmQ8L3RleHQ+PC9zdmc+'\r\n                }}\r\n              />\r\n              {!disabled && (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={removeImage}\r\n                  className=\"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-90 hover:opacity-100 transition-opacity hover:bg-red-600 z-10\"\r\n                  aria-label=\"Remove image\"\r\n                >\r\n                  <X className=\"h-3 w-3\" />\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <button\r\n            type=\"button\"\r\n            onClick={openUploadWidget}\r\n            disabled={uploading || disabled}\r\n            className={`w-full max-w-md aspect-[2/1] rounded-lg border-2 border-dashed transition-all flex flex-col items-center justify-center gap-1.5 ${\r\n              uploading\r\n                ? 'border-blue-400 bg-blue-50'\r\n                : 'border-gray-300 bg-gray-50 hover:border-blue-400 hover:bg-blue-50'\r\n            } disabled:opacity-50 disabled:cursor-not-allowed`}\r\n            style={{ maxHeight: '150px' }}\r\n          >\r\n            {uploading ? (\r\n              <>\r\n                <Loader2 className=\"h-6 w-6 animate-spin text-blue-600\" />\r\n                <span className=\"text-xs font-semibold text-blue-600\">Uploading...</span>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Upload className=\"h-6 w-6 text-gray-400\" />\r\n                <span className=\"text-xs font-semibold text-gray-600\">Upload Landscape Image</span>\r\n                <span className=\"text-xs text-gray-500\">Recommended: 2:1 (e.g., 1200Ã—600px)</span>\r\n              </>\r\n            )}\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      <p className=\"text-xs text-gray-500\">\r\n        <strong>Important:</strong> Upload a landscape/rectangular image (wider than tall). \r\n        Square or circular images will show a warning. Ideal aspect ratio: 1.5:1 to 2.5:1.\r\n      </p>\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\ConfirmationModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\CreditPolicyForm.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'formatCurrency' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":70,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\r\nimport { CreditCard, Calendar, AlertCircle, IndianRupee } from 'lucide-react'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nexport function CreditPolicyForm({ vendor, onSubmit, onCancel, loading = false }) {\r\n  const [formData, setFormData] = useState({\r\n    repaymentDays: '',\r\n    penaltyRate: '',\r\n  })\r\n\r\n  const [errors, setErrors] = useState({})\r\n\r\n  useEffect(() => {\r\n    if (vendor) {\r\n      const repaymentDays = typeof vendor.repaymentDays === 'number'\r\n        ? vendor.repaymentDays\r\n        : vendor.creditPolicy?.repaymentDays || 30\r\n\r\n      const penaltyRate = typeof vendor.penaltyRate === 'number'\r\n        ? vendor.penaltyRate\r\n        : vendor.creditPolicy?.penaltyRate || 2\r\n\r\n      setFormData({\r\n        repaymentDays: repaymentDays || 30,\r\n        penaltyRate: penaltyRate || 2,\r\n      })\r\n    }\r\n  }, [vendor])\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target\r\n    setFormData((prev) => ({ ...prev, [name]: value }))\r\n    // Clear error when user starts typing\r\n    if (errors[name]) {\r\n      setErrors((prev) => ({ ...prev, [name]: '' }))\r\n    }\r\n  }\r\n\r\n  const validate = () => {\r\n    const newErrors = {}\r\n\r\n    if (!formData.repaymentDays || parseInt(formData.repaymentDays) <= 0) {\r\n      newErrors.repaymentDays = 'Repayment days must be greater than 0'\r\n    }\r\n\r\n    if (formData.penaltyRate === '' || parseFloat(formData.penaltyRate) < 0) {\r\n      newErrors.penaltyRate = 'Penalty rate must be 0 or greater'\r\n    }\r\n\r\n    if (parseFloat(formData.penaltyRate) > 10) {\r\n      newErrors.penaltyRate = 'Penalty rate should not exceed 10%'\r\n    }\r\n\r\n    setErrors(newErrors)\r\n    return Object.keys(newErrors).length === 0\r\n  }\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault()\r\n    if (!validate()) return\r\n\r\n    const submitData = {\r\n      repaymentDays: parseInt(formData.repaymentDays),\r\n      penaltyRate: parseFloat(formData.penaltyRate),\r\n    }\r\n\r\n    onSubmit(submitData)\r\n  }\r\n\r\n  const formatCurrency = (value) => {\r\n    if (!value) return ''\r\n    const num = parseFloat(value)\r\n    if (num >= 100000) {\r\n      return `â‚¹${(num / 100000).toFixed(1)} L`\r\n    }\r\n    return `â‚¹${num.toLocaleString('en-IN')}`\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n      {/* Repayment Days */}\r\n      <div>\r\n        <label htmlFor=\"repaymentDays\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n          <Calendar className=\"mr-1 inline h-4 w-4\" />\r\n          Repayment Days <span className=\"text-red-500\">*</span>\r\n        </label>\r\n        <input\r\n          type=\"number\"\r\n          id=\"repaymentDays\"\r\n          name=\"repaymentDays\"\r\n          value={formData.repaymentDays}\r\n          onChange={handleChange}\r\n          placeholder=\"0\"\r\n          min=\"1\"\r\n          max=\"90\"\r\n          className={cn(\r\n            'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2',\r\n            errors.repaymentDays\r\n              ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n              : 'border-gray-300 bg-white focus:border-green-500 focus:ring-green-500/50',\r\n          )}\r\n        />\r\n        {errors.repaymentDays && <p className=\"mt-1 text-xs text-red-600\">{errors.repaymentDays}</p>}\r\n        <p className=\"mt-1 text-xs text-gray-500\">Number of days vendor has to repay after purchase</p>\r\n      </div>\r\n\r\n      {/* Penalty Rate */}\r\n      <div>\r\n        <label htmlFor=\"penaltyRate\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n          <AlertCircle className=\"mr-1 inline h-4 w-4\" />\r\n          Penalty Rate (%) <span className=\"text-red-500\">*</span>\r\n        </label>\r\n        <div className=\"relative\">\r\n          <input\r\n            type=\"number\"\r\n            id=\"penaltyRate\"\r\n            name=\"penaltyRate\"\r\n            value={formData.penaltyRate}\r\n            onChange={handleChange}\r\n            placeholder=\"0.0\"\r\n            min=\"0\"\r\n            max=\"10\"\r\n            step=\"0.1\"\r\n            className={cn(\r\n              'w-full rounded-xl border px-4 py-3 pr-12 text-sm transition-all focus:outline-none focus:ring-2',\r\n              errors.penaltyRate\r\n                ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n                : 'border-gray-300 bg-white focus:border-green-500 focus:ring-green-500/50',\r\n            )}\r\n          />\r\n          <div className=\"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-500\">%</div>\r\n        </div>\r\n        {errors.penaltyRate && <p className=\"mt-1 text-xs text-red-600\">{errors.penaltyRate}</p>}\r\n        <p className=\"mt-1 text-xs text-gray-500\">Daily penalty rate applied after grace period</p>\r\n      </div>\r\n\r\n      {/* Info Box */}\r\n      <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\r\n        <div className=\"flex items-start gap-3\">\r\n          <CreditCard className=\"h-5 w-5 flex-shrink-0 text-blue-600\" />\r\n          <div className=\"text-xs text-blue-900\">\r\n            <p className=\"font-bold\">Credit Policy Guidelines</p>\r\n            <ul className=\"mt-2 space-y-1 list-disc list-inside\">\r\n              <li>No credit limit - vendors can order within â‚¹50,000 - â‚¹100,000 range</li>\r\n              <li>Standard repayment period is 30 days</li>\r\n              <li>Default penalty rate is 2% per day after due date</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Action Buttons */}\r\n      <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          disabled={loading}\r\n          className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\r\n        >\r\n          {loading ? 'Updating...' : 'Update Credit Policy'}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\DataTable.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\FilterBar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\FinancialParametersForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\FinancialParametersModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\ImageUpload.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'fileInputRefs' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":20,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react'\nimport { Upload, X, Image as ImageIcon, Loader2, GripVertical } from 'lucide-react'\nimport { CLOUDINARY_CONFIG } from '../config/cloudinary'\nimport { cn } from '../../../lib/cn'\n\n/**\n * Image Upload Component for Product Images\n * Supports up to 4 images with Cloudinary integration\n * \n * @param {Array} images - Array of existing images {url, publicId, isPrimary, order}\n * @param {Function} onChange - Callback when images change\n * @param {number} maxImages - Maximum number of images (default: 4)\n * @param {boolean} disabled - Disable upload\n */\nexport function ImageUpload({ images = [], onChange, maxImages = 4, disabled = false }) {\n  const [uploadingIndex, setUploadingIndex] = useState(null)\n  const [error, setError] = useState(null)\n  const [draggedIndex, setDraggedIndex] = useState(null)\n  const [dragOverIndex, setDragOverIndex] = useState(null)\n  const fileInputRefs = useRef({})\n  const widgetRefs = useRef({})\n\n  // Load Cloudinary Upload Widget script\n  useEffect(() => {\n    // Check if script already loaded\n    if (window.cloudinary) {\n      return\n    }\n\n    const script = document.createElement('script')\n    script.src = 'https://upload-widget.cloudinary.com/global/all.js'\n    script.async = true\n    script.onload = () => {\n      console.log('Cloudinary Upload Widget loaded')\n    }\n    script.onerror = () => {\n      setError('Failed to load Cloudinary Upload Widget. Please refresh the page.')\n    }\n    document.body.appendChild(script)\n\n    return () => {\n      // Cleanup on unmount\n      const existingScript = document.querySelector('script[src*=\"upload-widget.cloudinary.com\"]')\n      if (existingScript) {\n        existingScript.remove()\n      }\n    }\n  }, [])\n\n  const openUploadWidget = (index) => {\n    if (disabled || uploadingIndex !== null) return\n    if (!window.cloudinary) {\n      setError('Cloudinary Upload Widget is not loaded yet. Please wait a moment and try again.')\n      return\n    }\n\n    if (!CLOUDINARY_CONFIG.uploadPreset || CLOUDINARY_CONFIG.uploadPreset === 'unsigned') {\n      setError('Please configure the Cloudinary upload preset. See CLOUDINARY_SETUP.md for instructions.')\n      return\n    }\n\n    setUploadingIndex(index)\n    setError(null)\n\n    // Cloudinary Upload Widget options with optimization\n    const options = {\n      cloudName: CLOUDINARY_CONFIG.cloudName,\n      uploadPreset: CLOUDINARY_CONFIG.uploadPreset, // Use unsigned preset\n      sources: ['local', 'camera', 'url'],\n      multiple: false,\n      clientAllowedFormats: ['jpg', 'jpeg', 'png', 'webp'],\n      maxFileSize: 5000000, // 5MB\n      cropping: true,\n      croppingAspectRatio: 1, // Square images\n      croppingDefaultSelectionRatio: 0.9,\n      folder: 'ira-sathi/products', // Organize images in folder\n      transformation: [\n        {\n          width: 800,\n          height: 800,\n          crop: 'limit',\n          quality: 'auto:good', // Optimize quality and file size\n          fetchFormat: 'auto', // Auto format (webp when supported)\n        },\n      ],\n      styles: {\n        palette: {\n          window: '#FFFFFF',\n          windowBorder: '#90A0B3',\n          tabIcon: '#0078FF',\n          menuIcons: '#5A616A',\n          textDark: '#000000',\n          textLight: '#FFFFFF',\n          link: '#0078FF',\n          action: '#FF620C',\n          inactiveTabIcon: '#0E2F5A',\n          error: '#F44235',\n          inProgress: '#0078FF',\n          complete: '#20B832',\n          sourceBg: '#E4EBF1',\n        },\n      },\n    }\n\n    const widget = window.cloudinary.createUploadWidget(\n      options,\n      (error, result) => {\n        setUploadingIndex(null)\n        \n        if (error) {\n          console.error('Upload error:', error)\n          setError(error.message || 'Failed to upload image. Please try again.')\n          return\n        }\n\n        if (result && result.event === 'success') {\n          const newImage = {\n            url: result.info.secure_url,\n            publicId: result.info.public_id,\n            isPrimary: images.length === 0 && index === 0, // First image is primary\n            order: index !== null ? index : images.length,\n          }\n\n          const updatedImages = [...images]\n          if (index !== null && index < images.length) {\n            // Replace existing image\n            updatedImages[index] = newImage\n          } else {\n            // Add new image\n            updatedImages.push(newImage)\n          }\n\n          // Ensure only one primary image\n          const finalImages = updatedImages.map((img, idx) => ({\n            ...img,\n            isPrimary: idx === 0, // First image is always primary\n            order: idx,\n          }))\n\n          onChange(finalImages)\n          setError(null)\n        }\n      }\n    )\n\n    widgetRefs.current[index] = widget\n    widget.open()\n  }\n\n  const removeImage = (index) => {\n    if (disabled) return\n    \n    const updatedImages = images.filter((_, idx) => idx !== index)\n    \n    // Ensure first image is primary\n    const finalImages = updatedImages.map((img, idx) => ({\n      ...img,\n      isPrimary: idx === 0,\n      order: idx,\n    }))\n\n    onChange(finalImages)\n  }\n\n  // Drag and drop handlers for reordering images\n  const handleDragStart = (e, index) => {\n    if (disabled || images.length <= 1) return\n    setDraggedIndex(index)\n    e.dataTransfer.effectAllowed = 'move'\n    e.dataTransfer.setData('text/plain', index.toString())\n    // Set opacity on the dragged element\n    if (e.currentTarget) {\n      e.currentTarget.style.opacity = '0.5'\n    }\n  }\n\n  const handleDragEnd = (e) => {\n    // Reset opacity\n    if (e.currentTarget) {\n      e.currentTarget.style.opacity = '1'\n    }\n    setDraggedIndex(null)\n    setDragOverIndex(null)\n  }\n\n  const handleDragOver = (e, index) => {\n    e.preventDefault()\n    e.dataTransfer.dropEffect = 'move'\n    if (draggedIndex !== null && draggedIndex !== index) {\n      setDragOverIndex(index)\n    }\n  }\n\n  const handleDragLeave = () => {\n    setDragOverIndex(null)\n  }\n\n  const handleDrop = (e, dropIndex) => {\n    e.preventDefault()\n    setDragOverIndex(null)\n    \n    if (draggedIndex === null || draggedIndex === dropIndex || disabled) {\n      return\n    }\n\n    const updatedImages = [...images]\n    const draggedImage = updatedImages[draggedIndex]\n    \n    // Remove dragged image from its position\n    updatedImages.splice(draggedIndex, 1)\n    \n    // Insert at new position\n    updatedImages.splice(dropIndex, 0, draggedImage)\n    \n    // Update order and primary status\n    const finalImages = updatedImages.map((img, idx) => ({\n      ...img,\n      isPrimary: idx === 0,\n      order: idx,\n    }))\n\n    onChange(finalImages)\n    setDraggedIndex(null)\n  }\n\n  const canAddMore = images.length < maxImages\n\n  return (\n    <div className=\"space-y-3\">\n      <label className=\"block text-sm font-bold text-gray-900\">\n        <ImageIcon className=\"mr-1 inline h-4 w-4\" />\n        Product Images\n        <span className=\"text-xs font-normal text-gray-500 ml-2\">\n          (Max {maxImages} images. First image will be the primary image. Drag images to reorder)\n        </span>\n      </label>\n\n      {error && (\n        <div className=\"rounded-lg bg-red-50 border border-red-200 px-4 py-2 text-sm text-red-700\">\n          {error}\n        </div>\n      )}\n\n      <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4\">\n        {/* Existing Images */}\n        {images.map((image, index) => {\n          // Handle both object format {url, publicId} and string format (for backward compatibility)\n          const imageUrl = typeof image === 'string' ? image : (image?.url || '')\n          if (!imageUrl) return null\n          \n          const isDragging = draggedIndex === index\n          const isDragOver = dragOverIndex === index\n          \n          return (\n          <div \n            key={index} \n            className={cn(\n              \"relative group transition-all\",\n              !disabled && images.length > 1 && \"cursor-move\",\n              isDragging && \"opacity-50 scale-95\",\n              isDragOver && \"ring-2 ring-purple-500 ring-offset-2 scale-105\"\n            )}\n            draggable={!disabled && images.length > 1}\n            onDragStart={(e) => handleDragStart(e, index)}\n            onDragEnd={handleDragEnd}\n            onDragOver={(e) => handleDragOver(e, index)}\n            onDragLeave={handleDragLeave}\n            onDrop={(e) => handleDrop(e, index)}\n          >\n            <div className=\"relative aspect-square rounded-xl border-2 border-gray-300 overflow-hidden bg-gray-50\">\n              {!disabled && images.length > 1 && (\n                <div className=\"absolute top-2 left-2 z-10 p-1.5 bg-gray-800/70 text-white rounded cursor-move opacity-0 group-hover:opacity-100 transition-opacity\">\n                  <GripVertical className=\"h-4 w-4\" />\n                </div>\n              )}\n              <img\n                src={imageUrl}\n                alt={`Product image ${index + 1}`}\n                className=\"w-full h-full object-cover pointer-events-none\"\n                draggable={false}\n                onError={(e) => {\n                  e.target.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI0U0RThFQiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5Q0EzQUYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5JbWFnZSBub3QgZm91bmQ8L3RleHQ+PC9zdmc+'\n                }}\n              />\n              {((typeof image === 'object' && image.isPrimary) || (index === 0)) && (\n                <div className=\"absolute top-2 right-2 bg-green-500 text-white text-xs font-bold px-2 py-1 rounded\">\n                  Primary\n                </div>\n              )}\n              {!disabled && (\n                <button\n                  type=\"button\"\n                  onClick={() => removeImage(index)}\n                  className=\"absolute bottom-2 right-2 p-1.5 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 z-10\"\n                  aria-label=\"Remove image\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </button>\n              )}\n            </div>\n            {index === 0 && images.length > 1 && (\n              <p className=\"mt-1 text-xs text-center text-gray-500\">Primary</p>\n            )}\n            {images.length > 1 && !disabled && (\n              <p className=\"mt-1 text-xs text-center text-gray-500\">\n                Position {index + 1} â€¢ Drag to reorder\n              </p>\n            )}\n          </div>\n        )})}\n\n        {/* Upload Button */}\n        {canAddMore && !disabled && (\n          <button\n            type=\"button\"\n            onClick={() => openUploadWidget(images.length)}\n            disabled={uploadingIndex !== null || disabled}\n            className={cn(\n              'aspect-square rounded-xl border-2 border-dashed transition-all',\n              'flex flex-col items-center justify-center gap-2',\n              'hover:border-purple-400 hover:bg-purple-50',\n              'disabled:opacity-50 disabled:cursor-not-allowed',\n              uploadingIndex === images.length\n                ? 'border-purple-400 bg-purple-50'\n                : 'border-gray-300 bg-gray-50'\n            )}\n          >\n            {uploadingIndex === images.length ? (\n              <>\n                <Loader2 className=\"h-6 w-6 animate-spin text-purple-600\" />\n                <span className=\"text-xs font-semibold text-purple-600\">Uploading...</span>\n              </>\n            ) : (\n              <>\n                <Upload className=\"h-6 w-6 text-gray-400\" />\n                <span className=\"text-xs font-semibold text-gray-600\">Add Image</span>\n              </>\n            )}\n          </button>\n        )}\n\n        {/* Replace Image Button (for existing slots) */}\n        {images.length > 0 && images.length < maxImages && !disabled && (\n          <button\n            type=\"button\"\n            onClick={() => openUploadWidget(images.length)}\n            disabled={uploadingIndex !== null || disabled}\n            className={cn(\n              'aspect-square rounded-xl border-2 border-dashed transition-all',\n              'flex flex-col items-center justify-center gap-2',\n              'hover:border-purple-400 hover:bg-purple-50',\n              'disabled:opacity-50 disabled:cursor-not-allowed',\n              'border-gray-300 bg-gray-50'\n            )}\n          >\n            <Upload className=\"h-6 w-6 text-gray-400\" />\n            <span className=\"text-xs font-semibold text-gray-600\">Add Image</span>\n          </button>\n        )}\n      </div>\n\n      {images.length === 0 && !disabled && (\n        <p className=\"text-xs text-gray-500\">\n          Click the upload button to add product images. The first image will be set as the primary image.\n        </p>\n      )}\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\LogisticsSettingsForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\LogisticsSettingsModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\MetricCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\Modal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\NotificationForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\NotificationFormFullScreen.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\OrderDetailModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[232,268],"text":""},"desc":"Remove unused variable 'cn'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Package, IndianRupee, Calendar, CreditCard, AlertCircle, FileText, Download, RefreshCw } from 'lucide-react'\nimport { Modal } from './Modal'\nimport { StatusBadge } from './StatusBadge'\nimport { Timeline } from './Timeline'\nimport { cn } from '../../../lib/cn'\n\nexport function OrderDetailModal({ isOpen, onClose, order, onReassign, onGenerateInvoice, onProcessRefund, onUpdateStatus, loading }) {\n  if (!order) return null\n\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') {\n      return value\n    }\n    if (value >= 100000) {\n      return `â‚¹${(value / 100000).toFixed(1)} L`\n    }\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  // Extract vendor name safely - handle both populated object and string\n  const getVendorName = () => {\n    if (typeof order.vendor === 'string') {\n      return order.vendor\n    }\n    if (order.vendorId && typeof order.vendorId === 'object') {\n      return order.vendorId.name || 'Unknown Vendor'\n    }\n    if (order.vendor && typeof order.vendor === 'object') {\n      return order.vendor.name || 'Unknown Vendor'\n    }\n    return 'Unknown Vendor'\n  }\n\n  // Extract vendor ID safely - handle both populated object and string ID\n  const getVendorId = () => {\n    if (typeof order.vendorId === 'string') {\n      return order.vendorId\n    }\n    if (order.vendorId && typeof order.vendorId === 'object') {\n      return order.vendorId._id || order.vendorId.id || null\n    }\n    if (order.vendor && typeof order.vendor === 'object') {\n      return order.vendor._id || order.vendor.id || null\n    }\n    return null\n  }\n\n  // Extract user name safely - handle both populated object and string\n  const getUserName = () => {\n    if (typeof order.user === 'string') {\n      return order.user\n    }\n    if (order.userId && typeof order.userId === 'object') {\n      return order.userId.name || 'Unknown User'\n    }\n    if (order.user && typeof order.user === 'object') {\n      return order.user.name || 'Unknown User'\n    }\n    return null\n  }\n\n  // Extract order ID safely\n  const getOrderId = () => {\n    if (typeof order.id === 'string') {\n      return order.id\n    }\n    if (order._id) {\n      return typeof order._id === 'string' ? order._id : String(order._id)\n    }\n    if (order.orderId) {\n      return typeof order.orderId === 'string' ? order.orderId : String(order.orderId)\n    }\n    if (order.id && typeof order.id === 'object' && order.id._id) {\n      return String(order.id._id)\n    }\n    return 'N/A'\n  }\n\n  // Format date safely\n  const formatDate = (dateValue) => {\n    if (!dateValue) return null\n    if (typeof dateValue === 'string') {\n      return dateValue\n    }\n    if (dateValue instanceof Date) {\n      return dateValue.toLocaleDateString('en-IN')\n    }\n    try {\n      return new Date(dateValue).toLocaleDateString('en-IN')\n    } catch {\n      return String(dateValue)\n    }\n  }\n\n  const orderValue = typeof order.value === 'number' \n    ? order.value \n    : parseFloat(order.value?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n\n  const advanceAmount = typeof order.advance === 'number'\n    ? order.advance\n    : order.advanceStatus === 'paid' ? orderValue * 0.3 : 0\n\n  const pendingAmount = typeof order.pending === 'number'\n    ? order.pending\n    : orderValue - advanceAmount\n\n  const advanceStatus = order.advanceStatus || (order.advance === 'Paid' ? 'paid' : 'pending')\n\n  const vendorName = getVendorName()\n  const vendorId = getVendorId()\n  const userName = getUserName()\n  const orderId = getOrderId()\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title={`Order Details - ${orderId}`} size=\"xl\">\n      <div className=\"space-y-6\">\n        {/* Order Header */}\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex items-start gap-4\">\n              <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-red-500 to-red-600 text-white shadow-lg\">\n                <Package className=\"h-6 w-6\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-bold text-gray-900\">Order #{orderId}</h3>\n                <p className=\"text-sm text-gray-600\">Type: {order.type || 'Unknown'}</p>\n                <div className=\"mt-2 flex items-center gap-4 text-xs text-gray-500\">\n                  {(order.date || order.createdAt) && (\n                    <div className=\"flex items-center gap-1\">\n                      <Calendar className=\"h-3.5 w-3.5\" />\n                      <span>{formatDate(order.date || order.createdAt)}</span>\n                    </div>\n                  )}\n                  {order.region && (\n                    <span>{order.region}</span>\n                  )}\n                </div>\n                {userName && (\n                  <div className=\"mt-1 text-xs text-gray-500\">\n                    User: {userName}\n                  </div>\n                )}\n              </div>\n            </div>\n            <StatusBadge tone={order.status === 'Processing' || order.status === 'processing' ? 'warning' : order.status === 'Completed' || order.status === 'completed' ? 'success' : 'neutral'}>\n              {order.status || 'Unknown'}\n            </StatusBadge>\n          </div>\n        </div>\n\n        {/* Vendor Information */}\n        {(vendorName || vendorId) && (\n          <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n            <p className=\"text-xs text-gray-500 mb-1\">Vendor</p>\n            <p className=\"text-sm font-bold text-gray-900\">{vendorName}</p>\n            {vendorId && (\n              <p className=\"text-xs text-gray-600 mt-1\">Vendor ID: {vendorId}</p>\n            )}\n          </div>\n        )}\n\n        {/* Payment Summary */}\n        <div className=\"space-y-4\">\n          <h4 className=\"text-sm font-bold text-gray-900\">Payment Status</h4>\n          \n          <div className=\"grid gap-4 sm:grid-cols-3\">\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <p className=\"text-xs text-gray-500\">Order Value</p>\n              <p className=\"mt-1 text-lg font-bold text-gray-900\">\n                {formatCurrency(orderValue)}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <div className=\"flex items-center justify-between mb-1\">\n                <p className=\"text-xs text-gray-500\">Advance (30%)</p>\n                <StatusBadge tone={advanceStatus === 'paid' ? 'success' : 'warning'}>\n                  {advanceStatus === 'paid' ? 'Paid' : 'Pending'}\n                </StatusBadge>\n              </div>\n              <p className=\"text-lg font-bold text-gray-900\">\n                {formatCurrency(advanceAmount)}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <p className=\"text-xs text-gray-500\">Pending (70%)</p>\n              <p className=\"mt-1 text-lg font-bold text-red-600\">\n                {formatCurrency(pendingAmount)}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {/* Order Items */}\n        {order.items && order.items.length > 0 && (\n          <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n            <h4 className=\"mb-4 text-sm font-bold text-gray-900\">Order Items</h4>\n            <div className=\"space-y-3\">\n              {order.items.map((item, index) => {\n                // Extract product name safely - handle both populated object and string\n                const getProductName = () => {\n                  if (item.name) {\n                    return typeof item.name === 'string' ? item.name : String(item.name)\n                  }\n                  if (item.productId && typeof item.productId === 'object') {\n                    return item.productId.name || 'Unknown Product'\n                  }\n                  if (item.product) {\n                    return typeof item.product === 'string' ? item.product : String(item.product)\n                  }\n                  return 'Unknown Product'\n                }\n\n                // Extract product price safely - use variant-specific price (unitPrice) if available\n                const getProductPrice = () => {\n                  if (item.unitPrice) return item.unitPrice // Variant-specific price\n                  if (item.price) return item.price\n                  if (item.amount) return item.amount\n                  if (item.productId && typeof item.productId === 'object' && item.productId.priceToUser) {\n                    return item.productId.priceToUser\n                  }\n                  return 0\n                }\n\n                const productName = getProductName()\n                const unitPrice = getProductPrice()\n                const quantity = item.quantity || 1\n                const totalPrice = item.totalPrice || (unitPrice * quantity)\n                const variantAttrs = item.variantAttributes || {}\n\n                return (\n                  <div key={item.id || item._id || index} className=\"flex items-center justify-between rounded-lg border border-gray-200 bg-gray-50 p-3\">\n                    <div>\n                      <p className=\"text-sm font-bold text-gray-900\">{productName}</p>\n                      {/* Display variant attributes if present */}\n                      {variantAttrs && Object.keys(variantAttrs).length > 0 && (\n                        <div className=\"mt-1 space-y-0.5\">\n                          {Object.entries(variantAttrs).map(([key, value]) => (\n                            <p key={key} className=\"text-xs text-gray-600\">\n                              <span className=\"font-medium\">{key}:</span> {value}\n                            </p>\n                          ))}\n                        </div>\n                      )}\n                      <p className=\"text-xs text-gray-600\">Quantity: {quantity} {item.unit || 'units'} Ã— â‚¹{unitPrice.toLocaleString('en-IN')}</p>\n                    </div>\n                    <p className=\"text-sm font-bold text-gray-900\">{formatCurrency(totalPrice)}</p>\n                  </div>\n                )\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Payment Timeline */}\n        {order.paymentHistory && order.paymentHistory.length > 0 && (\n          <div className=\"rounded-xl border border-blue-200 bg-white p-5\">\n            <div className=\"mb-4 flex items-center gap-2\">\n              <CreditCard className=\"h-5 w-5 text-blue-600\" />\n              <h4 className=\"text-sm font-bold text-gray-900\">Payment Timeline</h4>\n            </div>\n            <Timeline\n              events={order.paymentHistory.map((payment, index) => ({\n                id: payment.id || `payment-${index}`,\n                title: payment.type || 'Payment',\n                timestamp: payment.date || payment.timestamp || 'N/A',\n                description: formatCurrency(payment.amount || 0),\n                status: payment.status || 'completed',\n              }))}\n            />\n          </div>\n        )}\n\n        {/* Refunds & Escalations */}\n        {(order.refunds && order.refunds.length > 0) || order.escalated ? (\n          <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-5\">\n            <div className=\"mb-4 flex items-center gap-2\">\n              <AlertCircle className=\"h-5 w-5 text-orange-600\" />\n              <h4 className=\"text-sm font-bold text-gray-900\">Refunds & Escalations</h4>\n            </div>\n            {order.escalated && (\n              <div className=\"mb-3 rounded-lg border border-orange-300 bg-white p-3\">\n                <p className=\"text-sm font-bold text-orange-900\">Order Escalated</p>\n                <p className=\"text-xs text-orange-700\">{order.escalationReason || 'Order requires admin attention'}</p>\n              </div>\n            )}\n            {order.refunds && order.refunds.length > 0 && (\n              <div className=\"space-y-2\">\n                {order.refunds.map((refund, index) => (\n                  <div key={refund.id || index} className=\"rounded-lg border border-orange-300 bg-white p-3\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"text-sm font-bold text-gray-900\">Refund #{refund.id || index + 1}</p>\n                        <p className=\"text-xs text-gray-600\">{refund.reason || 'Refund requested'}</p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-sm font-bold text-orange-600\">{formatCurrency(refund.amount || 0)}</p>\n                        <StatusBadge tone={refund.status === 'processed' ? 'success' : 'warning'}>\n                          {refund.status || 'Pending'}\n                        </StatusBadge>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        ) : null}\n\n        {/* Status Update Section (for admin-fulfilled orders) */}\n        {order.assignedTo === 'admin' && onUpdateStatus && order.status !== 'fully_paid' && (\n          <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-5\">\n            <div className=\"mb-4 flex items-center gap-2\">\n              <RefreshCw className=\"h-5 w-5 text-blue-600\" />\n              <h4 className=\"text-sm font-bold text-gray-900\">Update Order Status</h4>\n            </div>\n            <div className=\"space-y-3\">\n              <div className=\"flex flex-wrap gap-2\">\n                {(order.status === 'processing' || order.status === 'awaiting') && (\n                  <button\n                    type=\"button\"\n                    onClick={() => onUpdateStatus(orderId, { status: 'dispatched' })}\n                    disabled={loading}\n                    className=\"rounded-lg border border-blue-300 bg-white px-4 py-2 text-sm font-semibold text-blue-700 transition-all hover:bg-blue-50 disabled:opacity-50\"\n                  >\n                    Mark as Dispatched\n                  </button>\n                )}\n                {(order.status === 'dispatched' || order.status === 'processing' || order.status === 'awaiting') && (\n                  <button\n                    type=\"button\"\n                    onClick={() => onUpdateStatus(orderId, { status: 'delivered' })}\n                    disabled={loading}\n                    className=\"rounded-lg border border-green-300 bg-white px-4 py-2 text-sm font-semibold text-green-700 transition-all hover:bg-green-50 disabled:opacity-50\"\n                  >\n                    Mark as Delivered\n                  </button>\n                )}\n                {order.status === 'delivered' && (\n                  <button\n                    type=\"button\"\n                    onClick={() => onUpdateStatus(orderId, { status: 'fully_paid' })}\n                    disabled={loading}\n                    className=\"rounded-lg border border-purple-300 bg-white px-4 py-2 text-sm font-semibold text-purple-700 transition-all hover:bg-purple-50 disabled:opacity-50\"\n                  >\n                    Mark as Paid Full Amount\n                  </button>\n                )}\n              </div>\n              <p className=\"text-xs text-gray-600\">\n                Current status: <span className=\"font-semibold\">{order.status || 'processing'}</span>\n              </p>\n            </div>\n          </div>\n        )}\n\n        {/* Action Buttons */}\n        <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n          <button\n            type=\"button\"\n            onClick={onClose}\n            disabled={loading}\n            className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n          >\n            Close\n          </button>\n          <div className=\"flex gap-3\">\n            {onReassign && (\n              <button\n                type=\"button\"\n                onClick={() => onReassign(order)}\n                disabled={loading}\n                className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50 disabled:opacity-50\"\n              >\n                <RefreshCw className=\"h-4 w-4\" />\n                Reassign\n              </button>\n            )}\n            {onProcessRefund && order.refunds && order.refunds.some(r => r.status !== 'processed') && (\n              <button\n                type=\"button\"\n                onClick={() => onProcessRefund(orderId)}\n                disabled={loading}\n                className=\"flex items-center gap-2 rounded-xl border border-orange-300 bg-white px-6 py-3 text-sm font-bold text-orange-600 transition-all hover:bg-orange-50 disabled:opacity-50\"\n              >\n                <RefreshCw className=\"h-4 w-4\" />\n                Process Refund\n              </button>\n            )}\n            {onGenerateInvoice && (\n              <button\n                type=\"button\"\n                onClick={() => onGenerateInvoice(orderId)}\n                disabled={loading}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(59,130,246,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(59,130,246,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <FileText className=\"h-4 w-4\" />\n                Generate Invoice\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    </Modal>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\OrderEscalationModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[189,225],"text":""},"desc":"Remove unused variable 'cn'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\r\nimport { Package, Warehouse, AlertCircle, CheckCircle } from 'lucide-react'\r\nimport { Modal } from './Modal'\r\nimport { StatusBadge } from './StatusBadge'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nexport function OrderEscalationModal({ isOpen, onClose, order, onFulfillFromWarehouse, loading }) {\r\n  const [fulfillmentNote, setFulfillmentNote] = useState('')\r\n\r\n  if (!order) return null\r\n\r\n  const formatCurrency = (value) => {\r\n    if (typeof value === 'string') {\r\n      return value\r\n    }\r\n    if (value >= 100000) {\r\n      return `â‚¹${(value / 100000).toFixed(1)} L`\r\n    }\r\n    return `â‚¹${value.toLocaleString('en-IN')}`\r\n  }\r\n\r\n  const handleFulfill = () => {\r\n    if (onFulfillFromWarehouse) {\r\n      onFulfillFromWarehouse(order.id, {\r\n        note: fulfillmentNote.trim() || 'Order fulfilled from master warehouse',\r\n      })\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Modal isOpen={isOpen} onClose={onClose} title=\"Order Escalation - Manual Fulfillment\" size=\"md\">\r\n      <div className=\"space-y-6\">\r\n        {/* Order Info */}\r\n        <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n          <div className=\"mb-3 flex items-center gap-2\">\r\n            <Package className=\"h-5 w-5 text-gray-600\" />\r\n            <p className=\"text-sm font-bold text-gray-900\">Order #{order.orderNumber || order.id}</p>\r\n          </div>\r\n          <div className=\"space-y-2 text-sm\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-gray-600\">Vendor:</span>\r\n              <span className=\"font-bold text-gray-900\">{order.vendor || 'N/A'}</span>\r\n            </div>\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-gray-600\">Order Value:</span>\r\n              <span className=\"font-bold text-gray-900\">\r\n                {formatCurrency(order.value || order.orderValue || 0)}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-gray-600\">Status:</span>\r\n              <StatusBadge tone=\"warning\">Vendor Not Available</StatusBadge>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Escalation Reason */}\r\n        <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-4\">\r\n          <div className=\"flex items-start gap-3\">\r\n            <AlertCircle className=\"h-5 w-5 flex-shrink-0 text-orange-600\" />\r\n            <div>\r\n              <p className=\"text-sm font-bold text-orange-900\">Escalation Reason</p>\r\n              <p className=\"mt-1 text-xs text-orange-700\">\r\n                {order.escalationReason || order.escalation?.escalationReason || order.notes || 'Vendor marked this order as \"Not Available\". You can manually fulfill this order from the master warehouse.'}\r\n              </p>\r\n              {order.escalation?.escalatedAt && (\r\n                <p className=\"mt-2 text-xs text-orange-600\">\r\n                  Escalated on: {new Date(order.escalation.escalatedAt).toLocaleString('en-IN')}\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Order Items */}\r\n        {order.items && order.items.length > 0 && (\r\n          <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\r\n            <p className=\"mb-3 text-sm font-bold text-gray-900\">Order Items</p>\r\n            <div className=\"space-y-2\">\r\n              {order.items.map((item, index) => {\r\n                const itemId = item._id || item.id || index\r\n                const productName = item.productName || item.productId?.name || item.name || item.product || 'Unknown Product'\r\n                const quantity = item.quantity || 1\r\n                const unitPrice = item.unitPrice || item.price || item.amount || 0\r\n                const totalPrice = item.totalPrice || (unitPrice * quantity)\r\n                const variantAttrs = item.variantAttributes || {}\r\n                \r\n                return (\r\n                  <div key={itemId} className=\"flex items-center justify-between rounded-lg border border-gray-200 bg-gray-50 p-2\">\r\n                    <div>\r\n                      <p className=\"text-sm font-bold text-gray-900\">{productName}</p>\r\n                      {/* Display variant attributes if present */}\r\n                      {variantAttrs && Object.keys(variantAttrs).length > 0 && (\r\n                        <div className=\"mt-1 space-y-0.5\">\r\n                          {Object.entries(variantAttrs).map(([key, value]) => (\r\n                            <p key={key} className=\"text-xs text-gray-600\">\r\n                              <span className=\"font-medium\">{key}:</span> {value}\r\n                            </p>\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                      <p className=\"text-xs text-gray-600\">Qty: {quantity} {item.unit || 'units'} Ã— â‚¹{unitPrice.toLocaleString('en-IN')}</p>\r\n                    </div>\r\n                    <p className=\"text-sm font-bold text-gray-900\">\r\n                      {formatCurrency(totalPrice)}\r\n                    </p>\r\n                  </div>\r\n                )\r\n              })}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Fulfillment Note */}\r\n        <div>\r\n          <label htmlFor=\"fulfillmentNote\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n            Fulfillment Note (Optional)\r\n          </label>\r\n          <textarea\r\n            id=\"fulfillmentNote\"\r\n            value={fulfillmentNote}\r\n            onChange={(e) => setFulfillmentNote(e.target.value)}\r\n            placeholder=\"Add any notes about this fulfillment...\"\r\n            rows={3}\r\n            className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\r\n          />\r\n        </div>\r\n\r\n        {/* Info Box */}\r\n        <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\r\n          <div className=\"flex items-start gap-3\">\r\n            <Warehouse className=\"h-5 w-5 flex-shrink-0 text-blue-600\" />\r\n            <div className=\"text-xs text-blue-900\">\r\n              <p className=\"font-bold\">Master Warehouse Fulfillment</p>\r\n              <ul className=\"mt-2 space-y-1 list-disc list-inside\">\r\n                <li>Order will be fulfilled from master warehouse inventory</li>\r\n                <li>Vendor will be notified of the fulfillment</li>\r\n                <li>Order status will be updated to \"Accepted\"</li>\r\n                <li>You can then update status: Dispatched â†’ Delivered â†’ Fully Paid (if partial payment)</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={onClose}\r\n            disabled={loading}\r\n            className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleFulfill}\r\n            disabled={loading}\r\n            className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\r\n          >\r\n            <CheckCircle className=\"h-4 w-4\" />\r\n            {loading ? 'Fulfilling...' : 'Fulfill from Warehouse'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\OrderReassignmentModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\OrderStatusUpdateModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\OutstandingCreditsView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[129,165],"text":""},"desc":"Remove unused variable 'cn'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'onViewDetails' is defined but never used.","line":5,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":64,"suggestions":[{"messageId":"removeVar","data":{"varName":"onViewDetails"},"fix":{"range":[217,232],"text":""},"desc":"Remove unused variable 'onViewDetails'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { IndianRupee, TrendingUp, AlertCircle, CheckCircle } from 'lucide-react'\r\nimport { ProgressList } from './ProgressList'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nexport function OutstandingCreditsView({ credits, onViewDetails }) {\r\n  if (!credits || credits.length === 0) {\r\n    return (\r\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n        <p className=\"text-sm text-gray-600\">No outstanding credits data available</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4 rounded-3xl border border-pink-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n      <div className=\"flex items-center gap-3\">\r\n        <IndianRupee className=\"h-5 w-5 text-pink-600\" />\r\n        <div>\r\n          <h3 className=\"text-lg font-bold text-pink-700\">Outstanding Credits</h3>\r\n          <p className=\"text-sm text-gray-600\">Monitor overall credit utilization and recovery status</p>\r\n        </div>\r\n      </div>\r\n      <ProgressList items={credits} />\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\ProductAttributesModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\ProductForm.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'handleAttributeChange' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":278,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":278,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'id' is defined but never used.","line":473,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":473,"endColumn":60,"suggestions":[{"messageId":"removeVar","data":{"varName":"id"},"fix":{"range":[21200,21203],"text":""},"desc":"Remove unused variable 'id'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":812,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":812,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[36703,36704],"text":""},"desc":"Remove unused variable '_'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\nimport { Calendar, Package, IndianRupee, Eye, EyeOff, Tag, X, Layers } from 'lucide-react'\nimport { cn } from '../../../lib/cn'\nimport { ImageUpload } from './ImageUpload'\nimport { AttributeStockForm } from './AttributeStockForm'\n\nconst STOCK_UNITS = ['kg', 'L', 'bags', 'units']\n\n// Fertilizer Categories (This platform is for fertilizers only)\nconst FERTILIZER_CATEGORIES = [\n  { value: 'npk', label: 'NPK Fertilizers', description: 'Balanced NPK fertilizers' },\n  { value: 'nitrogen', label: 'Nitrogen Fertilizers', description: 'High nitrogen content' },\n  { value: 'phosphorus', label: 'Phosphorus Fertilizers', description: 'Phosphorus-rich fertilizers' },\n  { value: 'potassium', label: 'Potassium Fertilizers', description: 'Potassium fertilizers' },\n  { value: 'organic', label: 'Organic Fertilizers', description: 'Natural and organic fertilizers' },\n  { value: 'biofertilizer', label: 'Biofertilizers', description: 'Microbial fertilizers' },\n  { value: 'micronutrient', label: 'Micronutrient Fertilizers', description: 'Essential trace elements' },\n  { value: 'liquid', label: 'Liquid Fertilizers', description: 'Water-soluble fertilizers' },\n  { value: 'granular', label: 'Granular Fertilizers', description: 'Solid granular fertilizers' },\n  { value: 'foliar', label: 'Foliar Fertilizers', description: 'Applied to plant leaves' },\n  { value: 'soil-conditioner', label: 'Soil Conditioners', description: 'Improve soil structure' },\n  { value: 'specialty', label: 'Specialty Fertilizers', description: 'Specialized fertilizers' },\n]\n\n// Category-specific attributes configuration\nconst CATEGORY_ATTRIBUTES = {\n  npk: [\n    { key: 'npkRatio', label: 'NPK Ratio (N-P-K)', type: 'text', placeholder: 'e.g., 19:19:19', required: false },\n    { key: 'form', label: 'Form', type: 'select', options: ['Granular', 'Liquid', 'Powder'], required: false },\n    { key: 'grade', label: 'Grade', type: 'text', placeholder: 'e.g., Premium, Standard', required: false },\n  ],\n  nitrogen: [\n    { key: 'nitrogenContent', label: 'Nitrogen Content (%)', type: 'number', placeholder: 'e.g., 46', required: false },\n    { key: 'form', label: 'Form', type: 'select', options: ['Urea', 'Ammonium', 'Nitrate', 'Liquid'], required: false },\n    { key: 'applicationMethod', label: 'Application Method', type: 'select', options: ['Soil', 'Foliar', 'Drip'], required: false },\n  ],\n  phosphorus: [\n    { key: 'phosphorusContent', label: 'Phosphorus Content (%)', type: 'number', placeholder: 'e.g., 20', required: false },\n    { key: 'form', label: 'Form', type: 'select', options: ['Granular', 'Liquid', 'Powder'], required: false },\n    { key: 'applicationMethod', label: 'Application Method', type: 'select', options: ['Soil', 'Foliar', 'Drip'], required: false },\n  ],\n  potassium: [\n    { key: 'potassiumContent', label: 'Potassium Content (%)', type: 'number', placeholder: 'e.g., 60', required: false },\n    { key: 'form', label: 'Form', type: 'select', options: ['Granular', 'Liquid', 'Powder'], required: false },\n    { key: 'applicationMethod', label: 'Application Method', type: 'select', options: ['Soil', 'Foliar', 'Drip'], required: false },\n  ],\n  organic: [\n    { key: 'organicCertified', label: 'Organic Certified', type: 'select', options: ['Yes', 'No'], required: false },\n    { key: 'source', label: 'Source', type: 'select', options: ['Plant-based', 'Animal-based', 'Mixed'], required: false },\n    { key: 'form', label: 'Form', type: 'select', options: ['Compost', 'Manure', 'Liquid', 'Granular'], required: false },\n  ],\n  biofertilizer: [\n    { key: 'microorganismType', label: 'Microorganism Type', type: 'text', placeholder: 'e.g., Rhizobium, Azotobacter', required: false },\n    { key: 'applicationMethod', label: 'Application Method', type: 'select', options: ['Seed Treatment', 'Soil Application', 'Foliar'], required: false },\n    { key: 'shelfLife', label: 'Shelf Life (months)', type: 'number', placeholder: 'e.g., 12', required: false },\n  ],\n  micronutrient: [\n    { key: 'micronutrientType', label: 'Micronutrient Type', type: 'select', options: ['Zinc', 'Iron', 'Boron', 'Manganese', 'Copper', 'Molybdenum'], required: false },\n    { key: 'concentration', label: 'Concentration (%)', type: 'number', placeholder: 'e.g., 12', required: false },\n    { key: 'form', label: 'Form', type: 'select', options: ['Chelated', 'Sulfate', 'Liquid'], required: false },\n  ],\n  liquid: [\n    { key: 'concentration', label: 'Concentration (%)', type: 'number', placeholder: 'e.g., 20', required: false },\n    { key: 'applicationMethod', label: 'Application Method', type: 'select', options: ['Foliar', 'Drip', 'Soil Drench'], required: false },\n    { key: 'dilutionRatio', label: 'Dilution Ratio', type: 'text', placeholder: 'e.g., 1:100', required: false },\n  ],\n  granular: [\n    { key: 'granuleSize', label: 'Granule Size', type: 'select', options: ['Fine', 'Medium', 'Coarse'], required: false },\n    { key: 'applicationMethod', label: 'Application Method', type: 'select', options: ['Broadcast', 'Band Placement', 'Side Dressing'], required: false },\n    { key: 'releaseType', label: 'Release Type', type: 'select', options: ['Immediate', 'Slow Release', 'Controlled Release'], required: false },\n  ],\n  foliar: [\n    { key: 'applicationMethod', label: 'Application Method', type: 'select', options: ['Spray', 'Mist', 'Drip'], required: false },\n    { key: 'dilutionRatio', label: 'Dilution Ratio', type: 'text', placeholder: 'e.g., 1:200', required: false },\n    { key: 'cropCompatibility', label: 'Crop Compatibility', type: 'text', placeholder: 'e.g., All crops, Vegetables', required: false },\n  ],\n  'soil-conditioner': [\n    { key: 'phAdjustment', label: 'pH Adjustment', type: 'select', options: ['Acidic', 'Alkaline', 'Neutral'], required: false },\n    { key: 'organicMatter', label: 'Organic Matter (%)', type: 'number', placeholder: 'e.g., 30', required: false },\n    { key: 'applicationRate', label: 'Application Rate (kg/acre)', type: 'number', placeholder: 'e.g., 100', required: false },\n  ],\n  specialty: [\n    { key: 'specialProperties', label: 'Special Properties', type: 'text', placeholder: 'e.g., Water-soluble, Slow-release', required: false },\n    { key: 'applicationMethod', label: 'Application Method', type: 'select', options: ['Foliar', 'Soil', 'Drip', 'Hydroponic'], required: false },\n    { key: 'targetCrops', label: 'Target Crops', type: 'text', placeholder: 'e.g., Fruits, Vegetables, Flowers', required: false },\n  ],\n}\n\nexport function ProductForm({ product, onSubmit, onCancel, loading = false }) {\n  const [formData, setFormData] = useState({\n    name: '',\n    category: 'npk', // Default to NPK\n    shortDescription: '', // Short description for product cards\n    description: '', // Long description for product details page\n    actualStock: '',\n    displayStock: '',\n    stockUnit: 'kg',\n    vendorPrice: '',\n    userPrice: '',\n    expiry: '',\n    visibility: 'active',\n    batchNumber: '',\n    tags: [],\n    attributes: {},\n    images: [], // Array of image objects {url, publicId, isPrimary, order}\n    attributeStocks: [], // Array of stock entries per attribute combination\n  })\n\n  const [tagInput, setTagInput] = useState('')\n  const [errors, setErrors] = useState({})\n  const [showAttributeStockForm, setShowAttributeStockForm] = useState(false)\n\n  useEffect(() => {\n    if (product) {\n      // Parse existing product data\n      // Handle stock: check for actualStock and displayStock first, fallback to legacy stock\n      let actualStockValue = ''\n      let displayStockValue = ''\n      let stockUnit = 'kg'\n      \n      // Check for actualStock and displayStock first\n      if (product.actualStock != null && product.actualStock !== undefined) {\n        actualStockValue = String(product.actualStock)\n      }\n      if (product.displayStock != null && product.displayStock !== undefined) {\n        displayStockValue = String(product.displayStock)\n      }\n      \n      // Fallback to legacy stock field if new fields not available\n      if (!actualStockValue && product.stock != null && product.stock !== undefined) {\n        if (typeof product.stock === 'number') {\n          actualStockValue = String(product.stock)\n        } else {\n          const stockString = String(product.stock)\n          const stockMatch = stockString.match(/^([\\d,]+)\\s*(kg|L|bags|units)?$/i)\n          if (stockMatch) {\n            actualStockValue = stockMatch[1].replace(/,/g, '')\n            stockUnit = stockMatch[2]?.toLowerCase() || product.stockUnit || 'kg'\n          }\n        }\n      }\n      if (!displayStockValue && product.stock != null && product.stock !== undefined) {\n        if (typeof product.stock === 'number') {\n          displayStockValue = String(product.stock)\n        } else {\n          const stockString = String(product.stock)\n          const stockMatch = stockString.match(/^([\\d,]+)\\s*(kg|L|bags|units)?$/i)\n          if (stockMatch) {\n            displayStockValue = stockMatch[1].replace(/,/g, '')\n            if (!stockUnit) stockUnit = stockMatch[2]?.toLowerCase() || product.stockUnit || 'kg'\n          }\n        }\n      }\n      \n      if (product.stockUnit) {\n        stockUnit = product.stockUnit\n      }\n      \n      // Also check weight.unit as fallback\n      if (product.weight?.unit) {\n        stockUnit = product.weight.unit\n      }\n      \n      // Convert prices to string if they're numbers\n      const vendorPriceString = product.vendorPrice != null ? String(product.vendorPrice) : ''\n      const userPriceString = product.userPrice != null ? String(product.userPrice) : ''\n      const vendorPriceValue = vendorPriceString.replace(/[â‚¹,]/g, '') || ''\n      const userPriceValue = userPriceString.replace(/[â‚¹,]/g, '') || ''\n      \n      // Parse expiry date (assuming format like \"Aug 2026\" or ISO date)\n      let expiryDate = ''\n      if (product.expiry) {\n        const expiryString = String(product.expiry)\n        if (expiryString.includes('-')) {\n          expiryDate = expiryString.split('T')[0] // ISO date\n        } else {\n          // Try to parse \"Aug 2026\" format\n          const months = {\n            'Jan': '01', 'Feb': '02', 'Mar': '03', 'Apr': '04',\n            'May': '05', 'Jun': '06', 'Jul': '07', 'Aug': '08',\n            'Sep': '09', 'Oct': '10', 'Nov': '11', 'Dec': '12'\n          }\n          const parts = expiryString.split(' ')\n          if (parts.length === 2) {\n            const month = months[parts[0]]\n            const year = parts[1]\n            if (month && year) {\n              expiryDate = `${year}-${month}-15` // Default to 15th of month\n            }\n          }\n        }\n      }\n\n      // Parse specifications (attributes) from product\n      const attributes = {}\n      if (product.specifications && typeof product.specifications === 'object') {\n        // Handle Map type from MongoDB\n        if (product.specifications instanceof Map) {\n          product.specifications.forEach((value, key) => {\n            attributes[key] = value\n          })\n        } else {\n          // Handle plain object\n          Object.keys(product.specifications).forEach((key) => {\n            attributes[key] = product.specifications[key]\n          })\n        }\n      }\n\n      // Parse images\n      let productImages = []\n      if (product.images && Array.isArray(product.images) && product.images.length > 0) {\n        productImages = product.images.map((img, index) => ({\n          url: img.url || (typeof img === 'string' ? img : ''),\n          publicId: img.publicId || '',\n          isPrimary: img.isPrimary === true || (index === 0 && img.isPrimary !== false),\n          order: img.order !== undefined ? img.order : index,\n        }))\n      }\n\n      setFormData({\n        name: product.name || '',\n        category: product.category || 'npk',\n        shortDescription: product.shortDescription || '',\n        description: product.description || product.longDescription || '',\n        actualStock: actualStockValue,\n        displayStock: displayStockValue,\n        stockUnit: stockUnit,\n        vendorPrice: vendorPriceValue,\n        userPrice: userPriceValue,\n        expiry: expiryDate,\n        visibility: product.isActive !== false ? 'active' : 'inactive',\n        batchNumber: product.batchNumber || '',\n        tags: product.tags && Array.isArray(product.tags) ? product.tags : [],\n        attributes: attributes,\n        images: productImages,\n        attributeStocks: product.attributeStocks && Array.isArray(product.attributeStocks) \n          ? product.attributeStocks.map((stock, index) => {\n              // Convert attributes Map to plain object if needed\n              let attributesObj = {}\n              if (stock.attributes) {\n                if (stock.attributes instanceof Map) {\n                  stock.attributes.forEach((value, key) => {\n                    attributesObj[key] = value\n                  })\n                } else if (typeof stock.attributes === 'object') {\n                  attributesObj = stock.attributes\n                }\n              }\n              \n              return {\n                ...stock,\n                attributes: attributesObj,\n                vendorPrice: stock.vendorPrice != null ? String(stock.vendorPrice) : '',\n                userPrice: stock.userPrice != null ? String(stock.userPrice) : '',\n                id: stock.id || stock._id || Date.now() + index, // Ensure each has an ID\n              }\n            })\n          : [],\n      })\n    }\n  }, [product])\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setFormData((prev) => ({ ...prev, [name]: value }))\n    // Clear error when user starts typing\n    if (errors[name]) {\n      setErrors((prev) => ({ ...prev, [name]: '' }))\n    }\n    \n    // Reset attributes when category changes\n    if (name === 'category') {\n      setFormData((prev) => ({ ...prev, attributes: {} }))\n    }\n  }\n\n  const handleAttributeChange = (key, value) => {\n    setFormData((prev) => ({\n      ...prev,\n      attributes: {\n        ...prev.attributes,\n        [key]: value,\n      },\n    }))\n  }\n\n  const handleAddTag = (e) => {\n    if (e.key === 'Enter' && tagInput.trim()) {\n      e.preventDefault()\n      const newTag = tagInput.trim().toLowerCase()\n      if (!formData.tags.includes(newTag)) {\n        setFormData((prev) => ({\n          ...prev,\n          tags: [...prev.tags, newTag],\n        }))\n      }\n      setTagInput('')\n    }\n  }\n\n  const handleRemoveTag = (tagToRemove) => {\n    setFormData((prev) => ({\n      ...prev,\n      tags: prev.tags.filter((tag) => tag !== tagToRemove),\n    }))\n  }\n\n  // Sync displayStock unit when stockUnit changes\n  useEffect(() => {\n    // When stockUnit changes, we don't need to do anything special\n    // The disabled select will show the same unit automatically\n  }, [formData.stockUnit])\n\n  const validate = () => {\n    const newErrors = {}\n\n    if (!formData.name.trim()) {\n      newErrors.name = 'Product name is required'\n    }\n\n    if (!formData.category) {\n      newErrors.category = 'Category is required'\n    }\n\n    if (!formData.shortDescription.trim()) {\n      newErrors.shortDescription = 'Short description is required (for product cards)'\n    }\n\n    if (!formData.description.trim()) {\n      newErrors.description = 'Long description is required (for product details page)'\n    }\n\n    // Only validate main stock and price fields if no attributeStocks are configured\n    if (!formData.attributeStocks || formData.attributeStocks.length === 0) {\n      if (!formData.actualStock || parseFloat(formData.actualStock) < 0) {\n        newErrors.actualStock = 'Actual quantity is required and cannot be negative'\n      }\n      if (!formData.displayStock || parseFloat(formData.displayStock) < 0) {\n        newErrors.displayStock = 'Display quantity is required and cannot be negative'\n      }\n      if (parseFloat(formData.displayStock) > parseFloat(formData.actualStock)) {\n        newErrors.displayStock = 'Display quantity cannot exceed actual quantity'\n      }\n\n      if (!formData.vendorPrice || parseFloat(formData.vendorPrice) <= 0) {\n        newErrors.vendorPrice = 'Vendor price must be greater than 0'\n      }\n\n      if (!formData.userPrice || parseFloat(formData.userPrice) <= 0) {\n        newErrors.userPrice = 'User price must be greater than 0'\n      }\n\n      if (parseFloat(formData.userPrice) <= parseFloat(formData.vendorPrice)) {\n        newErrors.userPrice = 'User price must be greater than vendor price'\n      }\n\n      if (!formData.expiry) {\n        newErrors.expiry = 'Expiry date is required'\n      }\n    } else {\n      // Validate that at least one attributeStock entry exists\n      if (formData.attributeStocks.length === 0) {\n        newErrors.attributeStocks = 'At least one stock entry with attributes is required'\n      }\n    }\n\n    setErrors(newErrors)\n    const isValid = Object.keys(newErrors).length === 0\n    \n    // Scroll to first error if validation fails\n    if (!isValid) {\n      setTimeout(() => {\n        const firstErrorField = Object.keys(newErrors)[0]\n        if (firstErrorField) {\n          const errorElement = document.getElementById(firstErrorField) || document.querySelector(`[name=\"${firstErrorField}\"]`)\n          if (errorElement) {\n            errorElement.scrollIntoView({ behavior: 'smooth', block: 'center' })\n            errorElement.focus()\n          }\n        }\n      }, 100)\n    }\n    \n    return isValid\n  }\n\n  const handleSubmit = (e) => {\n    e.preventDefault()\n    if (!validate()) {\n      return\n    }\n\n    // Ensure prices are valid numbers (only if not using attributeStocks)\n    const vendorPrice = (!formData.attributeStocks || formData.attributeStocks.length === 0) \n      ? parseFloat(formData.vendorPrice) \n      : 0\n    const userPrice = (!formData.attributeStocks || formData.attributeStocks.length === 0) \n      ? parseFloat(formData.userPrice) \n      : 0\n\n    // Build specifications object from attributes (only include non-empty values)\n    const specifications = {}\n    Object.keys(formData.attributes).forEach((key) => {\n      const value = formData.attributes[key]\n      if (value !== '' && value !== null && value !== undefined) {\n        specifications[key] = String(value)\n      }\n    })\n\n    // Calculate total stock and prices from attributeStocks if they exist, otherwise use main fields\n    let actualStockValue = 0\n    let displayStockValue = 0\n    let vendorPriceValue = 0\n    let userPriceValue = 0\n    let expiryValue = ''\n    let batchNumberValue = ''\n    \n    if (formData.attributeStocks && formData.attributeStocks.length > 0) {\n      // Sum up all attributeStocks\n      actualStockValue = formData.attributeStocks.reduce((sum, stock) => sum + (parseFloat(stock.actualStock) || 0), 0)\n      displayStockValue = formData.attributeStocks.reduce((sum, stock) => sum + (parseFloat(stock.displayStock) || 0), 0)\n      \n      // Calculate weighted average prices based on stock quantities\n      let totalStock = 0\n      let weightedVendorPrice = 0\n      let weightedUserPrice = 0\n      \n      formData.attributeStocks.forEach(stock => {\n        const stockQty = parseFloat(stock.displayStock) || 0\n        totalStock += stockQty\n        weightedVendorPrice += (parseFloat(stock.vendorPrice) || 0) * stockQty\n        weightedUserPrice += (parseFloat(stock.userPrice) || 0) * stockQty\n      })\n      \n      if (totalStock > 0) {\n        vendorPriceValue = weightedVendorPrice / totalStock\n        userPriceValue = weightedUserPrice / totalStock\n      }\n      \n      // Use first entry's expiry and batchNumber as defaults (or leave empty)\n      const firstEntry = formData.attributeStocks[0]\n      expiryValue = firstEntry.expiry || ''\n      batchNumberValue = firstEntry.batchNumber || ''\n    } else {\n      // Use main fields\n      actualStockValue = parseFloat(formData.actualStock) || 0\n      displayStockValue = parseFloat(formData.displayStock) || 0\n      vendorPriceValue = !isNaN(vendorPrice) && vendorPrice > 0 ? vendorPrice : 0\n      userPriceValue = !isNaN(userPrice) && userPrice > 0 ? userPrice : 0\n      expiryValue = formData.expiry\n      batchNumberValue = formData.batchNumber || ''\n    }\n\n    const submitData = {\n      name: formData.name.trim(),\n      category: formData.category,\n      shortDescription: formData.shortDescription.trim(),\n      description: formData.description.trim(),\n      longDescription: formData.description.trim(), // Also save as longDescription for clarity\n      actualStock: actualStockValue,\n      displayStock: displayStockValue,\n      stockUnit: formData.stockUnit,\n      priceToVendor: vendorPriceValue > 0 ? vendorPriceValue : undefined,\n      priceToUser: userPriceValue > 0 ? userPriceValue : undefined,\n      ...(expiryValue && { expiry: expiryValue }),\n      isActive: formData.visibility === 'active',\n      ...(batchNumberValue && { batchNumber: batchNumberValue.trim() }),\n      tags: formData.tags.filter((tag) => tag.trim() !== ''),\n      ...(Object.keys(specifications).length > 0 && { specifications }),\n      ...(formData.images && formData.images.length > 0 && { images: formData.images }),\n      ...(formData.attributeStocks && formData.attributeStocks.length > 0 && { \n        attributeStocks: formData.attributeStocks.map(({ id, ...stock }) => stock) // Remove temporary IDs\n      }),\n    }\n\n    onSubmit(submitData)\n  }\n\n  // Handle attribute stock form save\n  const handleAttributeStockSave = (stocks) => {\n    setFormData((prev) => ({\n      ...prev,\n      attributeStocks: stocks.map((stock, index) => ({\n        ...stock,\n        id: stock.id || Date.now() + index, // Ensure each has an ID\n      })),\n    }))\n  }\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-6\">\n      {/* Product Name */}\n      <div>\n        <label htmlFor=\"name\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n          Product Name <span className=\"text-red-500\">*</span>\n        </label>\n        <input\n          type=\"text\"\n          id=\"name\"\n          name=\"name\"\n          value={formData.name}\n          onChange={handleChange}\n          placeholder=\"e.g., NPK 24:24:0 Fertilizer\"\n          className={cn(\n            'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2',\n            errors.name\n              ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n              : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n          )}\n        />\n        {errors.name && <p className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\n      </div>\n\n      {/* Category Selection */}\n      <div>\n        <label htmlFor=\"category\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n          Fertilizer Category <span className=\"text-red-500\">*</span>\n        </label>\n        <select\n          id=\"category\"\n          name=\"category\"\n          value={formData.category}\n          onChange={handleChange}\n          className={cn(\n            'w-full rounded-xl border px-4 py-3 text-sm font-semibold transition-all focus:outline-none focus:ring-2',\n            errors.category\n              ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n              : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n          )}\n        >\n          {FERTILIZER_CATEGORIES.map((cat) => (\n            <option key={cat.value} value={cat.value}>\n              {cat.label} - {cat.description}\n            </option>\n          ))}\n        </select>\n        {errors.category && <p className=\"mt-1 text-xs text-red-600\">{errors.category}</p>}\n      </div>\n\n      {/* Short Description - For Product Cards */}\n      <div>\n        <label htmlFor=\"shortDescription\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n          Short Description <span className=\"text-red-500\">*</span>\n          <span className=\"text-xs font-normal text-gray-500 ml-2\">(Shown on product cards in user dashboard)</span>\n        </label>\n        <textarea\n          id=\"shortDescription\"\n          name=\"shortDescription\"\n          value={formData.shortDescription}\n          onChange={handleChange}\n          placeholder=\"Brief description (1-2 lines) that will appear on product cards...\"\n          rows={2}\n          maxLength={150}\n          className={cn(\n            'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2 resize-none',\n            errors.shortDescription\n              ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n              : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n          )}\n        />\n        <p className=\"mt-1 text-xs text-gray-500\">{formData.shortDescription.length}/150 characters</p>\n        {errors.shortDescription && <p className=\"mt-1 text-xs text-red-600\">{errors.shortDescription}</p>}\n      </div>\n\n      {/* Long Description - For Product Details Page */}\n      <div>\n        <label htmlFor=\"description\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n          Long Description <span className=\"text-red-500\">*</span>\n          <span className=\"text-xs font-normal text-gray-500 ml-2\">(Shown on product details page)</span>\n        </label>\n        <textarea\n          id=\"description\"\n          name=\"description\"\n          value={formData.description}\n          onChange={handleChange}\n          placeholder=\"Detailed description with composition, benefits, usage instructions, etc. (Line breaks will be preserved)...\"\n          rows={5}\n          className={cn(\n            'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2 resize-none',\n            errors.description\n              ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n              : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n          )}\n        />\n        {errors.description && <p className=\"mt-1 text-xs text-red-600\">{errors.description}</p>}\n      </div>\n\n      {/* Product Images */}\n      <div>\n        <ImageUpload\n          images={formData.images || []}\n          onChange={(images) => setFormData((prev) => ({ ...prev, images }))}\n          maxImages={4}\n          disabled={loading}\n        />\n      </div>\n\n      {/* Stock Quantity & Unit - Only show if no attributeStocks are configured */}\n      {(!formData.attributeStocks || formData.attributeStocks.length === 0) && (\n        <div className=\"grid gap-4 sm:grid-cols-2\">\n          <div>\n            <label htmlFor=\"actualStock\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n              Actual Quantity <span className=\"text-red-500\">*</span>\n              <span className=\"text-xs font-normal text-gray-500 ml-2\">(Internal/Admin use)</span>\n            </label>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"number\"\n                id=\"actualStock\"\n                name=\"actualStock\"\n                value={formData.actualStock}\n                onChange={handleChange}\n                placeholder=\"0\"\n                min=\"0\"\n                step=\"0.01\"\n                className={cn(\n                  'flex-1 rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none',\n                  errors.actualStock\n                    ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                    : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n                )}\n              />\n              <select\n                name=\"stockUnit\"\n                value={formData.stockUnit}\n                onChange={handleChange}\n                className=\"rounded-xl border border-gray-300 bg-white px-3 py-3 text-sm font-semibold text-gray-700 focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n              >\n                {STOCK_UNITS.map((unit) => (\n                  <option key={unit} value={unit}>\n                    {unit}\n                  </option>\n                ))}\n              </select>\n            </div>\n            {errors.actualStock && <p className=\"mt-1 text-xs text-red-600\">{errors.actualStock}</p>}\n          </div>\n\n          <div>\n            <label htmlFor=\"displayStock\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n              Quantity to Show to Vendors <span className=\"text-red-500\">*</span>\n              <span className=\"text-xs font-normal text-gray-500 ml-2\">(Visible to vendors)</span>\n            </label>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"number\"\n                id=\"displayStock\"\n                name=\"displayStock\"\n                value={formData.displayStock}\n                onChange={handleChange}\n                placeholder=\"0\"\n                min=\"0\"\n                step=\"0.01\"\n                className={cn(\n                  'flex-1 rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none',\n                  errors.displayStock\n                    ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                    : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n                )}\n              />\n              <select\n                value={formData.stockUnit}\n                disabled\n                className=\"rounded-xl border border-gray-300 bg-gray-100 px-3 py-3 text-sm font-semibold text-gray-500 cursor-not-allowed\"\n              >\n                {STOCK_UNITS.map((unit) => (\n                  <option key={unit} value={unit}>\n                    {unit}\n                  </option>\n                ))}\n              </select>\n            </div>\n            {errors.displayStock && <p className=\"mt-1 text-xs text-red-600\">{errors.displayStock}</p>}\n            {formData.displayStock && parseFloat(formData.displayStock) > parseFloat(formData.actualStock || 0) && (\n              <p className=\"mt-1 text-xs text-yellow-600\">âš ï¸ Display quantity exceeds actual quantity</p>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Expiry Date - Only show if no attributeStocks are configured */}\n      {(!formData.attributeStocks || formData.attributeStocks.length === 0) && (\n        <div>\n          <label htmlFor=\"expiry\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n            Expiry Date / Batch <span className=\"text-red-500\">*</span>\n          </label>\n          <div className=\"relative\">\n            <Calendar className=\"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400\" />\n            <input\n              type=\"date\"\n              id=\"expiry\"\n              name=\"expiry\"\n              value={formData.expiry}\n              onChange={handleChange}\n              className={cn(\n                'w-full rounded-xl border pl-10 pr-4 py-3 text-sm transition-all focus:outline-none focus:ring-2',\n                errors.expiry\n                  ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                  : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n              )}\n            />\n          </div>\n          {errors.expiry && <p className=\"mt-1 text-xs text-red-600\">{errors.expiry}</p>}\n        </div>\n      )}\n\n      {/* Batch Number (Optional) - Only show if no attributeStocks are configured */}\n      {(!formData.attributeStocks || formData.attributeStocks.length === 0) && (\n        <div>\n          <label htmlFor=\"batchNumber\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n            Batch Number <span className=\"text-xs font-normal text-gray-500\">(Optional)</span>\n          </label>\n          <input\n            type=\"text\"\n            id=\"batchNumber\"\n            name=\"batchNumber\"\n            value={formData.batchNumber}\n            onChange={handleChange}\n            placeholder=\"e.g., BATCH-2024-001\"\n            className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n          />\n        </div>\n      )}\n\n      {/* Pricing - Only show if no attributeStocks are configured */}\n      {(!formData.attributeStocks || formData.attributeStocks.length === 0) && (\n        <div className=\"grid gap-4 sm:grid-cols-2\">\n          <div>\n            <label htmlFor=\"vendorPrice\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n              <IndianRupee className=\"mr-1 inline h-4 w-4\" />\n              Vendor Price <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"number\"\n              id=\"vendorPrice\"\n              name=\"vendorPrice\"\n              value={formData.vendorPrice}\n              onChange={handleChange}\n              placeholder=\"0.00\"\n              min=\"0\"\n              step=\"0.01\"\n              className={cn(\n                'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none',\n                errors.vendorPrice\n                  ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                  : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n              )}\n            />\n            {errors.vendorPrice && <p className=\"mt-1 text-xs text-red-600\">{errors.vendorPrice}</p>}\n          </div>\n\n          <div>\n            <label htmlFor=\"userPrice\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n              <IndianRupee className=\"mr-1 inline h-4 w-4\" />\n              User Price <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"number\"\n              id=\"userPrice\"\n              name=\"userPrice\"\n              value={formData.userPrice}\n              onChange={handleChange}\n              placeholder=\"0.00\"\n              min=\"0\"\n              step=\"0.01\"\n              className={cn(\n                'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none',\n                errors.userPrice\n                  ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                  : 'border-gray-300 bg-white focus:border-purple-500 focus:ring-purple-500/50',\n              )}\n            />\n            {errors.userPrice && <p className=\"mt-1 text-xs text-red-600\">{errors.userPrice}</p>}\n          </div>\n        </div>\n      )}\n\n      {/* Custom Attributes - Stock Management */}\n      <div className=\"rounded-2xl border border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/50 p-5\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-bold text-blue-700\">Stock Management by Custom Attributes</h3>\n            <p className=\"text-sm text-gray-600 mt-1\">\n              Add custom attributes (e.g., Type, Percentage, NPK Ratio) and manage stock for each combination\n            </p>\n          </div>\n          <button\n            type=\"button\"\n            onClick={() => setShowAttributeStockForm(!showAttributeStockForm)}\n            className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-purple-500 to-purple-600 px-4 py-2 text-sm font-bold text-white shadow-[0_4px_15px_rgba(168,85,247,0.3)] transition-all hover:shadow-[0_6px_20px_rgba(168,85,247,0.4)]\"\n          >\n            <Layers className=\"h-4 w-4\" />\n            {showAttributeStockForm ? 'Close Stock Manager' : 'Manage Stock by Attributes'}\n            {formData.attributeStocks && formData.attributeStocks.length > 0 && (\n              <span className=\"ml-1 rounded-full bg-white/20 px-2 py-0.5 text-xs\">\n                {formData.attributeStocks.length}\n              </span>\n            )}\n          </button>\n        </div>\n        \n        {/* Display existing attribute stocks summary when form is closed */}\n        {!showAttributeStockForm && formData.attributeStocks && formData.attributeStocks.length > 0 && (\n          <div className=\"rounded-xl border border-purple-200 bg-purple-50/50 p-4\">\n            <p className=\"text-sm font-semibold text-purple-700 mb-2\">\n              Stock Entries Configured: {formData.attributeStocks.length}\n            </p>\n            <div className=\"space-y-2\">\n              {formData.attributeStocks.slice(0, 3).map((stock, index) => {\n                const attributeSummary = Object.entries(stock.attributes || {})\n                  .filter(([_, value]) => value && value !== '')\n                  .map(([key, value]) => `${key}: ${value}`)\n                  .join(', ')\n                \n                return (\n                  <div key={stock.id || index} className=\"text-xs text-gray-600 bg-white rounded-lg px-3 py-2\">\n                    <span className=\"font-semibold\">Entry #{index + 1}:</span> {attributeSummary || 'No attributes'} \n                    {' - '}\n                    <span className=\"font-semibold\">Stock:</span> {stock.displayStock || 0} {stock.stockUnit || formData.stockUnit}\n                  </div>\n                )\n              })}\n              {formData.attributeStocks.length > 3 && (\n                <p className=\"text-xs text-gray-500 italic\">\n                  + {formData.attributeStocks.length - 3} more entries...\n                </p>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Attribute Stock Form - Inline Dropdown */}\n      {showAttributeStockForm && (\n        <AttributeStockForm\n          isOpen={showAttributeStockForm}\n          onClose={() => setShowAttributeStockForm(false)}\n          category={formData.category}\n          categoryAttributes={[]}\n          attributeStocks={formData.attributeStocks || []}\n          onSave={handleAttributeStockSave}\n          stockUnit={formData.stockUnit}\n        />\n      )}\n\n      {/* Tags */}\n      <div>\n        <label htmlFor=\"tags\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n          <Tag className=\"mr-1 inline h-4 w-4\" />\n          Product Tags\n          <span className=\"text-xs font-normal text-gray-500 ml-2\">(Press Enter to add, used for search and identification)</span>\n        </label>\n        <div className=\"space-y-3\">\n          <input\n            type=\"text\"\n            id=\"tags\"\n            value={tagInput}\n            onChange={(e) => setTagInput(e.target.value)}\n            onKeyDown={handleAddTag}\n            placeholder=\"Type a tag and press Enter (e.g., organic, premium, fast-acting)\"\n            className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n          />\n          {formData.tags.length > 0 && (\n            <div className=\"flex flex-wrap gap-2\">\n              {formData.tags.map((tag) => (\n                <span\n                  key={tag}\n                  className=\"inline-flex items-center gap-1 rounded-full border border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100 px-3 py-1.5 text-xs font-bold text-purple-700 shadow-[0_2px_8px_rgba(168,85,247,0.2),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n                >\n                  {tag}\n                  <button\n                    type=\"button\"\n                    onClick={() => handleRemoveTag(tag)}\n                    className=\"ml-1 rounded-full hover:bg-purple-200 transition-colors\"\n                    aria-label={`Remove ${tag} tag`}\n                  >\n                    <X className=\"h-3 w-3\" />\n                  </button>\n                </span>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Visibility Toggle */}\n      <div>\n        <label className=\"mb-2 block text-sm font-bold text-gray-900\">\n          <Eye className=\"mr-1 inline h-4 w-4\" />\n          Product Visibility <span className=\"text-red-500\">*</span>\n        </label>\n        <div className=\"flex gap-3\">\n          <button\n            type=\"button\"\n            onClick={() => setFormData((prev) => ({ ...prev, visibility: 'active' }))}\n            className={cn(\n              'flex flex-1 items-center justify-center gap-2 rounded-xl border px-4 py-3 text-sm font-bold transition-all',\n              formData.visibility === 'active'\n                ? 'border-green-500 bg-gradient-to-br from-green-500 to-green-600 text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)]'\n                : 'border-gray-300 bg-white text-gray-700 hover:border-green-300 hover:bg-green-50',\n            )}\n          >\n            <Eye className=\"h-4 w-4\" />\n            Active\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setFormData((prev) => ({ ...prev, visibility: 'inactive' }))}\n            className={cn(\n              'flex flex-1 items-center justify-center gap-2 rounded-xl border px-4 py-3 text-sm font-bold transition-all',\n              formData.visibility === 'inactive'\n                ? 'border-gray-500 bg-gradient-to-br from-gray-500 to-gray-600 text-white shadow-[0_4px_15px_rgba(0,0,0,0.2),inset_0_1px_0_rgba(255,255,255,0.2)]'\n                : 'border-gray-300 bg-white text-gray-700 hover:border-gray-400 hover:bg-gray-50',\n            )}\n          >\n            <EyeOff className=\"h-4 w-4\" />\n            Inactive\n          </button>\n        </div>\n      </div>\n\n      {/* Action Buttons */}\n      <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n        <button\n          type=\"button\"\n          onClick={onCancel}\n          disabled={loading}\n          className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n        >\n          Cancel\n        </button>\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"rounded-xl bg-gradient-to-r from-purple-500 to-purple-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(168,85,247,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(168,85,247,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n        >\n          {loading ? 'Saving...' : product ? 'Update Product' : 'Create Product'}\n        </button>\n      </div>\n    </form>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\ProgressList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\PurchaseRequestModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[173,209],"text":""},"desc":"Remove unused variable 'cn'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Package, CheckCircle, XCircle, IndianRupee, Calendar, FileText } from 'lucide-react'\r\nimport { Modal } from './Modal'\r\nimport { StatusBadge } from './StatusBadge'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nexport function PurchaseRequestModal({ isOpen, onClose, request, onApprove, onReject, loading }) {\r\n  if (!request) return null\r\n\r\n  const handleApprove = () => {\r\n    onApprove(request.id)\r\n  }\r\n\r\n  const handleReject = () => {\r\n    const reason = window.prompt('Please provide a reason for rejection:')\r\n    if (reason) {\r\n      onReject(request.id, { reason })\r\n    }\r\n  }\r\n\r\n  const formatCurrency = (value) => {\r\n    if (typeof value === 'string') {\r\n      return value\r\n    }\r\n    if (value >= 100000) {\r\n      return `â‚¹${(value / 100000).toFixed(1)} L`\r\n    }\r\n    return `â‚¹${value.toLocaleString('en-IN')}`\r\n  }\r\n\r\n  return (\r\n    <Modal isOpen={isOpen} onClose={onClose} title=\"Vendor Purchase Request Review\" size=\"lg\">\r\n      <div className=\"space-y-6\">\r\n        {/* Request Header */}\r\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg\">\r\n                <Package className=\"h-6 w-6\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"text-lg font-bold text-gray-900\">\r\n                  Request #{request.id?.slice(-8) || request.requestId?.slice(-8) || 'N/A'}\r\n                </h3>\r\n                <p className=\"text-sm text-gray-600\">Vendor: {request.vendorName || request.vendor}</p>\r\n                <div className=\"mt-2 flex items-center gap-4 text-xs text-gray-500\">\r\n                  {request.date && (\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Calendar className=\"h-3.5 w-3.5\" />\r\n                      <span>{new Date(request.date).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })}</span>\r\n                    </div>\r\n                  )}\r\n                  {request.createdAt && !request.date && (\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Calendar className=\"h-3.5 w-3.5\" />\r\n                      <span>{new Date(request.createdAt).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })}</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <StatusBadge tone={request.status === 'pending' ? 'warning' : request.status === 'approved' ? 'success' : 'neutral'}>\r\n              {request.status || 'Pending'}\r\n            </StatusBadge>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Purchase Details */}\r\n        <div className=\"space-y-4\">\r\n          <h4 className=\"text-sm font-bold text-gray-900\">Purchase Details</h4>\r\n          \r\n          <div className=\"grid gap-4 sm:grid-cols-2\">\r\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n              <p className=\"text-xs text-gray-500\">Request Amount</p>\r\n              <p className=\"mt-1 text-lg font-bold text-gray-900\">\r\n                {formatCurrency(request.amount || request.value || 0)}\r\n              </p>\r\n            </div>\r\n            {request.advance && (\r\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n                <p className=\"text-xs text-gray-500\">Advance Payment (30%)</p>\r\n                <p className=\"mt-1 text-lg font-bold text-gray-900\">\r\n                  {formatCurrency(request.advance)}\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {request.products && request.products.length > 0 && (\r\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n              <p className=\"mb-3 text-xs font-bold text-gray-500\">Products Requested</p>\r\n              <div className=\"space-y-2\">\r\n                {request.products.map((product, index) => (\r\n                  <div key={index} className=\"flex items-center justify-between rounded-lg bg-white p-3\">\r\n                    <span className=\"text-sm text-gray-700\">{product.name || product}</span>\r\n                    {product.quantity && (\r\n                      <span className=\"text-xs text-gray-500\">Qty: {product.quantity}</span>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {request.description && (\r\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n              <p className=\"mb-2 text-xs text-gray-500\">Description</p>\r\n              <p className=\"text-sm text-gray-700\">{request.description}</p>\r\n            </div>\r\n          )}\r\n\r\n          {request.documents && request.documents.length > 0 && (\r\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n              <p className=\"mb-2 text-xs text-gray-500\">Supporting Documents</p>\r\n              <div className=\"space-y-2\">\r\n                {request.documents.map((doc, index) => (\r\n                  <div key={index} className=\"flex items-center gap-2 text-sm\">\r\n                    <FileText className=\"h-4 w-4 text-gray-400\" />\r\n                    <span className=\"text-gray-700\">{doc.name || doc}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Vendor Performance Info */}\r\n        {request.vendorPerformance && (\r\n          <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\r\n            <p className=\"mb-2 text-xs font-bold text-blue-900\">Vendor Performance Summary</p>\r\n            <div className=\"grid gap-2 text-xs text-blue-800 sm:grid-cols-2\">\r\n              {request.vendorPerformance.creditUtilization && (\r\n                <div>\r\n                  <span className=\"font-semibold\">Credit Utilization: </span>\r\n                  <span>{request.vendorPerformance.creditUtilization}%</span>\r\n                </div>\r\n              )}\r\n              {request.vendorPerformance.repaymentHistory && (\r\n                <div>\r\n                  <span className=\"font-semibold\">Repayment History: </span>\r\n                  <span>{request.vendorPerformance.repaymentHistory}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={onClose}\r\n            disabled={loading}\r\n            className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <div className=\"flex gap-3\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleReject}\r\n              disabled={loading}\r\n              className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50 disabled:opacity-50\"\r\n            >\r\n              <XCircle className=\"h-4 w-4\" />\r\n              Reject\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleApprove}\r\n              disabled={loading}\r\n              className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\r\n            >\r\n              <CheckCircle className=\"h-4 w-4\" />\r\n              {loading ? 'Processing...' : 'Approve Request'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\RecoveryStatusView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\SellerDetailModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\SellerEditForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\SellerForm.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'autoGenerateId' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"autoGenerateId"},"fix":{"range":[497,511],"text":""},"desc":"Remove unused variable 'autoGenerateId'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\r\nimport { User, Percent, Target, IndianRupee, Hash } from 'lucide-react'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nexport function SellerForm({ seller, onSubmit, onCancel, loading = false }) {\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    email: '',\r\n    phone: '',\r\n    area: '',\r\n    sellerId: '',\r\n    cashbackRate: '',\r\n    commissionRate: '',\r\n    monthlyTarget: '',\r\n  })\r\n\r\n  const [errors, setErrors] = useState({})\r\n  const [autoGenerateId, setAutoGenerateId] = useState(true)\r\n\r\n  useEffect(() => {\r\n    if (seller) {\r\n      // Parse existing seller data\r\n      const cashbackRate = typeof seller.cashbackRate === 'number'\r\n        ? seller.cashbackRate\r\n        : parseFloat(seller.cashback?.replace(/[%\\s]/g, '') || '0')\r\n\r\n      const commissionRate = typeof seller.commissionRate === 'number'\r\n        ? seller.commissionRate\r\n        : parseFloat(seller.commission?.replace(/[%\\s]/g, '') || '0')\r\n\r\n      const monthlyTarget = typeof seller.monthlyTarget === 'number'\r\n        ? seller.monthlyTarget\r\n        : parseFloat(seller.target?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\r\n\r\n      setFormData({\r\n        name: seller.name || '',\r\n        email: seller.email || '',\r\n        phone: seller.phone || '',\r\n        area: seller.area || '',\r\n        sellerId: seller.sellerId || seller.id || '',\r\n        cashbackRate: cashbackRate || '',\r\n        commissionRate: commissionRate || '',\r\n        monthlyTarget: monthlyTarget || '',\r\n      })\r\n      setAutoGenerateId(false)\r\n    } else {\r\n      // Generate unique seller ID for new sellers\r\n      const newId = `SLR-${Math.floor(Math.random() * 1000).toString().padStart(3, '0')}`\r\n      setFormData((prev) => ({ ...prev, sellerId: newId }))\r\n    }\r\n  }, [seller])\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target\r\n    setFormData((prev) => ({ ...prev, [name]: value }))\r\n    // Clear error when user starts typing\r\n    if (errors[name]) {\r\n      setErrors((prev) => ({ ...prev, [name]: '' }))\r\n    }\r\n  }\r\n\r\n  const handleGenerateId = () => {\r\n    const newId = `SLR-${Math.floor(Math.random() * 1000).toString().padStart(3, '0')}`\r\n    setFormData((prev) => ({ ...prev, sellerId: newId }))\r\n  }\r\n\r\n  const validate = () => {\r\n    const newErrors = {}\r\n\r\n    if (!formData.name.trim()) {\r\n      newErrors.name = 'IRA Partner name is required'\r\n    }\r\n\r\n    if (!seller && !formData.email.trim()) {\r\n      newErrors.email = 'Email is required'\r\n    } else if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\r\n      newErrors.email = 'Invalid email format'\r\n    }\r\n\r\n    if (!formData.phone.trim()) {\r\n      newErrors.phone = 'Phone number is required'\r\n    } else if (!/^[+]?[\\d\\s-()]{10,}$/.test(formData.phone.replace(/\\s/g, ''))) {\r\n      newErrors.phone = 'Invalid phone number'\r\n    }\r\n\r\n    if (!formData.area.trim()) {\r\n      newErrors.area = 'Area is required'\r\n    }\r\n\r\n    if (!formData.sellerId.trim()) {\r\n      newErrors.sellerId = 'IRA Partner ID is required'\r\n    } else if (!/^SLR-\\d{3}$/.test(formData.sellerId)) {\r\n      newErrors.sellerId = 'IRA Partner ID must be in format SLR-XXX'\r\n    }\r\n\r\n    if (formData.cashbackRate === '' || parseFloat(formData.cashbackRate) < 0 || parseFloat(formData.cashbackRate) > 10) {\r\n      newErrors.cashbackRate = 'Cashback rate must be between 0% and 10%'\r\n    }\r\n\r\n    if (formData.commissionRate === '' || parseFloat(formData.commissionRate) < 0 || parseFloat(formData.commissionRate) > 20) {\r\n      newErrors.commissionRate = 'Commission rate must be between 0% and 20%'\r\n    }\r\n\r\n    if (!formData.monthlyTarget || parseFloat(formData.monthlyTarget) <= 0) {\r\n      newErrors.monthlyTarget = 'Monthly target must be greater than 0'\r\n    }\r\n\r\n    setErrors(newErrors)\r\n    return Object.keys(newErrors).length === 0\r\n  }\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault()\r\n    if (!validate()) return\r\n\r\n    const submitData = {\r\n      name: formData.name.trim(),\r\n      email: formData.email.trim(),\r\n      phone: formData.phone.trim(),\r\n      area: formData.area.trim(),\r\n      sellerId: formData.sellerId.trim(),\r\n      cashbackRate: parseFloat(formData.cashbackRate),\r\n      commissionRate: parseFloat(formData.commissionRate),\r\n      monthlyTarget: parseFloat(formData.monthlyTarget),\r\n    }\r\n\r\n    onSubmit(submitData)\r\n  }\r\n\r\n  const formatCurrency = (value) => {\r\n    if (!value) return ''\r\n    const num = parseFloat(value)\r\n    if (num >= 100000) {\r\n      return `â‚¹${(num / 100000).toFixed(1)} L`\r\n    }\r\n    return `â‚¹${num.toLocaleString('en-IN')}`\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n      {/* Personal Information */}\r\n      <div className=\"space-y-4\">\r\n        <h4 className=\"text-sm font-bold text-gray-900\">Personal Information</h4>\r\n        \r\n        <div>\r\n          <label htmlFor=\"name\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n            <User className=\"mr-1 inline h-4 w-4\" />\r\n            IRA Partner Name <span className=\"text-red-500\">*</span>\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"name\"\r\n            name=\"name\"\r\n            value={formData.name}\r\n            onChange={handleChange}\r\n            placeholder=\"e.g., Priya Nair\"\r\n            className={cn(\r\n              'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2',\r\n              errors.name\r\n                ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n                : 'border-gray-300 bg-white focus:border-yellow-500 focus:ring-yellow-500/50',\r\n            )}\r\n          />\r\n          {errors.name && <p className=\"mt-1 text-xs text-red-600\">{errors.name}</p>}\r\n        </div>\r\n\r\n        <div className=\"grid gap-4 sm:grid-cols-2\">\r\n          <div>\r\n            <label htmlFor=\"email\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n              Email {!seller && <span className=\"text-red-500\">*</span>}\r\n            </label>\r\n            <input\r\n              type=\"email\"\r\n              id=\"email\"\r\n              name=\"email\"\r\n              value={formData.email}\r\n              onChange={handleChange}\r\n              placeholder=\"seller@example.com\"\r\n              className={cn(\r\n                'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2',\r\n                errors.email\r\n                  ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n                  : 'border-gray-300 bg-white focus:border-yellow-500 focus:ring-yellow-500/50',\r\n              )}\r\n            />\r\n            {errors.email && <p className=\"mt-1 text-xs text-red-600\">{errors.email}</p>}\r\n          </div>\r\n\r\n          <div>\r\n            <label htmlFor=\"phone\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n              Phone <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <input\r\n              type=\"tel\"\r\n              id=\"phone\"\r\n              name=\"phone\"\r\n              value={formData.phone}\r\n              onChange={handleChange}\r\n              placeholder=\"+91 9876543210\"\r\n              className={cn(\r\n                'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2',\r\n                errors.phone\r\n                  ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n                  : 'border-gray-300 bg-white focus:border-yellow-500 focus:ring-yellow-500/50',\r\n              )}\r\n            />\r\n            {errors.phone && <p className=\"mt-1 text-xs text-red-600\">{errors.phone}</p>}\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <label htmlFor=\"area\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n            Area / Region <span className=\"text-red-500\">*</span>\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"area\"\r\n            name=\"area\"\r\n            value={formData.area}\r\n            onChange={handleChange}\r\n            placeholder=\"e.g., Surat, Gujarat\"\r\n            className={cn(\r\n              'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2',\r\n              errors.area\r\n                ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n                : 'border-gray-300 bg-white focus:border-yellow-500 focus:ring-yellow-500/50',\r\n            )}\r\n          />\r\n          {errors.area && <p className=\"mt-1 text-xs text-red-600\">{errors.area}</p>}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Seller ID */}\r\n      <div>\r\n        <label htmlFor=\"sellerId\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n          <Hash className=\"mr-1 inline h-4 w-4\" />\r\n          Unique IRA Partner ID <span className=\"text-red-500\">*</span>\r\n        </label>\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            type=\"text\"\r\n            id=\"sellerId\"\r\n            name=\"sellerId\"\r\n            value={formData.sellerId}\r\n            onChange={handleChange}\r\n            placeholder=\"SLR-001\"\r\n            pattern=\"SLR-\\d{3}\"\r\n            className={cn(\r\n              'flex-1 rounded-xl border px-4 py-3 text-sm font-mono transition-all focus:outline-none focus:ring-2',\r\n              errors.sellerId\r\n                ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n                : 'border-gray-300 bg-white focus:border-yellow-500 focus:ring-yellow-500/50',\r\n            )}\r\n          />\r\n          {!seller && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleGenerateId}\r\n              className=\"rounded-xl border border-gray-300 bg-white px-4 py-3 text-xs font-bold text-gray-700 transition-all hover:bg-gray-50\"\r\n            >\r\n              Generate\r\n            </button>\r\n          )}\r\n        </div>\r\n        {errors.sellerId && <p className=\"mt-1 text-xs text-red-600\">{errors.sellerId}</p>}\r\n        <p className=\"mt-1 text-xs text-gray-500\">Format: SLR-XXX (e.g., SLR-883)</p>\r\n      </div>\r\n\r\n      {/* Incentive Settings */}\r\n      <div className=\"space-y-4\">\r\n        <h4 className=\"text-sm font-bold text-gray-900\">Incentive Settings</h4>\r\n        \r\n        <div className=\"grid gap-4 sm:grid-cols-2\">\r\n          <div>\r\n            <label htmlFor=\"cashbackRate\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n              <Percent className=\"mr-1 inline h-4 w-4\" />\r\n              Cashback Rate (%) <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <div className=\"relative\">\r\n              <input\r\n                type=\"number\"\r\n                id=\"cashbackRate\"\r\n                name=\"cashbackRate\"\r\n                value={formData.cashbackRate}\r\n                onChange={handleChange}\r\n                placeholder=\"0.0\"\r\n                min=\"0\"\r\n                max=\"10\"\r\n                step=\"0.1\"\r\n                className={cn(\r\n                  'w-full rounded-xl border px-4 py-3 pr-12 text-sm transition-all focus:outline-none focus:ring-2',\r\n                  errors.cashbackRate\r\n                    ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n                    : 'border-gray-300 bg-white focus:border-yellow-500 focus:ring-yellow-500/50',\r\n                )}\r\n              />\r\n              <div className=\"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-500\">%</div>\r\n            </div>\r\n            {errors.cashbackRate && <p className=\"mt-1 text-xs text-red-600\">{errors.cashbackRate}</p>}\r\n          </div>\r\n\r\n          <div>\r\n            <label htmlFor=\"commissionRate\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n              <Percent className=\"mr-1 inline h-4 w-4\" />\r\n              Commission Rate (%) <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <div className=\"relative\">\r\n              <input\r\n                type=\"number\"\r\n                id=\"commissionRate\"\r\n                name=\"commissionRate\"\r\n                value={formData.commissionRate}\r\n                onChange={handleChange}\r\n                placeholder=\"0.0\"\r\n                min=\"0\"\r\n                max=\"20\"\r\n                step=\"0.1\"\r\n                className={cn(\r\n                  'w-full rounded-xl border px-4 py-3 pr-12 text-sm transition-all focus:outline-none focus:ring-2',\r\n                  errors.commissionRate\r\n                    ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n                    : 'border-gray-300 bg-white focus:border-yellow-500 focus:ring-yellow-500/50',\r\n                )}\r\n              />\r\n              <div className=\"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-500\">%</div>\r\n            </div>\r\n            {errors.commissionRate && <p className=\"mt-1 text-xs text-red-600\">{errors.commissionRate}</p>}\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <label htmlFor=\"monthlyTarget\" className=\"mb-2 block text-sm font-bold text-gray-900\">\r\n            <Target className=\"mr-1 inline h-4 w-4\" />\r\n            <IndianRupee className=\"mr-1 inline h-4 w-4\" />\r\n            Monthly Sales Target <span className=\"text-red-500\">*</span>\r\n          </label>\r\n          <div className=\"relative\">\r\n            <input\r\n              type=\"number\"\r\n              id=\"monthlyTarget\"\r\n              name=\"monthlyTarget\"\r\n              value={formData.monthlyTarget}\r\n              onChange={handleChange}\r\n              placeholder=\"0\"\r\n              min=\"0\"\r\n              step=\"1000\"\r\n              className={cn(\r\n                'w-full rounded-xl border px-4 py-3 pr-24 text-sm transition-all focus:outline-none focus:ring-2',\r\n                errors.monthlyTarget\r\n                  ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\r\n                  : 'border-gray-300 bg-white focus:border-yellow-500 focus:ring-yellow-500/50',\r\n              )}\r\n            />\r\n            <div className=\"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-500\">\r\n              {formData.monthlyTarget ? formatCurrency(formData.monthlyTarget) : 'â‚¹0'}\r\n            </div>\r\n          </div>\r\n          {errors.monthlyTarget && <p className=\"mt-1 text-xs text-red-600\">{errors.monthlyTarget}</p>}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Action Buttons */}\r\n      <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          disabled={loading}\r\n          className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"rounded-xl bg-gradient-to-r from-yellow-500 to-yellow-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(234,179,8,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(234,179,8,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\r\n        >\r\n          {loading ? 'Saving...' : seller ? 'Update IRA Partner' : 'Create IRA Partner'}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\SellerWithdrawalApprovalScreen.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[17,28],"text":""},"desc":"Remove unused variable 'useEffect'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'paymentCompleted' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"paymentCompleted"},"fix":{"range":[1035,1051],"text":""},"desc":"Remove unused variable 'paymentCompleted'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\r\nimport { ArrowLeft, CheckCircle, AlertCircle, IndianRupee, ShieldCheck, CreditCard, Shield, Calendar } from 'lucide-react'\r\nimport { useAdminApi } from '../hooks/useAdminApi'\r\nimport { useToast } from '../components/ToastNotification'\r\nimport { openRazorpayCheckout } from '../../../utils/razorpay'\r\nimport { getMaskedBankDetails } from '../../../utils/maskSensitiveData'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nconst STEPS = [\r\n  { id: 1, label: 'Confirmation', icon: AlertCircle },\r\n  { id: 2, label: 'Payment', icon: CreditCard },\r\n  { id: 3, label: 'Approval', icon: CheckCircle },\r\n]\r\n\r\nexport function SellerWithdrawalApprovalScreen({ request, onBack, onSuccess }) {\r\n  const { approveSellerWithdrawal, createSellerWithdrawalPaymentIntent } = useAdminApi()\r\n  const { success, error: showError } = useToast()\r\n\r\n  const [currentStep, setCurrentStep] = useState(1)\r\n  const [loading, setLoading] = useState(false)\r\n  const [paymentIntent, setPaymentIntent] = useState(null)\r\n  const [paymentCompleted, setPaymentCompleted] = useState(false)\r\n\r\n  const formatCurrency = (value) => {\r\n    if (typeof value === 'string') return value\r\n    if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\r\n    return `â‚¹${value.toLocaleString('en-IN')}`\r\n  }\r\n\r\n  const handleConfirm = () => {\r\n    setCurrentStep(2)\r\n  }\r\n\r\n  const handleProceedToPayment = async () => {\r\n    try {\r\n      setLoading(true)\r\n      // Create payment intent\r\n      const result = await createSellerWithdrawalPaymentIntent(request.requestId || request.id, {\r\n        amount: request.amount,\r\n      })\r\n\r\n      if (result?.error) {\r\n        showError(result.error.message || 'Failed to create payment intent')\r\n        return\r\n      }\r\n\r\n      if (result?.data?.paymentIntent) {\r\n        setPaymentIntent(result.data.paymentIntent)\r\n      } else {\r\n        showError('Invalid payment intent response')\r\n        return\r\n      }\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to initialize payment')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handlePayment = async () => {\r\n    if (!paymentIntent) {\r\n      showError('Payment intent not initialized')\r\n      return\r\n    }\r\n\r\n    try {\r\n      setLoading(true)\r\n      const { razorpayOrderId, keyId, amount, isTestMode } = paymentIntent\r\n\r\n      // If in test mode (simulated order), skip Razorpay checkout and simulate payment\r\n      if (isTestMode || razorpayOrderId?.startsWith('order_test_')) {\r\n        console.log('âš ï¸ [SellerWithdrawalApprovalScreen] Test mode detected, simulating payment...')\r\n        \r\n        // Simulate payment success\r\n        const simulatedPaymentResponse = {\r\n          paymentId: `pay_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n          orderId: razorpayOrderId,\r\n          signature: `sig_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n        }\r\n\r\n        // Payment successful, proceed to approval\r\n        setPaymentCompleted(true)\r\n        setCurrentStep(3)\r\n\r\n        // Approve withdrawal with simulated payment details\r\n        const approveResult = await approveSellerWithdrawal(request.requestId || request.id, {\r\n          paymentReference: simulatedPaymentResponse.paymentId,\r\n          paymentMethod: 'razorpay',\r\n          paymentDate: new Date().toISOString(),\r\n          gatewayPaymentId: simulatedPaymentResponse.paymentId,\r\n          gatewayOrderId: simulatedPaymentResponse.orderId,\r\n          gatewaySignature: simulatedPaymentResponse.signature,\r\n        })\r\n\r\n        if (approveResult?.error) {\r\n          showError(approveResult.error.message || 'Failed to approve withdrawal')\r\n          setCurrentStep(2)\r\n          setPaymentCompleted(false)\r\n          return\r\n        }\r\n\r\n        success('Withdrawal approved and payment processed successfully! (Test Mode)')\r\n        setTimeout(() => {\r\n          onSuccess?.()\r\n        }, 1500)\r\n        return\r\n      }\r\n\r\n      if (!razorpayOrderId || !keyId) {\r\n        showError('Payment gateway configuration error')\r\n        return\r\n      }\r\n\r\n      // Open Razorpay Checkout (only for real orders)\r\n      const razorpayResponse = await openRazorpayCheckout({\r\n        key: keyId,\r\n        amount: amount,\r\n        currency: 'INR',\r\n        order_id: razorpayOrderId,\r\n        name: 'IRA SATHI',\r\n        description: `Seller Withdrawal Payment - ${request.sellerName || request.sellerId || 'IRA Partner'}`,\r\n        prefill: {\r\n          name: request.sellerName || '',\r\n          email: '',\r\n          contact: '',\r\n        },\r\n      })\r\n\r\n      // Payment successful, proceed to approval\r\n      setPaymentCompleted(true)\r\n      setCurrentStep(3)\r\n\r\n      // Approve withdrawal with payment details\r\n      const approveResult = await approveSellerWithdrawal(request.requestId || request.id, {\r\n        paymentReference: razorpayResponse.paymentId,\r\n        paymentMethod: 'razorpay',\r\n        paymentDate: new Date().toISOString(),\r\n        gatewayPaymentId: razorpayResponse.paymentId,\r\n        gatewayOrderId: razorpayResponse.orderId,\r\n        gatewaySignature: razorpayResponse.signature,\r\n      })\r\n\r\n      if (approveResult?.error) {\r\n        showError(approveResult.error.message || 'Failed to approve withdrawal')\r\n        setCurrentStep(2)\r\n        setPaymentCompleted(false)\r\n        return\r\n      }\r\n\r\n      success('Withdrawal approved and payment processed successfully!')\r\n      setTimeout(() => {\r\n        onSuccess?.()\r\n      }, 1500)\r\n    } catch (razorpayError) {\r\n      if (razorpayError.error) {\r\n        showError(razorpayError.error || 'Payment was cancelled or failed')\r\n      } else {\r\n        showError(razorpayError.message || 'Payment processing failed')\r\n      }\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const bankDetails = request.bankDetails ? getMaskedBankDetails(request.bankDetails) : null\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <header className=\"flex items-center gap-4\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onBack}\r\n          className=\"flex h-10 w-10 items-center justify-center rounded-xl border border-gray-300 bg-white text-gray-700 transition-all hover:border-green-500 hover:bg-green-50 hover:text-green-700\"\r\n        >\r\n          <ArrowLeft className=\"h-5 w-5\" />\r\n        </button>\r\n        <div>\r\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Finance â€¢ Withdrawals</p>\r\n          <h2 className=\"text-2xl font-bold text-gray-900\">Approve IRA Partner Withdrawal</h2>\r\n          <p className=\"text-sm text-gray-600\">Process IRA Partner (Seller) withdrawal request and payment</p>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Steps Indicator */}\r\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\r\n        <div className=\"flex items-center justify-between\">\r\n          {STEPS.map((step, index) => {\r\n            const isActive = currentStep === step.id\r\n            const isCompleted = currentStep > step.id\r\n            const Icon = step.icon\r\n\r\n            return (\r\n              <div key={step.id} className=\"flex flex-1 items-center\">\r\n                <div className=\"flex flex-col items-center\">\r\n                  <div\r\n                    className={cn(\r\n                      'flex h-12 w-12 items-center justify-center rounded-full border-2 transition-all',\r\n                      isCompleted\r\n                        ? 'border-green-500 bg-green-500 text-white'\r\n                        : isActive\r\n                        ? 'border-green-500 bg-green-50 text-green-600'\r\n                        : 'border-gray-300 bg-white text-gray-400',\r\n                    )}\r\n                  >\r\n                    <Icon className=\"h-5 w-5\" />\r\n                  </div>\r\n                  <p\r\n                    className={cn(\r\n                      'mt-2 text-xs font-medium',\r\n                      isActive || isCompleted ? 'text-gray-900' : 'text-gray-400',\r\n                    )}\r\n                  >\r\n                    {step.label}\r\n                  </p>\r\n                </div>\r\n                {index < STEPS.length - 1 && (\r\n                  <div\r\n                    className={cn(\r\n                      'mx-4 h-0.5 flex-1',\r\n                      isCompleted ? 'bg-green-500' : 'bg-gray-300',\r\n                    )}\r\n                  />\r\n                )}\r\n              </div>\r\n            )\r\n          })}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Step 1: Confirmation */}\r\n      {currentStep === 1 && (\r\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\r\n          <div className=\"space-y-6\">\r\n            <div>\r\n              <h3 className=\"text-lg font-bold text-gray-900\">Withdrawal Request Details</h3>\r\n              <p className=\"text-sm text-gray-600\">Review the withdrawal request before proceeding</p>\r\n            </div>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2\">\r\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n                <p className=\"text-xs text-gray-600 mb-1\">IRA Partner</p>\r\n                <p className=\"text-lg font-bold text-gray-900\">{request.sellerName || request.sellerId || 'N/A'}</p>\r\n              </div>\r\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n                <p className=\"text-xs text-gray-600 mb-1\">Withdrawal Amount</p>\r\n                <p className=\"text-lg font-bold text-green-600\">{formatCurrency(request.amount || 0)}</p>\r\n              </div>\r\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n                <p className=\"text-xs text-gray-600 mb-1\">Request Date</p>\r\n                <p className=\"text-lg font-bold text-gray-900\">\r\n                  {request.date || request.createdAt\r\n                    ? new Date(request.date || request.createdAt).toLocaleDateString('en-IN', {\r\n                        year: 'numeric',\r\n                        month: 'long',\r\n                        day: 'numeric',\r\n                      })\r\n                    : 'N/A'}\r\n                </p>\r\n              </div>\r\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n                <p className=\"text-xs text-gray-600 mb-1\">Status</p>\r\n                <span className=\"inline-flex items-center rounded-full bg-yellow-100 px-3 py-1 text-xs font-semibold text-yellow-800\">\r\n                  Pending\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            {bankDetails && (\r\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n                <p className=\"text-xs text-gray-600 mb-3\">Bank Account Details</p>\r\n                <div className=\"grid gap-2 md:grid-cols-2\">\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Account Holder</p>\r\n                    <p className=\"text-sm font-medium text-gray-900\">{bankDetails.accountHolderName || 'N/A'}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Account Number</p>\r\n                    <p className=\"text-sm font-medium text-gray-900\">{bankDetails.accountNumber || 'N/A'}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">IFSC Code</p>\r\n                    <p className=\"text-sm font-medium text-gray-900\">{bankDetails.ifscCode || 'N/A'}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Bank Name</p>\r\n                    <p className=\"text-sm font-medium text-gray-900\">{bankDetails.bankName || 'N/A'}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"flex items-center gap-4 pt-4 border-t border-gray-200\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={onBack}\r\n                className=\"flex-1 rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm font-semibold text-gray-700 transition-all hover:bg-gray-50\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleConfirm}\r\n                className=\"flex-1 rounded-xl bg-green-600 px-4 py-3 text-sm font-semibold text-white transition-all hover:bg-green-700\"\r\n              >\r\n                Proceed to Payment\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Step 2: Payment */}\r\n      {currentStep === 2 && (\r\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\r\n          <div className=\"space-y-6\">\r\n            <div>\r\n              <h3 className=\"text-lg font-bold text-gray-900\">Payment Processing</h3>\r\n              <p className=\"text-sm text-gray-600\">Initialize payment for this withdrawal</p>\r\n            </div>\r\n\r\n            {!paymentIntent ? (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-6 text-center\">\r\n                  <CreditCard className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\r\n                  <p className=\"text-sm text-gray-600\">Click below to create payment intent</p>\r\n                </div>\r\n                <div className=\"flex items-center gap-4\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setCurrentStep(1)}\r\n                    className=\"flex-1 rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm font-semibold text-gray-700 transition-all hover:bg-gray-50\"\r\n                  >\r\n                    Back\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleProceedToPayment}\r\n                    disabled={loading}\r\n                    className=\"flex-1 rounded-xl bg-green-600 px-4 py-3 text-sm font-semibold text-white transition-all hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  >\r\n                    {loading ? 'Creating Payment Intent...' : 'Create Payment Intent'}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"rounded-xl border border-green-200 bg-green-50 p-6\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"flex h-12 w-12 items-center justify-center rounded-full bg-green-500 text-white\">\r\n                      <CheckCircle className=\"h-6 w-6\" />\r\n                    </div>\r\n                    <div className=\"flex-1\">\r\n                      <p className=\"text-sm font-semibold text-green-900\">Payment Intent Created</p>\r\n                      <p className=\"text-xs text-green-700\">\r\n                        Order ID: {paymentIntent.razorpayOrderId || 'N/A'}\r\n                      </p>\r\n                      {paymentIntent.isTestMode && (\r\n                        <p className=\"text-xs text-yellow-700 mt-1\">âš ï¸ Test Mode - Payment will be simulated</p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n                  <div className=\"grid gap-4 md:grid-cols-2\">\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-600 mb-1\">Payment Amount</p>\r\n                      <p className=\"text-lg font-bold text-gray-900\">{formatCurrency(paymentIntent.amount || 0)}</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-600 mb-1\">Currency</p>\r\n                      <p className=\"text-lg font-bold text-gray-900\">{paymentIntent.currency || 'INR'}</p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-4 pt-4 border-t border-gray-200\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => {\r\n                      setPaymentIntent(null)\r\n                      setCurrentStep(1)\r\n                    }}\r\n                    className=\"flex-1 rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm font-semibold text-gray-700 transition-all hover:bg-gray-50\"\r\n                  >\r\n                    Back\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handlePayment}\r\n                    disabled={loading}\r\n                    className=\"flex-1 rounded-xl bg-green-600 px-4 py-3 text-sm font-semibold text-white transition-all hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  >\r\n                    {loading ? 'Processing Payment...' : 'Process Payment'}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Step 3: Approval */}\r\n      {currentStep === 3 && (\r\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\r\n          <div className=\"space-y-6\">\r\n            <div className=\"rounded-xl border border-green-200 bg-green-50 p-6 text-center\">\r\n              <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-green-500 text-white mx-auto mb-4\">\r\n                <CheckCircle className=\"h-8 w-8\" />\r\n              </div>\r\n              <h3 className=\"text-lg font-bold text-green-900 mb-2\">Withdrawal Approved!</h3>\r\n              <p className=\"text-sm text-green-700\">\r\n                Payment has been processed and withdrawal request has been approved successfully.\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n              <div className=\"grid gap-4 md:grid-cols-2\">\r\n                <div>\r\n                  <p className=\"text-xs text-gray-600 mb-1\">Payment Reference</p>\r\n                  <p className=\"text-sm font-medium text-gray-900\">\r\n                    {paymentIntent?.razorpayOrderId || 'N/A'}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-xs text-gray-600 mb-1\">Amount Transferred</p>\r\n                  <p className=\"text-sm font-bold text-green-600\">\r\n                    {formatCurrency(request.amount || 0)}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-4 pt-4 border-t border-gray-200\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  onSuccess?.()\r\n                }}\r\n                className=\"flex-1 rounded-xl bg-green-600 px-4 py-3 text-sm font-semibold text-white transition-all hover:bg-green-700\"\r\n              >\r\n                Done\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\Sidebar.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'colorStyles' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":161,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":161,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'onSignOut' is defined but never used.","line":227,"column":66,"nodeType":"Identifier","messageId":"unusedVar","endLine":227,"endColumn":75,"suggestions":[{"messageId":"removeVar","data":{"varName":"onSignOut"},"fix":{"range":[6708,6719],"text":""},"desc":"Remove unused variable 'onSignOut'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":261,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":261,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[7609,7621],"text":""},"desc":"Remove unused variable 'Icon'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'description' is defined but never used.","line":261,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":261,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"description"},"fix":{"range":[7621,7634],"text":""},"desc":"Remove unused variable 'description'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'color' is defined but never used.","line":261,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":261,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"color"},"fix":{"range":[7634,7641],"text":""},"desc":"Remove unused variable 'color'."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { BarChart3, Building2, Factory, Home, Layers3, ShieldCheck, Users2, Wallet, Settings, ArrowRightLeft, IndianRupee, History, ChevronDown, ChevronRight, ImageIcon, Star, ListTodo } from 'lucide-react'\nimport { cn } from '../../../lib/cn'\nimport { useAdminState } from '../context/AdminContext'\n\nconst links = [\n  {\n    id: 'dashboard',\n    label: 'Dashboard',\n    icon: Home,\n    description: 'Overview & important updates',\n    color: 'blue',\n    suboptions: []\n  },\n  {\n    id: 'tasks',\n    label: 'TODO Tasks',\n    icon: ListTodo,\n    description: 'Operational tasks and priorities',\n    color: 'orange',\n    suboptions: []\n  },\n  {\n    id: 'products',\n    label: 'Products',\n    icon: Layers3,\n    description: 'All products list',\n    color: 'purple',\n    suboptions: [\n      { id: 'products/add', label: 'Add Products' },\n      { id: 'products/active', label: 'Active Products' },\n      { id: 'products/inactive', label: 'Inactive Products' },\n    ]\n  },\n  {\n    id: 'offers',\n    label: 'Offers',\n    icon: ImageIcon,\n    description: 'Manage carousels and special offers',\n    color: 'purple',\n    suboptions: []\n  },\n  {\n    id: 'reviews',\n    label: 'Reviews',\n    icon: Star,\n    description: 'Manage product reviews and ratings',\n    color: 'purple',\n    suboptions: []\n  },\n  {\n    id: 'orders',\n    label: 'Orders',\n    icon: Building2,\n    description: 'Approvals & delivery',\n    color: 'red',\n    suboptions: [\n      { id: 'orders/all', label: 'ALL' },\n      { id: 'orders/escalated', label: 'Escalated Orders' },\n      { id: 'orders/processing', label: 'Processing Orders' },\n      { id: 'orders/completed', label: 'Completed' },\n    ]\n  },\n  {\n    id: 'vendors',\n    label: 'Vendors',\n    icon: Factory,\n    description: 'Payment & how well they are doing',\n    color: 'green',\n    suboptions: [\n      { id: 'vendors/on-track', label: 'On Track Vendors' },\n      { id: 'vendors/out-of-track', label: 'Out of Track Vendors' },\n      { id: 'vendors/purchase-requests', label: 'Purchase Requests' },\n    ]\n  },\n  {\n    id: 'sellers',\n    label: 'IRA Partners',\n    icon: ShieldCheck,\n    description: 'Goals & earnings',\n    color: 'yellow',\n    suboptions: [\n      { id: 'sellers/active', label: 'Active IRA Partners' },\n      { id: 'sellers/inactive', label: 'Inactive IRA Partners' },\n    ]\n  },\n  {\n    id: 'users',\n    label: 'Users',\n    icon: Users2,\n    description: 'User status & help requests',\n    color: 'orange',\n    suboptions: [\n      { id: 'users/all', label: 'ALL' },\n      { id: 'users/active', label: 'Active' },\n      { id: 'users/inactive', label: 'Inactive' },\n    ]\n  },\n  {\n    id: 'finance',\n    label: 'Credits',\n    icon: Wallet,\n    description: 'Advance payments & pending amounts',\n    color: 'pink',\n    suboptions: [\n      { id: 'finance/overview', label: 'Overview' },\n      { id: 'finance/penalties', label: 'Penalties' },\n      { id: 'repayments', label: 'Repayments' },\n    ]\n  },\n  {\n    id: 'vendor-withdrawals',\n    label: 'Vendor Withdrawals',\n    icon: Factory,\n    description: 'Manage vendor withdrawal requests',\n    color: 'green',\n    suboptions: []\n  },\n  {\n    id: 'seller-withdrawals',\n    label: 'IRA Partner Withdrawals',\n    icon: ShieldCheck,\n    description: 'Manage seller withdrawal requests',\n    color: 'yellow',\n    suboptions: []\n  },\n  {\n    id: 'payment-history',\n    label: 'Payment History',\n    icon: History,\n    description: 'Complete audit log of all transactions',\n    color: 'indigo',\n    suboptions: []\n  },\n  {\n    id: 'operations',\n    label: 'Operations',\n    icon: Settings,\n    description: 'Logistics, escalations & notifications',\n    color: 'teal',\n    suboptions: [\n      { id: 'operations/notifications/add', label: 'Add Notifications' },\n      { id: 'operations/delivery-timeline/update', label: 'Update Delivery Timeline' },\n    ]\n  },\n  {\n    id: 'analytics',\n    label: 'Analytics',\n    icon: BarChart3,\n    description: 'Area & group patterns',\n    color: 'indigo',\n    suboptions: [\n      { id: 'analytics/sales', label: 'Sales Analytics' },\n      { id: 'analytics/users', label: 'User Analytics' },\n      { id: 'analytics/vendors', label: 'Vendor Analytics' },\n      { id: 'analytics/orders', label: 'Order Analytics' },\n    ]\n  },\n]\n\nconst colorStyles = {\n  blue: {\n    active: 'bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-[0_2px_6px_rgba(0,0,0,0.1)]',\n    bg: 'bg-blue-50',\n    text: 'text-blue-600',\n    border: 'border-blue-200',\n    hover: 'hover:bg-blue-50 hover:border-blue-300',\n  },\n  purple: {\n    active: 'bg-gradient-to-br from-purple-500 to-purple-600 text-white shadow-[0_2px_6px_rgba(0,0,0,0.1)]',\n    bg: 'bg-purple-50',\n    text: 'text-purple-600',\n    border: 'border-purple-200',\n    hover: 'hover:bg-purple-50 hover:border-purple-300',\n  },\n  green: {\n    active: 'bg-gradient-to-br from-green-500 to-green-600 text-white shadow-[0_2px_6px_rgba(0,0,0,0.1)]',\n    bg: 'bg-green-50',\n    text: 'text-green-600',\n    border: 'border-green-200',\n    hover: 'hover:bg-green-50 hover:border-green-300',\n  },\n  yellow: {\n    active: 'bg-gradient-to-br from-yellow-500 to-yellow-600 text-white shadow-[0_2px_6px_rgba(0,0,0,0.1)]',\n    bg: 'bg-yellow-50',\n    text: 'text-yellow-600',\n    border: 'border-yellow-200',\n    hover: 'hover:bg-yellow-50 hover:border-yellow-300',\n  },\n  orange: {\n    active: 'bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-[0_2px_6px_rgba(0,0,0,0.1)]',\n    bg: 'bg-orange-50',\n    text: 'text-orange-600',\n    border: 'border-orange-200',\n    hover: 'hover:bg-orange-50 hover:border-orange-300',\n  },\n  red: {\n    active: 'bg-gradient-to-br from-red-500 to-red-600 text-white shadow-[0_2px_6px_rgba(0,0,0,0.1)]',\n    bg: 'bg-red-50',\n    text: 'text-red-600',\n    border: 'border-red-200',\n    hover: 'hover:bg-red-50 hover:border-red-300',\n  },\n  pink: {\n    active: 'bg-gradient-to-br from-pink-500 to-pink-600 text-white shadow-[0_2px_6px_rgba(0,0,0,0.1)]',\n    bg: 'bg-pink-50',\n    text: 'text-pink-600',\n    border: 'border-pink-200',\n    hover: 'hover:bg-pink-50 hover:border-pink-300',\n  },\n  indigo: {\n    active: 'bg-gradient-to-br from-indigo-500 to-indigo-600 text-white shadow-[0_2px_6px_rgba(0,0,0,0.1)]',\n    bg: 'bg-indigo-50',\n    text: 'text-indigo-600',\n    border: 'border-indigo-200',\n    hover: 'hover:bg-indigo-50 hover:border-indigo-300',\n  },\n  teal: {\n    active: 'bg-gradient-to-br from-teal-500 to-teal-600 text-white shadow-[0_2px_6px_rgba(0,0,0,0.1)]',\n    bg: 'bg-teal-50',\n    text: 'text-teal-600',\n    border: 'border-teal-200',\n    hover: 'hover:bg-teal-50 hover:border-teal-300',\n  },\n}\n\nexport function Sidebar({ active, onNavigate, condensed = false, onSignOut }) {\n  const { tasks } = useAdminState?.() || { tasks: { pendingCount: 0 } }\n  const [expandedItems, setExpandedItems] = useState(new Set())\n\n  const toggleExpand = (id) => {\n    setExpandedItems((prev) => {\n      const next = new Set(prev)\n      if (next.has(id)) {\n        next.delete(id)\n      } else {\n        next.add(id)\n      }\n      return next\n    })\n  }\n\n  const isParentActive = (id, suboptions) => {\n    if (active === id) return true\n    if (suboptions && suboptions.length > 0) {\n      return suboptions.some((sub) => {\n        if (sub.id === active) return true\n        if (active.startsWith(sub.id + '/')) return true\n        return false\n      })\n    }\n    return active.startsWith(id + '/')\n  }\n\n  const isSuboptionActive = (subId) => {\n    return active === subId || active.startsWith(subId + '/')\n  }\n\n  return (\n    <nav className=\"mt-2\">\n      {links.map(({ id, label, icon: Icon, description, color, suboptions = [] }) => {\n        const hasSuboptions = suboptions && suboptions.length > 0\n        const isExpanded = expandedItems.has(id)\n        const isActive = isParentActive(id, suboptions)\n\n        return (\n          <div key={id}>\n            <button\n              type=\"button\"\n              onClick={() => {\n                if (hasSuboptions) {\n                  toggleExpand(id)\n                }\n                onNavigate(id)\n              }}\n              className={cn(\n                'w-full flex items-center gap-3 px-3 py-2.5 text-left transition-colors duration-150 focus-visible:outline-none',\n                isActive\n                  ? 'bg-[#2271b1] text-white border-l-4 border-[#2271b1]'\n                  : 'text-[#b4b9be] hover:bg-[#32373c] hover:text-white',\n                id === 'tasks' && tasks?.pendingCount > 0 && !isActive && 'animate-pulse bg-orange-900/40 text-orange-400 font-bold',\n                condensed && 'justify-center'\n              )}\n            >\n              <div className=\"relative\">\n                <Icon className={cn('h-5 w-5 flex-shrink-0', isActive ? 'text-white' : 'text-[#b4b9be]')} />\n                {id === 'tasks' && tasks?.pendingCount > 0 && !isActive && (\n                  <span className=\"absolute -top-1 -right-1 flex h-2 w-2\">\n                    <span className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-orange-400 opacity-75\"></span>\n                    <span className=\"relative inline-flex rounded-full h-2 w-2 bg-orange-500 shadow-sm border border-white\"></span>\n                  </span>\n                )}\n              </div>\n              {!condensed && (\n                <>\n                  <span className={cn('text-sm', isActive ? 'text-white font-medium' : (id === 'tasks' && tasks?.pendingCount > 0 ? 'text-orange-400' : 'text-[#b4b9be]'))}>\n                    {label}\n                  </span>\n                  {hasSuboptions && (\n                    <span className={cn('ml-auto transition-transform duration-200', isExpanded && 'rotate-90')}>\n                      <ChevronRight className=\"h-4 w-4\" />\n                    </span>\n                  )}\n                </>\n              )}\n            </button>\n            {hasSuboptions && isExpanded && !condensed && (\n              <div className=\"bg-[#1d2327]\">\n                {suboptions.map((sub) => {\n                  const isSubActive = isSuboptionActive(sub.id)\n                  return (\n                    <button\n                      key={sub.id}\n                      type=\"button\"\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        onNavigate(sub.id)\n                      }}\n                      className={cn(\n                        'w-full flex items-center gap-3 pl-11 pr-3 py-2 text-left text-sm transition-colors duration-150',\n                        isSubActive\n                          ? 'bg-[#2271b1] text-white border-l-4 border-[#2271b1]'\n                          : 'text-[#b4b9be] hover:bg-[#32373c] hover:text-white',\n                      )}\n                    >\n                      <span className={isSubActive ? 'text-white' : 'text-[#b4b9be]'}>\n                        {sub.label}\n                      </span>\n                    </button>\n                  )\n                })}\n              </div>\n            )}\n          </div>\n        )\n      })}\n    </nav>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\StatusBadge.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\SupportTicketModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\Timeline.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\ToastNotification.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[9,19],"text":""},"desc":"Remove unused variable 'useEffect'."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":41,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":41,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, createContext, useContext } from 'react'\r\nimport { X, CheckCircle2, AlertTriangle, Info, XCircle } from 'lucide-react'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nconst ToastContext = createContext(null)\r\n\r\nexport function ToastProvider({ children }) {\r\n  const [toasts, setToasts] = useState([])\r\n\r\n  const addToast = (message, type = 'info', duration = 4000) => {\r\n    const id = Date.now() + Math.random()\r\n    const toast = { id, message, type }\r\n    setToasts((prev) => [...prev, toast])\r\n\r\n    if (duration > 0) {\r\n      setTimeout(() => {\r\n        dismissToast(id)\r\n      }, duration)\r\n    }\r\n\r\n    return id\r\n  }\r\n\r\n  const dismissToast = (id) => {\r\n    setToasts((prev) => prev.filter((toast) => toast.id !== id))\r\n  }\r\n\r\n  const success = (message, duration) => addToast(message, 'success', duration)\r\n  const error = (message, duration) => addToast(message, 'error', duration)\r\n  const warning = (message, duration) => addToast(message, 'warning', duration)\r\n  const info = (message, duration) => addToast(message, 'info', duration)\r\n\r\n  return (\r\n    <ToastContext.Provider value={{ toasts, addToast, dismissToast, success, error, warning, info }}>\r\n      {children}\r\n      <ToastContainer toasts={toasts} onDismiss={dismissToast} />\r\n    </ToastContext.Provider>\r\n  )\r\n}\r\n\r\nexport function useToast() {\r\n  const context = useContext(ToastContext)\r\n  if (!context) {\r\n    return {\r\n      toasts: [],\r\n      addToast: () => {},\r\n      dismissToast: () => {},\r\n      success: () => {},\r\n      error: () => {},\r\n      warning: () => {},\r\n      info: () => {},\r\n    }\r\n  }\r\n  return context\r\n}\r\n\r\nexport function ToastContainer({ toasts, onDismiss }) {\r\n  if (toasts.length === 0) return null\r\n\r\n  return (\r\n    <div className=\"fixed top-4 right-4 z-[9999] flex flex-col gap-3 max-w-md w-full pointer-events-none\">\r\n      {toasts.map((toast) => (\r\n        <ToastNotification key={toast.id} toast={toast} onDismiss={onDismiss} />\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction ToastNotification({ toast, onDismiss }) {\r\n  const [isExiting, setIsExiting] = useState(false)\r\n\r\n  const handleDismiss = () => {\r\n    setIsExiting(true)\r\n    setTimeout(() => {\r\n      onDismiss(toast.id)\r\n    }, 300)\r\n  }\r\n\r\n  const iconConfig = {\r\n    success: {\r\n      icon: CheckCircle2,\r\n      bg: 'bg-gradient-to-br from-green-50 to-green-100/50',\r\n      border: 'border-green-200',\r\n      iconBg: 'bg-gradient-to-br from-green-500 to-green-600',\r\n      iconColor: 'text-white',\r\n      text: 'text-green-900',\r\n      shadow: 'shadow-[0_8px_24px_rgba(34,197,94,0.25),inset_0_1px_0_rgba(255,255,255,0.8)]',\r\n    },\r\n    error: {\r\n      icon: XCircle,\r\n      bg: 'bg-gradient-to-br from-red-50 to-red-100/50',\r\n      border: 'border-red-200',\r\n      iconBg: 'bg-gradient-to-br from-red-500 to-red-600',\r\n      iconColor: 'text-white',\r\n      text: 'text-red-900',\r\n      shadow: 'shadow-[0_8px_24px_rgba(239,68,68,0.25),inset_0_1px_0_rgba(255,255,255,0.8)]',\r\n    },\r\n    warning: {\r\n      icon: AlertTriangle,\r\n      bg: 'bg-gradient-to-br from-amber-50 to-amber-100/50',\r\n      border: 'border-amber-200',\r\n      iconBg: 'bg-gradient-to-br from-amber-500 to-amber-600',\r\n      iconColor: 'text-white',\r\n      text: 'text-amber-900',\r\n      shadow: 'shadow-[0_8px_24px_rgba(245,158,11,0.25),inset_0_1px_0_rgba(255,255,255,0.8)]',\r\n    },\r\n    info: {\r\n      icon: Info,\r\n      bg: 'bg-gradient-to-br from-purple-50 to-purple-100/50',\r\n      border: 'border-purple-200',\r\n      iconBg: 'bg-gradient-to-br from-purple-500 to-purple-600',\r\n      iconColor: 'text-white',\r\n      text: 'text-purple-900',\r\n      shadow: 'shadow-[0_8px_24px_rgba(168,85,247,0.25),inset_0_1px_0_rgba(255,255,255,0.8)]',\r\n    },\r\n  }\r\n\r\n  const config = iconConfig[toast.type] || iconConfig.info\r\n  const Icon = config.icon\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'pointer-events-auto flex items-start gap-4 rounded-2xl border p-4 transition-all duration-300 ease-out',\r\n        config.bg,\r\n        config.border,\r\n        config.shadow,\r\n        isExiting ? 'opacity-0 translate-x-full scale-95' : 'opacity-100 translate-x-0 scale-100',\r\n        'hover:scale-[1.02] hover:shadow-[0_12px_32px_rgba(0,0,0,0.15),inset_0_1px_0_rgba(255,255,255,0.8)]'\r\n      )}\r\n    >\r\n      {/* Icon */}\r\n      <div\r\n        className={cn(\r\n          'flex h-10 w-10 shrink-0 items-center justify-center rounded-xl transition-all',\r\n          config.iconBg,\r\n          config.iconColor,\r\n          'shadow-[0_4px_12px_rgba(0,0,0,0.15),inset_0_1px_0_rgba(255,255,255,0.3)]'\r\n        )}\r\n      >\r\n        <Icon className=\"h-5 w-5\" strokeWidth={2.5} />\r\n      </div>\r\n\r\n      {/* Message */}\r\n      <div className=\"flex-1 min-w-0 pt-0.5\">\r\n        <p className={cn('text-sm font-semibold leading-relaxed', config.text)}>\r\n          {toast.message}\r\n        </p>\r\n      </div>\r\n\r\n      {/* Close Button */}\r\n      <button\r\n        type=\"button\"\r\n        onClick={handleDismiss}\r\n        className={cn(\r\n          'flex h-7 w-7 shrink-0 items-center justify-center rounded-lg transition-all',\r\n          'text-gray-400 hover:bg-white/50 hover:text-gray-600',\r\n          'focus:outline-none focus:ring-2 focus:ring-purple-500/50'\r\n        )}\r\n        aria-label=\"Dismiss notification\"\r\n      >\r\n        <X className=\"h-4 w-4\" strokeWidth={2.5} />\r\n      </button>\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\UserDetailModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[226,262],"text":""},"desc":"Remove unused variable 'cn'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { User, Hash, MapPin, ShoppingBag, CreditCard, MessageSquare, Ban, CheckCircle } from 'lucide-react'\r\nimport { Modal } from './Modal'\r\nimport { StatusBadge } from './StatusBadge'\r\nimport { Timeline } from './Timeline'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nexport function UserDetailModal({ isOpen, onClose, user, onBlock, onDeactivate, onActivate, onViewSupportTickets }) {\r\n  if (!user) return null\r\n\r\n  const formatCurrency = (value) => {\r\n    if (typeof value === 'string') {\r\n      return value\r\n    }\r\n    if (value >= 100000) {\r\n      return `â‚¹${(value / 100000).toFixed(1)} L`\r\n    }\r\n    return `â‚¹${value.toLocaleString('en-IN')}`\r\n  }\r\n\r\n  return (\r\n    <Modal isOpen={isOpen} onClose={onClose} title=\"User Details & Activity\" size=\"xl\">\r\n      <div className=\"space-y-6\">\r\n        {/* User Header */}\r\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-lg\">\r\n                <User className=\"h-6 w-6\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"text-lg font-bold text-gray-900\">{user.name}</h3>\r\n                <p className=\"text-sm text-gray-600\">User ID: {user.id}</p>\r\n                <div className=\"mt-2 flex items-center gap-4 text-xs text-gray-500\">\r\n                  {user.region && (\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <MapPin className=\"h-3.5 w-3.5\" />\r\n                      <span>{user.region}</span>\r\n                    </div>\r\n                  )}\r\n                  {user.phone && (\r\n                    <div>\r\n                      <span>{user.phone}</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <StatusBadge tone={user.status === 'Active' || user.status === 'active' ? 'success' : user.status === 'Blocked' || user.status === 'blocked' ? 'neutral' : 'warning'}>\r\n              {user.status || 'Unknown'}\r\n            </StatusBadge>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Linked IRA Partner */}\r\n        {user.sellerId && (\r\n          <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Hash className=\"h-5 w-5 text-blue-600\" />\r\n                <div>\r\n                  <p className=\"text-xs text-blue-500\">Linked IRA Partner ID</p>\r\n                  <p className=\"text-sm font-bold text-blue-900\">{user.sellerId}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Activity Summary */}\r\n        <div className=\"grid gap-4 sm:grid-cols-3\">\r\n          <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\r\n            <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\r\n              <ShoppingBag className=\"h-4 w-4\" />\r\n              <span>Total Orders</span>\r\n            </div>\r\n            <p className=\"text-2xl font-bold text-gray-900\">\r\n              {user.orders || user.totalOrders || 0}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\r\n            <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\r\n              <CreditCard className=\"h-4 w-4\" />\r\n              <span>Payment Status</span>\r\n            </div>\r\n            <StatusBadge tone={user.payments === 'On Time' || user.payments === 'on_time' ? 'success' : 'warning'}>\r\n              {user.payments || 'Unknown'}\r\n            </StatusBadge>\r\n          </div>\r\n          <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\r\n            <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\r\n              <MessageSquare className=\"h-4 w-4\" />\r\n              <span>Support Tickets</span>\r\n            </div>\r\n            <div className=\"flex items-center justify-between\">\r\n              <p className=\"text-2xl font-bold text-gray-900\">\r\n                {user.supportTickets || user.openTickets || 0}\r\n              </p>\r\n              {user.supportTickets > 0 && onViewSupportTickets && (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => onViewSupportTickets(user)}\r\n                  className=\"text-xs font-bold text-orange-600 hover:text-orange-700\"\r\n                >\r\n                  View All\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Orders History */}\r\n        {user.ordersHistory && user.ordersHistory.length > 0 && (\r\n          <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\r\n            <div className=\"mb-4 flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <ShoppingBag className=\"h-5 w-5 text-gray-600\" />\r\n                <h4 className=\"text-sm font-bold text-gray-900\">Order History</h4>\r\n              </div>\r\n            </div>\r\n            <div className=\"space-y-3 max-h-64 overflow-y-auto\">\r\n              {user.ordersHistory.map((order, index) => (\r\n                <div key={order.id || index} className=\"rounded-lg border border-gray-200 bg-gray-50 p-3\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm font-bold text-gray-900\">{order.id || `Order #${index + 1}`}</p>\r\n                      <p className=\"text-xs text-gray-600\">{order.date || order.createdAt}</p>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                      <p className=\"text-sm font-bold text-gray-900\">{formatCurrency(order.value || order.amount || 0)}</p>\r\n                      <StatusBadge tone={order.status === 'completed' ? 'success' : order.status === 'pending' ? 'warning' : 'neutral'}>\r\n                        {order.status || 'Unknown'}\r\n                      </StatusBadge>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Payment History */}\r\n        {user.paymentHistory && user.paymentHistory.length > 0 && (\r\n          <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\r\n            <div className=\"mb-4 flex items-center gap-2\">\r\n              <CreditCard className=\"h-5 w-5 text-gray-600\" />\r\n              <h4 className=\"text-sm font-bold text-gray-900\">Payment History</h4>\r\n            </div>\r\n            <Timeline\r\n              events={user.paymentHistory.map((payment, index) => ({\r\n                id: payment.id || `payment-${index}`,\r\n                title: payment.description || `Payment ${index + 1}`,\r\n                timestamp: payment.date || payment.timestamp || 'N/A',\r\n                description: formatCurrency(payment.amount || 0),\r\n                status: payment.status || 'completed',\r\n              }))}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {/* Support Tickets Summary */}\r\n        {user.supportTickets > 0 && (\r\n          <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-bold text-orange-900\">Active Support Tickets</p>\r\n                <p className=\"text-xs text-orange-700\">{user.supportTickets} ticket(s) require attention</p>\r\n              </div>\r\n              {onViewSupportTickets && (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => onViewSupportTickets(user)}\r\n                  className=\"rounded-lg border border-orange-300 bg-white px-4 py-2 text-xs font-bold text-orange-700 transition-all hover:bg-orange-100\"\r\n                >\r\n                  View Tickets\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={onClose}\r\n            className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\r\n          >\r\n            Close\r\n          </button>\r\n          <div className=\"flex gap-3\">\r\n            {user.status === 'Active' || user.status === 'active' ? (\r\n              <>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => onDeactivate(user.id)}\r\n                  className=\"flex items-center gap-2 rounded-xl border border-orange-300 bg-white px-6 py-3 text-sm font-bold text-orange-600 transition-all hover:bg-orange-50\"\r\n                >\r\n                  <Ban className=\"h-4 w-4\" />\r\n                  Deactivate\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => onBlock(user.id)}\r\n                  className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50\"\r\n                >\r\n                  <Ban className=\"h-4 w-4\" />\r\n                  Block User\r\n                </button>\r\n              </>\r\n            ) : (\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => onActivate(user.id)}\r\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)]\"\r\n              >\r\n                <CheckCircle className=\"h-4 w-4\" />\r\n                Activate User\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\VendorApprovalModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\VendorCreditBalanceModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\VendorDetailModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\VendorEditForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\VendorMap.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\VendorWithdrawalApprovalScreen.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[17,28],"text":""},"desc":"Remove unused variable 'useEffect'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\nimport { ArrowLeft, CheckCircle, AlertCircle, IndianRupee, Factory, CreditCard, Shield, Calendar } from 'lucide-react'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { openRazorpayCheckout } from '../../../utils/razorpay'\nimport { getMaskedBankDetails } from '../../../utils/maskSensitiveData'\nimport { cn } from '../../../lib/cn'\n\nconst STEPS = [\n  { id: 1, label: 'Confirmation', icon: AlertCircle },\n  { id: 2, label: 'Payment', icon: CreditCard },\n  { id: 3, label: 'Approval', icon: CheckCircle },\n]\n\nexport function VendorWithdrawalApprovalScreen({ request, onBack, onSuccess }) {\n  const { approveVendorWithdrawal, createVendorWithdrawalPaymentIntent } = useAdminApi()\n  const { success, error: showError } = useToast()\n\n  const [currentStep, setCurrentStep] = useState(1)\n  const [loading, setLoading] = useState(false)\n  const [paymentIntent, setPaymentIntent] = useState(null)\n  const [paymentCompleted, setPaymentCompleted] = useState(false)\n\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') return value\n    if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  const handleConfirm = () => {\n    setCurrentStep(2)\n  }\n\n  const handleProceedToPayment = async () => {\n    try {\n      setLoading(true)\n      // Create payment intent\n      const result = await createVendorWithdrawalPaymentIntent(request.requestId || request.id, {\n        amount: request.amount,\n      })\n\n      if (result?.error) {\n        showError(result.error.message || 'Failed to create payment intent')\n        return\n      }\n\n      if (result?.data?.paymentIntent) {\n        setPaymentIntent(result.data.paymentIntent)\n      } else {\n        showError('Invalid payment intent response')\n        return\n      }\n    } catch (err) {\n      showError(err.message || 'Failed to initialize payment')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handlePayment = async () => {\n    if (!paymentIntent) {\n      showError('Payment intent not initialized')\n      return\n    }\n\n    try {\n      setLoading(true)\n      const { razorpayOrderId, keyId, amount, isTestMode } = paymentIntent\n\n      // If in test mode (simulated order), skip Razorpay checkout and simulate payment\n      if (isTestMode || razorpayOrderId?.startsWith('order_test_')) {\n        console.log('âš ï¸ [VendorWithdrawalApprovalScreen] Test mode detected, simulating payment...')\n        \n        // Simulate payment success\n        const simulatedPaymentResponse = {\n          paymentId: `pay_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          orderId: razorpayOrderId,\n          signature: `sig_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        }\n\n        // Payment successful, proceed to approval\n        setPaymentCompleted(true)\n        setCurrentStep(3)\n\n        // Approve withdrawal with simulated payment details\n        const approveResult = await approveVendorWithdrawal(request.requestId || request.id, {\n          paymentReference: simulatedPaymentResponse.paymentId,\n          paymentMethod: 'razorpay',\n          paymentDate: new Date().toISOString(),\n          gatewayPaymentId: simulatedPaymentResponse.paymentId,\n          gatewayOrderId: simulatedPaymentResponse.orderId,\n          gatewaySignature: simulatedPaymentResponse.signature,\n        })\n\n        if (approveResult?.error) {\n          showError(approveResult.error.message || 'Failed to approve withdrawal')\n          setCurrentStep(2)\n          setPaymentCompleted(false)\n          return\n        }\n\n        success('Withdrawal approved and payment processed successfully! (Test Mode)')\n        setTimeout(() => {\n          onSuccess?.()\n        }, 1500)\n        return\n      }\n\n      if (!razorpayOrderId || !keyId) {\n        showError('Payment gateway configuration error')\n        return\n      }\n\n      // Open Razorpay Checkout (only for real orders)\n      const razorpayResponse = await openRazorpayCheckout({\n        key: keyId,\n        amount: amount,\n        currency: 'INR',\n        order_id: razorpayOrderId,\n        name: 'IRA SATHI',\n        description: `Vendor Withdrawal Payment - ${request.vendorName || 'Vendor'}`,\n        prefill: {\n          name: request.vendorName || '',\n          email: '',\n          contact: '',\n        },\n      })\n\n      // Payment successful, proceed to approval\n      setPaymentCompleted(true)\n      setCurrentStep(3)\n\n      // Approve withdrawal with payment details\n      const approveResult = await approveVendorWithdrawal(request.requestId || request.id, {\n        paymentReference: razorpayResponse.paymentId,\n        paymentMethod: 'razorpay',\n        paymentDate: new Date().toISOString(),\n        gatewayPaymentId: razorpayResponse.paymentId,\n        gatewayOrderId: razorpayResponse.orderId,\n        gatewaySignature: razorpayResponse.signature,\n      })\n\n      if (approveResult?.error) {\n        showError(approveResult.error.message || 'Failed to approve withdrawal')\n        setCurrentStep(2)\n        setPaymentCompleted(false)\n        return\n      }\n\n      success('Withdrawal approved and payment processed successfully!')\n      setTimeout(() => {\n        onSuccess?.()\n      }, 1500)\n    } catch (razorpayError) {\n      if (razorpayError.error) {\n        showError(razorpayError.error || 'Payment was cancelled or failed')\n      } else {\n        showError(razorpayError.message || 'Payment processing failed')\n      }\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const bankDetails = request.bankDetails ? getMaskedBankDetails(request.bankDetails) : null\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <header className=\"flex items-center gap-4\">\n        <button\n          type=\"button\"\n          onClick={onBack}\n          className=\"flex h-10 w-10 items-center justify-center rounded-xl border border-gray-300 bg-white text-gray-700 transition-all hover:border-green-500 hover:bg-green-50 hover:text-green-700\"\n        >\n          <ArrowLeft className=\"h-5 w-5\" />\n        </button>\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Finance â€¢ Withdrawals</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Approve Vendor Withdrawal</h2>\n          <p className=\"text-sm text-gray-600\">Process vendor withdrawal request and payment</p>\n        </div>\n      </header>\n\n      {/* Steps Indicator */}\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n        <div className=\"flex items-center justify-between\">\n          {STEPS.map((step, index) => {\n            const isActive = currentStep === step.id\n            const isCompleted = currentStep > step.id\n            const Icon = step.icon\n\n            return (\n              <div key={step.id} className=\"flex flex-1 items-center\">\n                <div className=\"flex flex-col items-center\">\n                  <div\n                    className={cn(\n                      'flex h-12 w-12 items-center justify-center rounded-full border-2 transition-all',\n                      isCompleted\n                        ? 'border-green-500 bg-green-500 text-white'\n                        : isActive\n                        ? 'border-green-500 bg-green-50 text-green-600'\n                        : 'border-gray-300 bg-white text-gray-400'\n                    )}\n                  >\n                    {isCompleted ? (\n                      <CheckCircle className=\"h-6 w-6\" />\n                    ) : (\n                      <Icon className=\"h-6 w-6\" />\n                    )}\n                  </div>\n                  <span\n                    className={cn(\n                      'mt-2 text-xs font-medium',\n                      isActive ? 'text-green-600' : isCompleted ? 'text-green-500' : 'text-gray-400'\n                    )}\n                  >\n                    {step.label}\n                  </span>\n                </div>\n                {index < STEPS.length - 1 && (\n                  <div\n                    className={cn(\n                      'mx-4 h-0.5 flex-1',\n                      isCompleted ? 'bg-green-500' : 'bg-gray-300'\n                    )}\n                  />\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n\n      {/* Step 1: Confirmation */}\n      {currentStep === 1 && (\n        <div className=\"space-y-6\">\n          <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n            <div className=\"mb-6 flex items-start gap-4\">\n              <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600 text-white shadow-lg\">\n                <Factory className=\"h-6 w-6\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"text-lg font-bold text-gray-900\">Request #{request.requestId || request.id || 'N/A'}</h3>\n                <div className=\"mt-1 flex items-center gap-2 text-sm text-gray-600\">\n                  <span>{request.vendorName || 'Unknown Vendor'}</span>\n                </div>\n                {request.date && (\n                  <div className=\"mt-2 flex items-center gap-1 text-xs text-gray-500\">\n                    <Calendar className=\"h-3.5 w-3.5\" />\n                    <span>{new Date(request.date).toLocaleDateString('en-IN')}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div className=\"rounded-xl border border-green-200 bg-green-50 p-5\">\n                <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\n                  <IndianRupee className=\"h-4 w-4\" />\n                  <span>Withdrawal Amount</span>\n                </div>\n                <p className=\"text-2xl font-bold text-gray-900\">{formatCurrency(request.amount || 0)}</p>\n              </div>\n\n              {bankDetails && (\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <p className=\"mb-2 text-xs font-bold text-gray-500\">Bank Account Details</p>\n                  <div className=\"space-y-1 text-sm text-gray-700\">\n                    {bankDetails.accountHolderName && (\n                      <p>Account Holder: {bankDetails.accountHolderName}</p>\n                    )}\n                    {bankDetails.accountNumber && (\n                      <p>Account: {bankDetails.accountNumber}</p>\n                    )}\n                    {bankDetails.ifscCode && <p>IFSC: {bankDetails.ifscCode}</p>}\n                    {bankDetails.bankName && <p>Bank: {bankDetails.bankName}</p>}\n                  </div>\n                </div>\n              )}\n\n              <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n                <div className=\"flex items-start gap-2\">\n                  <AlertCircle className=\"h-5 w-5 text-blue-600 mt-0.5\" />\n                  <div>\n                    <p className=\"text-sm font-semibold text-blue-900\">Confirmation Required</p>\n                    <p className=\"mt-1 text-xs text-blue-700\">\n                      Please verify all details before proceeding. Once approved, the payment will be processed via Razorpay and the amount will be credited to the vendor's account.\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"mt-6 flex justify-end gap-3 border-t border-gray-200 pt-6\">\n              <button\n                type=\"button\"\n                onClick={onBack}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleConfirm}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4)]\"\n              >\n                <CheckCircle className=\"h-4 w-4\" />\n                Confirm & Proceed\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Step 2: Payment */}\n      {currentStep === 2 && (\n        <div className=\"space-y-6\">\n          <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n            <div className=\"mb-6\">\n              <h3 className=\"text-lg font-bold text-gray-900\">Payment Processing</h3>\n              <p className=\"mt-1 text-sm text-gray-600\">Process payment via Razorpay</p>\n            </div>\n\n            {!paymentIntent ? (\n              <div className=\"space-y-4\">\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-5\">\n                  <div className=\"flex items-center gap-3 mb-4\">\n                    <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 text-white\">\n                      <CreditCard className=\"h-5 w-5\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm font-semibold text-gray-900\">Razorpay Payment Gateway</p>\n                      <p className=\"text-xs text-gray-600\">Secure payment processing</p>\n                    </div>\n                  </div>\n                  <div className=\"rounded-lg border border-gray-200 bg-white p-4\">\n                    <div className=\"flex justify-between items-center mb-2\">\n                      <span className=\"text-sm text-gray-600\">Amount to Pay</span>\n                      <span className=\"text-xl font-bold text-gray-900\">{formatCurrency(request.amount || 0)}</span>\n                    </div>\n                    <div className=\"mt-4 flex items-center gap-2 text-xs text-gray-500\">\n                      <Shield className=\"h-4 w-4\" />\n                      <span>Your payment is secured by Razorpay</span>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"flex justify-end gap-3 border-t border-gray-200 pt-6\">\n                  <button\n                    type=\"button\"\n                    onClick={() => setCurrentStep(1)}\n                    className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n                  >\n                    Back\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={handleProceedToPayment}\n                    disabled={loading}\n                    className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(59,130,246,0.3)] transition-all hover:shadow-[0_6px_20px_rgba(59,130,246,0.4)] disabled:opacity-50\"\n                  >\n                    {loading ? 'Initializing...' : 'Proceed to Payment'}\n                  </button>\n                </div>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                <div className=\"rounded-xl border border-green-200 bg-green-50 p-5\">\n                  <div className=\"flex items-center gap-3 mb-4\">\n                    <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-green-500 to-green-600 text-white\">\n                      <CheckCircle className=\"h-5 w-5\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm font-semibold text-gray-900\">Payment Ready</p>\n                      <p className=\"text-xs text-gray-600\">Click below to complete payment</p>\n                    </div>\n                  </div>\n                  <div className=\"rounded-lg border border-gray-200 bg-white p-4\">\n                    <div className=\"flex justify-between items-center mb-2\">\n                      <span className=\"text-sm text-gray-600\">Amount</span>\n                      <span className=\"text-xl font-bold text-gray-900\">{formatCurrency(request.amount || 0)}</span>\n                    </div>\n                    <div className=\"mt-2 text-xs text-gray-500\">\n                      Payment Gateway: Razorpay\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"flex justify-end gap-3 border-t border-gray-200 pt-6\">\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setPaymentIntent(null)\n                      setCurrentStep(1)\n                    }}\n                    className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n                  >\n                    Back\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={handlePayment}\n                    disabled={loading}\n                    className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4)] disabled:opacity-50\"\n                  >\n                    {loading ? 'Processing...' : 'Pay Now'}\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Step 3: Approval Complete */}\n      {currentStep === 3 && paymentCompleted && (\n        <div className=\"space-y-6\">\n          <div className=\"rounded-3xl border border-green-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n            <div className=\"text-center py-8\">\n              <div className=\"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-green-100\">\n                <CheckCircle className=\"h-10 w-10 text-green-600\" />\n              </div>\n              <h3 className=\"mt-4 text-2xl font-bold text-gray-900\">Withdrawal Approved!</h3>\n              <p className=\"mt-2 text-sm text-gray-600\">\n                Payment processed successfully and amount has been credited to vendor.\n              </p>\n              <div className=\"mt-6 rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-600\">Vendor:</span>\n                    <span className=\"font-semibold text-gray-900\">{request.vendorName || 'N/A'}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-600\">Amount:</span>\n                    <span className=\"font-semibold text-gray-900\">{formatCurrency(request.amount || 0)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-600\">Status:</span>\n                    <span className=\"font-semibold text-green-600\">Approved & Paid</span>\n                  </div>\n                </div>\n              </div>\n              <button\n                type=\"button\"\n                onClick={onSuccess}\n                className=\"mt-6 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4)]\"\n              >\n                Done\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\components\\WithdrawalRequestModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[168,204],"text":""},"desc":"Remove unused variable 'cn'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getSellerWallet' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":81,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":24}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Wallet, CheckCircle, XCircle, IndianRupee, Calendar, User } from 'lucide-react'\r\nimport { Modal } from './Modal'\r\nimport { StatusBadge } from './StatusBadge'\r\nimport { cn } from '../../../lib/cn'\r\nimport { getMaskedBankDetails } from '../../../utils/maskSensitiveData'\r\n\r\nexport function WithdrawalRequestModal({ isOpen, onClose, request, onApprove, onReject, loading }) {\r\n  if (!request) return null\r\n\r\n  // Extract request ID safely - handle both object and string ID\r\n  const getRequestId = () => {\r\n    if (typeof request.id === 'string') {\r\n      return request.id\r\n    }\r\n    if (request._id) {\r\n      return typeof request._id === 'string' ? request._id : String(request._id)\r\n    }\r\n    if (request.requestId) {\r\n      return typeof request.requestId === 'string' ? request.requestId : String(request.requestId)\r\n    }\r\n    if (request.id && typeof request.id === 'object' && request.id._id) {\r\n      return String(request.id._id)\r\n    }\r\n    return null\r\n  }\r\n\r\n  const requestId = getRequestId()\r\n\r\n  const handleApprove = () => {\r\n    if (requestId) {\r\n      onApprove(requestId)\r\n    }\r\n  }\r\n\r\n  const handleReject = () => {\r\n    const reason = window.prompt('Please provide a reason for rejection:')\r\n    if (reason && requestId) {\r\n      onReject(requestId, { reason })\r\n    }\r\n  }\r\n\r\n  const formatCurrency = (value) => {\r\n    if (typeof value === 'string') {\r\n      return value\r\n    }\r\n    if (value >= 100000) {\r\n      return `â‚¹${(value / 100000).toFixed(1)} L`\r\n    }\r\n    return `â‚¹${value.toLocaleString('en-IN')}`\r\n  }\r\n\r\n  // Extract seller ID safely - handle both populated object and string ID\r\n  const getSellerId = () => {\r\n    if (typeof request.sellerId === 'string') {\r\n      return request.sellerId\r\n    }\r\n    if (request.sellerId && typeof request.sellerId === 'object') {\r\n      return request.sellerId.sellerId || request.sellerId._id || request.sellerId.id\r\n    }\r\n    if (request.seller && typeof request.seller === 'object') {\r\n      return request.seller.sellerId || request.seller._id || request.seller.id\r\n    }\r\n    return null\r\n  }\r\n\r\n  // Extract seller name safely - handle both populated object and direct name\r\n  const getSellerName = () => {\r\n    if (request.sellerName) {\r\n      return request.sellerName\r\n    }\r\n    if (request.sellerId && typeof request.sellerId === 'object') {\r\n      return request.sellerId.name\r\n    }\r\n    if (request.seller && typeof request.seller === 'object') {\r\n      return request.seller.name\r\n    }\r\n    return 'Unknown IRA Partner'\r\n  }\r\n\r\n  // Extract seller wallet safely\r\n  const getSellerWallet = () => {\r\n    if (request.sellerId && typeof request.sellerId === 'object' && request.sellerId.wallet) {\r\n      return request.sellerId.wallet\r\n    }\r\n    if (request.seller && typeof request.seller === 'object' && request.seller.wallet) {\r\n      return request.seller.wallet\r\n    }\r\n    return null\r\n  }\r\n\r\n  const sellerId = getSellerId()\r\n  const sellerName = getSellerName()\r\n\r\n  return (\r\n    <Modal isOpen={isOpen} onClose={onClose} title=\"IRA Partner Withdrawal Request Review\" size=\"md\">\r\n      <div className=\"space-y-6\">\r\n        {/* Request Header */}\r\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-yellow-500 to-yellow-600 text-white shadow-lg\">\r\n                <Wallet className=\"h-6 w-6\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"text-lg font-bold text-gray-900\">Request #{requestId || 'N/A'}</h3>\r\n                <div className=\"mt-1 flex items-center gap-2 text-sm text-gray-600\">\r\n                  <User className=\"h-4 w-4\" />\r\n                  <span>{sellerName}</span>\r\n                </div>\r\n                {sellerId && (\r\n                  <p className=\"mt-1 text-xs text-gray-500\">IRA Partner ID: {sellerId}</p>\r\n                )}\r\n                {(request.date || request.createdAt) && (\r\n                  <div className=\"mt-2 flex items-center gap-1 text-xs text-gray-500\">\r\n                    <Calendar className=\"h-3.5 w-3.5\" />\r\n                    <span>\r\n                      {request.date \r\n                        ? (typeof request.date === 'string' ? request.date : new Date(request.date).toLocaleDateString('en-IN'))\r\n                        : request.createdAt \r\n                        ? (typeof request.createdAt === 'string' ? request.createdAt : new Date(request.createdAt).toLocaleDateString('en-IN'))\r\n                        : ''}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <StatusBadge tone={request.status === 'pending' ? 'warning' : request.status === 'approved' ? 'success' : 'neutral'}>\r\n              {request.status || 'Pending'}\r\n            </StatusBadge>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Withdrawal Details */}\r\n        <div className=\"space-y-4\">\r\n          <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-5\">\r\n            <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\r\n              <IndianRupee className=\"h-4 w-4\" />\r\n              <span>Withdrawal Amount</span>\r\n            </div>\r\n            <p className=\"text-2xl font-bold text-gray-900\">\r\n              {formatCurrency(request.amount || 0)}\r\n            </p>\r\n          </div>\r\n\r\n          {request.bankDetails && (() => {\r\n            const maskedDetails = getMaskedBankDetails({\r\n              ...request.bankDetails,\r\n              ifscCode: request.bankDetails.ifsc || request.bankDetails.ifscCode,\r\n            })\r\n            return (\r\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n                <p className=\"mb-2 text-xs font-bold text-gray-500\">Bank Account Details (Masked for Privacy)</p>\r\n                <div className=\"space-y-1 text-sm text-gray-700\">\r\n                  {maskedDetails.accountHolderName && (\r\n                    <p>Account Holder: {maskedDetails.accountHolderName}</p>\r\n                  )}\r\n                  {maskedDetails.accountNumber && (\r\n                    <p>Account: {maskedDetails.accountNumber}</p>\r\n                  )}\r\n                  {maskedDetails.ifscCode && (\r\n                    <p>IFSC: {maskedDetails.ifscCode}</p>\r\n                  )}\r\n                  {maskedDetails.bankName && (\r\n                    <p>Bank: {maskedDetails.bankName}</p>\r\n                  )}\r\n                </div>\r\n                <p className=\"mt-2 text-xs text-gray-500 italic\">\r\n                  Note: Account details are masked for security. Full details are available in payment history for processed transactions.\r\n                </p>\r\n              </div>\r\n            )\r\n          })()}\r\n\r\n          {request.reason && (\r\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\r\n              <p className=\"mb-2 text-xs font-bold text-gray-500\">Reason for Withdrawal</p>\r\n              <p className=\"text-sm text-gray-700\">{request.reason}</p>\r\n            </div>\r\n          )}\r\n\r\n          {request.sellerPerformance && (\r\n            <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\r\n              <p className=\"mb-2 text-xs font-bold text-blue-900\">IRA Partner Performance Summary</p>\r\n              <div className=\"grid gap-2 text-xs text-blue-800 sm:grid-cols-2\">\r\n                {request.sellerPerformance.totalSales && (\r\n                  <div>\r\n                    <span className=\"font-semibold\">Total Sales: </span>\r\n                    <span>{formatCurrency(request.sellerPerformance.totalSales)}</span>\r\n                  </div>\r\n                )}\r\n                {request.sellerPerformance.pendingEarnings && (\r\n                  <div>\r\n                    <span className=\"font-semibold\">Pending Earnings: </span>\r\n                    <span>{formatCurrency(request.sellerPerformance.pendingEarnings)}</span>\r\n                  </div>\r\n                )}\r\n                {request.sellerPerformance.targetAchievement && (\r\n                  <div>\r\n                    <span className=\"font-semibold\">Target Achievement: </span>\r\n                    <span>{request.sellerPerformance.targetAchievement}%</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={onClose}\r\n            disabled={loading}\r\n            className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <div className=\"flex gap-3\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleReject}\r\n              disabled={loading}\r\n              className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50 disabled:opacity-50\"\r\n            >\r\n              <XCircle className=\"h-4 w-4\" />\r\n              Reject\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleApprove}\r\n              disabled={loading}\r\n              className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-yellow-500 to-yellow-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(234,179,8,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(234,179,8,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\r\n            >\r\n              <CheckCircle className=\"h-4 w-4\" />\r\n              {loading ? 'Processing...' : 'Approve Withdrawal'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\config\\cloudinary.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\context\\AdminContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":309,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":309,"endColumn":30},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":315,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":315,"endColumn":33}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useMemo, useReducer, useEffect } from 'react'\nimport { initializeRealtimeConnection, handleRealtimeNotification } from '../services/adminApi'\n\nconst AdminStateContext = createContext(null)\nconst AdminDispatchContext = createContext(() => { })\n\nconst initialState = {\n  activeTenant: 'IRA Sathi Super Admin',\n  authenticated: false,\n  profile: {\n    name: 'Guest Admin',\n    phone: '',\n    role: '',\n  },\n  filters: {\n    region: 'All',\n    period: '30d',\n  },\n  notifications: [],\n  dashboard: {\n    data: null,\n    loading: false,\n    error: null,\n  },\n  products: {\n    data: null,\n    updated: false,\n  },\n  vendors: {\n    data: null,\n    updated: false,\n  },\n  sellers: {\n    data: null,\n    updated: false,\n  },\n  users: {\n    data: null,\n    updated: false,\n  },\n  orders: {\n    data: null,\n    updated: false,\n  },\n  finance: {\n    data: null,\n    updated: false,\n  },\n  analytics: {\n    data: null,\n  },\n  tasks: {\n    data: null,\n    pendingCount: 0,\n    updated: false,\n  },\n  realtimeConnected: false,\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'SET_FILTER':\n      return {\n        ...state,\n        filters: {\n          ...state.filters,\n          [action.payload.key]: action.payload.value,\n        },\n      }\n    case 'RESET_FILTERS':\n      return {\n        ...state,\n        filters: initialState.filters,\n      }\n    case 'AUTH_LOGIN':\n      return {\n        ...state,\n        authenticated: true,\n        profile: {\n          ...state.profile,\n          ...action.payload,\n        },\n      }\n    case 'AUTH_LOGOUT':\n      return {\n        ...state,\n        authenticated: false,\n        profile: initialState.profile,\n        notifications: [],\n        dashboard: initialState.dashboard,\n        products: initialState.products,\n        vendors: initialState.vendors,\n        sellers: initialState.sellers,\n        users: initialState.users,\n        orders: initialState.orders,\n        finance: initialState.finance,\n        analytics: initialState.analytics,\n        tasks: initialState.tasks,\n      }\n    case 'SET_DASHBOARD_DATA':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          data: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'SET_PRODUCTS_DATA':\n      return {\n        ...state,\n        products: {\n          ...state.products,\n          data: action.payload,\n        },\n      }\n    case 'SET_PRODUCTS_UPDATED':\n      return {\n        ...state,\n        products: {\n          ...state.products,\n          updated: action.payload,\n        },\n      }\n    case 'SET_VENDORS_DATA':\n      return {\n        ...state,\n        vendors: {\n          ...state.vendors,\n          data: action.payload,\n        },\n      }\n    case 'SET_VENDORS_UPDATED':\n      return {\n        ...state,\n        vendors: {\n          ...state.vendors,\n          updated: action.payload,\n        },\n      }\n    case 'SET_SELLERS_DATA':\n      return {\n        ...state,\n        sellers: {\n          ...state.sellers,\n          data: action.payload,\n        },\n      }\n    case 'SET_SELLERS_UPDATED':\n      return {\n        ...state,\n        sellers: {\n          ...state.sellers,\n          updated: action.payload,\n        },\n      }\n    case 'SET_USERS_DATA':\n      return {\n        ...state,\n        users: {\n          ...state.users,\n          data: action.payload,\n        },\n      }\n    case 'SET_USERS_UPDATED':\n      return {\n        ...state,\n        users: {\n          ...state.users,\n          updated: action.payload,\n        },\n      }\n    case 'SET_ORDERS_DATA':\n      return {\n        ...state,\n        orders: {\n          ...state.orders,\n          data: action.payload,\n        },\n      }\n    case 'SET_ORDERS_UPDATED':\n      return {\n        ...state,\n        orders: {\n          ...state.orders,\n          updated: action.payload,\n        },\n      }\n    case 'SET_FINANCE_DATA':\n      return {\n        ...state,\n        finance: {\n          ...state.finance,\n          data: action.payload,\n        },\n      }\n    case 'SET_FINANCE_UPDATED':\n      return {\n        ...state,\n        finance: {\n          ...state.finance,\n          updated: action.payload,\n        },\n      }\n    case 'SET_ANALYTICS_DATA':\n      return {\n        ...state,\n        analytics: {\n          ...state.analytics,\n          data: action.payload,\n        },\n      }\n    case 'SET_TASKS_DATA':\n      return {\n        ...state,\n        tasks: {\n          ...state.tasks,\n          data: action.payload.tasks,\n          pendingCount: action.payload.totalPending,\n          updated: false,\n        },\n      }\n    case 'SET_TASKS_UPDATED':\n      return {\n        ...state,\n        tasks: {\n          ...state.tasks,\n          updated: action.payload,\n        },\n      }\n    case 'ADD_NOTIFICATION': {\n      // Check if notification already exists (prevent duplicates)\n      const existingIndex = state.notifications.findIndex(\n        (n) => n.id === action.payload.id || (n.type === action.payload.type && n.data?.id === action.payload.data?.id),\n      )\n      if (existingIndex >= 0) {\n        return state\n      }\n      return {\n        ...state,\n        notifications: [\n          {\n            id: action.payload.id || Date.now().toString(),\n            ...action.payload,\n            read: action.payload.read || false,\n            timestamp: action.payload.timestamp || new Date().toISOString(),\n          },\n          ...state.notifications,\n        ],\n      }\n    }\n    case 'MARK_NOTIFICATION_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) =>\n          notif.id === action.payload.id ? { ...notif, read: true } : notif,\n        ),\n      }\n    case 'MARK_ALL_NOTIFICATIONS_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) => ({ ...notif, read: true })),\n      }\n    case 'SET_REALTIME_CONNECTED':\n      return {\n        ...state,\n        realtimeConnected: action.payload,\n      }\n    default:\n      return state\n  }\n}\n\nexport function AdminProvider({ children }) {\n  const [state, dispatch] = useReducer(reducer, initialState)\n\n  // Get toast functions from context (if available)\n  let showToast = (message, type) => {\n    // Fallback if toast is not available\n    console.log(`[${type.toUpperCase()}] ${message}`)\n  }\n\n  // Initialize real-time connection when authenticated\n  useEffect(() => {\n    if (state.authenticated && state.profile.id) {\n      const cleanup = initializeRealtimeConnection((notification) => {\n        handleRealtimeNotification(notification, dispatch, showToast)\n      })\n\n      dispatch({ type: 'SET_REALTIME_CONNECTED', payload: true })\n\n      return () => {\n        cleanup()\n        dispatch({ type: 'SET_REALTIME_CONNECTED', payload: false })\n      }\n    }\n  }, [state.authenticated, state.profile.id, dispatch])\n\n  const value = useMemo(() => state, [state])\n\n  return (\n    <AdminStateContext.Provider value={value}>\n      <AdminDispatchContext.Provider value={dispatch}>{children}</AdminDispatchContext.Provider>\n    </AdminStateContext.Provider>\n  )\n}\n\nexport function useAdminState() {\n  const context = useContext(AdminStateContext)\n  if (!context) throw new Error('useAdminState must be used within AdminProvider')\n  return context\n}\n\nexport function useAdminDispatch() {\n  const dispatch = useContext(AdminDispatchContext)\n  if (!dispatch) throw new Error('useAdminDispatch must be used within AdminProvider')\n  return dispatch\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\hooks\\useAdminApi.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'dispatch'. Either exclude it or remove the dependency array.","line":35,"column":5,"nodeType":"ArrayExpression","endLine":35,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[1107,1117],"text":"[]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'updateVendor' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":184,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":184,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Custom hook for Admin API integration\n * Provides easy access to API functions with loading states and error handling\n */\n\nimport { useState, useCallback } from 'react'\nimport { useAdminDispatch } from '../context/AdminContext'\nimport * as adminApi from '../services/adminApi'\n\nexport function useAdminApi() {\n  const dispatch = useAdminDispatch()\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  const callApi = useCallback(\n    async (apiFunction, ...args) => {\n      setLoading(true)\n      setError(null)\n      try {\n        const result = await apiFunction(...args)\n        if (result.success) {\n          return { success: true, data: result.data, error: null }\n        } else {\n          setError(result.error)\n          return { success: false, data: null, error: result.error }\n        }\n      } catch (err) {\n        const errorMsg = { message: err.message || 'An unexpected error occurred' }\n        setError(errorMsg)\n        return { success: false, data: null, error: errorMsg }\n      } finally {\n        setLoading(false)\n      }\n    },\n    [dispatch],\n  )\n\n  // Authentication APIs\n  const login = useCallback((credentials) => callApi(adminApi.loginAdmin, credentials), [callApi])\n\n  const logout = useCallback(() => callApi(adminApi.logoutAdmin), [callApi])\n\n  const fetchProfile = useCallback(() => callApi(adminApi.getAdminProfile), [callApi])\n\n  // Dashboard APIs\n  const fetchDashboardData = useCallback(\n    (params) => {\n      return callApi(adminApi.getDashboardData, params).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_DASHBOARD_DATA', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  // Product Management APIs\n  const getProducts = useCallback(\n    (params) => {\n      return callApi(adminApi.getProducts, params).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_PRODUCTS_DATA', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getProductDetails = useCallback((productId) => callApi(adminApi.getProductDetails, productId), [callApi])\n\n  const createProduct = useCallback(\n    (productData) => {\n      return callApi(adminApi.createProduct, productData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_PRODUCTS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const updateProduct = useCallback(\n    (productId, productData) => {\n      return callApi(adminApi.updateProduct, productId, productData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_PRODUCTS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const deleteProduct = useCallback(\n    (productId) => {\n      return callApi(adminApi.deleteProduct, productId).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_PRODUCTS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const assignProductToVendor = useCallback(\n    (productId, assignmentData) => {\n      return callApi(adminApi.assignProductToVendor, productId, assignmentData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_PRODUCTS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const toggleProductVisibility = useCallback(\n    (productId, visibilityData) => {\n      return callApi(adminApi.toggleProductVisibility, productId, visibilityData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_PRODUCTS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  // Vendor Management APIs\n  const getVendors = useCallback(\n    (params) => {\n      return callApi(adminApi.getVendors, params).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_VENDORS_DATA', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getVendorDetails = useCallback((vendorId) => callApi(adminApi.getVendorDetails, vendorId), [callApi])\n\n  const approveVendor = useCallback(\n    (vendorId, approvalData) => {\n      return callApi(adminApi.approveVendor, vendorId, approvalData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_VENDORS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const rejectVendor = useCallback(\n    (vendorId, rejectionData) => {\n      return callApi(adminApi.rejectVendor, vendorId, rejectionData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_VENDORS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const updateVendorCreditPolicy = useCallback(\n    (vendorId, policyData) => {\n      return callApi(adminApi.updateVendorCreditPolicy, vendorId, policyData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_VENDORS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const updateVendor = useCallback(\n    (vendorId, vendorData) => {\n      return callApi(adminApi.updateVendor, vendorId, vendorData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_VENDORS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const approveVendorPurchase = useCallback(\n    (requestId, shortDescription = '') => {\n      return callApi(adminApi.approveVendorPurchase, requestId, shortDescription).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n          dispatch({ type: 'SET_PRODUCTS_UPDATED', payload: true }) // Refresh products after stock update\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const rejectVendorPurchase = useCallback(\n    (requestId, rejectionData) => {\n      return callApi(adminApi.rejectVendorPurchase, requestId, rejectionData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const sendVendorPurchaseStock = useCallback(\n    (requestId, deliveryData) => {\n      return callApi(adminApi.sendVendorPurchaseStock, requestId, deliveryData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const confirmVendorPurchaseDelivery = useCallback(\n    (requestId, deliveryData) => {\n      return callApi(adminApi.confirmVendorPurchaseDelivery, requestId, deliveryData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n          dispatch({ type: 'SET_VENDORS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getVendorPurchaseRequests = useCallback((params) => callApi(adminApi.getVendorPurchaseRequests, params), [callApi])\n\n  const banVendor = useCallback(\n    (vendorId, banData) => {\n      return callApi(adminApi.banVendor, vendorId, banData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_VENDORS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const unbanVendor = useCallback(\n    (vendorId, unbanData) => {\n      return callApi(adminApi.unbanVendor, vendorId, unbanData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_VENDORS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const deleteVendor = useCallback(\n    (vendorId, deleteData) => {\n      return callApi(adminApi.deleteVendor, vendorId, deleteData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_VENDORS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  // Seller Management APIs\n  const getSellers = useCallback(\n    (params) => {\n      return callApi(adminApi.getSellers, params).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_DATA', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getSellerDetails = useCallback((sellerId) => callApi(adminApi.getSellerDetails, sellerId), [callApi])\n\n  const createSeller = useCallback(\n    (sellerData) => {\n      return callApi(adminApi.createSeller, sellerData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const updateSeller = useCallback(\n    (sellerId, sellerData) => {\n      return callApi(adminApi.updateSeller, sellerId, sellerData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const approveSeller = useCallback(\n    (sellerId) => {\n      return callApi(adminApi.approveSeller, sellerId).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const rejectSeller = useCallback(\n    (sellerId, rejectionData) => {\n      return callApi(adminApi.rejectSeller, sellerId, rejectionData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const deleteSeller = useCallback(\n    (sellerId) => {\n      return callApi(adminApi.deleteSeller, sellerId).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  // Vendor Withdrawal APIs\n  const getVendorWithdrawalRequests = useCallback((params) => callApi(adminApi.getVendorWithdrawalRequests, params), [callApi])\n\n  const createVendorWithdrawalPaymentIntent = useCallback(\n    (requestId, data) => {\n      return callApi(adminApi.createVendorWithdrawalPaymentIntent, requestId, data)\n    },\n    [callApi],\n  )\n\n  const approveVendorWithdrawal = useCallback(\n    (requestId, data) => {\n      return callApi(adminApi.approveVendorWithdrawal, requestId, data).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const rejectVendorWithdrawal = useCallback(\n    (requestId, rejectionData) => {\n      return callApi(adminApi.rejectVendorWithdrawal, requestId, rejectionData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const completeVendorWithdrawal = useCallback(\n    (requestId, completionData) => {\n      return callApi(adminApi.completeVendorWithdrawal, requestId, completionData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  // Seller Withdrawal APIs\n  const createSellerWithdrawalPaymentIntent = useCallback(\n    (requestId, data) => {\n      return callApi(adminApi.createSellerWithdrawalPaymentIntent, requestId, data)\n    },\n    [callApi],\n  )\n\n  const approveSellerWithdrawal = useCallback(\n    (requestId, data) => {\n      return callApi(adminApi.approveSellerWithdrawal, requestId, data).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const rejectSellerWithdrawal = useCallback(\n    (requestId, rejectionData) => {\n      return callApi(adminApi.rejectSellerWithdrawal, requestId, rejectionData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getSellerWithdrawalRequests = useCallback((params) => callApi(adminApi.getSellerWithdrawalRequests, params), [callApi])\n\n  // Seller Change Request APIs\n  const getSellerChangeRequests = useCallback(\n    (params) => {\n      return callApi(adminApi.getSellerChangeRequests, params).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getSellerChangeRequestDetails = useCallback((requestId) => callApi(adminApi.getSellerChangeRequestDetails, requestId), [callApi])\n\n  const approveSellerChangeRequest = useCallback(\n    (requestId) => {\n      return callApi(adminApi.approveSellerChangeRequest, requestId).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const rejectSellerChangeRequest = useCallback(\n    (requestId, rejectionData) => {\n      return callApi(adminApi.rejectSellerChangeRequest, requestId, rejectionData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  // Payment History APIs\n  const getPaymentHistory = useCallback((params) => callApi(adminApi.getPaymentHistory, params), [callApi])\n  const getPaymentHistoryStats = useCallback((params) => callApi(adminApi.getPaymentHistoryStats, params), [callApi])\n\n  // User Management APIs\n  const getUsers = useCallback(\n    (params) => {\n      return callApi(adminApi.getUsers, params).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_USERS_DATA', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getUserDetails = useCallback((userId) => callApi(adminApi.getUserDetails, userId), [callApi])\n\n  const blockUser = useCallback(\n    (userId, blockData) => {\n      return callApi(adminApi.blockUser, userId, blockData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_USERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const deactivateUser = useCallback(\n    (userId, deactivateData) => {\n      return callApi(adminApi.deactivateUser, userId, deactivateData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_USERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const activateUser = useCallback(\n    (userId) => {\n      return callApi(adminApi.activateUser, userId).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_USERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  // Order Management APIs\n  const getOrders = useCallback(\n    (params) => {\n      return callApi(adminApi.getOrders, params).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getOrderDetails = useCallback((orderId) => callApi(adminApi.getOrderDetails, orderId), [callApi])\n\n  const reassignOrder = useCallback(\n    (orderId, reassignData) => {\n      return callApi(adminApi.reassignOrder, orderId, reassignData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_ORDERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const generateInvoice = useCallback((orderId) => callApi(adminApi.generateInvoice, orderId), [callApi])\n\n  const getCommissions = useCallback(\n    (params) => {\n      return callApi(adminApi.getCommissions, params)\n    },\n    [callApi],\n  )\n\n  // Finance & Credit Management APIs\n  const getFinanceData = useCallback(\n    () => {\n      return callApi(adminApi.getFinanceData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_DATA', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getFinancialParameters = useCallback(() => callApi(adminApi.getFinancialParameters), [callApi])\n\n  const updateFinancialParameters = useCallback(\n    (parameters) => {\n      return callApi(adminApi.updateFinancialParameters, parameters).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getVendorCreditBalances = useCallback((params) => callApi(adminApi.getVendorCreditBalances, params), [callApi])\n\n  const applyPenalty = useCallback(\n    (vendorId) => {\n      return callApi(adminApi.applyPenalty, vendorId).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getOutstandingCredits = useCallback(() => callApi(adminApi.getOutstandingCredits), [callApi])\n\n  const getRecoveryStatus = useCallback(() => callApi(adminApi.getRecoveryStatus), [callApi])\n\n  const updateGlobalParameters = useCallback(\n    (parameters) => {\n      return callApi(adminApi.updateGlobalParameters, parameters).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const applyVendorPenalty = useCallback(\n    (vendorId, penaltyData) => {\n      return callApi(adminApi.applyVendorPenalty, vendorId, penaltyData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getVendorCreditHistory = useCallback((vendorId, params) => callApi(adminApi.getVendorCreditHistory, vendorId, params), [callApi])\n\n  // Credit Repayment APIs\n  const getRepayments = useCallback((params) => callApi(adminApi.getRepayments, params), [callApi])\n\n  const getRepaymentDetails = useCallback((repaymentId) => callApi(adminApi.getRepaymentDetails, repaymentId), [callApi])\n\n  const getVendorRepayments = useCallback((vendorId, params) => callApi(adminApi.getVendorRepayments, vendorId, params), [callApi])\n\n  // Operations & Controls APIs\n  const getLogisticsSettings = useCallback(() => callApi(adminApi.getLogisticsSettings), [callApi])\n\n  const updateLogisticsSettings = useCallback(\n    (settings) => {\n      return callApi(adminApi.updateLogisticsSettings, settings).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_ORDERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getEscalatedOrders = useCallback(() => callApi(adminApi.getEscalatedOrders), [callApi])\n\n  const fulfillOrderFromWarehouse = useCallback(\n    (orderId, fulfillmentData) => {\n      return callApi(adminApi.fulfillOrderFromWarehouse, orderId, fulfillmentData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_ORDERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const revertEscalation = useCallback(\n    (orderId, revertData) => {\n      return callApi(adminApi.revertEscalation, orderId, revertData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_ORDERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const updateOrderStatus = useCallback(\n    (orderId, statusData) => {\n      return callApi(adminApi.updateOrderStatus, orderId, statusData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_ORDERS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getNotifications = useCallback(() => callApi(adminApi.getNotifications), [callApi])\n\n  const createNotification = useCallback(\n    (notificationData) => {\n      return callApi(adminApi.createNotification, notificationData).then((result) => {\n        if (result.data) {\n          // Could dispatch a notification update action if needed\n        }\n        return result\n      })\n    },\n    [callApi],\n  )\n\n  const updateNotification = useCallback(\n    (notificationId, notificationData) => {\n      return callApi(adminApi.updateNotification, notificationId, notificationData).then((result) => {\n        if (result.data) {\n          // Could dispatch a notification update action if needed\n        }\n        return result\n      })\n    },\n    [callApi],\n  )\n\n  const deleteNotification = useCallback(\n    (notificationId) => {\n      return callApi(adminApi.deleteNotification, notificationId).then((result) => {\n        if (result.data) {\n          // Could dispatch a notification update action if needed\n        }\n        return result\n      })\n    },\n    [callApi],\n  )\n\n  // Analytics & Reports APIs\n  const getAnalyticsData = useCallback(\n    (params) => {\n      return callApi(adminApi.getAnalyticsData, params).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_ANALYTICS_DATA', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getSalesAnalytics = useCallback(\n    (params) => {\n      return callApi(adminApi.getSalesAnalytics, params)\n    },\n    [callApi],\n  )\n\n  const getUserAnalytics = useCallback(\n    (params) => {\n      return callApi(adminApi.getUserAnalytics, params)\n    },\n    [callApi],\n  )\n\n  const getVendorAnalytics = useCallback(\n    (params) => {\n      return callApi(adminApi.getVendorAnalytics, params)\n    },\n    [callApi],\n  )\n\n  const getOrderAnalytics = useCallback(\n    (params) => {\n      return callApi(adminApi.getOrderAnalytics, params)\n    },\n    [callApi],\n  )\n\n  const exportReports = useCallback((exportData) => callApi(adminApi.exportReports, exportData), [callApi])\n\n  // Review Management APIs\n  const getReviews = useCallback((params) => callApi(adminApi.getReviews, params), [callApi])\n\n  const getReviewDetails = useCallback((reviewId) => callApi(adminApi.getReviewDetails, reviewId), [callApi])\n\n  const respondToReview = useCallback(\n    (reviewId, data) => {\n      return callApi(adminApi.respondToReview, reviewId, data).then((result) => {\n        if (result.data) {\n          // Could dispatch a review update action if needed\n        }\n        return result\n      })\n    },\n    [callApi],\n  )\n\n  const updateReviewResponse = useCallback(\n    (reviewId, data) => {\n      return callApi(adminApi.updateReviewResponse, reviewId, data).then((result) => {\n        if (result.data) {\n          // Could dispatch a review update action if needed\n        }\n        return result\n      })\n    },\n    [callApi],\n  )\n\n  const deleteReviewResponse = useCallback(\n    (reviewId) => {\n      return callApi(adminApi.deleteReviewResponse, reviewId).then((result) => {\n        if (result.data) {\n          // Could dispatch a review update action if needed\n        }\n        return result\n      })\n    },\n    [callApi],\n  )\n\n  const moderateReview = useCallback(\n    (reviewId, data) => {\n      return callApi(adminApi.moderateReview, reviewId, data).then((result) => {\n        if (result.data) {\n          // Could dispatch a review update action if needed\n        }\n        return result\n      })\n    },\n    [callApi],\n  )\n\n  const deleteReview = useCallback(\n    (reviewId) => {\n      return callApi(adminApi.deleteReview, reviewId).then((result) => {\n        if (result.data) {\n          // Could dispatch a review update action if needed\n        }\n        return result\n      })\n    },\n    [callApi],\n  )\n\n  // Task Management APIs\n  const fetchTasks = useCallback(\n    (params) => {\n      return callApi(adminApi.getAdminTasks, params).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'SET_TASKS_DATA', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const markTaskViewed = useCallback(\n    (taskId) => {\n      return callApi(adminApi.markTaskAsViewed, taskId).then((result) => {\n        if (result.success) {\n          dispatch({ type: 'SET_TASKS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const markTaskCompleted = useCallback(\n    (taskId) => {\n      return callApi(adminApi.markTaskAsCompleted, taskId).then((result) => {\n        if (result.success) {\n          dispatch({ type: 'SET_TASKS_UPDATED', payload: true })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  return {\n    loading,\n    error,\n    // Authentication\n    login,\n    logout,\n    fetchProfile,\n    // Dashboard\n    fetchDashboardData,\n    // Products\n    getProducts,\n    getProductDetails,\n    createProduct,\n    updateProduct,\n    deleteProduct,\n    assignProductToVendor,\n    toggleProductVisibility,\n    // Vendors\n    getVendors,\n    getVendorDetails,\n    approveVendor,\n    rejectVendor,\n    updateVendorCreditPolicy,\n    approveVendorPurchase,\n    rejectVendorPurchase,\n    sendVendorPurchaseStock,\n    confirmVendorPurchaseDelivery,\n    getVendorPurchaseRequests,\n    banVendor,\n    unbanVendor,\n    deleteVendor,\n    // Sellers\n    getSellers,\n    getSellerDetails,\n    createSeller,\n    updateSeller,\n    approveSeller,\n    rejectSeller,\n    deleteSeller,\n    getVendorWithdrawalRequests,\n    createVendorWithdrawalPaymentIntent,\n    approveVendorWithdrawal,\n    rejectVendorWithdrawal,\n    completeVendorWithdrawal,\n    createSellerWithdrawalPaymentIntent,\n    approveSellerWithdrawal,\n    rejectSellerWithdrawal,\n    getSellerWithdrawalRequests,\n    getSellerChangeRequests,\n    getSellerChangeRequestDetails,\n    approveSellerChangeRequest,\n    rejectSellerChangeRequest,\n    getPaymentHistory,\n    getPaymentHistoryStats,\n    // Users\n    getUsers,\n    getUserDetails,\n    blockUser,\n    deactivateUser,\n    activateUser,\n    // Orders\n    getOrders,\n    getOrderDetails,\n    reassignOrder,\n    generateInvoice,\n    getCommissions,\n    // Finance\n    getFinanceData,\n    getFinancialParameters,\n    updateFinancialParameters,\n    getVendorCreditBalances,\n    applyPenalty,\n    getOutstandingCredits,\n    getRecoveryStatus,\n    updateGlobalParameters,\n    applyVendorPenalty,\n    getVendorCreditHistory,\n    // Credit Repayments\n    getRepayments,\n    getRepaymentDetails,\n    getVendorRepayments,\n    // Operations\n    getLogisticsSettings,\n    updateLogisticsSettings,\n    getEscalatedOrders,\n    fulfillOrderFromWarehouse,\n    revertEscalation,\n    updateOrderStatus,\n    getNotifications,\n    createNotification,\n    updateNotification,\n    deleteNotification,\n    // Analytics\n    getAnalyticsData,\n    getSalesAnalytics,\n    getUserAnalytics,\n    getVendorAnalytics,\n    getOrderAnalytics,\n    exportReports,\n    // Reviews\n    getReviews,\n    getReviewDetails,\n    respondToReview,\n    updateReviewResponse,\n    deleteReviewResponse,\n    moderateReview,\n    deleteReview,\n    // Tasks\n    fetchTasks,\n    markTaskViewed,\n    markTaskCompleted,\n  }\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\AdminLogin.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":87,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":87,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\nimport { useAdminDispatch } from '../context/AdminContext'\nimport * as adminApi from '../services/adminApi'\nimport iraSathiLogo from '../../../assets/IRA Sathi.png'\n\nexport function AdminLogin({ onSubmit }) {\n  const dispatch = useAdminDispatch()\n  const [step, setStep] = useState('credentials') // 'credentials' | 'otp'\n  const [form, setForm] = useState({ phone: '' })\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setForm((prev) => ({ ...prev, [name]: value }))\n    setError(null)\n  }\n\n  const handleSubmitCredentials = async (e) => {\n    e.preventDefault()\n    setError(null)\n    setLoading(true)\n\n    try {\n      if (!form.phone.trim()) {\n        setError('Phone number is required')\n        setLoading(false)\n        return\n      }\n\n      // Step 1: Login with phone (triggers OTP)\n      const result = await adminApi.loginAdmin({ phone: form.phone })\n\n      if (result.success || result.data) {\n        // Request OTP to phone\n        await adminApi.requestAdminOTP({ phone: form.phone })\n        setStep('otp')\n      } else {\n        setError(result.error?.message || 'Invalid credentials. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Login failed. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleVerifyOtp = async (otpCode) => {\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Step 2: Verify OTP and complete login\n      const result = await adminApi.verifyAdminOTP({ phone: form.phone, otp: otpCode })\n\n      if (result.success || result.data) {\n        // Store token\n        if (result.data?.token) {\n          localStorage.setItem('admin_token', result.data.token)\n        }\n        // Update context with admin profile\n        dispatch({\n          type: 'AUTH_LOGIN',\n          payload: {\n            id: result.data.admin.id,\n            name: result.data.admin.name,\n            phone: result.data.admin.phone,\n            role: result.data.admin.role,\n          },\n        })\n        onSubmit?.(result.data.admin)\n      } else {\n        setError(result.error?.message || 'Invalid OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Verification failed. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleResendOtp = async () => {\n    setLoading(true)\n    try {\n      await adminApi.requestAdminOTP({ phone: form.phone })\n    } catch (err) {\n      setError('Failed to resend OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (step === 'otp') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-gray-50 via-white to-gray-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"rounded-3xl border border-gray-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <OtpVerification\n              phone={form.phone}\n              onVerify={handleVerifyOtp}\n              onResend={handleResendOtp}\n              onBack={() => setStep('credentials')}\n              loading={loading}\n              error={error}\n              userType=\"admin\"\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-gray-50 via-white to-gray-50 px-6 py-12\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-white mb-4 overflow-hidden border border-gray-200\">\n            <img src={iraSathiLogo} alt=\"IRA Sathi\" className=\"h-full w-full object-contain p-2\" />\n          </div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-600 font-semibold\">Admin Access</p>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Sign in to IRA Sathi</h1>\n          <p className=\"text-sm text-gray-600\">Enter your phone number to access admin dashboard</p>\n        </div>\n\n        <div className=\"rounded-3xl border border-gray-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n          <form onSubmit={handleSubmitCredentials} className=\"space-y-5\">\n            {error && (\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\n                <p className=\"text-sm text-red-600\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"admin-phone\" className=\"text-xs font-semibold text-gray-700\">\n                Contact Number <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"admin-phone\"\n                name=\"phone\"\n                type=\"tel\"\n                required\n                value={form.phone}\n                onChange={handleChange}\n                placeholder=\"8878495502\"\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500/20 transition-all\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full rounded-full bg-gradient-to-r from-gray-700 to-gray-800 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? 'Verifying...' : 'Continue'}\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Analytics.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[446,482],"text":""},"desc":"Remove unused variable 'cn'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setPeriod' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":27,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"setPeriod"},"fix":{"range":[1180,1191],"text":""},"desc":"Remove unused variable 'setPeriod'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'regionWise' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":133,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":133,"endColumn":21}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\nimport { ArrowUpRight, BarChart3, Download, PieChart, ArrowLeft, TrendingUp, Users, Building2, Package, Loader2 } from 'lucide-react'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { FilterBar } from '../components/FilterBar'\nimport { Timeline } from '../components/Timeline'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { cn } from '../../../lib/cn'\n\n// Format currency helper\nfunction formatCurrency(amount) {\n  if (amount >= 10000000) return `â‚¹${(amount / 10000000).toFixed(1)} Cr`\n  if (amount >= 100000) return `â‚¹${(amount / 100000).toFixed(1)} L`\n  if (amount >= 1000) return `â‚¹${(amount / 1000).toFixed(1)}K`\n  return `â‚¹${Math.round(amount).toLocaleString('en-IN')}`\n}\n\n// Format number helper\nfunction formatNumber(num) {\n  return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\n}\n\nexport function AnalyticsPage({ subRoute = null, navigate }) {\n  const { getAnalyticsData, getSalesAnalytics, getUserAnalytics, getVendorAnalytics, getOrderAnalytics, loading } = useAdminApi()\n  const { error: showError } = useToast()\n  \n  const [period, setPeriod] = useState(30)\n  const [analyticsData, setAnalyticsData] = useState(null)\n  const [salesData, setSalesData] = useState(null)\n  const [userData, setUserData] = useState(null)\n  const [vendorData, setVendorData] = useState(null)\n  const [orderData, setOrderData] = useState(null)\n\n  // Fetch analytics overview data\n  useEffect(() => {\n    if (!subRoute) {\n      const fetchData = async () => {\n        try {\n          const result = await getAnalyticsData({ period })\n          if (result.data) {\n            setAnalyticsData(result.data)\n          } else if (result.error) {\n            showError(result.error.message || 'Failed to load analytics data', 5000)\n          }\n        } catch (error) {\n          showError(error.message || 'Failed to load analytics data', 5000)\n        }\n      }\n      fetchData()\n    }\n  }, [subRoute, period, getAnalyticsData, showError])\n\n  // Fetch sales analytics data\n  useEffect(() => {\n    if (subRoute === 'sales') {\n      const fetchData = async () => {\n        try {\n          const result = await getSalesAnalytics({ period })\n          if (result.data) {\n            setSalesData(result.data)\n          } else if (result.error) {\n            showError(result.error.message || 'Failed to load sales analytics', 5000)\n          }\n        } catch (error) {\n          showError(error.message || 'Failed to load sales analytics', 5000)\n        }\n      }\n      fetchData()\n    }\n  }, [subRoute, period, getSalesAnalytics, showError])\n\n  // Fetch user analytics data\n  useEffect(() => {\n    if (subRoute === 'users') {\n      const fetchData = async () => {\n        try {\n          const result = await getUserAnalytics({ period })\n          if (result.data) {\n            setUserData(result.data)\n          } else if (result.error) {\n            showError(result.error.message || 'Failed to load user analytics', 5000)\n          }\n        } catch (error) {\n          showError(error.message || 'Failed to load user analytics', 5000)\n        }\n      }\n      fetchData()\n    }\n  }, [subRoute, period, getUserAnalytics, showError])\n\n  // Fetch vendor analytics data\n  useEffect(() => {\n    if (subRoute === 'vendors') {\n      const fetchData = async () => {\n        try {\n          const result = await getVendorAnalytics({ period })\n          if (result.data) {\n            setVendorData(result.data)\n          } else if (result.error) {\n            showError(result.error.message || 'Failed to load vendor analytics', 5000)\n          }\n        } catch (error) {\n          showError(error.message || 'Failed to load vendor analytics', 5000)\n        }\n      }\n      fetchData()\n    }\n  }, [subRoute, period, getVendorAnalytics, showError])\n\n  // Fetch order analytics data\n  useEffect(() => {\n    if (subRoute === 'orders') {\n      const fetchData = async () => {\n        try {\n          const result = await getOrderAnalytics({ period })\n          if (result.data) {\n            setOrderData(result.data)\n          } else if (result.error) {\n            showError(result.error.message || 'Failed to load order analytics', 5000)\n          }\n        } catch (error) {\n          showError(error.message || 'Failed to load order analytics', 5000)\n        }\n      }\n      fetchData()\n    }\n  }, [subRoute, period, getOrderAnalytics, showError])\n\n  // Show Overview (default when subRoute is null)\n  if (!subRoute) {\n    const highlights = analyticsData?.highlights || []\n    const timeline = analyticsData?.timeline || []\n    const regionWise = analyticsData?.regionWise || []\n\n    return (\n      <div className=\"space-y-6\">\n        <header className=\"flex flex-wrap items-center justify-between gap-4\">\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 8 â€¢ Reporting & Analytics</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Insights & Export Hub</h2>\n            <p className=\"text-sm text-gray-600\">\n              Slice daily, weekly, and monthly performance metrics with export-ready reports.\n            </p>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <button className=\"inline-flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm text-gray-700 font-semibold shadow-[0_2px_8px_rgba(0,0,0,0.05),inset_0_1px_0_rgba(255,255,255,0.8)] transition hover:border-indigo-300 hover:bg-indigo-50 hover:text-indigo-700 hover:shadow-[0_4px_12px_rgba(0,0,0,0.1),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n              <PieChart className=\"h-4 w-4\" />\n              Custom Cohort\n            </button>\n            <button className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-indigo-500 to-indigo-600 px-4 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(99,102,241,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all duration-200 hover:shadow-[0_6px_20px_rgba(99,102,241,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] hover:scale-105 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.2)]\">\n              <Download className=\"h-4 w-4\" />\n              Export Excel / PDF\n            </button>\n          </div>\n        </header>\n\n        <FilterBar\n          filters={[\n            { id: 'period', label: `Last ${period} days`, active: true },\n            { id: 'region', label: 'All regions' },\n            { id: 'vendor', label: 'Top vendors' },\n            { id: 'seller', label: 'Top sellers' },\n          ]}\n        />\n\n        {loading && !analyticsData ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-indigo-600\" />\n          </div>\n        ) : (\n          <>\n            <section className=\"grid gap-6 lg:grid-cols-3\">\n              {highlights.length > 0 ? (\n                highlights.map((item, index) => {\n                  const colors = [\n                    { border: 'border-blue-200', bg: 'bg-gradient-to-br from-blue-50 to-blue-100/50', text: 'text-blue-700' },\n                    { border: 'border-purple-200', bg: 'bg-gradient-to-br from-purple-50 to-purple-100/50', text: 'text-purple-700' },\n                    { border: 'border-green-200', bg: 'bg-gradient-to-br from-green-50 to-green-100/50', text: 'text-green-700' },\n                    { border: 'border-yellow-200', bg: 'bg-gradient-to-br from-yellow-50 to-yellow-100/50', text: 'text-yellow-700' },\n                  ]\n                  const color = colors[index % colors.length]\n                  return (\n                    <div key={item.label || index} className={`rounded-3xl border ${color.border} ${color.bg} p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]`}>\n                      <div className=\"flex items-start justify-between\">\n                        <div>\n                          <p className={`text-xs uppercase tracking-wide ${color.text} font-bold`}>{item.label}</p>\n                          <p className=\"mt-3 text-2xl font-bold text-gray-900\">{item.value}</p>\n                          {item.change && (\n                            <StatusBadge tone=\"success\" className=\"mt-3\">{item.change}</StatusBadge>\n                          )}\n                        </div>\n                        <ArrowUpRight className={`h-5 w-5 ${color.text}`} />\n                      </div>\n                      <p className=\"mt-4 text-xs text-gray-600\">\n                        Quick snapshot across the last {period} days with contextual insights layered for the admin.\n                      </p>\n                    </div>\n                  )\n                })\n              ) : (\n                <div className=\"lg:col-span-3 rounded-3xl border border-gray-200 bg-white p-6 text-center text-gray-500\">\n                  No analytics data available for the selected period.\n                </div>\n              )}\n            </section>\n\n            <section className=\"grid gap-6 lg:grid-cols-2\">\n              <Timeline events={timeline.length > 0 ? timeline : [{\n                id: 'no-events',\n                title: 'No recent events',\n                timestamp: new Date().toLocaleString('en-IN'),\n                description: 'No timeline events available.',\n                status: 'completed',\n              }]} />\n              <div className=\"space-y-4 rounded-3xl border border-indigo-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <div className=\"flex items-center gap-3\">\n                  <BarChart3 className=\"h-5 w-5 text-indigo-600\" />\n                  <div>\n                    <h3 className=\"text-lg font-bold text-indigo-700\">Top Products</h3>\n                    <p className=\"text-sm text-gray-600\">Best performing products by revenue.</p>\n                  </div>\n                </div>\n                {analyticsData?.topProducts && analyticsData.topProducts.length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {analyticsData.topProducts.slice(0, 4).map((product, index) => {\n                      const colorMap = [\n                        'border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/50',\n                        'border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100/50',\n                        'border-green-200 bg-gradient-to-br from-green-50 to-green-100/50',\n                        'border-yellow-200 bg-gradient-to-br from-yellow-50 to-yellow-100/50',\n                      ]\n                      return (\n                        <div key={product.productId || index} className={`rounded-2xl border ${colorMap[index % colorMap.length]} p-4`}>\n                          <div className=\"flex items-center justify-between text-sm font-bold text-gray-900\">\n                            <span>{product.productName || 'Unknown Product'}</span>\n                            <span>{formatCurrency(product.totalRevenue || 0)}</span>\n                          </div>\n                          <p className=\"mt-2 text-xs text-gray-600\">\n                            {formatNumber(product.totalQuantity || 0)} {product.category || 'units'} sold â€¢ {product.orderCount || 0} orders\n                          </p>\n                        </div>\n                      )\n                    })}\n                  </div>\n                ) : (\n                  <p className=\"text-sm text-gray-500 text-center py-4\">No product data available</p>\n                )}\n              </div>\n            </section>\n          </>\n        )}\n      </div>\n    )\n  }\n\n  // Show Sales Analytics\n  if (subRoute === 'sales') {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={() => navigate('analytics')}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Analytics\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 8 â€¢ Reporting & Analytics</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Sales Analytics</h2>\n            <p className=\"text-sm text-gray-600\">\n              Comprehensive sales performance metrics and revenue insights.\n            </p>\n          </div>\n        </div>\n\n        {loading && !salesData ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-indigo-600\" />\n          </div>\n        ) : salesData ? (\n          <div className=\"space-y-6\">\n            {/* Summary Cards */}\n            <section className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-4\">\n              <div className=\"rounded-3xl border border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-blue-700 font-bold\">Total Revenue</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatCurrency(salesData.summary?.totalRevenue || 0)}</p>\n                <p className=\"mt-1 text-xs text-blue-600\">Last {period} days</p>\n              </div>\n              <div className=\"rounded-3xl border border-green-200 bg-gradient-to-br from-green-50 to-green-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-green-700 font-bold\">Total Orders</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatNumber(salesData.summary?.totalOrders || 0)}</p>\n                <p className=\"mt-1 text-xs text-green-600\">{salesData.summary?.deliveredOrders || 0} delivered</p>\n              </div>\n              <div className=\"rounded-3xl border border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-purple-700 font-bold\">Avg Order Value</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatCurrency(salesData.summary?.averageOrderValue || 0)}</p>\n                <p className=\"mt-1 text-xs text-purple-600\">Per order</p>\n              </div>\n              <div className=\"rounded-3xl border border-yellow-200 bg-gradient-to-br from-yellow-50 to-yellow-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-yellow-700 font-bold\">Fulfillment Rate</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{Math.round(salesData.summary?.fulfillmentRate || 0)}%</p>\n                <p className=\"mt-1 text-xs text-yellow-600\">{salesData.summary?.cancelledOrders || 0} cancelled</p>\n              </div>\n            </section>\n\n            {/* Top Products */}\n            {salesData.topProducts && salesData.topProducts.length > 0 && (\n              <div className=\"rounded-3xl border border-indigo-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <TrendingUp className=\"h-5 w-5 text-indigo-600\" />\n                  <h3 className=\"text-lg font-bold text-indigo-700\">Top Products by Revenue</h3>\n                </div>\n                <div className=\"space-y-3\">\n                  {salesData.topProducts.slice(0, 10).map((product, index) => (\n                    <div key={product.id || index} className=\"flex items-center justify-between p-3 rounded-xl border border-gray-200 bg-gray-50\">\n                      <div>\n                        <p className=\"font-semibold text-gray-900\">{product.name}</p>\n                        <p className=\"text-xs text-gray-600\">{product.category} â€¢ {formatNumber(product.quantity)} units â€¢ {product.orderCount} orders</p>\n                      </div>\n                      <p className=\"font-bold text-indigo-700\">{formatCurrency(product.revenue)}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"rounded-3xl border border-indigo-200 bg-white p-6 text-center text-gray-500\">\n            No sales data available for the selected period.\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Show User Analytics\n  if (subRoute === 'users') {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={() => navigate('analytics')}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Analytics\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 8 â€¢ Reporting & Analytics</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">User Analytics</h2>\n            <p className=\"text-sm text-gray-600\">\n              User engagement, growth, and behavior analytics.\n            </p>\n          </div>\n        </div>\n\n        {loading && !userData ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-indigo-600\" />\n          </div>\n        ) : userData ? (\n          <div className=\"space-y-6\">\n            {/* Summary Cards */}\n            <section className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-4\">\n              <div className=\"rounded-3xl border border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-blue-700 font-bold\">Total Users</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatNumber(userData.summary?.totalUsers || 0)}</p>\n                <p className=\"mt-1 text-xs text-blue-600\">{userData.summary?.activeUsers || 0} active</p>\n              </div>\n              <div className=\"rounded-3xl border border-green-200 bg-gradient-to-br from-green-50 to-green-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-green-700 font-bold\">New Users</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatNumber(userData.summary?.newUsersInPeriod || 0)}</p>\n                <p className=\"mt-1 text-xs text-green-600\">Last {period} days</p>\n              </div>\n              <div className=\"rounded-3xl border border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-purple-700 font-bold\">Active Users</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatNumber(userData.summary?.activeUsersInPeriod || 0)}</p>\n                <p className=\"mt-1 text-xs text-purple-600\">With orders in period</p>\n              </div>\n              <div className=\"rounded-3xl border border-yellow-200 bg-gradient-to-br from-yellow-50 to-yellow-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-yellow-700 font-bold\">Avg Orders/User</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{userData.summary?.averageOrdersPerUser?.toFixed(1) || '0.0'}</p>\n                <p className=\"mt-1 text-xs text-yellow-600\">{userData.summary?.usersWithSellerId || 0} with seller ID</p>\n              </div>\n            </section>\n\n            {/* Users by State */}\n            {userData.usersByState && userData.usersByState.length > 0 && (\n              <div className=\"rounded-3xl border border-indigo-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <Users className=\"h-5 w-5 text-indigo-600\" />\n                  <h3 className=\"text-lg font-bold text-indigo-700\">User Distribution by State</h3>\n                </div>\n                <div className=\"grid gap-3 sm:grid-cols-2 lg:grid-cols-3\">\n                  {userData.usersByState.map((item, index) => {\n                    const colorMap = [\n                      'border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/50',\n                      'border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100/50',\n                      'border-green-200 bg-gradient-to-br from-green-50 to-green-100/50',\n                      'border-yellow-200 bg-gradient-to-br from-yellow-50 to-yellow-100/50',\n                      'border-orange-200 bg-gradient-to-br from-orange-50 to-orange-100/50',\n                    ]\n                    return (\n                      <div key={item.state || index} className={`rounded-2xl border ${colorMap[index % colorMap.length]} p-4`}>\n                        <div className=\"flex items-center justify-between text-sm font-bold text-gray-900\">\n                          <span>{item.state}</span>\n                          <span>{formatNumber(item.count)}</span>\n                        </div>\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"rounded-3xl border border-indigo-200 bg-white p-6 text-center text-gray-500\">\n            No user data available for the selected period.\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Show Vendor Analytics\n  if (subRoute === 'vendors') {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={() => navigate('analytics')}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Analytics\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 8 â€¢ Reporting & Analytics</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Vendor Analytics</h2>\n            <p className=\"text-sm text-gray-600\">\n              Vendor performance, order fulfillment, and revenue metrics.\n            </p>\n          </div>\n        </div>\n\n        {loading && !vendorData ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-indigo-600\" />\n          </div>\n        ) : vendorData ? (\n          <div className=\"space-y-6\">\n            {/* Summary Cards */}\n            <section className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-4\">\n              <div className=\"rounded-3xl border border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-blue-700 font-bold\">Total Vendors</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatNumber(vendorData.summary?.totalVendors || 0)}</p>\n                <p className=\"mt-1 text-xs text-blue-600\">{vendorData.summary?.approvedVendors || 0} approved</p>\n              </div>\n              <div className=\"rounded-3xl border border-green-200 bg-gradient-to-br from-green-50 to-green-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-green-700 font-bold\">Total Revenue</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatCurrency(vendorData.summary?.totalVendorRevenue || 0)}</p>\n                <p className=\"mt-1 text-xs text-green-600\">Last {period} days</p>\n              </div>\n              <div className=\"rounded-3xl border border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-purple-700 font-bold\">Credit Utilization</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{vendorData.summary?.creditUtilization?.toFixed(1) || '0.0'}%</p>\n                <p className=\"mt-1 text-xs text-purple-600\">{formatCurrency(vendorData.summary?.totalCreditUsed || 0)} / {formatCurrency(vendorData.summary?.totalCreditLimit || 0)}</p>\n              </div>\n              <div className=\"rounded-3xl border border-yellow-200 bg-gradient-to-br from-yellow-50 to-yellow-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-yellow-700 font-bold\">Escalations</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatNumber(vendorData.summary?.totalEscalations || 0)}</p>\n                <p className=\"mt-1 text-xs text-yellow-600\">{vendorData.summary?.vendorsWithEscalations || 0} vendors</p>\n              </div>\n            </section>\n\n            {/* Top Vendors */}\n            {vendorData.topVendors && vendorData.topVendors.length > 0 && (\n              <div className=\"rounded-3xl border border-indigo-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <Building2 className=\"h-5 w-5 text-indigo-600\" />\n                  <h3 className=\"text-lg font-bold text-indigo-700\">Top Vendors by Revenue</h3>\n                </div>\n                <div className=\"space-y-3\">\n                  {vendorData.topVendors.slice(0, 10).map((vendor, index) => (\n                    <div key={vendor.id || index} className=\"flex items-center justify-between p-3 rounded-xl border border-gray-200 bg-gray-50\">\n                      <div>\n                        <p className=\"font-semibold text-gray-900\">{vendor.name}</p>\n                        <p className=\"text-xs text-gray-600\">{vendor.orderCount || 0} orders</p>\n                      </div>\n                      <p className=\"font-bold text-indigo-700\">{formatCurrency(vendor.revenue)}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"rounded-3xl border border-indigo-200 bg-white p-6 text-center text-gray-500\">\n            No vendor data available for the selected period.\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Show Order Analytics\n  if (subRoute === 'orders') {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={() => navigate('analytics')}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Analytics\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 8 â€¢ Reporting & Analytics</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Order Analytics</h2>\n            <p className=\"text-sm text-gray-600\">\n              Order trends, fulfillment rates, and delivery performance.\n            </p>\n          </div>\n        </div>\n\n        {loading && !orderData ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-indigo-600\" />\n          </div>\n        ) : orderData ? (\n          <div className=\"space-y-6\">\n            {/* Summary Cards */}\n            <section className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-4\">\n              <div className=\"rounded-3xl border border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-blue-700 font-bold\">Total Orders</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatNumber(orderData.summary?.totalOrders || 0)}</p>\n                <p className=\"mt-1 text-xs text-blue-600\">{orderData.summary?.ordersInPeriod || 0} in period</p>\n              </div>\n              <div className=\"rounded-3xl border border-green-200 bg-gradient-to-br from-green-50 to-green-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-green-700 font-bold\">Delivered</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatNumber(orderData.summary?.deliveredOrders || 0)}</p>\n                <p className=\"mt-1 text-xs text-green-600\">{Math.round(orderData.summary?.fulfillmentRate || 0)}% fulfillment rate</p>\n              </div>\n              <div className=\"rounded-3xl border border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-purple-700 font-bold\">Avg Order Value</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatCurrency(orderData.summary?.averageOrderValue || 0)}</p>\n                <p className=\"mt-1 text-xs text-purple-600\">Per order</p>\n              </div>\n              <div className=\"rounded-3xl border border-yellow-200 bg-gradient-to-br from-yellow-50 to-yellow-100/50 p-6\">\n                <p className=\"text-xs uppercase tracking-wide text-yellow-700 font-bold\">Escalated</p>\n                <p className=\"mt-2 text-2xl font-bold text-gray-900\">{formatNumber(orderData.summary?.escalatedOrders || 0)}</p>\n                <p className=\"mt-1 text-xs text-yellow-600\">{orderData.summary?.cancelledOrders || 0} cancelled</p>\n              </div>\n            </section>\n\n            {/* Status Breakdown */}\n            {orderData.statusBreakdown && orderData.statusBreakdown.length > 0 && (\n              <div className=\"rounded-3xl border border-indigo-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <Package className=\"h-5 w-5 text-indigo-600\" />\n                  <h3 className=\"text-lg font-bold text-indigo-700\">Order Status Breakdown</h3>\n                </div>\n                <div className=\"grid gap-3 sm:grid-cols-2 lg:grid-cols-3\">\n                  {orderData.statusBreakdown.map((item, index) => {\n                    const colorMap = [\n                      'border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/50',\n                      'border-purple-200 bg-gradient-to-br from-purple-50 to-purple-100/50',\n                      'border-green-200 bg-gradient-to-br from-green-50 to-green-100/50',\n                      'border-yellow-200 bg-gradient-to-br from-yellow-50 to-yellow-100/50',\n                    ]\n                    return (\n                      <div key={item.status || index} className={`rounded-2xl border ${colorMap[index % colorMap.length]} p-4`}>\n                        <div className=\"flex items-center justify-between text-sm font-bold text-gray-900\">\n                          <span className=\"capitalize\">{item.status?.replace('_', ' ') || 'Unknown'}</span>\n                          <span>{formatNumber(item.count)}</span>\n                        </div>\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"rounded-3xl border border-indigo-200 bg-white p-6 text-center text-gray-500\">\n            No order data available for the selected period.\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Default fallback\n  return null\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Dashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Finance.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'applyVendorPenalty' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":34,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"applyVendorPenalty"},"fix":{"range":[1546,1570],"text":""},"desc":"Remove unused variable 'applyVendorPenalty'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getVendors' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":37,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"getVendors"},"fix":{"range":[1620,1636],"text":""},"desc":"Remove unused variable 'getVendors'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getVendorCreditHistory' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":43,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"getVendorCreditHistory"},"fix":{"range":[1784,1812],"text":""},"desc":"Remove unused variable 'getVendorCreditHistory'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'purchaseRequestsLoading' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":54,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"purchaseRequestsLoading"},"fix":{"range":[2272,2295],"text":""},"desc":"Remove unused variable 'purchaseRequestsLoading'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\nimport { BadgeIndianRupee, Sparkles, Building2, Eye, AlertCircle, Package, CheckCircle, XCircle, ArrowLeft, Calendar } from 'lucide-react'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { ProgressList } from '../components/ProgressList'\nimport { Timeline } from '../components/Timeline'\nimport { OutstandingCreditsView } from '../components/OutstandingCreditsView'\nimport { RecoveryStatusView } from '../components/RecoveryStatusView'\nimport { DataTable } from '../components/DataTable'\nimport { FinancialParametersForm } from '../components/FinancialParametersForm'\nimport { PenaltiesPage } from './Penalties'\nimport { useAdminState } from '../context/AdminContext'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { finance as mockFinance } from '../services/adminData'\nimport { cn } from '../../../lib/cn'\n\nconst vendorColumns = [\n  { Header: 'Vendor', accessor: 'name' },\n  { Header: 'Credit Limit', accessor: 'creditLimit' },\n  { Header: 'Used Credit', accessor: 'usedCredit' },\n  { Header: 'Overdue', accessor: 'overdue' },\n  { Header: 'Penalty', accessor: 'penalty' },\n  { Header: 'Status', accessor: 'status' },\n  { Header: 'Actions', accessor: 'actions' },\n]\n\nexport function FinancePage({ subRoute = null, navigate }) {\n  const { finance: financeState, vendors } = useAdminState()\n  const {\n    getVendorCreditBalances,\n    getFinancialParameters,\n    updateFinancialParameters,\n    applyPenalty,\n    applyVendorPenalty,\n    getOutstandingCredits,\n    getRecoveryStatus,\n    getVendors,\n    getVendorPurchaseRequests,\n    approveVendorPurchase,\n    rejectVendorPurchase,\n    sendVendorPurchaseStock,\n    confirmVendorPurchaseDelivery,\n    getVendorCreditHistory,\n    getVendorRepayments,\n    loading,\n  } = useAdminApi()\n  const { success, error: showError, warning: showWarning } = useToast()\n\n  const [vendorCredits, setVendorCredits] = useState([])\n  const [financialParameters, setFinancialParameters] = useState(null)\n  const [outstandingCredits, setOutstandingCredits] = useState([])\n  const [recoveryStatus, setRecoveryStatus] = useState([])\n  const [purchaseRequests, setPurchaseRequests] = useState([])\n  const [purchaseRequestsLoading, setPurchaseRequestsLoading] = useState(false)\n\n  // View states (replacing modals with full-screen views)\n  const [currentView, setCurrentView] = useState(null) // 'parameters', 'creditBalance', 'purchaseRequest'\n  const [selectedVendorForCredit, setSelectedVendorForCredit] = useState(null)\n  const [selectedVendorCreditData, setSelectedVendorCreditData] = useState(null)\n  const [selectedPurchaseRequest, setSelectedPurchaseRequest] = useState(null)\n  const [selectedVendorRepayments, setSelectedVendorRepayments] = useState([])\n  const [repaymentsLoading, setRepaymentsLoading] = useState(false)\n  const [approvingPurchase, setApprovingPurchase] = useState(false)\n  const [purchaseRejectReasonState, setPurchaseRejectReasonState] = useState('')\n\n  // Fetch purchase requests\n  const fetchPurchaseRequests = useCallback(async () => {\n    setPurchaseRequestsLoading(true)\n    try {\n      const result = await getVendorPurchaseRequests({ status: 'pending', limit: 50 })\n      if (result.data?.purchases) {\n        setPurchaseRequests(result.data.purchases)\n      }\n    } catch (error) {\n      console.error('Failed to fetch purchase requests:', error)\n    } finally {\n      setPurchaseRequestsLoading(false)\n    }\n  }, [getVendorPurchaseRequests])\n\n  // Fetch data\n  const fetchData = useCallback(async () => {\n    // Fetch vendor credit balances\n    const creditsResult = await getVendorCreditBalances()\n    if (creditsResult.data?.credits) {\n      setVendorCredits(creditsResult.data.credits)\n    }\n\n    // Fetch financial parameters\n    const paramsResult = await getFinancialParameters()\n    if (paramsResult.data) {\n      setFinancialParameters(paramsResult.data)\n    }\n\n    // Fetch outstanding credits\n    const outstandingResult = await getOutstandingCredits()\n    if (outstandingResult.data?.credits) {\n      setOutstandingCredits(outstandingResult.data.credits)\n    } else {\n      // Fallback to mock data\n      setOutstandingCredits(mockFinance.outstandingCredits)\n    }\n\n    // Fetch recovery status\n    const recoveryResult = await getRecoveryStatus()\n    if (recoveryResult.data?.recoveries) {\n      setRecoveryStatus(recoveryResult.data.recoveries)\n    }\n\n    // Fetch purchase requests\n    fetchPurchaseRequests()\n  }, [getVendorCreditBalances, getFinancialParameters, getOutstandingCredits, getRecoveryStatus, fetchPurchaseRequests])\n\n  useEffect(() => {\n    fetchData()\n  }, [fetchData])\n\n  // Refresh when finance is updated\n  useEffect(() => {\n    if (financeState.updated) {\n      fetchData()\n    }\n  }, [financeState.updated, fetchData])\n\n  const handleViewCreditBalance = async (vendor) => {\n    setSelectedVendorForCredit(vendor)\n\n    // Fetch detailed credit data\n    const result = await getVendorCreditBalances({ vendorId: vendor.id || vendor.vendorId })\n    if (result.data?.creditData) {\n      setSelectedVendorCreditData(result.data.creditData)\n    }\n\n    setCurrentView('creditBalance')\n  }\n\n  const handleSaveParameters = async (params) => {\n    try {\n      const result = await updateFinancialParameters(params)\n      if (result.data) {\n        setCurrentView(null)\n        fetchData()\n        success('Financial parameters updated successfully!', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to update financial parameters'\n        if (errorMessage.includes('validation') || errorMessage.includes('invalid')) {\n          showWarning(errorMessage, 5000)\n        } else {\n          showError(errorMessage, 5000)\n        }\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to update financial parameters', 5000)\n    }\n  }\n\n  const handleBackToList = () => {\n    setCurrentView(null)\n    setSelectedVendorForCredit(null)\n    setSelectedVendorCreditData(null)\n    setSelectedPurchaseRequest(null)\n    if (navigate) navigate('finance/overview')\n  }\n\n  const handleApplyPenalty = async (vendorId) => {\n    const confirmed = window.confirm('Are you sure you want to apply penalty for this vendor?')\n    if (confirmed) {\n      try {\n        const result = await applyPenalty(vendorId)\n        if (result.data) {\n          fetchData()\n          setCurrentView(null)\n          setSelectedVendorForCredit(null)\n          setSelectedVendorCreditData(null)\n          success('Penalty applied successfully!', 3000)\n        } else if (result.error) {\n          const errorMessage = result.error.message || 'Failed to apply penalty'\n          if (errorMessage.includes('not eligible') || errorMessage.includes('cannot')) {\n            showWarning(errorMessage, 6000)\n          } else {\n            showError(errorMessage, 5000)\n          }\n        }\n      } catch (error) {\n        showError(error.message || 'Failed to apply penalty', 5000)\n      }\n    }\n  }\n\n  const handleViewPurchaseRequest = async (request) => {\n    setSelectedPurchaseRequest(request)\n    setCurrentView('purchaseRequest')\n\n    // Fetch vendor repayments\n    const vendorId = request.vendorId\n    if (vendorId) {\n      setRepaymentsLoading(true)\n      try {\n        const result = await getVendorRepayments(vendorId)\n        if (result.data?.repayments) {\n          setSelectedVendorRepayments(result.data.repayments)\n        } else {\n          setSelectedVendorRepayments([])\n        }\n      } catch (error) {\n        console.error('Failed to fetch vendor repayments:', error)\n        setSelectedVendorRepayments([])\n      } finally {\n        setRepaymentsLoading(false)\n      }\n    }\n  }\n\n  const handleApprovePurchase = async (requestId) => {\n    setApprovingPurchase(true)\n    try {\n      const result = await approveVendorPurchase(requestId)\n      if (result.data) {\n        success('Purchase request approved successfully!', 3000)\n        // Refresh request data so we can see the \"Send Stock\" button\n        if (selectedPurchaseRequest && selectedPurchaseRequest.id === requestId) {\n          setSelectedPurchaseRequest({ ...selectedPurchaseRequest, status: 'approved', deliveryStatus: 'pending' })\n        }\n        fetchPurchaseRequests()\n        fetchData() // Refresh credit balances\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to approve purchase request'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to approve purchase request', 5000)\n    } finally {\n      setApprovingPurchase(false)\n    }\n  }\n\n  const handleSendStock = async (requestId) => {\n    setApprovingPurchase(true)\n    try {\n      const result = await sendVendorPurchaseStock(requestId)\n      if (result.data) {\n        success('Stock marked as in-transit!', 3000)\n        // Refresh request data\n        if (selectedPurchaseRequest && selectedPurchaseRequest.id === requestId) {\n          setSelectedPurchaseRequest({ ...selectedPurchaseRequest, deliveryStatus: 'in_transit' })\n        }\n        fetchPurchaseRequests()\n      } else if (result.error) {\n        showError(result.error.message || 'Failed to update delivery status', 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to update delivery status', 5000)\n    } finally {\n      setApprovingPurchase(false)\n    }\n  }\n\n  const handleConfirmDelivery = async (requestId) => {\n    setApprovingPurchase(true)\n    try {\n      const result = await confirmVendorPurchaseDelivery(requestId)\n      if (result.data) {\n        success('Stock delivery confirmed and inventory updated!', 3000)\n        setCurrentView(null)\n        setSelectedPurchaseRequest(null)\n        fetchPurchaseRequests()\n        fetchData()\n      } else if (result.error) {\n        showError(result.error.message || 'Failed to confirm delivery', 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to confirm delivery', 5000)\n    } finally {\n      setApprovingPurchase(false)\n    }\n  }\n\n  const handleRejectPurchase = async (requestId, rejectionData) => {\n    setApprovingPurchase(true)\n    try {\n      const result = await rejectVendorPurchase(requestId, rejectionData)\n      if (result.data) {\n        success('Purchase request rejected successfully!', 3000)\n        setCurrentView(null)\n        setSelectedPurchaseRequest(null)\n        fetchPurchaseRequests()\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to reject purchase request'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to reject purchase request', 5000)\n    } finally {\n      setApprovingPurchase(false)\n    }\n  }\n\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') {\n      return value\n    }\n    if (value >= 10000000) {\n      return `â‚¹${(value / 10000000).toFixed(1)} Cr`\n    }\n    if (value >= 100000) {\n      return `â‚¹${(value / 100000).toFixed(1)} L`\n    }\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  const tableColumns = vendorColumns.map((column) => {\n    if (column.accessor === 'status') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const utilization = row.creditLimit > 0 ? (row.usedCredit / row.creditLimit) * 100 : 0\n          const tone = utilization > 80 ? 'warning' : utilization > 50 ? 'neutral' : 'success'\n          return <StatusBadge tone={tone}>{utilization.toFixed(0)}%</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'actions') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const originalVendor = vendors.data?.vendors?.find((v) => v.id === row.id) || row\n          return (\n            <button\n              type=\"button\"\n              onClick={() => handleViewCreditBalance(originalVendor)}\n              className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-pink-500 hover:bg-pink-50 hover:text-pink-700\"\n              title=\"View credit balance\"\n            >\n              <Eye className=\"h-4 w-4\" />\n            </button>\n          )\n        },\n      }\n    }\n    if (['creditLimit', 'usedCredit', 'overdue', 'penalty'].includes(column.accessor)) {\n      return {\n        ...column,\n        Cell: (row) => {\n          const value = row[column.accessor] || 0\n          return <span className=\"text-sm font-bold text-gray-900\">{formatCurrency(value)}</span>\n        },\n      }\n    }\n    return column\n  })\n\n  // Show Penalties screen when subRoute is 'penalties'\n  if (subRoute === 'penalties') {\n    return <PenaltiesPage navigate={navigate} />\n  }\n\n  // Show full-screen views (replacing modals)\n  if (currentView === 'parameters') {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Credits Overview\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 7 â€¢ Credit & Finance</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Update Credit Settings</h2>\n            <p className=\"text-sm text-gray-600\">\n              Configure global financial parameters for the platform.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <FinancialParametersForm\n            parameters={financialParameters}\n            onSave={handleSaveParameters}\n            onCancel={handleBackToList}\n            loading={loading}\n          />\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'creditBalance' && selectedVendorForCredit && selectedVendorCreditData) {\n    const vendor = selectedVendorForCredit\n    const creditData = selectedVendorCreditData\n    const creditUtilization = creditData.creditLimit > 0\n      ? (creditData.usedCredit / creditData.creditLimit) * 100\n      : 0\n    const overdueAmount = creditData.overdueAmount || 0\n    const penaltyAmount = creditData.penaltyAmount || 0\n\n    const formatCurrency = (value) => {\n      if (typeof value === 'string') return value\n      if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\n      if (value >= 10000000) return `â‚¹${(value / 10000000).toFixed(1)} Cr`\n      return `â‚¹${value.toLocaleString('en-IN')}`\n    }\n\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Credits Overview\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 7 â€¢ Credit & Finance</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Credit Balance - {vendor.name || vendor.vendorName}</h2>\n            <p className=\"text-sm text-gray-600\">\n              View detailed credit information, repayment history, and overdue payments.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-6\">\n            {/* Vendor Header */}\n            <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-pink-500 to-pink-600 text-white shadow-lg\">\n                    <Building2 className=\"h-6 w-6\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-bold text-gray-900\">{vendor.name || vendor.vendorName}</h3>\n                    <p className=\"text-sm text-gray-600\">Vendor ID: {vendor.id || vendor.vendorId}</p>\n                    {vendor.region && (\n                      <p className=\"text-xs text-gray-500 mt-1\">Region: {vendor.region}</p>\n                    )}\n                  </div>\n                </div>\n                <StatusBadge tone={creditUtilization > 80 ? 'warning' : creditUtilization > 50 ? 'neutral' : 'success'}>\n                  {creditUtilization.toFixed(0)}% Utilized\n                </StatusBadge>\n              </div>\n            </div>\n\n            {/* Credit Summary */}\n            <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-4\">\n              <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n                <div className=\"flex items-center gap-2 text-xs text-blue-500 mb-2\">\n                  <Sparkles className=\"h-4 w-4\" />\n                  <span>Credit Limit</span>\n                </div>\n                <p className=\"text-xl font-bold text-blue-900\">\n                  {formatCurrency(creditData.creditLimit || 0)}\n                </p>\n              </div>\n              <div className=\"rounded-xl border border-green-200 bg-green-50 p-4\">\n                <div className=\"flex items-center gap-2 text-xs text-green-500 mb-2\">\n                  <BadgeIndianRupee className=\"h-4 w-4\" />\n                  <span>Used Credit</span>\n                </div>\n                <p className=\"text-xl font-bold text-green-900\">\n                  {formatCurrency(creditData.usedCredit || 0)}\n                </p>\n              </div>\n              <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-4\">\n                <div className=\"flex items-center gap-2 text-xs text-orange-500 mb-2\">\n                  <AlertCircle className=\"h-4 w-4\" />\n                  <span>Overdue</span>\n                </div>\n                <p className=\"text-xl font-bold text-orange-900\">\n                  {formatCurrency(overdueAmount)}\n                </p>\n              </div>\n              <div className=\"rounded-xl border border-red-200 bg-red-50 p-4\">\n                <div className=\"flex items-center gap-2 text-xs text-red-500 mb-2\">\n                  <AlertCircle className=\"h-4 w-4\" />\n                  <span>Penalty</span>\n                </div>\n                <p className=\"text-xl font-bold text-red-900\">\n                  {formatCurrency(penaltyAmount)}\n                </p>\n              </div>\n            </div>\n\n            {/* Credit Utilization Progress */}\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <div className=\"mb-3 flex items-center justify-between\">\n                <h4 className=\"text-sm font-bold text-gray-900\">Credit Utilization</h4>\n                <span className=\"text-xs text-gray-600\">\n                  {formatCurrency(creditData.availableCredit || 0)} available\n                </span>\n              </div>\n              <div className=\"h-3 w-full overflow-hidden rounded-full bg-gray-200\">\n                <div\n                  className={cn(\n                    'h-full transition-all',\n                    creditUtilization > 80 ? 'bg-red-500' : creditUtilization > 50 ? 'bg-orange-500' : 'bg-green-500',\n                  )}\n                  style={{ width: `${Math.min(creditUtilization, 100)}%` }}\n                />\n              </div>\n            </div>\n\n            {/* Repayment History */}\n            {creditData.repaymentHistory && creditData.repaymentHistory.length > 0 && (\n              <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n                <div className=\"mb-4 flex items-center gap-2\">\n                  <Calendar className=\"h-5 w-5 text-gray-600\" />\n                  <h4 className=\"text-sm font-bold text-gray-900\">Repayment History</h4>\n                </div>\n                <Timeline\n                  events={creditData.repaymentHistory.map((payment, index) => ({\n                    id: payment.id || `payment-${index}`,\n                    title: payment.description || `Repayment ${index + 1}`,\n                    timestamp: payment.date || payment.timestamp || 'N/A',\n                    description: formatCurrency(payment.amount || 0),\n                    status: payment.status || payment.onTime ? 'completed' : 'pending',\n                  }))}\n                />\n              </div>\n            )}\n\n            {/* Overdue Payments */}\n            {creditData.overduePayments && creditData.overduePayments.length > 0 && (\n              <div className=\"rounded-xl border border-red-200 bg-red-50 p-5\">\n                <div className=\"mb-4 flex items-center gap-2\">\n                  <AlertCircle className=\"h-5 w-5 text-red-600\" />\n                  <h4 className=\"text-sm font-bold text-gray-900\">Overdue Payments</h4>\n                </div>\n                <div className=\"space-y-3\">\n                  {creditData.overduePayments.map((payment, index) => (\n                    <div key={payment.id || index} className=\"rounded-lg border border-red-300 bg-white p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm font-bold text-gray-900\">{payment.description || `Payment ${index + 1}`}</p>\n                          <p className=\"text-xs text-gray-600\">Due: {payment.dueDate || 'N/A'}</p>\n                          <p className=\"text-xs text-red-600\">Days overdue: {payment.daysOverdue || 0}</p>\n                        </div>\n                        <div className=\"text-right\">\n                          <p className=\"text-sm font-bold text-red-600\">{formatCurrency(payment.amount || 0)}</p>\n                          {payment.penaltyApplied && (\n                            <StatusBadge tone=\"warning\">Penalty Applied</StatusBadge>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Action Buttons */}\n            {overdueAmount > 0 && (\n              <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n                <button\n                  type=\"button\"\n                  onClick={handleBackToList}\n                  disabled={loading}\n                  className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n                >\n                  Close\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => handleApplyPenalty(vendor.id || vendor.vendorId)}\n                  disabled={loading || penaltyAmount > 0}\n                  className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-red-500 to-red-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(239,68,68,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(239,68,68,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n                >\n                  <AlertCircle className=\"h-4 w-4\" />\n                  Apply Penalty\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'purchaseRequest' && selectedPurchaseRequest) {\n    const request = selectedPurchaseRequest\n    const rejectReason = purchaseRejectReasonState\n    const setRejectReason = setPurchaseRejectReasonState\n\n    const formatCurrency = (value) => {\n      if (typeof value === 'string') return value\n      if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\n      return `â‚¹${value.toLocaleString('en-IN')}`\n    }\n\n    const handleRejectWithReason = () => {\n      if (!rejectReason.trim()) {\n        showError('Please provide a reason for rejection', 5000)\n        return\n      }\n      handleRejectPurchase(request.id, { reason: rejectReason.trim() })\n    }\n\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Credits Overview\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 7 â€¢ Credit & Finance</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Vendor Purchase Request Review</h2>\n            <p className=\"text-sm text-gray-600\">\n              Review and approve or reject vendor purchase requests.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-6\">\n            {/* Request Header */}\n            <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg\">\n                    <Package className=\"h-6 w-6\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-bold text-gray-900\">\n                      Request #{request.id?.slice(-8) || request.requestId?.slice(-8) || 'N/A'}\n                    </h3>\n                    <p className=\"text-sm text-gray-600\">Vendor: {request.vendorName || request.vendor}</p>\n                    <div className=\"mt-2 flex items-center gap-4 text-xs text-gray-500\">\n                      {request.date && (\n                        <div className=\"flex items-center gap-1\">\n                          <Calendar className=\"h-3.5 w-3.5\" />\n                          <span>{new Date(request.date).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })}</span>\n                        </div>\n                      )}\n                      {request.createdAt && !request.date && (\n                        <div className=\"flex items-center gap-1\">\n                          <Calendar className=\"h-3.5 w-3.5\" />\n                          <span>{new Date(request.createdAt).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })}</span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n                <StatusBadge tone={request.status === 'pending' ? 'warning' : request.status === 'approved' ? 'success' : 'neutral'}>\n                  {request.status || 'Pending'}\n                </StatusBadge>\n              </div>\n            </div>\n\n            {/* Vendor Credit Performance */}\n            <div className=\"space-y-4\">\n              <h4 className=\"text-sm font-bold text-gray-900\">Vendor Credit Performance</h4>\n              <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-4\">\n                <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n                  <p className=\"text-xs text-blue-500\">Credit Limit</p>\n                  <p className=\"mt-1 text-lg font-bold text-blue-900\">\n                    {formatCurrency(request.vendorPerformance?.creditLimit || 0)}\n                  </p>\n                </div>\n                <div className=\"rounded-xl border border-purple-200 bg-purple-50 p-4\">\n                  <p className=\"text-xs text-purple-500\">Used Credit</p>\n                  <p className=\"mt-1 text-lg font-bold text-purple-900\">\n                    {formatCurrency(request.vendorPerformance?.creditUsed || 0)}\n                  </p>\n                </div>\n                <div className={cn(\n                  \"rounded-xl border p-4\",\n                  request.vendorPerformance?.hasOutstandingDues ? \"border-red-200 bg-red-50\" : \"border-green-200 bg-green-50\"\n                )}>\n                  <p className={cn(\"text-xs\", request.vendorPerformance?.hasOutstandingDues ? \"text-red-500\" : \"text-green-500\")}>\n                    Outstanding Dues\n                  </p>\n                  <p className={cn(\"mt-1 text-lg font-bold\", request.vendorPerformance?.hasOutstandingDues ? \"text-red-900\" : \"text-green-900\")}>\n                    {formatCurrency(request.vendorPerformance?.outstandingAmount || 0)}\n                  </p>\n                </div>\n                <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-4\">\n                  <p className=\"text-xs text-orange-500\">Utilization</p>\n                  <p className=\"mt-1 text-lg font-bold text-orange-900\">\n                    {(request.vendorPerformance?.creditUtilization || 0).toFixed(1)}%\n                  </p>\n                </div>\n              </div>\n\n              {request.vendorPerformance?.hasOutstandingDues && (\n                <div className=\"flex items-center gap-2 rounded-lg border border-red-300 bg-red-100/50 p-3 text-sm text-red-900\">\n                  <AlertCircle className=\"h-4 w-4 shrink-0\" />\n                  <span>Warning: This vendor had outstanding dues of {formatCurrency(request.vendorPerformance?.outstandingAmount)} at the time of this request.</span>\n                </div>\n              )}\n            </div>\n\n            {/* Purchase Details */}\n            <div className=\"space-y-4\">\n              <h4 className=\"text-sm font-bold text-gray-900\">Purchase Details</h4>\n\n              <div className=\"grid gap-4 sm:grid-cols-2\">\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <p className=\"text-xs text-gray-500\">Request Amount</p>\n                  <p className=\"mt-1 text-lg font-bold text-gray-900\">\n                    {formatCurrency(request.amount || request.value || 0)}\n                  </p>\n                </div>\n                {request.advance && (\n                  <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                    <p className=\"text-xs text-gray-500\">Advance Payment (30%)</p>\n                    <p className=\"mt-1 text-lg font-bold text-gray-900\">\n                      {formatCurrency(request.advance)}\n                    </p>\n                  </div>\n                )}\n              </div>\n\n              {request.products && request.products.length > 0 && (\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <p className=\"mb-3 text-xs font-bold text-gray-500\">Products Requested</p>\n                  <div className=\"space-y-2\">\n                    {request.products.map((product, index) => {\n                      // Format attribute label\n                      const formatAttributeLabel = (key) => {\n                        return key\n                          .replace(/([A-Z])/g, ' $1')\n                          .replace(/^./, str => str.toUpperCase())\n                          .trim()\n                      }\n\n                      return (\n                        <div key={index} className=\"rounded-lg bg-white p-3\">\n                          <div className=\"flex items-center justify-between mb-1\">\n                            <span className=\"text-sm font-semibold text-gray-900\">{product.name || product}</span>\n                            {product.quantity && (\n                              <span className=\"text-xs text-gray-500\">\n                                Qty: {product.quantity} {product.unit || 'kg'}\n                              </span>\n                            )}\n                          </div>\n                          {/* Display variant attributes if present */}\n                          {product.attributeCombination && Object.keys(product.attributeCombination).length > 0 && (\n                            <div className=\"mt-2 space-y-1 pt-2 border-t border-gray-100\">\n                              {Object.entries(product.attributeCombination).map(([key, value]) => (\n                                <div key={key} className=\"flex items-center gap-2 text-xs\">\n                                  <span className=\"text-gray-600 font-medium\">{formatAttributeLabel(key)}:</span>\n                                  <span className=\"text-gray-900\">{value}</span>\n                                </div>\n                              ))}\n                            </div>\n                          )}\n                          {product.price && (\n                            <div className=\"mt-1 text-xs text-gray-500\">\n                              Price: â‚¹{product.price.toLocaleString('en-IN')}/{product.unit || 'kg'}\n                            </div>\n                          )}\n                        </div>\n                      )\n                    })}\n                  </div>\n                </div>\n              )}\n\n              {request.description && (\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <p className=\"mb-2 text-xs text-gray-500\">Description</p>\n                  <p className=\"text-sm text-gray-700\">{request.description}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Repayment History */}\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <h4 className=\"text-sm font-bold text-gray-900\">Repayment History</h4>\n                {repaymentsLoading && <span className=\"text-xs text-pink-500 animate-pulse\">Loading...</span>}\n              </div>\n\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                {selectedVendorRepayments.length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {selectedVendorRepayments.slice(0, 5).map((repayment, index) => (\n                      <div key={repayment.id || index} className=\"flex items-center justify-between rounded-lg bg-white p-3 shadow-sm\">\n                        <div>\n                          <p className=\"text-sm font-bold text-gray-900\">\n                            â‚¹{repayment.amount?.toLocaleString('en-IN') || 0}\n                          </p>\n                          <p className=\"text-xs text-gray-500\">\n                            {repayment.date ? new Date(repayment.date).toLocaleDateString() : 'N/A'}\n                          </p>\n                        </div>\n                        <StatusBadge tone={repayment.status === 'completed' ? 'success' : 'warning'}>\n                          {repayment.status || 'Pending'}\n                        </StatusBadge>\n                      </div>\n                    ))}\n                    {selectedVendorRepayments.length > 5 && (\n                      <p className=\"text-center text-xs text-gray-500\">\n                        View all {selectedVendorRepayments.length} repayments in Vendor Details\n                      </p>\n                    )}\n                  </div>\n                ) : (\n                  <p className=\"text-center text-sm text-gray-500 py-4\">\n                    {repaymentsLoading ? 'Fetching repayment history...' : 'No repayment history found for this vendor.'}\n                  </p>\n                )}\n              </div>\n            </div>\n\n            {/* Rejection Reason Input */}\n            <div>\n              <label htmlFor=\"rejectReason\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Rejection Reason <span className=\"text-xs font-normal text-gray-500\">(Required for rejection)</span>\n              </label>\n              <textarea\n                id=\"rejectReason\"\n                value={rejectReason}\n                onChange={(e) => setRejectReason(e.target.value)}\n                placeholder=\"Enter reason for rejection\"\n                rows={3}\n                className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-500/50\"\n              />\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                disabled={loading}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n              >\n                Cancel\n              </button>\n              <div className=\"flex gap-3\">\n                <button\n                  type=\"button\"\n                  onClick={handleRejectWithReason}\n                  disabled={loading || !rejectReason.trim()}\n                  className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50 disabled:opacity-50\"\n                >\n                  <XCircle className=\"h-4 w-4\" />\n                  Reject\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => handleApprovePurchase(request.id)}\n                  disabled={loading || approvingPurchase}\n                  className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n                >\n                  <CheckCircle className=\"h-4 w-4\" />\n                  {approvingPurchase ? 'Processing...' : 'Approve Request'}\n                </button>\n              </div>\n            </div>\n\n            {/* Delivery Actions (Visible after approval) */}\n            {request.status === 'approved' && request.deliveryStatus !== 'delivered' && (\n              <div className=\"mt-8 rounded-2xl border-2 border-dashed border-blue-200 bg-blue-50/50 p-6\">\n                <div className=\"mb-4 flex items-center justify-between\">\n                  <div>\n                    <h4 className=\"text-sm font-bold text-gray-900\">Stock Delivery Workflow</h4>\n                    <p className=\"text-xs text-gray-600\">Current Phase: <span className=\"font-semibold uppercase text-blue-600\">{request.deliveryStatus || 'Pending'}</span></p>\n                  </div>\n                </div>\n\n                <div className=\"flex flex-wrap gap-4\">\n                  {request.deliveryStatus === 'pending' && (\n                    <button\n                      type=\"button\"\n                      onClick={() => handleSendStock(request.id)}\n                      disabled={approvingPurchase}\n                      className=\"flex items-center gap-2 rounded-xl bg-blue-600 px-6 py-2.5 text-sm font-bold text-white shadow-lg transition-all hover:bg-blue-700 disabled:opacity-50\"\n                    >\n                      <Package className=\"h-4 w-4\" />\n                      Dispatch Stock (Mark Sent)\n                    </button>\n                  )}\n\n                  {request.deliveryStatus === 'in_transit' && (\n                    <button\n                      type=\"button\"\n                      onClick={() => handleConfirmDelivery(request.id)}\n                      disabled={approvingPurchase}\n                      className=\"flex items-center gap-2 rounded-xl bg-pink-600 px-6 py-2.5 text-sm font-bold text-white shadow-lg transition-all hover:bg-pink-700 disabled:opacity-50\"\n                    >\n                      <CheckCircle className=\"h-4 w-4\" />\n                      Confirm Receipt (Actual Stock Transfer)\n                    </button>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Show Overview (default when subRoute is null or 'overview')\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 7 â€¢ Credit & Finance</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Recoveries & Policy Control</h2>\n          <p className=\"text-sm text-gray-600\">\n            Track credit utilisation, configure repayment guardrails, and deploy automatic penalty workflows.\n          </p>\n        </div>\n        <button\n          onClick={() => setCurrentView('parameters')}\n          className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-pink-500 to-pink-600 px-5 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(236,72,153,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all duration-200 hover:shadow-[0_6px_20px_rgba(236,72,153,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] hover:scale-105 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.2)]\"\n        >\n          <BadgeIndianRupee className=\"h-4 w-4\" />\n          Update Credit Settings\n        </button>\n      </header>\n\n      {/* Pending Purchase Requests */}\n      {purchaseRequests.length > 0 && (\n        <div className=\"rounded-3xl border border-orange-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"mb-4 flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-lg\">\n                <Package className=\"h-5 w-5\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-bold text-gray-900\">Pending Purchase Requests</h3>\n                <p className=\"text-xs text-gray-600\">{purchaseRequests.length} request{purchaseRequests.length !== 1 ? 's' : ''} awaiting approval</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"space-y-3\">\n            {purchaseRequests.slice(0, 5).map((request) => (\n              <div\n                key={request.id}\n                className=\"flex items-center justify-between rounded-xl border border-gray-200 bg-gray-50 p-4 transition-all hover:border-orange-300 hover:bg-orange-50/50 cursor-pointer\"\n                onClick={() => handleViewPurchaseRequest(request)}\n              >\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-3\">\n                    <p className=\"font-bold text-gray-900\">{request.vendorName || 'Unknown Vendor'}</p>\n                    <StatusBadge tone=\"warning\">Pending</StatusBadge>\n                  </div>\n                  <p className=\"mt-1 text-sm text-gray-600\">\n                    {request.products?.length || 0} product{request.products?.length !== 1 ? 's' : ''} â€¢ {formatCurrency(request.amount || request.value || 0)}\n                  </p>\n                  {request.date && (\n                    <p className=\"mt-1 text-xs text-gray-500\">Requested on {new Date(request.date).toLocaleDateString('en-IN')}</p>\n                  )}\n                </div>\n                <button\n                  type=\"button\"\n                  onClick={(e) => {\n                    e.stopPropagation()\n                    handleViewPurchaseRequest(request)\n                  }}\n                  className=\"ml-4 flex h-9 w-9 items-center justify-center rounded-lg border border-orange-300 bg-white text-orange-600 transition-all hover:border-orange-500 hover:bg-orange-50\"\n                  title=\"Review request\"\n                >\n                  <Eye className=\"h-4 w-4\" />\n                </button>\n              </div>\n            ))}\n            {purchaseRequests.length > 5 && (\n              <p className=\"text-center text-xs text-gray-500\">\n                +{purchaseRequests.length - 5} more request{purchaseRequests.length - 5 !== 1 ? 's' : ''}\n              </p>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Vendor Credit Balances Table */}\n      {vendorCredits.length > 0 && (\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <h3 className=\"mb-4 text-lg font-bold text-gray-900\">Vendor Credit Balances</h3>\n          <DataTable\n            columns={tableColumns}\n            rows={vendorCredits}\n            emptyState=\"No vendor credit data available\"\n          />\n        </div>\n      )}\n\n      <section className=\"grid gap-6 lg:grid-cols-2\">\n        <div className=\"space-y-4 rounded-3xl border border-pink-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <h3 className=\"text-lg font-bold text-pink-700\">Global Parameters</h3>\n          <p className=\"text-sm text-gray-600\">\n            Set default advances, minimum order values, and vendor purchase thresholds for the platform.\n          </p>\n          <div className=\"space-y-3\">\n            {financialParameters ? (\n              <>\n                <div className=\"rounded-2xl border border-gray-200 bg-white p-4 shadow-[0_2px_8px_rgba(0,0,0,0.05),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-sm font-bold text-gray-900\">User Advance Payment %</p>\n                    <StatusBadge tone=\"success\">{financialParameters.userAdvancePaymentPercent || 30}%</StatusBadge>\n                  </div>\n                  <p className=\"mt-2 text-xs text-gray-600\">Default advance for all user orders</p>\n                </div>\n                <div className=\"rounded-2xl border border-gray-200 bg-white p-4 shadow-[0_2px_8px_rgba(0,0,0,0.05),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-sm font-bold text-gray-900\">Minimum User Order</p>\n                    <StatusBadge tone=\"success\">â‚¹{financialParameters.minimumUserOrder?.toLocaleString('en-IN') || '2,000'}</StatusBadge>\n                  </div>\n                  <p className=\"mt-2 text-xs text-gray-600\">Minimum order value for user purchases</p>\n                </div>\n                <div className=\"rounded-2xl border border-gray-200 bg-white p-4 shadow-[0_2px_8px_rgba(0,0,0,0.05),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-sm font-bold text-gray-900\">Minimum Vendor Purchase</p>\n                    <StatusBadge tone=\"success\">â‚¹{financialParameters.minimumVendorPurchase?.toLocaleString('en-IN') || '50,000'}</StatusBadge>\n                  </div>\n                  <p className=\"mt-2 text-xs text-gray-600\">Minimum purchase value for vendor orders</p>\n                </div>\n              </>\n            ) : (\n              mockFinance.creditPolicies.map((policy) => (\n                <div key={policy.id} className=\"rounded-2xl border border-gray-200 bg-white p-4 shadow-[0_2px_8px_rgba(0,0,0,0.05),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-sm font-bold text-gray-900\">{policy.label}</p>\n                    <StatusBadge tone=\"success\">{policy.value}</StatusBadge>\n                  </div>\n                  <p className=\"mt-2 text-xs text-gray-600\">{policy.meta}</p>\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n        <OutstandingCreditsView credits={outstandingCredits} />\n      </section>\n\n      <section className=\"grid gap-6 lg:grid-cols-2\">\n        <div className=\"space-y-4 rounded-3xl border border-indigo-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"flex items-center gap-3\">\n            <Sparkles className=\"h-5 w-5 text-indigo-600\" />\n            <div>\n              <h3 className=\"text-lg font-bold text-indigo-700\">Automated Penalties</h3>\n              <p className=\"text-sm text-gray-600\">\n                Penalties triggered by repayment delays are auto-applied with configurable grace periods.\n              </p>\n            </div>\n          </div>\n          <div className=\"space-y-3\">\n            {[\n              {\n                title: 'Grace Period',\n                detail: '5 day grace period before penalty kicks in. Update for festive cycles if needed.',\n              },\n              {\n                title: 'Penalty Computation',\n                detail: 'Daily penalty applied post grace period. Compounded weekly with automated alerts.',\n              },\n              {\n                title: 'Collections Workflow',\n                detail: 'Escalate to finance after 14 days overdue. Trigger legal notices automatically.',\n              },\n            ].map((item) => (\n              <div key={item.title} className=\"rounded-2xl border border-gray-200 bg-white p-4 hover:-translate-y-1 hover:shadow-[0_6px_20px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <p className=\"text-sm font-bold text-gray-900\">{item.title}</p>\n                <p className=\"mt-2 text-xs text-gray-600\">{item.detail}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n        <Timeline\n          events={[\n            {\n              id: 'finance-1',\n              title: 'Outstanding Credits Review',\n              timestamp: 'Today â€¢ 08:30',\n              description: 'â‚¹1.92 Cr flagged for recovery. Weekly sync scheduled with collections team.',\n              status: 'completed',\n            },\n            {\n              id: 'finance-2',\n              title: 'Penalty Applied',\n              timestamp: 'Today â€¢ 10:45',\n              description: 'Penalty of â‚¹82,300 applied to 4 vendors exceeding grace period.',\n              status: 'completed',\n            },\n            {\n              id: 'finance-3',\n              title: 'Recovery Follow-up',\n              timestamp: 'Today â€¢ 14:00',\n              description: 'Auto reminders scheduled. Finance to confirm repayment plans.',\n              status: 'pending',\n            },\n          ]}\n        />\n      </section>\n\n      {/* Recovery Status */}\n      {recoveryStatus.length > 0 && (\n        <RecoveryStatusView recoveryData={recoveryStatus} />\n      )}\n\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Offers.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'carouselForm' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"carouselForm"},"fix":{"range":[1389,1401],"text":""},"desc":"Remove unused variable 'carouselForm'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setCarouselForm' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":25,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"setCarouselForm"},"fix":{"range":[1401,1418],"text":""},"desc":"Remove unused variable 'setCarouselForm'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'specialOfferForm' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":34,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"specialOfferForm"},"fix":{"range":[1562,1578],"text":""},"desc":"Remove unused variable 'specialOfferForm'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setSpecialOfferForm' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":34,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"setSpecialOfferForm"},"fix":{"range":[1578,1599],"text":""},"desc":"Remove unused variable 'setSpecialOfferForm'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\r\nimport { ImageIcon, Plus, Edit2, Trash2, ToggleRight, ToggleLeft, Save, ArrowLeft, AlertCircle, GripVertical } from 'lucide-react'\r\nimport { StatusBadge } from '../components/StatusBadge'\r\nimport { useToast } from '../components/ToastNotification'\r\nimport { cn } from '../../../lib/cn'\r\nimport * as adminApi from '../services/adminApi'\r\nimport { ImageUpload } from '../components/ImageUpload'\r\nimport { CarouselImageUpload } from '../components/CarouselImageUpload'\r\n\r\nexport function OffersPage({ subRoute = null, navigate }) {\r\n  const { success, error: showError, warning } = useToast()\r\n  const [activeTab, setActiveTab] = useState('carousels') // 'carousels' | 'special-offers'\r\n  const [carousels, setCarousels] = useState([])\r\n  const [specialOffers, setSpecialOffers] = useState([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [carouselCount, setCarouselCount] = useState(0)\r\n  const [editingCarousel, setEditingCarousel] = useState(null)\r\n  const [editingSpecialOffer, setEditingSpecialOffer] = useState(null)\r\n  const [allProducts, setAllProducts] = useState([])\r\n  const [productsLoading, setProductsLoading] = useState(false)\r\n  const [draggedCarouselIndex, setDraggedCarouselIndex] = useState(null)\r\n  const [dragOverCarouselIndex, setDragOverCarouselIndex] = useState(null)\r\n\r\n  // Form states\r\n  const [carouselForm, setCarouselForm] = useState({\r\n    title: '',\r\n    description: '',\r\n    image: '',\r\n    productIds: [],\r\n    order: 0,\r\n    isActive: true,\r\n  })\r\n\r\n  const [specialOfferForm, setSpecialOfferForm] = useState({\r\n    title: '',\r\n    description: '',\r\n    specialTag: '',\r\n    specialValue: '',\r\n    linkedProductIds: [],\r\n    isActive: true,\r\n  })\r\n\r\n  // Fetch offers\r\n  const fetchOffers = useCallback(async () => {\r\n    try {\r\n      setLoading(true)\r\n      const result = await adminApi.getOffers()\r\n      if (result.success && result.data) {\r\n        setCarousels(result.data.offers?.filter(o => o.type === 'carousel') || [])\r\n        setSpecialOffers(result.data.offers?.filter(o => o.type === 'special_offer') || [])\r\n        setCarouselCount(result.data.carouselCount || 0)\r\n      }\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to load offers')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }, [showError])\r\n\r\n  // Fetch products for selection\r\n  const fetchProducts = useCallback(async () => {\r\n    try {\r\n      setProductsLoading(true)\r\n      const result = await adminApi.getProducts()\r\n      if (result.success && result.data?.products) {\r\n        setAllProducts(result.data.products)\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to load products:', err)\r\n    } finally {\r\n      setProductsLoading(false)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    fetchOffers()\r\n    fetchProducts()\r\n  }, [fetchOffers, fetchProducts])\r\n\r\n  // Parse subRoute to determine edit mode\r\n  useEffect(() => {\r\n    if (subRoute) {\r\n      const parts = subRoute.split('/')\r\n      if (parts[0] === 'carousel' && parts[1] === 'edit' && parts[2]) {\r\n        // Find carousel by ID\r\n        const carousel = carousels.find(c => (c._id || c.id) === parts[2])\r\n        if (carousel) {\r\n          setEditingCarousel(carousel)\r\n        } else if (carousels.length > 0) {\r\n          // Carousels loaded but not found - might need to refetch\r\n          fetchOffers()\r\n        }\r\n      } else if (parts[0] === 'special-offer' && parts[1] === 'edit' && parts[2]) {\r\n        // Find special offer by ID\r\n        const offer = specialOffers.find(o => (o._id || o.id) === parts[2])\r\n        if (offer) {\r\n          setEditingSpecialOffer(offer)\r\n        } else if (specialOffers.length > 0) {\r\n          // Offers loaded but not found - might need to refetch\r\n          fetchOffers()\r\n        }\r\n      } else if (parts[0] === 'carousel' && parts[1] === 'add') {\r\n        // Reset when adding new\r\n        setEditingCarousel(null)\r\n      } else if (parts[0] === 'special-offer' && parts[1] === 'add') {\r\n        // Reset when adding new\r\n        setEditingSpecialOffer(null)\r\n      }\r\n    } else {\r\n      // Reset editing states when navigating back\r\n      setEditingCarousel(null)\r\n      setEditingSpecialOffer(null)\r\n    }\r\n  }, [subRoute, carousels, specialOffers, fetchOffers])\r\n\r\n  // Carousel handlers\r\n  const handleCreateCarousel = () => {\r\n    if (carouselCount >= 6) {\r\n      warning('Maximum 6 active carousels allowed. Please delete or deactivate an existing carousel first.')\r\n      return\r\n    }\r\n    if (navigate) navigate('offers/carousel/add')\r\n  }\r\n\r\n  const handleEditCarousel = (carousel) => {\r\n    setEditingCarousel(carousel)\r\n    if (navigate) navigate(`offers/carousel/edit/${carousel._id || carousel.id}`)\r\n  }\r\n\r\n  const handleSaveCarousel = async (carouselForm) => {\r\n    try {\r\n      if (!carouselForm.title.trim()) {\r\n        showError('Title is required')\r\n        return false\r\n      }\r\n      if (!carouselForm.image) {\r\n        showError('Image is required for carousel')\r\n        return false\r\n      }\r\n      if (!carouselForm.productIds || carouselForm.productIds.length === 0) {\r\n        showError('At least one product must be selected')\r\n        return false\r\n      }\r\n\r\n      if (editingCarousel) {\r\n        const result = await adminApi.updateOffer(editingCarousel._id || editingCarousel.id, {\r\n          ...carouselForm,\r\n          type: 'carousel',\r\n        })\r\n        if (result.success) {\r\n          success('Carousel updated successfully')\r\n          setEditingCarousel(null)\r\n          fetchOffers()\r\n          if (navigate) navigate('offers')\r\n          return true\r\n        }\r\n      } else {\r\n        const result = await adminApi.createOffer({\r\n          ...carouselForm,\r\n          type: 'carousel',\r\n        })\r\n        if (result.success) {\r\n          success('Carousel created successfully')\r\n          fetchOffers()\r\n          if (navigate) navigate('offers')\r\n          return true\r\n        }\r\n      }\r\n      return false\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to save carousel')\r\n      return false\r\n    }\r\n  }\r\n\r\n  const handleDeleteCarousel = async (id) => {\r\n    if (!confirm('Are you sure you want to delete this carousel?')) return\r\n    try {\r\n      const result = await adminApi.deleteOffer(id)\r\n      if (result.success) {\r\n        success('Carousel deleted successfully')\r\n        fetchOffers()\r\n      }\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to delete carousel')\r\n    }\r\n  }\r\n\r\n  const handleToggleCarouselActive = async (carousel) => {\r\n    try {\r\n      const result = await adminApi.updateOffer(carousel._id || carousel.id, {\r\n        isActive: !carousel.isActive,\r\n      })\r\n      if (result.success) {\r\n        success(`Carousel ${carousel.isActive ? 'deactivated' : 'activated'} successfully`)\r\n        fetchOffers()\r\n      }\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to update carousel')\r\n    }\r\n  }\r\n\r\n  // Drag and drop handlers for carousel reordering\r\n  const handleCarouselDragStart = (e, index) => {\r\n    setDraggedCarouselIndex(index)\r\n    e.dataTransfer.effectAllowed = 'move'\r\n    e.dataTransfer.setData('text/plain', index.toString())\r\n    if (e.currentTarget) {\r\n      e.currentTarget.style.opacity = '0.5'\r\n    }\r\n  }\r\n\r\n  const handleCarouselDragEnd = (e) => {\r\n    if (e.currentTarget) {\r\n      e.currentTarget.style.opacity = '1'\r\n    }\r\n    setDraggedCarouselIndex(null)\r\n    setDragOverCarouselIndex(null)\r\n  }\r\n\r\n  const handleCarouselDragOver = (e, index) => {\r\n    e.preventDefault()\r\n    e.dataTransfer.dropEffect = 'move'\r\n    if (draggedCarouselIndex !== null && draggedCarouselIndex !== index) {\r\n      setDragOverCarouselIndex(index)\r\n    }\r\n  }\r\n\r\n  const handleCarouselDragLeave = () => {\r\n    setDragOverCarouselIndex(null)\r\n  }\r\n\r\n  const handleCarouselDrop = async (e, dropIndex) => {\r\n    e.preventDefault()\r\n    setDragOverCarouselIndex(null)\r\n    \r\n    if (draggedCarouselIndex === null || draggedCarouselIndex === dropIndex) {\r\n      return\r\n    }\r\n\r\n    const updatedCarousels = [...carousels]\r\n    const draggedCarousel = updatedCarousels[draggedCarouselIndex]\r\n    \r\n    // Remove dragged carousel from its position\r\n    updatedCarousels.splice(draggedCarouselIndex, 1)\r\n    \r\n    // Insert at new position\r\n    updatedCarousels.splice(dropIndex, 0, draggedCarousel)\r\n    \r\n    // Update order values based on new positions\r\n    const reorderedCarousels = updatedCarousels.map((carousel, idx) => ({\r\n      ...carousel,\r\n      order: idx,\r\n    }))\r\n\r\n    // Optimistically update UI\r\n    setCarousels(reorderedCarousels)\r\n    setDraggedCarouselIndex(null)\r\n\r\n    // Save new order to backend\r\n    try {\r\n      // Update all carousels with new order\r\n      const updatePromises = reorderedCarousels.map((carousel, idx) =>\r\n        adminApi.updateOffer(carousel._id || carousel.id, { order: idx })\r\n      )\r\n      await Promise.all(updatePromises)\r\n      success('Carousel order updated successfully')\r\n      // Refetch to ensure sync\r\n      fetchOffers()\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to update carousel order')\r\n      // Revert on error\r\n      fetchOffers()\r\n    }\r\n  }\r\n\r\n  // Special offer handlers\r\n  const handleCreateSpecialOffer = () => {\r\n    if (navigate) navigate('offers/special-offer/add')\r\n  }\r\n\r\n  const handleEditSpecialOffer = (offer) => {\r\n    setEditingSpecialOffer(offer)\r\n    if (navigate) navigate(`offers/special-offer/edit/${offer._id || offer.id}`)\r\n  }\r\n\r\n  const handleSaveSpecialOffer = async (specialOfferForm) => {\r\n    try {\r\n      if (!specialOfferForm.title.trim()) {\r\n        showError('Title is required')\r\n        return false\r\n      }\r\n      if (!specialOfferForm.specialTag.trim()) {\r\n        showError('Special tag is required')\r\n        return false\r\n      }\r\n      if (!specialOfferForm.specialValue.trim()) {\r\n        showError('Special value is required')\r\n        return false\r\n      }\r\n\r\n      if (editingSpecialOffer) {\r\n        const result = await adminApi.updateOffer(editingSpecialOffer._id || editingSpecialOffer.id, {\r\n          ...specialOfferForm,\r\n          type: 'special_offer',\r\n        })\r\n        if (result.success) {\r\n          success('Special offer updated successfully')\r\n          setEditingSpecialOffer(null)\r\n          fetchOffers()\r\n          if (navigate) navigate('offers')\r\n          return true\r\n        }\r\n      } else {\r\n        const result = await adminApi.createOffer({\r\n          ...specialOfferForm,\r\n          type: 'special_offer',\r\n        })\r\n        if (result.success) {\r\n          success('Special offer created successfully')\r\n          fetchOffers()\r\n          if (navigate) navigate('offers')\r\n          return true\r\n        }\r\n      }\r\n      return false\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to save special offer')\r\n      return false\r\n    }\r\n  }\r\n\r\n  const handleDeleteSpecialOffer = async (id) => {\r\n    if (!confirm('Are you sure you want to delete this special offer?')) return\r\n    try {\r\n      const result = await adminApi.deleteOffer(id)\r\n      if (result.success) {\r\n        success('Special offer deleted successfully')\r\n        fetchOffers()\r\n      }\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to delete special offer')\r\n    }\r\n  }\r\n\r\n  const handleToggleSpecialOfferActive = async (offer) => {\r\n    try {\r\n      const result = await adminApi.updateOffer(offer._id || offer.id, {\r\n        isActive: !offer.isActive,\r\n      })\r\n      if (result.success) {\r\n        success(`Special offer ${offer.isActive ? 'deactivated' : 'activated'} successfully`)\r\n        fetchOffers()\r\n      }\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to update special offer')\r\n    }\r\n  }\r\n\r\n  // Show full-screen form views based on subRoute\r\n  if (subRoute === 'carousel/add' || (subRoute && subRoute.startsWith('carousel/edit'))) {\r\n    return (\r\n      <CarouselFormScreen\r\n        editingCarousel={editingCarousel}\r\n        allProducts={allProducts}\r\n        productsLoading={productsLoading}\r\n        onSave={handleSaveCarousel}\r\n        onCancel={() => {\r\n          setEditingCarousel(null)\r\n          if (navigate) navigate('offers')\r\n        }}\r\n        carouselCount={carouselCount}\r\n      />\r\n    )\r\n  }\r\n\r\n  if (subRoute === 'special-offer/add' || (subRoute && subRoute.startsWith('special-offer/edit'))) {\r\n    return (\r\n      <SpecialOfferFormScreen\r\n        editingSpecialOffer={editingSpecialOffer}\r\n        allProducts={allProducts}\r\n        productsLoading={productsLoading}\r\n        onSave={handleSaveSpecialOffer}\r\n        onCancel={() => {\r\n          setEditingSpecialOffer(null)\r\n          if (navigate) navigate('offers')\r\n        }}\r\n      />\r\n    )\r\n  }\r\n\r\n  // Show list view\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">Offers Management</h1>\r\n          <p className=\"text-sm text-gray-600 mt-1\">Manage carousels and special offers for user dashboard</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <div className=\"border-b border-gray-200\">\r\n        <nav className=\"-mb-px flex space-x-8\">\r\n          <button\r\n            onClick={() => setActiveTab('carousels')}\r\n            className={cn(\r\n              'py-4 px-1 border-b-2 font-medium text-sm transition-colors',\r\n              activeTab === 'carousels'\r\n                ? 'border-blue-500 text-blue-600'\r\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n            )}\r\n          >\r\n            Carousels ({carouselCount}/6)\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('special-offers')}\r\n            className={cn(\r\n              'py-4 px-1 border-b-2 font-medium text-sm transition-colors',\r\n              activeTab === 'special-offers'\r\n                ? 'border-blue-500 text-blue-600'\r\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n            )}\r\n          >\r\n            Special Offers ({specialOffers.length})\r\n          </button>\r\n        </nav>\r\n      </div>\r\n\r\n      {/* Carousels Tab */}\r\n      {activeTab === 'carousels' && (\r\n        <div className=\"space-y-4\">\r\n          {carouselCount >= 6 && (\r\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-start gap-3\">\r\n              <AlertCircle className=\"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5\" />\r\n              <div>\r\n                <p className=\"text-sm font-medium text-yellow-800\">Maximum carousels reached</p>\r\n                <p className=\"text-sm text-yellow-700 mt-1\">\r\n                  You have reached the maximum limit of 6 active carousels. Delete or deactivate an existing carousel to add a new one.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex justify-end\">\r\n            <button\r\n              onClick={handleCreateCarousel}\r\n              disabled={carouselCount >= 6}\r\n              className={cn(\r\n                'flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-colors',\r\n                carouselCount >= 6\r\n                  ? 'bg-gray-100 text-gray-400 cursor-not-allowed'\r\n                  : 'bg-blue-600 text-white hover:bg-blue-700'\r\n              )}\r\n            >\r\n              <Plus className=\"h-4 w-4\" />\r\n              Add Carousel\r\n            </button>\r\n          </div>\r\n\r\n          {loading ? (\r\n            <div className=\"text-center py-12\">\r\n              <p className=\"text-gray-500\">Loading carousels...</p>\r\n            </div>\r\n          ) : carousels.length === 0 ? (\r\n            <div className=\"text-center py-12 bg-gray-50 rounded-lg\">\r\n              <ImageIcon className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n              <p className=\"text-gray-600 font-medium\">No carousels yet</p>\r\n              <p className=\"text-sm text-gray-500 mt-1\">Create your first carousel to display on the user dashboard</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              <p className=\"text-xs text-gray-500 mb-2 flex items-center gap-2\">\r\n                <GripVertical className=\"h-4 w-4\" />\r\n                Drag carousels to reorder them (top carousel appears first on user dashboard)\r\n              </p>\r\n              <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                {carousels\r\n                  .sort((a, b) => (a.order || 0) - (b.order || 0))\r\n                  .map((carousel, index) => {\r\n                    const isDragging = draggedCarouselIndex === index\r\n                    const isDragOver = dragOverCarouselIndex === index\r\n                    return (\r\n                      <div\r\n                        key={carousel._id || carousel.id}\r\n                        draggable\r\n                        onDragStart={(e) => handleCarouselDragStart(e, index)}\r\n                        onDragEnd={handleCarouselDragEnd}\r\n                        onDragOver={(e) => handleCarouselDragOver(e, index)}\r\n                        onDragLeave={handleCarouselDragLeave}\r\n                        onDrop={(e) => handleCarouselDrop(e, index)}\r\n                        className={cn(\r\n                          'border rounded-lg p-4 space-y-3 cursor-move transition-all',\r\n                          carousel.isActive ? 'border-gray-200 bg-white' : 'border-gray-100 bg-gray-50 opacity-75',\r\n                          isDragging && 'opacity-50 scale-95',\r\n                          isDragOver && 'ring-2 ring-blue-500 ring-offset-2 scale-105'\r\n                        )}\r\n                      >\r\n                        <div className=\"flex items-start gap-2\">\r\n                          <GripVertical className=\"h-5 w-5 text-gray-400 mt-1 flex-shrink-0\" />\r\n                          <div className=\"flex-1\">\r\n                            {carousel.image && (\r\n                              <div className=\"aspect-video rounded-lg overflow-hidden bg-gray-100\">\r\n                                <img src={carousel.image} alt={carousel.title} className=\"w-full h-full object-cover\" />\r\n                              </div>\r\n                            )}\r\n                            <div>\r\n                              <h3 className=\"font-medium text-gray-900\">{carousel.title}</h3>\r\n                              {carousel.description && (\r\n                                <p className=\"text-sm text-gray-600 mt-1 line-clamp-2\">{carousel.description}</p>\r\n                              )}\r\n                              <p className=\"text-xs text-gray-500 mt-2\">\r\n                                {carousel.productIds?.length || 0} product{carousel.productIds?.length !== 1 ? 's' : ''} linked\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between pt-2 border-t\">\r\n                          <StatusBadge status={carousel.isActive ? 'active' : 'inactive'} />\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <button\r\n                              onClick={(e) => {\r\n                                e.stopPropagation()\r\n                                handleToggleCarouselActive(carousel)\r\n                              }}\r\n                              className=\"p-1.5 hover:bg-gray-100 rounded transition-colors\"\r\n                              title={carousel.isActive ? 'Deactivate' : 'Activate'}\r\n                            >\r\n                              {carousel.isActive ? (\r\n                                <ToggleRight className=\"h-5 w-5 text-green-600\" />\r\n                              ) : (\r\n                                <ToggleLeft className=\"h-5 w-5 text-gray-400\" />\r\n                              )}\r\n                            </button>\r\n                            <button\r\n                              onClick={(e) => {\r\n                                e.stopPropagation()\r\n                                handleEditCarousel(carousel)\r\n                              }}\r\n                              className=\"p-1.5 hover:bg-gray-100 rounded transition-colors\"\r\n                              title=\"Edit\"\r\n                            >\r\n                              <Edit2 className=\"h-4 w-4 text-gray-600\" />\r\n                            </button>\r\n                            <button\r\n                              onClick={(e) => {\r\n                                e.stopPropagation()\r\n                                handleDeleteCarousel(carousel._id || carousel.id)\r\n                              }}\r\n                              className=\"p-1.5 hover:bg-red-50 rounded transition-colors\"\r\n                              title=\"Delete\"\r\n                            >\r\n                              <Trash2 className=\"h-4 w-4 text-red-600\" />\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )\r\n                  })}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Special Offers Tab */}\r\n      {activeTab === 'special-offers' && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex justify-end\">\r\n            <button\r\n              onClick={handleCreateSpecialOffer}\r\n              className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium text-sm hover:bg-blue-700 transition-colors\"\r\n            >\r\n              <Plus className=\"h-4 w-4\" />\r\n              Add Special Offer\r\n            </button>\r\n          </div>\r\n\r\n          {loading ? (\r\n            <div className=\"text-center py-12\">\r\n              <p className=\"text-gray-500\">Loading special offers...</p>\r\n            </div>\r\n          ) : specialOffers.length === 0 ? (\r\n            <div className=\"text-center py-12 bg-gray-50 rounded-lg\">\r\n              <ImageIcon className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n              <p className=\"text-gray-600 font-medium\">No special offers yet</p>\r\n              <p className=\"text-sm text-gray-500 mt-1\">Create special offers to display on the user dashboard</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n              {specialOffers.map((offer) => (\r\n                <div\r\n                  key={offer._id || offer.id}\r\n                  className={cn(\r\n                    'border rounded-lg p-4 space-y-3',\r\n                    offer.isActive ? 'border-gray-200 bg-white' : 'border-gray-100 bg-gray-50 opacity-75'\r\n                  )}\r\n                >\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-2 mb-2\">\r\n                        <span className=\"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded\">\r\n                          {offer.specialTag}\r\n                        </span>\r\n                        <span className=\"px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded\">\r\n                          {offer.specialValue}\r\n                        </span>\r\n                      </div>\r\n                      <h3 className=\"font-medium text-gray-900\">{offer.title}</h3>\r\n                      {offer.description && (\r\n                        <p className=\"text-sm text-gray-600 mt-1 line-clamp-2\">{offer.description}</p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-between pt-2 border-t\">\r\n                    <StatusBadge status={offer.isActive ? 'active' : 'inactive'} />\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <button\r\n                        onClick={() => handleToggleSpecialOfferActive(offer)}\r\n                        className=\"p-1.5 hover:bg-gray-100 rounded transition-colors\"\r\n                        title={offer.isActive ? 'Deactivate' : 'Activate'}\r\n                      >\r\n                        {offer.isActive ? (\r\n                          <ToggleRight className=\"h-5 w-5 text-green-600\" />\r\n                        ) : (\r\n                          <ToggleLeft className=\"h-5 w-5 text-gray-400\" />\r\n                        )}\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleEditSpecialOffer(offer)}\r\n                        className=\"p-1.5 hover:bg-gray-100 rounded transition-colors\"\r\n                        title=\"Edit\"\r\n                      >\r\n                        <Edit2 className=\"h-4 w-4 text-gray-600\" />\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleDeleteSpecialOffer(offer._id || offer.id)}\r\n                        className=\"p-1.5 hover:bg-red-50 rounded transition-colors\"\r\n                        title=\"Delete\"\r\n                      >\r\n                        <Trash2 className=\"h-4 w-4 text-red-600\" />\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\n// Carousel Form Screen Component\r\nfunction CarouselFormScreen({ editingCarousel, allProducts, productsLoading, onSave, onCancel, carouselCount }) {\r\n  const [form, setForm] = useState({\r\n    title: editingCarousel?.title || '',\r\n    description: editingCarousel?.description || '',\r\n    image: editingCarousel?.image || '',\r\n    productIds: editingCarousel?.productIds?.map(p => p._id || p) || [],\r\n    order: editingCarousel?.order || carouselCount || 0,\r\n    isActive: editingCarousel?.isActive !== false,\r\n  })\r\n  const [imageUrl, setImageUrl] = useState(form.image || '')\r\n  const isEditing = !!editingCarousel\r\n\r\n  useEffect(() => {\r\n    if (editingCarousel) {\r\n      setForm({\r\n        title: editingCarousel.title || '',\r\n        description: editingCarousel.description || '',\r\n        image: editingCarousel.image || '',\r\n        productIds: editingCarousel.productIds?.map(p => p._id || p) || [],\r\n        isActive: editingCarousel.isActive !== false,\r\n      })\r\n      setImageUrl(editingCarousel.image || '')\r\n    }\r\n  }, [editingCarousel])\r\n\r\n\r\n  const handleProductToggle = (productId) => {\r\n    const currentIds = form.productIds || []\r\n    if (currentIds.includes(productId)) {\r\n      setForm({ ...form, productIds: currentIds.filter(id => id !== productId) })\r\n    } else {\r\n      setForm({ ...form, productIds: [...currentIds, productId] })\r\n    }\r\n  }\r\n\r\n  const handleSave = async () => {\r\n    const success = await onSave(form)\r\n    if (success) {\r\n      // Navigation handled in onSave\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header with Back Button */}\r\n      <div>\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\r\n        >\r\n          <ArrowLeft className=\"h-4 w-4\" />\r\n          Back to Offers\r\n        </button>\r\n        <div>\r\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Offers Management</p>\r\n          <h2 className=\"text-2xl font-bold text-gray-900\">\r\n            {isEditing ? 'Edit Carousel' : 'Add New Carousel'}\r\n          </h2>\r\n          <p className=\"text-sm text-gray-600\">\r\n            {isEditing \r\n              ? 'Update carousel details, image, and linked products.'\r\n              : 'Create a new carousel with image and linked products for the user dashboard.'}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Form Container */}\r\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n        <div className=\"space-y-6\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Title *</label>\r\n            <input\r\n              type=\"text\"\r\n              value={form.title}\r\n              onChange={(e) => setForm({ ...form, title: e.target.value })}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n              placeholder=\"e.g., Seasonal Sale\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Description</label>\r\n            <textarea\r\n              value={form.description}\r\n              onChange={(e) => setForm({ ...form, description: e.target.value })}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n              rows={3}\r\n              placeholder=\"Short description for the carousel\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <CarouselImageUpload\r\n              image={imageUrl}\r\n              onChange={(url) => {\r\n                setImageUrl(url)\r\n                setForm({ ...form, image: url })\r\n              }}\r\n              disabled={false}\r\n              title={form.title}\r\n              description={form.description}\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Link Products *</label>\r\n            <p className=\"text-xs text-gray-500 mb-2\">Select products to showcase when users click this carousel</p>\r\n            {productsLoading ? (\r\n              <p className=\"text-sm text-gray-500\">Loading products...</p>\r\n            ) : (\r\n              <div className=\"border border-gray-200 rounded-lg max-h-60 overflow-y-auto p-2\">\r\n                {allProducts.length === 0 ? (\r\n                  <p className=\"text-sm text-gray-500 text-center py-4\">No products available</p>\r\n                ) : (\r\n                  <div className=\"space-y-2\">\r\n                    {allProducts.map((product) => (\r\n                      <label\r\n                        key={product._id || product.id}\r\n                        className=\"flex items-center gap-3 p-2 hover:bg-gray-50 rounded cursor-pointer\"\r\n                      >\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={form.productIds?.includes(product._id || product.id)}\r\n                          onChange={() => handleProductToggle(product._id || product.id)}\r\n                          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                        />\r\n                        <div className=\"flex-1\">\r\n                          <p className=\"text-sm font-medium text-gray-900\">{product.name}</p>\r\n                          <p className=\"text-xs text-gray-500\">â‚¹{product.priceToUser || product.price || 0}</p>\r\n                        </div>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n            {form.productIds && form.productIds.length > 0 && (\r\n              <p className=\"text-xs text-blue-600 mt-1\">{form.productIds.length} product(s) selected</p>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <input\r\n              type=\"checkbox\"\r\n              id=\"carousel-active\"\r\n              checked={form.isActive}\r\n              onChange={(e) => setForm({ ...form, isActive: e.target.checked })}\r\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n            />\r\n            <label htmlFor=\"carousel-active\" className=\"text-sm text-gray-700\">\r\n              Active (visible on user dashboard)\r\n            </label>\r\n          </div>\r\n\r\n          {/* Preview Container - Placed here before buttons */}\r\n          {imageUrl && (\r\n            <div className=\"pt-4 border-t border-gray-200\">\r\n              <p className=\"text-xs font-semibold text-gray-700 mb-2\">Preview: How it will appear on user dashboard</p>\r\n              <div className=\"relative rounded-xl border-2 border-gray-300 overflow-hidden bg-gray-50 mx-auto\" style={{ \r\n                width: '380px', \r\n                maxWidth: '100%',\r\n                height: '200px'\r\n              }}>\r\n                <img\r\n                  src={imageUrl}\r\n                  alt=\"Carousel preview\"\r\n                  className=\"w-full h-full object-cover\"\r\n                  style={{ objectPosition: 'center' }}\r\n                />\r\n                {/* Overlay gradient */}\r\n                <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent\" />\r\n                {/* Text overlay preview */}\r\n                <div className=\"absolute bottom-0 left-0 right-0 p-4 text-white z-10\">\r\n                  <h3 className=\"text-lg font-bold mb-1\" style={{ textShadow: '0 2px 8px rgba(0,0,0,0.3)' }}>\r\n                    {form.title || 'Carousel Title'}\r\n                  </h3>\r\n                  {form.description && (\r\n                    <p className=\"text-sm opacity-95\" style={{ textShadow: '0 1px 4px rgba(0,0,0,0.2)' }}>\r\n                      {form.description}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <p className=\"text-xs text-gray-500 mt-1 text-center\">\r\n                Actual carousel dimensions: 380px Ã— 200px (matches user dashboard)\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex items-center justify-end gap-3 pt-4 border-t\">\r\n            <button\r\n              onClick={onCancel}\r\n              className=\"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              onClick={handleSave}\r\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\r\n            >\r\n              <Save className=\"h-4 w-4\" />\r\n              {isEditing ? 'Update' : 'Create'} Carousel\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n// Special Offer Form Screen Component\r\nfunction SpecialOfferFormScreen({ editingSpecialOffer, allProducts, productsLoading, onSave, onCancel }) {\r\n  const [form, setForm] = useState({\r\n    title: editingSpecialOffer?.title || '',\r\n    description: editingSpecialOffer?.description || '',\r\n    specialTag: editingSpecialOffer?.specialTag || '',\r\n    specialValue: editingSpecialOffer?.specialValue || '',\r\n    linkedProductIds: editingSpecialOffer?.linkedProductIds?.map(p => p._id || p) || [],\r\n    isActive: editingSpecialOffer?.isActive !== false,\r\n  })\r\n  const isEditing = !!editingSpecialOffer\r\n\r\n  useEffect(() => {\r\n    if (editingSpecialOffer) {\r\n      setForm({\r\n        title: editingSpecialOffer.title || '',\r\n        description: editingSpecialOffer.description || '',\r\n        specialTag: editingSpecialOffer.specialTag || '',\r\n        specialValue: editingSpecialOffer.specialValue || '',\r\n        linkedProductIds: editingSpecialOffer.linkedProductIds?.map(p => p._id || p) || [],\r\n        isActive: editingSpecialOffer.isActive !== false,\r\n      })\r\n    }\r\n  }, [editingSpecialOffer])\r\n\r\n  const handleProductToggle = (productId) => {\r\n    const currentIds = form.linkedProductIds || []\r\n    if (currentIds.includes(productId)) {\r\n      setForm({ ...form, linkedProductIds: currentIds.filter(id => id !== productId) })\r\n    } else {\r\n      setForm({ ...form, linkedProductIds: [...currentIds, productId] })\r\n    }\r\n  }\r\n\r\n  const handleSave = async () => {\r\n    const success = await onSave(form)\r\n    if (success) {\r\n      // Navigation handled in onSave\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header with Back Button */}\r\n      <div>\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\r\n        >\r\n          <ArrowLeft className=\"h-4 w-4\" />\r\n          Back to Offers\r\n        </button>\r\n        <div>\r\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Offers Management</p>\r\n          <h2 className=\"text-2xl font-bold text-gray-900\">\r\n            {isEditing ? 'Edit Special Offer' : 'Add New Special Offer'}\r\n          </h2>\r\n          <p className=\"text-sm text-gray-600\">\r\n            {isEditing \r\n              ? 'Update special offer details, tags, and linked products.'\r\n              : 'Create a new special offer card for the user dashboard.'}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Form Container */}\r\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n        <div className=\"space-y-6\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Title *</label>\r\n            <input\r\n              type=\"text\"\r\n              value={form.title}\r\n              onChange={(e) => setForm({ ...form, title: e.target.value })}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n              placeholder=\"e.g., Seasonal Discount\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Description</label>\r\n            <textarea\r\n              value={form.description}\r\n              onChange={(e) => setForm({ ...form, description: e.target.value })}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n              rows={3}\r\n              placeholder=\"Short description for the offer\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Special Tag *</label>\r\n              <input\r\n                type=\"text\"\r\n                value={form.specialTag}\r\n                onChange={(e) => setForm({ ...form, specialTag: e.target.value })}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                placeholder=\"e.g., SPECIAL OFFER, NEW ARRIVAL\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Displayed as badge</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Special Value *</label>\r\n              <input\r\n                type=\"text\"\r\n                value={form.specialValue}\r\n                onChange={(e) => setForm({ ...form, specialValue: e.target.value })}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                placeholder=\"e.g., 30% OFF, FREE, NEW\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Displayed as value</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Link Products (Optional)</label>\r\n            <p className=\"text-xs text-gray-500 mb-2\">Optionally link products to this offer</p>\r\n            {productsLoading ? (\r\n              <p className=\"text-sm text-gray-500\">Loading products...</p>\r\n            ) : (\r\n              <div className=\"border border-gray-200 rounded-lg max-h-60 overflow-y-auto p-2\">\r\n                {allProducts.length === 0 ? (\r\n                  <p className=\"text-sm text-gray-500 text-center py-4\">No products available</p>\r\n                ) : (\r\n                  <div className=\"space-y-2\">\r\n                    {allProducts.map((product) => (\r\n                      <label\r\n                        key={product._id || product.id}\r\n                        className=\"flex items-center gap-3 p-2 hover:bg-gray-50 rounded cursor-pointer\"\r\n                      >\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={form.linkedProductIds?.includes(product._id || product.id)}\r\n                          onChange={() => handleProductToggle(product._id || product.id)}\r\n                          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                        />\r\n                        <div className=\"flex-1\">\r\n                          <p className=\"text-sm font-medium text-gray-900\">{product.name}</p>\r\n                          <p className=\"text-xs text-gray-500\">â‚¹{product.priceToUser || product.price || 0}</p>\r\n                        </div>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n            {form.linkedProductIds && form.linkedProductIds.length > 0 && (\r\n              <p className=\"text-xs text-blue-600 mt-1\">{form.linkedProductIds.length} product(s) selected</p>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <input\r\n              type=\"checkbox\"\r\n              id=\"special-offer-active\"\r\n              checked={form.isActive}\r\n              onChange={(e) => setForm({ ...form, isActive: e.target.checked })}\r\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n            />\r\n            <label htmlFor=\"special-offer-active\" className=\"text-sm text-gray-700\">\r\n              Active (visible on user dashboard)\r\n            </label>\r\n          </div>\r\n\r\n          {/* Preview Container - Placed here before buttons */}\r\n          {(form.title || form.specialTag || form.specialValue) && (\r\n            <div className=\"pt-4 border-t border-gray-200\">\r\n              <p className=\"text-xs font-semibold text-gray-700 mb-2\">Preview: How it will appear on user dashboard</p>\r\n              <div className=\"max-w-md mx-auto\">\r\n                <div className=\"home-deal-card\" style={{ \r\n                  padding: '1.25rem',\r\n                  borderRadius: '20px',\r\n                  border: '1px solid rgba(34, 94, 65, 0.16)',\r\n                  background: 'linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(241, 244, 236, 0.9))',\r\n                  boxShadow: '0 18px 38px -28px rgba(13, 38, 24, 0.35)',\r\n                  position: 'relative',\r\n                  overflow: 'hidden',\r\n                }}>\r\n                  {form.specialTag && (\r\n                    <div className=\"home-deal-card__badge\" style={{\r\n                      position: 'absolute',\r\n                      top: '0.75rem',\r\n                      right: '0.75rem',\r\n                      padding: '0.25rem 0.75rem',\r\n                      borderRadius: '12px',\r\n                      background: 'linear-gradient(135deg, rgba(43, 118, 79, 0.2), rgba(43, 118, 79, 0.1))',\r\n                      color: '#1b8f5b',\r\n                      fontSize: '0.65rem',\r\n                      fontWeight: '700',\r\n                      textTransform: 'uppercase',\r\n                      letterSpacing: '0.05em',\r\n                      border: '1px solid rgba(43, 118, 79, 0.2)',\r\n                    }}>\r\n                      {form.specialTag}\r\n                    </div>\r\n                  )}\r\n                  <div className=\"home-deal-card__content\" style={{ marginBottom: '0.75rem' }}>\r\n                    {form.title && (\r\n                      <h4 className=\"home-deal-card__title\" style={{\r\n                        fontSize: '1rem',\r\n                        fontWeight: '700',\r\n                        color: '#172022',\r\n                        margin: '0 0 0.5rem 0',\r\n                        lineHeight: '1.3',\r\n                      }}>\r\n                        {form.title}\r\n                      </h4>\r\n                    )}\r\n                    {form.description && (\r\n                      <p className=\"home-deal-card__description\" style={{\r\n                        fontSize: '0.875rem',\r\n                        fontWeight: '500',\r\n                        color: 'rgba(26, 42, 34, 0.65)',\r\n                        margin: '0.5rem 0 0 0',\r\n                        lineHeight: '1.4',\r\n                      }}>\r\n                        {form.description}\r\n                      </p>\r\n                    )}\r\n                    {form.specialValue && (\r\n                      <div className=\"home-deal-card__price\" style={{ marginTop: '0.75rem' }}>\r\n                        <span className=\"home-deal-card__price-current\" style={{\r\n                          fontSize: '1.25rem',\r\n                          fontWeight: '700',\r\n                          color: '#1b8f5b',\r\n                        }}>\r\n                          {form.specialValue}\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <p className=\"text-xs text-gray-500 mt-2 text-center\">\r\n                Preview shows how the special offer card will appear on the user dashboard\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex items-center justify-end gap-3 pt-4 border-t\">\r\n            <button\r\n              onClick={onCancel}\r\n              className=\"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              onClick={handleSave}\r\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\r\n            >\r\n              <Save className=\"h-4 w-4\" />\r\n              {isEditing ? 'Update' : 'Create'} Special Offer\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Operations.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'ordersState' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":31,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"ordersState"},"fix":{"range":[1364,1411],"text":""},"desc":"Remove unused variable 'ordersState'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getOrderDetails' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":43,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"getOrderDetails"},"fix":{"range":[1669,1690],"text":""},"desc":"Remove unused variable 'getOrderDetails'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\nimport { Settings, Truck, Package, Bell, Plus, Edit2, Trash2, AlertCircle, Recycle, ArrowLeft, Eye, RefreshCw, CheckCircle } from 'lucide-react'\nimport { DataTable } from '../components/DataTable'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { LogisticsSettingsForm } from '../components/LogisticsSettingsForm'\nimport { NotificationFormFullScreen } from '../components/NotificationFormFullScreen'\nimport { useAdminState } from '../context/AdminContext'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { cn } from '../../../lib/cn'\n\nconst notificationColumns = [\n  { Header: 'Title', accessor: 'title' },\n  { Header: 'Target', accessor: 'targetAudience' },\n  { Header: 'Priority', accessor: 'priority' },\n  { Header: 'Status', accessor: 'isActive' },\n  { Header: 'Created', accessor: 'createdAt' },\n  { Header: 'Actions', accessor: 'actions' },\n]\n\nconst escalationColumns = [\n  { Header: 'Order ID', accessor: 'id' },\n  { Header: 'Vendor', accessor: 'vendor' },\n  { Header: 'Order Value', accessor: 'value' },\n  { Header: 'Escalated', accessor: 'escalatedAt' },\n  { Header: 'Status', accessor: 'status' },\n  { Header: 'Actions', accessor: 'actions' },\n]\n\nexport function OperationsPage({ subRoute = null, navigate }) {\n  const { orders: ordersState } = useAdminState()\n  const {\n    getLogisticsSettings,\n    updateLogisticsSettings,\n    getEscalatedOrders,\n    fulfillOrderFromWarehouse,\n    revertEscalation,\n    getNotifications,\n    createNotification,\n    updateNotification,\n    deleteNotification,\n    updateOrderStatus,\n    getOrderDetails,\n    loading,\n  } = useAdminApi()\n  const { success, error: showError, warning: showWarning } = useToast()\n\n  const [logisticsSettings, setLogisticsSettings] = useState(null)\n  const [notifications, setNotifications] = useState([])\n  const [escalatedOrders, setEscalatedOrders] = useState([])\n  \n  // View states (replacing modals with full-screen views)\n  const [currentView, setCurrentView] = useState(null) // 'logistics', 'notification', 'escalation', 'revertEscalation', 'statusUpdate'\n  const [selectedNotification, setSelectedNotification] = useState(null)\n  const [selectedOrderForEscalation, setSelectedOrderForEscalation] = useState(null)\n  const [selectedOrderForRevert, setSelectedOrderForRevert] = useState(null)\n  const [selectedOrderForStatusUpdate, setSelectedOrderForStatusUpdate] = useState(null)\n  const [revertReason, setRevertReason] = useState('')\n  const [fulfillmentNote, setFulfillmentNote] = useState('')\n  \n  // Status update form states\n  const [selectedStatus, setSelectedStatus] = useState('')\n  const [selectedPaymentStatus, setSelectedPaymentStatus] = useState('')\n  const [statusUpdateNotes, setStatusUpdateNotes] = useState('')\n  const [isRevert, setIsRevert] = useState(false)\n\n  // Fetch data\n  const fetchData = useCallback(async () => {\n    // Fetch logistics settings\n    const logisticsResult = await getLogisticsSettings()\n    if (logisticsResult.data) {\n      setLogisticsSettings(logisticsResult.data)\n    }\n\n    // Fetch notifications\n    const notificationsResult = await getNotifications()\n    if (notificationsResult.data?.notifications) {\n      setNotifications(notificationsResult.data.notifications)\n    }\n\n    // Fetch escalated orders\n    const escalatedResult = await getEscalatedOrders()\n    if (escalatedResult.data?.orders) {\n      setEscalatedOrders(escalatedResult.data.orders)\n    }\n  }, [getLogisticsSettings, getNotifications, getEscalatedOrders])\n\n  useEffect(() => {\n    fetchData()\n  }, [fetchData])\n\n  const handleSaveLogisticsSettings = async (settings) => {\n    try {\n      const result = await updateLogisticsSettings(settings)\n      if (result.data) {\n        setCurrentView(null)\n        fetchData()\n        success('Logistics settings updated successfully!', 3000)\n        if (navigate) navigate('operations')\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to update logistics settings'\n        if (errorMessage.includes('validation') || errorMessage.includes('invalid')) {\n          showWarning(errorMessage, 5000)\n        } else {\n          showError(errorMessage, 5000)\n        }\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to update logistics settings', 5000)\n    }\n  }\n\n  const handleSaveNotification = async (notificationData) => {\n    try {\n      let result\n      if (selectedNotification) {\n        result = await updateNotification(selectedNotification.id, notificationData)\n      } else {\n        result = await createNotification(notificationData)\n      }\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedNotification(null)\n        fetchData()\n        success(selectedNotification ? 'Notification updated successfully!' : 'Notification created successfully!', 3000)\n        if (navigate) navigate('operations')\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to save notification'\n        if (errorMessage.includes('validation') || errorMessage.includes('required')) {\n          showWarning(errorMessage, 5000)\n        } else {\n          showError(errorMessage, 5000)\n        }\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to save notification', 5000)\n    }\n  }\n\n  const handleDeleteNotification = async (notificationId) => {\n    if (window.confirm('Are you sure you want to delete this notification?')) {\n      try {\n        const result = await deleteNotification(notificationId)\n        if (result.data) {\n          setCurrentView(null)\n          setSelectedNotification(null)\n          fetchData()\n          success('Notification deleted successfully!', 3000)\n          if (navigate) navigate('operations')\n        } else if (result.error) {\n          const errorMessage = result.error.message || 'Failed to delete notification'\n          showError(errorMessage, 5000)\n        }\n      } catch (error) {\n        showError(error.message || 'Failed to delete notification', 5000)\n      }\n    }\n  }\n\n  const handleFulfillFromWarehouse = async (orderId, fulfillmentData) => {\n    try {\n      const result = await fulfillOrderFromWarehouse(orderId, fulfillmentData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedOrderForEscalation(null)\n        fetchData()\n        success('Order fulfilled from warehouse successfully!', 3000)\n        if (navigate) navigate('operations')\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to fulfill order'\n        if (errorMessage.includes('stock') || errorMessage.includes('unavailable') || errorMessage.includes('cannot')) {\n          showWarning(errorMessage, 6000)\n        } else {\n          showError(errorMessage, 5000)\n        }\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to fulfill order', 5000)\n    }\n  }\n\n  const handleRevertEscalation = async () => {\n    if (!revertReason.trim()) {\n      showError('Please provide a reason for reverting the escalation')\n      return\n    }\n\n    try {\n      const result = await revertEscalation(selectedOrderForRevert.id, { reason: revertReason.trim() })\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedOrderForRevert(null)\n        setRevertReason('')\n        fetchData()\n        success('Escalation reverted successfully. Order assigned back to vendor.', 3000)\n        if (navigate) navigate('operations')\n      } else if (result.error) {\n        showError(result.error.message || 'Failed to revert escalation', 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to revert escalation', 5000)\n    }\n  }\n\n  const handleBackToList = () => {\n    setCurrentView(null)\n    setSelectedNotification(null)\n    setSelectedOrderForEscalation(null)\n    setSelectedOrderForRevert(null)\n    setSelectedOrderForStatusUpdate(null)\n    setRevertReason('')\n    setSelectedStatus('')\n    setSelectedPaymentStatus('')\n    setStatusUpdateNotes('')\n    setIsRevert(false)\n    if (navigate) navigate('operations')\n  }\n\n  const handleUpdateOrderStatus = async (orderId, updateData) => {\n    try {\n      const result = await updateOrderStatus(orderId, updateData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedOrderForStatusUpdate(null)\n        setSelectedStatus('')\n        setSelectedPaymentStatus('')\n        setStatusUpdateNotes('')\n        setIsRevert(false)\n        fetchData()\n        success(result.data.message || 'Order status updated successfully!', 3000)\n        if (navigate) navigate('operations')\n      } else if (result.error) {\n        showError(result.error.message || 'Failed to update order status', 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to update order status', 5000)\n    }\n  }\n\n  // Helper function to normalize order status\n  const normalizeOrderStatus = (status) => {\n    if (!status) return 'awaiting'\n    const normalized = status.toLowerCase()\n    if (normalized === 'fully_paid') return 'fully_paid'\n    if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n    if (normalized === 'dispatched' || normalized === 'out_for_delivery' || normalized === 'ready_for_delivery') return 'dispatched'\n    if (normalized === 'delivered') return 'delivered'\n    if (normalized === 'pending' || normalized === 'awaiting') return 'awaiting'\n    return normalized\n  }\n\n  // Helper function to get next status\n  const getNextStatus = (order) => {\n    const currentStatus = normalizeOrderStatus(order?.status)\n    const paymentPreference = order?.paymentPreference || 'partial'\n    const isAlreadyPaid = order?.paymentStatus === 'fully_paid'\n\n    if (currentStatus === 'awaiting') return 'accepted'\n    if (currentStatus === 'accepted') return 'dispatched'\n    if (currentStatus === 'dispatched') return 'delivered'\n    if (currentStatus === 'delivered' && paymentPreference !== 'full' && !isAlreadyPaid) return 'fully_paid'\n    return null\n  }\n\n  // Helper function to get status button config\n  const getStatusButtonConfig = (order) => {\n    const nextStatus = getNextStatus(order)\n    if (!nextStatus) return null\n\n    const configs = {\n      dispatched: {\n        label: 'Mark Dispatched',\n        icon: Truck,\n        className: 'border-blue-300 bg-blue-50 text-blue-700 hover:border-blue-500 hover:bg-blue-100',\n        title: 'Mark as Dispatched',\n      },\n      delivered: {\n        label: 'Mark Delivered',\n        icon: CheckCircle,\n        className: 'border-green-300 bg-green-50 text-green-700 hover:border-green-500 hover:bg-green-100',\n        title: 'Mark as Delivered',\n      },\n      fully_paid: {\n        label: 'Payment Done',\n        icon: Package,\n        className: 'border-purple-300 bg-purple-50 text-purple-700 hover:border-purple-500 hover:bg-purple-100',\n        title: 'Mark Payment as Done',\n      },\n      accepted: {\n        label: 'Mark Accepted',\n        icon: CheckCircle,\n        className: 'border-blue-300 bg-blue-50 text-blue-700 hover:border-blue-500 hover:bg-blue-100',\n        title: 'Mark as Accepted',\n      },\n    }\n\n    return configs[nextStatus]\n  }\n\n  // Handler for opening status update modal (similar to Orders screen)\n  const handleOpenStatusUpdateModal = (order) => {\n    setSelectedOrderForStatusUpdate(order)\n    // Initialize status update form state\n    const currentStatus = (order?.status || '').toLowerCase()\n    const normalizedCurrentStatus = normalizeOrderStatus(currentStatus)\n    const isInStatusUpdateGracePeriod = order?.statusUpdateGracePeriod?.isActive\n    const previousStatus = order?.statusUpdateGracePeriod?.previousStatus\n    \n    if (isInStatusUpdateGracePeriod && previousStatus) {\n      const normalizedPrevious = normalizeOrderStatus(previousStatus)\n      setSelectedStatus(normalizedPrevious)\n      setIsRevert(true)\n    } else {\n      const nextStatus = getNextStatus(order)\n      setSelectedStatus(nextStatus || normalizedCurrentStatus)\n      setIsRevert(false)\n    }\n    setSelectedPaymentStatus('')\n    setStatusUpdateNotes('')\n    setCurrentView('statusUpdate')\n  }\n\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') {\n      return value\n    }\n    if (value >= 100000) {\n      return `â‚¹${(value / 100000).toFixed(1)} L`\n    }\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  // Helper function to format status for display (replace underscores with spaces)\n  const formatStatusForDisplay = (status) => {\n    if (!status) return 'Unknown'\n    // Replace underscores with spaces and capitalize each word\n    return status\n      .split('_')\n      .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\n      .join(' ')\n  }\n\n  const notificationTableColumns = notificationColumns.map((column) => {\n    if (column.accessor === 'targetAudience') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const audience = row.targetAudience || 'all'\n          const labels = {\n            all: 'All Users',\n            sellers: 'Sellers',\n            vendors: 'Vendors',\n            users: 'Users',\n          }\n          return <span className=\"text-sm font-bold text-gray-900\">{labels[audience] || audience}</span>\n        },\n      }\n    }\n    if (column.accessor === 'priority') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const priority = row.priority || 'normal'\n          const tones = {\n            urgent: 'neutral',\n            high: 'warning',\n            normal: 'success',\n            low: 'neutral',\n          }\n          return <StatusBadge tone={tones[priority] || 'neutral'}>{priority}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'isActive') {\n      return {\n        ...column,\n        Cell: (row) => {\n          return <StatusBadge tone={row.isActive ? 'success' : 'neutral'}>{row.isActive ? 'Active' : 'Inactive'}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'actions') {\n      return {\n        ...column,\n        Cell: (row) => {\n          return (\n            <div className=\"flex items-center gap-2\">\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setSelectedNotification(row)\n                  setCurrentView('notification')\n                }}\n                className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-blue-500 hover:bg-blue-50 hover:text-blue-700\"\n                title=\"Edit notification\"\n              >\n                <Edit2 className=\"h-4 w-4\" />\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => handleDeleteNotification(row.id)}\n                className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-red-600 transition-all hover:border-red-500 hover:bg-red-50\"\n                title=\"Delete notification\"\n              >\n                <Trash2 className=\"h-4 w-4\" />\n              </button>\n            </div>\n          )\n        },\n      }\n    }\n    return column\n  })\n\n  const escalationTableColumns = escalationColumns.map((column) => {\n    if (column.accessor === 'status') {\n      return {\n        ...column,\n        Cell: (row) => {\n          // Get the raw status value\n          const rawStatus = row.status || ''\n          const currentStatus = rawStatus.toLowerCase()\n          const normalizedStatus = normalizeOrderStatus(currentStatus)\n          \n          // Explicitly check for 'rejected' status - always show as \"Awaiting\" for escalated orders\n          if (currentStatus === 'rejected' || rawStatus.toLowerCase() === 'rejected') {\n            return (\n              <div className=\"flex flex-col gap-1\">\n                <StatusBadge tone=\"warning\">Escalated</StatusBadge>\n                <span className=\"text-xs text-gray-500\">Awaiting</span>\n              </div>\n            )\n          }\n          \n          // Check if order is fulfilled (accepted or beyond)\n          const isFulfilled = normalizedStatus === 'accepted' || normalizedStatus === 'dispatched' || normalizedStatus === 'delivered' || normalizedStatus === 'fully_paid'\n          \n          if (isFulfilled) {\n            // Show the actual status for fulfilled orders\n            const displayStatus = normalizedStatus === 'accepted' ? 'Accepted' : \n                                 normalizedStatus === 'dispatched' ? 'Dispatched' :\n                                 normalizedStatus === 'delivered' ? 'Delivered' :\n                                 normalizedStatus === 'fully_paid' ? 'Fully Paid' : 'Accepted'\n            return (\n              <div className=\"flex flex-col gap-1\">\n                <StatusBadge tone=\"success\">Accepted</StatusBadge>\n                <span className=\"text-xs text-gray-500\">{displayStatus}</span>\n              </div>\n            )\n          }\n          \n          // For escalated orders not yet fulfilled (including 'awaiting', 'pending', etc.),\n          // ALWAYS show \"Awaiting\" regardless of actual status value\n          return (\n            <div className=\"flex flex-col gap-1\">\n              <StatusBadge tone=\"warning\">Escalated</StatusBadge>\n              <span className=\"text-xs text-gray-500\">Awaiting</span>\n            </div>\n          )\n        },\n      }\n    }\n    if (column.accessor === 'value') {\n      return {\n        ...column,\n        Cell: (row) => {\n          return <span className=\"text-sm font-bold text-gray-900\">{formatCurrency(row.value || row.orderValue || 0)}</span>\n        },\n      }\n    }\n    if (column.accessor === 'actions') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const currentStatus = (row.status || '').toLowerCase()\n          const normalizedStatus = normalizeOrderStatus(currentStatus)\n          const isFulfilled = normalizedStatus === 'accepted' || normalizedStatus === 'dispatched' || normalizedStatus === 'delivered' || normalizedStatus === 'fully_paid'\n          const paymentPreference = row.paymentPreference || 'partial'\n          const workflowCompleted = paymentPreference === 'partial'\n            ? normalizedStatus === 'fully_paid'\n            : normalizedStatus === 'delivered'\n          const isInStatusUpdateGracePeriod = row.statusUpdateGracePeriod?.isActive\n          const statusUpdateGracePeriodExpiresAt = row.statusUpdateGracePeriod?.expiresAt\n          const statusUpdateTimeRemaining = statusUpdateGracePeriodExpiresAt ? Math.max(0, Math.floor((new Date(statusUpdateGracePeriodExpiresAt) - new Date()) / 1000 / 60)) : 0\n          const previousStatus = row.statusUpdateGracePeriod?.previousStatus\n          const hideUpdateButton = workflowCompleted && !isInStatusUpdateGracePeriod\n          const statusButtonConfig = hideUpdateButton ? null : getStatusButtonConfig(row)\n          \n          return (\n            <div className=\"flex flex-col gap-1\">\n              {isInStatusUpdateGracePeriod && (\n                <div className=\"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded border border-blue-200\">\n                  â° {statusUpdateTimeRemaining}m to revert\n                </div>\n              )}\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    // Navigate to Orders screen to view details\n                    if (navigate) {\n                      navigate(`orders/escalated?viewOrder=${row.id}`)\n                    }\n                  }}\n                  className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-red-500 hover:bg-red-50 hover:text-red-700\"\n                  title=\"View details\"\n                >\n                  <Eye className=\"h-4 w-4\" />\n                </button>\n                {/* Show Fulfill button only if not fulfilled */}\n                {!isFulfilled && (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedOrderForEscalation(row)\n                      setFulfillmentNote('')\n                      setCurrentView('escalation')\n                    }}\n                    className=\"flex items-center gap-2 rounded-lg border border-green-300 bg-white px-3 py-2 text-sm font-bold text-green-600 transition-all hover:bg-green-50\"\n                  >\n                    <Package className=\"h-4 w-4\" />\n                    Fulfill\n                  </button>\n                )}\n                {/* Show operation buttons if fulfilled */}\n                {isFulfilled && (\n                  <>\n                    {/* Confirm Status Update button - shown during grace period */}\n                    {isInStatusUpdateGracePeriod && !workflowCompleted && (\n                      <button\n                        type=\"button\"\n                        onClick={async () => {\n                          const result = await updateOrderStatus(row.id, { finalizeGracePeriod: true })\n                          if (result.data) {\n                            fetchData()\n                            success(result.data.message || 'Status update confirmed successfully!', 3000)\n                          } else if (result.error) {\n                            showError(result.error.message || 'Failed to confirm status update', 5000)\n                          }\n                        }}\n                        className=\"flex h-8 items-center justify-center gap-1.5 rounded-lg border border-green-300 bg-green-50 px-2.5 text-xs font-semibold text-green-700 transition-all hover:border-green-500 hover:bg-green-100\"\n                        title=\"Confirm status update\"\n                      >\n                        <CheckCircle className=\"h-3.5 w-3.5\" />\n                        <span>Confirm</span>\n                      </button>\n                    )}\n                    {/* Revert button - shown during grace period */}\n                    {isInStatusUpdateGracePeriod && previousStatus && !workflowCompleted && (\n                      <button\n                        type=\"button\"\n                        onClick={() => handleOpenStatusUpdateModal(row)}\n                        className=\"flex h-8 items-center justify-center gap-1.5 rounded-lg border border-orange-300 bg-orange-50 px-2.5 text-xs font-semibold text-orange-700 transition-all hover:border-orange-500 hover:bg-orange-100\"\n                        title={`Revert to ${previousStatus}`}\n                      >\n                        <ArrowLeft className=\"h-3.5 w-3.5\" />\n                        <span>Revert</span>\n                      </button>\n                    )}\n                    {/* Update Status button - hidden when workflow completed or during grace period */}\n                    {!hideUpdateButton && !isInStatusUpdateGracePeriod && (\n                      <button\n                        type=\"button\"\n                        onClick={() => handleOpenStatusUpdateModal(row)}\n                        disabled={!statusButtonConfig}\n                        className={cn(\n                          'flex h-8 items-center justify-center gap-1.5 rounded-lg border border-blue-300 bg-blue-50 px-2.5 text-xs font-semibold text-blue-700 transition-all hover:border-blue-500 hover:bg-blue-100',\n                          !statusButtonConfig && 'opacity-50 cursor-not-allowed'\n                        )}\n                        title=\"Update order status\"\n                      >\n                        <RefreshCw className=\"h-3.5 w-3.5\" />\n                        <span>Update Status</span>\n                      </button>\n                    )}\n                  </>\n                )}\n              </div>\n            </div>\n          )\n        },\n      }\n    }\n    return column\n  })\n\n  // Handle sub-routes\n  useEffect(() => {\n    if (subRoute === 'notifications/add') {\n      setSelectedNotification(null)\n      setCurrentView('notification')\n    } else if (subRoute === 'delivery-timeline/update') {\n      setCurrentView('logistics')\n    } else if (subRoute === null || subRoute === '') {\n      setCurrentView(null)\n    }\n  }, [subRoute])\n\n  // Show full-screen views (replacing modals)\n  if (currentView === 'logistics') {\n    return (\n      <LogisticsSettingsForm\n        settings={logisticsSettings}\n        onSave={handleSaveLogisticsSettings}\n        onCancel={handleBackToList}\n        loading={loading}\n      />\n    )\n  }\n\n  if (currentView === 'notification') {\n    return (\n      <NotificationFormFullScreen\n        notification={selectedNotification}\n        onSave={handleSaveNotification}\n        onDelete={handleDeleteNotification}\n        onCancel={handleBackToList}\n        loading={loading}\n      />\n    )\n  }\n\n  if (currentView === 'escalation' && selectedOrderForEscalation) {\n    const order = selectedOrderForEscalation\n\n    const handleFulfill = () => {\n      handleFulfillFromWarehouse(order.id, {\n        note: fulfillmentNote.trim() || 'Order fulfilled from master warehouse',\n      })\n    }\n\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Operations\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 8 â€¢ Operational Controls</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Order Escalation - Manual Fulfillment</h2>\n            <p className=\"text-sm text-gray-600\">\n              Fulfill escalated order from master warehouse.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-6\">\n            {/* Order Info */}\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n              <div className=\"mb-3 flex items-center gap-2\">\n                <Package className=\"h-5 w-5 text-gray-600\" />\n                <p className=\"text-sm font-bold text-gray-900\">Order #{order.orderNumber || order.id}</p>\n              </div>\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-600\">Vendor:</span>\n                  <span className=\"font-bold text-gray-900\">{order.vendor || 'N/A'}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-600\">Order Value:</span>\n                  <span className=\"font-bold text-gray-900\">\n                    {formatCurrency(order.value || order.orderValue || 0)}\n                  </span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-600\">Status:</span>\n                  <StatusBadge tone=\"warning\">Vendor Not Available</StatusBadge>\n                </div>\n              </div>\n            </div>\n\n            {/* Escalation Reason */}\n            <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-4\">\n              <div className=\"flex items-start gap-3\">\n                <AlertCircle className=\"h-5 w-5 flex-shrink-0 text-orange-600\" />\n                <div>\n                  <p className=\"text-sm font-bold text-orange-900\">Escalation Reason</p>\n                  <p className=\"mt-1 text-xs text-orange-700\">\n                    {order.escalationReason || order.escalation?.escalationReason || order.notes || 'Vendor marked this order as \"Not Available\". You can manually fulfill this order from the master warehouse.'}\n                  </p>\n                  {order.escalation?.escalatedAt && (\n                    <p className=\"mt-2 text-xs text-orange-600\">\n                      Escalated on: {new Date(order.escalation.escalatedAt).toLocaleString('en-IN')}\n                    </p>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            {/* Order Items */}\n            {order.items && order.items.length > 0 && (\n              <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n                <p className=\"mb-3 text-sm font-bold text-gray-900\">Order Items</p>\n                <div className=\"space-y-2\">\n                  {order.items.map((item, index) => {\n                    const itemId = item._id || item.id || index\n                    const productName = item.productName || item.productId?.name || item.name || item.product || 'Unknown Product'\n                    const quantity = item.quantity || 1\n                    const unitPrice = item.unitPrice || item.price || item.amount || 0\n                    const totalPrice = item.totalPrice || (unitPrice * quantity)\n                    \n                    return (\n                      <div key={itemId} className=\"flex items-center justify-between rounded-lg border border-gray-200 bg-gray-50 p-2\">\n                        <div>\n                          <p className=\"text-sm font-bold text-gray-900\">{productName}</p>\n                          <p className=\"text-xs text-gray-600\">Qty: {quantity} {item.unit || 'units'}</p>\n                        </div>\n                        <p className=\"text-sm font-bold text-gray-900\">\n                          {formatCurrency(totalPrice)}\n                        </p>\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n\n            {/* Fulfillment Note */}\n            <div>\n              <label htmlFor=\"fulfillmentNote\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Fulfillment Note (Optional)\n              </label>\n              <textarea\n                id=\"fulfillmentNote\"\n                value={fulfillmentNote}\n                onChange={(e) => setFulfillmentNote(e.target.value)}\n                placeholder=\"Add any notes about this fulfillment...\"\n                rows={3}\n                className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\n              />\n            </div>\n\n            {/* Info Box */}\n            <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n              <div className=\"flex items-start gap-3\">\n                <Package className=\"h-5 w-5 flex-shrink-0 text-blue-600\" />\n                <div className=\"text-xs text-blue-900\">\n                  <p className=\"font-bold\">Master Warehouse Fulfillment</p>\n                  <ul className=\"mt-2 space-y-1 list-disc list-inside\">\n                    <li>Order will be fulfilled from master warehouse inventory</li>\n                    <li>Vendor will be notified of the fulfillment</li>\n                    <li>Order status will be updated to \"Accepted\"</li>\n                    <li>You can then update status: Dispatched â†’ Delivered â†’ Fully Paid (if partial payment)</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                disabled={loading}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleFulfill}\n                disabled={loading}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <Package className=\"h-4 w-4\" />\n                {loading ? 'Fulfilling...' : 'Fulfill from Warehouse'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'revertEscalation' && selectedOrderForRevert) {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Operations\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 8 â€¢ Operational Controls</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Revert Escalation</h2>\n            <p className=\"text-sm text-gray-600\">\n              Revert escalated order back to vendor.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-4\">\n            <div className=\"rounded-lg border border-orange-200 bg-orange-50 p-3\">\n              <p className=\"text-sm font-semibold text-orange-900\">Order #{selectedOrderForRevert.orderNumber}</p>\n              <p className=\"text-xs text-orange-700 mt-1\">\n                Vendor: {selectedOrderForRevert.vendor || 'N/A'} | Value: {formatCurrency(selectedOrderForRevert.value || 0)}\n              </p>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">\n                Reason for Reverting <span className=\"text-red-500\">*</span>\n              </label>\n              <textarea\n                value={revertReason}\n                onChange={(e) => setRevertReason(e.target.value)}\n                placeholder=\"Why are you reverting this escalation back to the vendor?\"\n                rows={4}\n                className=\"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-500/50\"\n              />\n            </div>\n\n            <div className=\"rounded-lg border border-blue-200 bg-blue-50 p-3\">\n              <div className=\"flex items-start gap-2\">\n                <AlertCircle className=\"h-4 w-4 text-blue-600 flex-shrink-0 mt-0.5\" />\n                <p className=\"text-xs text-blue-900\">\n                  This order will be assigned back to the original vendor. The vendor will receive a notification and can proceed with fulfillment.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex gap-3 pt-4 border-t border-gray-200\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                disabled={loading}\n                className=\"flex-1 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-semibold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleRevertEscalation}\n                disabled={loading || !revertReason.trim()}\n                className=\"flex-1 flex items-center justify-center gap-2 rounded-lg bg-gradient-to-r from-orange-500 to-orange-600 px-4 py-2.5 text-sm font-semibold text-white shadow-lg transition-all hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {loading ? (\n                  'Reverting...'\n                ) : (\n                  <>\n                    <Recycle className=\"h-4 w-4\" />\n                    Revert to Vendor\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Status Update View\n  if (currentView === 'statusUpdate' && selectedOrderForStatusUpdate) {\n    const order = selectedOrderForStatusUpdate\n    const currentStatus = (order?.status || '').toLowerCase()\n    const currentPaymentStatus = order?.paymentStatus || 'pending'\n    const isPaid = currentPaymentStatus === 'fully_paid'\n    const isInStatusUpdateGracePeriod = order?.statusUpdateGracePeriod?.isActive\n    const statusUpdateGracePeriodExpiresAt = order?.statusUpdateGracePeriod?.expiresAt\n    const statusUpdateTimeRemaining = statusUpdateGracePeriodExpiresAt \n      ? Math.max(0, Math.floor((new Date(statusUpdateGracePeriodExpiresAt) - new Date()) / 1000 / 60)) \n      : 0\n    const previousStatus = order?.statusUpdateGracePeriod?.previousStatus\n    const normalizedCurrentStatus = normalizeOrderStatus(currentStatus)\n\n    const ORDER_STATUS_OPTIONS = [\n      { value: 'accepted', label: 'Accepted', description: 'Order has been accepted and is ready for dispatch' },\n      { value: 'dispatched', label: 'Dispatched', description: 'Order has been dispatched for delivery' },\n      { value: 'delivered', label: 'Delivered', description: 'Order has been delivered' },\n    ]\n\n    const PAYMENT_STATUS_OPTIONS = [\n      { value: 'fully_paid', label: 'Mark Payment as Done', description: 'Mark order payment as fully paid' },\n    ]\n\n    // Get payment preference from order\n    const paymentPreference = order?.paymentPreference || 'partial'\n    const isFullPayment = paymentPreference === 'full'\n\n    const normalizeStatusForDisplay = (status) => {\n      const normalized = (status || '').toLowerCase()\n      if (normalized === 'fully_paid') return 'delivered'\n      if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n      if (normalized === 'dispatched' || normalized === 'out_for_delivery' || normalized === 'ready_for_delivery') return 'dispatched'\n      if (normalized === 'delivered') return 'delivered'\n      return 'accepted'\n    }\n\n    const getAvailableStatusOptions = () => {\n      const options = []\n      if (isInStatusUpdateGracePeriod && previousStatus) {\n        const normalizedPrevious = normalizeStatusForDisplay(previousStatus)\n        const option = ORDER_STATUS_OPTIONS.find(opt => opt.value === normalizedPrevious)\n        if (option) {\n          return [{ value: normalizedPrevious, label: `Revert to ${option.label}`, description: 'Revert to previous status' }]\n        }\n      }\n      const statusFlow = ['accepted', 'dispatched', 'delivered']\n      const currentIndex = statusFlow.indexOf(normalizedCurrentStatus)\n      if (currentIndex >= 0) {\n        const currentOption = ORDER_STATUS_OPTIONS.find(opt => opt.value === statusFlow[currentIndex])\n        if (currentOption) options.push(currentOption)\n        const nextIndex = currentIndex + 1\n        if (nextIndex < statusFlow.length) {\n          const nextOption = ORDER_STATUS_OPTIONS.find(opt => opt.value === statusFlow[nextIndex])\n          if (nextOption) options.push(nextOption)\n        }\n      } else {\n        options.push(...ORDER_STATUS_OPTIONS)\n      }\n      return options\n    }\n\n    const handleStatusUpdateSubmit = () => {\n      if (!selectedStatus && !selectedPaymentStatus) return\n      const backendStatus = selectedPaymentStatus === 'fully_paid' \n        ? 'fully_paid' \n        : selectedStatus\n      const updateData = {\n        status: backendStatus,\n        notes: statusUpdateNotes.trim() || undefined,\n        isRevert: isRevert,\n      }\n      handleUpdateOrderStatus(order.id, updateData)\n    }\n\n    const canUpdate = () => {\n      if (isInStatusUpdateGracePeriod && previousStatus) {\n        const normalizedPrevious = normalizeStatusForDisplay(previousStatus)\n        return selectedStatus === normalizedPrevious\n      }\n      return selectedStatus || selectedPaymentStatus\n    }\n\n    const availableStatusOptions = getAvailableStatusOptions()\n    // Show payment option only if:\n    // 1. Order is delivered\n    // 2. Payment is not already fully paid\n    // 3. Payment preference is partial (not full payment)\n    const showPaymentOption = currentStatus === 'delivered' && !isPaid && !isFullPayment\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-blue-500 hover:bg-blue-50 hover:text-blue-700\"\n            title=\"Back to Operations\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">{isRevert ? 'Revert Current Status' : 'Update Order Status'}</h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <div className=\"space-y-6\">\n            {/* Order Info */}\n            {order && (\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                <div className=\"mb-3 flex items-center gap-2\">\n                  <AlertCircle className=\"h-5 w-5 text-blue-600\" />\n                  <p className=\"text-sm font-bold text-gray-900\">Order #{order.orderNumber || order.id}</p>\n                </div>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-600\">Current Status:</span>\n                    <span className=\"font-bold text-gray-900 capitalize\">{availableStatusOptions.find(opt => opt.value === normalizedCurrentStatus)?.label || normalizedCurrentStatus || 'Unknown'}</span>\n                  </div>\n                  {!isInStatusUpdateGracePeriod && (\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-600\">Next Status:</span>\n                      <span className=\"font-bold text-blue-600 capitalize\">\n                        {(() => {\n                          const nextStatus = getNextStatus(order)\n                          if (nextStatus) {\n                            const nextOption = ORDER_STATUS_OPTIONS.find(opt => opt.value === nextStatus)\n                            return nextOption?.label || nextStatus\n                          }\n                          if (normalizedCurrentStatus === 'delivered' && !isPaid && !isFullPayment) {\n                            return 'Fully Paid'\n                          }\n                          return 'N/A'\n                        })()}\n                      </span>\n                    </div>\n                  )}\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-600\">Payment Status:</span>\n                    <span className=\"font-bold text-gray-900 capitalize\">\n                      {isPaid ? 'Paid' : currentPaymentStatus === 'partial_paid' ? 'Partial Paid' : 'Pending'}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-600\">Payment Type:</span>\n                    <span className=\"font-bold text-gray-900 capitalize\">\n                      {isFullPayment ? 'Full Payment (100%)' : 'Partial Payment (30% advance, 70% after delivery)'}\n                    </span>\n                  </div>\n                  {order.value && (\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-600\">Order Value:</span>\n                      <span className=\"font-bold text-gray-900\">\n                        {typeof order.value === 'number'\n                          ? formatCurrency(order.value)\n                          : order.value || 'N/A'}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n\n            {/* Grace Period Notice */}\n            {isInStatusUpdateGracePeriod && (\n              <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n                <div className=\"flex items-start gap-3\">\n                  <AlertCircle className=\"h-5 w-5 flex-shrink-0 text-blue-600\" />\n                  <div className=\"text-sm text-blue-900\">\n                    <p className=\"font-bold\">Status Update Grace Period Active</p>\n                    <p className=\"mt-1\">\n                      You have {statusUpdateTimeRemaining} minutes remaining to revert to \"{formatStatusForDisplay(previousStatus)}\" status.\n                      After this period, the current status will be finalized.\n                    </p>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Status Selection */}\n            {(!isPaid || isInStatusUpdateGracePeriod) && (\n              <div>\n                <label htmlFor=\"status\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                  Order Status <span className=\"text-red-500\">*</span>\n                </label>\n                <select\n                  id=\"status\"\n                  value={selectedStatus}\n                  onChange={(e) => {\n                    setSelectedStatus(e.target.value)\n                    setIsRevert(false)\n                  }}\n                  disabled={isInStatusUpdateGracePeriod && previousStatus}\n                  className={cn(\n                    'w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50',\n                    isInStatusUpdateGracePeriod && previousStatus && 'bg-gray-100 cursor-not-allowed'\n                  )}\n                >\n                  <option value=\"\">Select status...</option>\n                  {availableStatusOptions.map((option) => (\n                    <option key={option.value} value={option.value}>\n                      {option.label}\n                    </option>\n                  ))}\n                </select>\n                {selectedStatus && (\n                  <p className=\"mt-2 text-xs text-gray-600\">\n                    {availableStatusOptions.find(opt => opt.value === selectedStatus)?.description}\n                  </p>\n                )}\n              </div>\n            )}\n\n            {/* Payment Status Selection */}\n            {showPaymentOption && !isPaid && (\n              <div>\n                <label htmlFor=\"paymentStatus\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                  Payment Status\n                </label>\n                <select\n                  id=\"paymentStatus\"\n                  value={selectedPaymentStatus}\n                  onChange={(e) => setSelectedPaymentStatus(e.target.value)}\n                  className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n                >\n                  <option value=\"\">Select payment status...</option>\n                  {PAYMENT_STATUS_OPTIONS.map((option) => (\n                    <option key={option.value} value={option.value}>\n                      {option.label}\n                    </option>\n                  ))}\n                </select>\n                {selectedPaymentStatus && (\n                  <p className=\"mt-2 text-xs text-gray-600\">\n                    {PAYMENT_STATUS_OPTIONS.find(opt => opt.value === selectedPaymentStatus)?.description}\n                  </p>\n                )}\n              </div>\n            )}\n\n            {/* Notes */}\n            <div>\n              <label htmlFor=\"notes\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Notes (Optional)\n              </label>\n              <textarea\n                id=\"notes\"\n                value={statusUpdateNotes}\n                onChange={(e) => setStatusUpdateNotes(e.target.value)}\n                placeholder=\"Add any notes about this status update...\"\n                rows={3}\n                className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\n              />\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                disabled={loading}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleStatusUpdateSubmit}\n                disabled={loading || !canUpdate()}\n                className={cn(\n                  'flex items-center gap-2 rounded-xl px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(59,130,246,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(59,130,246,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50',\n                  isRevert ? 'bg-gradient-to-r from-orange-500 to-orange-600 shadow-[0_4px_15px_rgba(249,115,22,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] hover:shadow-[0_6px_20px_rgba(249,115,22,0.4),inset_0_1px_0_rgba(255,255,255,0.2)]' : 'bg-gradient-to-r from-blue-500 to-blue-600'\n                )}\n              >\n                {loading ? (\n                  <>\n                    <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                    Updating...\n                  </>\n                ) : isRevert ? (\n                  <>\n                    <ArrowLeft className=\"h-4 w-4\" />\n                    Confirm Revert\n                  </>\n                ) : (\n                  <>\n                    <RefreshCw className=\"h-4 w-4\" />\n                    Update Status\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Show main Operations page (default)\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 8 â€¢ Operational Controls</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Operations & Settings</h2>\n          <p className=\"text-sm text-gray-600\">\n            Manage logistics settings, handle order escalations, and control platform notifications.\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={() => {\n              if (navigate) navigate('operations/delivery-timeline/update')\n              else setCurrentView('logistics')\n            }}\n            className=\"inline-flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm text-gray-700 font-semibold shadow-[0_2px_8px_rgba(0,0,0,0.05),inset_0_1px_0_rgba(255,255,255,0.8)] transition hover:border-blue-300 hover:bg-blue-50 hover:text-blue-700\"\n          >\n            <Truck className=\"h-4 w-4\" />\n            Delivery Settings\n          </button>\n          <button\n            onClick={() => {\n              setSelectedNotification(null)\n              if (navigate) navigate('operations/notifications/add')\n              else setCurrentView('notification')\n            }}\n            className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(59,130,246,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all duration-200 hover:shadow-[0_6px_20px_rgba(59,130,246,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] hover:scale-105\"\n          >\n            <Plus className=\"h-4 w-4\" />\n            New Notification\n          </button>\n        </div>\n      </header>\n\n      {/* Logistics Settings Summary */}\n      <div className=\"rounded-3xl border border-blue-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n        <div className=\"mb-4 flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <Truck className=\"h-5 w-5 text-blue-600\" />\n            <div>\n              <h3 className=\"text-lg font-bold text-blue-700\">Logistics & Delivery Settings</h3>\n              <p className=\"text-sm text-gray-600\">Configure delivery timelines shown to users</p>\n            </div>\n          </div>\n          <button\n            onClick={() => {\n              if (navigate) navigate('operations/delivery-timeline/update')\n              else setCurrentView('logistics')\n            }}\n            className=\"rounded-lg border border-blue-300 bg-white px-4 py-2 text-sm font-bold text-blue-600 transition-all hover:bg-blue-50\"\n          >\n            Configure\n          </button>\n        </div>\n        {logisticsSettings && (\n          <div className=\"grid gap-4 sm:grid-cols-3\">\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n              <p className=\"text-xs text-gray-500 mb-1\">Default Delivery</p>\n              <p className=\"text-lg font-bold text-gray-900\">\n                {logisticsSettings.defaultDeliveryTime === '3h' ? '3 Hours' : \n                 logisticsSettings.defaultDeliveryTime === '4h' ? '4 Hours' : '1 Day'}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n              <p className=\"text-xs text-gray-500 mb-1\">Available Options</p>\n              <p className=\"text-lg font-bold text-gray-900\">\n                {logisticsSettings.availableDeliveryOptions?.length || 0} options\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n              <p className=\"text-xs text-gray-500 mb-1\">Status</p>\n              <StatusBadge tone=\"success\">Active</StatusBadge>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Escalated Orders */}\n      {escalatedOrders.length > 0 && (\n        <div className=\"rounded-3xl border border-orange-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"mb-4 flex items-center gap-3\">\n            <AlertCircle className=\"h-5 w-5 text-orange-600\" />\n            <div>\n              <h3 className=\"text-lg font-bold text-orange-700\">Escalated Orders</h3>\n              <p className=\"text-sm text-gray-600\">Orders marked as \"Not Available\" by vendors</p>\n            </div>\n          </div>\n          <DataTable\n            columns={escalationTableColumns}\n            rows={escalatedOrders}\n            emptyState=\"No escalated orders\"\n          />\n        </div>\n      )}\n\n      {/* Notifications */}\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n        <div className=\"mb-4 flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <Bell className=\"h-5 w-5 text-gray-600\" />\n            <div>\n              <h3 className=\"text-lg font-bold text-gray-900\">Platform Notifications</h3>\n              <p className=\"text-sm text-gray-600\">Manage announcements and policy updates</p>\n            </div>\n          </div>\n        </div>\n        <DataTable\n          columns={notificationTableColumns}\n          rows={notifications}\n          emptyState=\"No notifications created yet\"\n        />\n      </div>\n\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Orders.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'vendors' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":32,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"vendors"},"fix":{"range":[1577,1586],"text":""},"desc":"Remove unused variable 'vendors'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'advanceAmount' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":93,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":93,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'handleProcessRefund' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":290,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":290,"endColumn":28}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\nimport { CalendarRange, Recycle, Truck, Eye, FileText, RefreshCw, AlertCircle, Warehouse, ArrowLeft, CheckCircle, CreditCard, Package, IndianRupee, Calendar, Download, Building2, MapPin, MoreVertical } from 'lucide-react'\nimport { DataTable } from '../components/DataTable'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { FilterBar } from '../components/FilterBar'\nimport { Timeline } from '../components/Timeline'\nimport { useAdminState } from '../context/AdminContext'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { orders as mockOrders } from '../services/adminData'\nimport { cn } from '../../../lib/cn'\n\nconst columns = [\n  { Header: 'Order ID', accessor: 'id' },\n  { Header: 'User', accessor: 'userName' },\n  { Header: 'User Location', accessor: 'userLocation' },\n  { Header: 'Vendor', accessor: 'vendor' },\n  { Header: 'Vendor Location', accessor: 'vendorLocation' },\n  { Header: 'Order Value', accessor: 'value' },\n  { Header: 'Advance (30%)', accessor: 'advance' },\n  { Header: 'Pending (70%)', accessor: 'pending' },\n  { Header: 'Status', accessor: 'status' },\n  { Header: 'Actions', accessor: 'actions' },\n]\n\n\nconst REGIONS = ['All', 'West', 'North', 'South', 'Central', 'North East', 'East']\nconst ORDER_STATUSES = ['All', 'Processing', 'Awaiting Dispatch', 'Completed', 'Cancelled']\nconst ORDER_TYPES = ['All', 'User', 'Vendor']\n\nexport function OrdersPage({ subRoute = null, navigate }) {\n  const { orders: ordersState, vendors } = useAdminState()\n  const {\n    getOrders,\n    getOrderDetails,\n    reassignOrder,\n    generateInvoice,\n    getVendors,\n    revertEscalation,\n    fulfillOrderFromWarehouse,\n    updateOrderStatus,\n    loading,\n  } = useAdminApi()\n  const { success, error: showError, warning: showWarning } = useToast()\n\n  const [ordersList, setOrdersList] = useState([])\n  const [allOrdersList, setAllOrdersList] = useState([])\n  const [availableVendors, setAvailableVendors] = useState([])\n  \n  // Filter states\n  const [filters, setFilters] = useState({\n    region: 'All',\n    vendor: 'All',\n    status: 'All',\n    type: 'All',\n    dateFrom: '',\n    dateTo: '',\n  })\n\n  // View states (replacing modals with full-screen views)\n  const [currentView, setCurrentView] = useState(null) // 'orderDetail', 'reassign', 'escalation', 'statusUpdate', 'revertEscalation'\n  const [selectedOrderForDetail, setSelectedOrderForDetail] = useState(null)\n  const [orderDetails, setOrderDetails] = useState(null)\n  const [selectedOrderForReassign, setSelectedOrderForReassign] = useState(null)\n  const [selectedOrderForEscalation, setSelectedOrderForEscalation] = useState(null)\n  const [selectedOrderForRevert, setSelectedOrderForRevert] = useState(null)\n  const [revertReason, setRevertReason] = useState('')\n  const [selectedOrderForStatusUpdate, setSelectedOrderForStatusUpdate] = useState(null)\n  \n  // Reassignment form states\n  const [selectedVendorId, setSelectedVendorId] = useState('')\n  const [reassignReason, setReassignReason] = useState('')\n  const [reassignErrors, setReassignErrors] = useState({})\n  \n  // Escalation form states\n  const [fulfillmentNote, setFulfillmentNote] = useState('')\n  \n  // Status update form states\n  const [selectedStatus, setSelectedStatus] = useState('')\n  const [selectedPaymentStatus, setSelectedPaymentStatus] = useState('')\n  const [statusUpdateNotes, setStatusUpdateNotes] = useState('')\n  const [isRevert, setIsRevert] = useState(false)\n  \n  // Dropdown state for actions menu\n  const [openActionsDropdown, setOpenActionsDropdown] = useState(null)\n\n  // Format order data for display\n  const formatOrderForDisplay = (order) => {\n    const orderValue = typeof order.value === 'number'\n      ? order.value\n      : parseFloat(order.value?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n\n    const advanceAmount = typeof order.advance === 'number'\n      ? order.advance\n      : order.advanceStatus === 'paid' ? orderValue * 0.3 : 0\n\n    const pendingAmount = typeof order.pending === 'number'\n      ? order.pending\n      : parseFloat(order.pending?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n\n    return {\n      ...order,\n      value: orderValue >= 100000 ? `â‚¹${(orderValue / 100000).toFixed(1)} L` : `â‚¹${orderValue.toLocaleString('en-IN')}`,\n      advance: order.advanceStatus === 'paid' || order.advance === 'Paid' ? 'Paid' : 'Pending',\n      pending: pendingAmount >= 100000 ? `â‚¹${(pendingAmount / 100000).toFixed(1)} L` : `â‚¹${pendingAmount.toLocaleString('en-IN')}`,\n      paymentStatus: order.paymentStatus || 'pending',\n      isPaid: order.paymentStatus === 'fully_paid',\n      statusUpdateGracePeriod: order.statusUpdateGracePeriod || null,\n    }\n  }\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (openActionsDropdown && !event.target.closest('.relative')) {\n        setOpenActionsDropdown(null)\n      }\n    }\n    \n    if (openActionsDropdown) {\n      document.addEventListener('mousedown', handleClickOutside)\n      return () => {\n        document.removeEventListener('mousedown', handleClickOutside)\n      }\n    }\n  }, [openActionsDropdown])\n\n  // Fetch orders\n  const fetchOrders = useCallback(async () => {\n    const params = {}\n    if (filters.region !== 'All') params.region = filters.region\n    if (filters.vendor !== 'All') params.vendorId = filters.vendor\n    if (filters.status !== 'All') params.status = filters.status.toLowerCase().replace(' ', '_')\n    if (filters.type !== 'All') params.type = filters.type.toLowerCase()\n    if (filters.dateFrom) params.dateFrom = filters.dateFrom\n    if (filters.dateTo) params.dateTo = filters.dateTo\n\n    const result = await getOrders(params)\n    if (result.data?.orders) {\n      const formatted = result.data.orders.map(formatOrderForDisplay)\n      setAllOrdersList(formatted)\n    } else {\n      // Fallback to mock data\n      const formatted = mockOrders.map(formatOrderForDisplay)\n      setAllOrdersList(formatted)\n    }\n  }, [getOrders, filters])\n\n  // Filter orders based on subRoute\n  useEffect(() => {\n    if (subRoute === 'escalated') {\n      setOrdersList(allOrdersList.filter((o) => {\n        const originalOrder = ordersState.data?.orders?.find((ord) => ord.id === o.id) || o\n        return originalOrder.escalated || originalOrder.assignedTo === 'admin'\n      }))\n    } else if (subRoute === 'processing') {\n      // Processing orders: accepted but not delivered\n      setOrdersList(allOrdersList.filter((o) => {\n        const status = (o.status || '').toLowerCase()\n        return (status === 'processing' || status === 'accepted' || status === 'awaiting dispatch' || status === 'dispatched') && \n               status !== 'delivered' && status !== 'completed' && status !== 'fully_paid'\n      }))\n    } else if (subRoute === 'completed') {\n      // Completed: delivered and fully paid\n      setOrdersList(allOrdersList.filter((o) => {\n        const originalOrder = ordersState.data?.orders?.find((ord) => ord.id === o.id) || o\n        const status = (o.status || '').toLowerCase()\n        const isPaid = o.isPaid || originalOrder.paymentStatus === 'fully_paid'\n        return (status === 'delivered' || status === 'completed') && isPaid\n      }))\n    } else {\n      setOrdersList(allOrdersList)\n    }\n  }, [subRoute, allOrdersList, ordersState.data?.orders])\n\n  // Fetch vendors for reassignment\n  const fetchVendors = useCallback(async () => {\n    const result = await getVendors()\n    if (result.data?.vendors) {\n      setAvailableVendors(result.data.vendors)\n    }\n  }, [getVendors])\n\n  useEffect(() => {\n    fetchOrders()\n    fetchVendors()\n  }, [fetchOrders, fetchVendors])\n\n  // Refresh when orders are updated\n  useEffect(() => {\n    if (ordersState.updated) {\n      fetchOrders()\n    }\n  }, [ordersState.updated, fetchOrders])\n\n  const handleFilterChange = (filter) => {\n    // This would open a dropdown/modal for filter selection\n    // For now, we'll toggle the active state\n    setFilters((prev) => ({\n      ...prev,\n      [filter.id]: prev[filter.id] === filter.label ? 'All' : filter.label,\n    }))\n  }\n\n  const handleViewOrderDetails = async (order) => {\n    const originalOrder = ordersState.data?.orders?.find((o) => o.id === order.id) || order\n    setSelectedOrderForDetail(originalOrder)\n    \n    // Fetch detailed order data\n    const result = await getOrderDetails(order.id)\n    if (result.data) {\n      setOrderDetails(result.data)\n    }\n    \n    setCurrentView('orderDetail')\n  }\n\n  const handleReassignOrder = (order) => {\n    const originalOrder = ordersState.data?.orders?.find((o) => o.id === order.id) || order\n    setSelectedOrderForReassign(originalOrder)\n    setSelectedVendorId('')\n    setReassignReason('')\n    setReassignErrors({})\n    setCurrentView('reassign')\n  }\n\n  const handleBackToList = () => {\n    setCurrentView(null)\n    setSelectedOrderForDetail(null)\n    setOrderDetails(null)\n    setSelectedOrderForReassign(null)\n    setSelectedOrderForEscalation(null)\n    setSelectedOrderForRevert(null)\n    setRevertReason('')\n    setSelectedOrderForStatusUpdate(null)\n    setSelectedVendorId('')\n    setReassignReason('')\n    setReassignErrors({})\n    setFulfillmentNote('')\n    setSelectedStatus('')\n    setSelectedPaymentStatus('')\n    setStatusUpdateNotes('')\n    setIsRevert(false)\n    if (navigate) navigate('orders')\n  }\n\n  const handleReassignSubmit = async (orderId, reassignData) => {\n    try {\n      const result = await reassignOrder(orderId, reassignData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedOrderForReassign(null)\n        setSelectedVendorId('')\n        setReassignReason('')\n        setReassignErrors({})\n        fetchOrders()\n        success('Order reassigned successfully!', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to reassign order'\n        if (errorMessage.includes('vendor') || errorMessage.includes('unavailable') || errorMessage.includes('stock')) {\n          showWarning(errorMessage, 6000)\n        } else {\n          showError(errorMessage, 5000)\n        }\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to reassign order', 5000)\n    }\n  }\n\n  const handleGenerateInvoice = async (orderId) => {\n    try {\n      const result = await generateInvoice(orderId)\n      if (result.data) {\n        // Invoice is automatically downloaded and opened for printing\n        success(result.data.message || 'Invoice generated successfully! Use browser print (Ctrl+P) to save as PDF.', 5000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to generate invoice'\n        if (errorMessage.includes('not found') || errorMessage.includes('cannot')) {\n          showWarning(errorMessage, 6000)\n        } else {\n          showError(errorMessage, 5000)\n        }\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to generate invoice', 5000)\n    }\n  }\n\n  const handleProcessRefund = async (orderId) => {\n    const confirmed = window.confirm('Are you sure you want to process this refund?')\n    if (confirmed) {\n      // This would call a refund API\n      console.log('Processing refund for order:', orderId)\n      alert('Refund processed successfully')\n      fetchOrders()\n    }\n  }\n\n  const handleRevertEscalation = async () => {\n    if (!revertReason.trim()) {\n      showError('Please provide a reason for reverting the escalation')\n      return\n    }\n\n    try {\n      const result = await revertEscalation(selectedOrderForRevert.id, { reason: revertReason.trim() })\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedOrderForRevert(null)\n        setRevertReason('')\n        fetchOrders()\n        success('Escalation reverted successfully. Order assigned back to vendor.', 3000)\n      } else if (result.error) {\n        showError(result.error.message || 'Failed to revert escalation', 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to revert escalation', 5000)\n    }\n  }\n\n  const handleFulfillFromWarehouse = async (orderId, fulfillmentData) => {\n    try {\n      const result = await fulfillOrderFromWarehouse(orderId, fulfillmentData)\n      if (result.data) {\n        // After successful fulfill, automatically open status update interface\n        // Fetch updated order details to get the new status\n        try {\n          const orderDetailsResult = await getOrderDetails(orderId)\n          if (orderDetailsResult.data?.order) {\n            const updatedOrder = orderDetailsResult.data.order\n            // Set the fulfilled order for status update\n            setSelectedOrderForStatusUpdate(updatedOrder)\n            // Initialize status update form\n            const currentStatus = (updatedOrder?.status || '').toLowerCase()\n            const normalizedCurrentStatus = normalizeOrderStatus(currentStatus)\n            const nextStatus = getNextStatus(updatedOrder)\n            setSelectedStatus(nextStatus || normalizedCurrentStatus)\n            setIsRevert(false)\n            setSelectedPaymentStatus('')\n            setStatusUpdateNotes('')\n            // Switch to status update view\n            setCurrentView('statusUpdate')\n            setFulfillmentNote('')\n            success('Order fulfilled from warehouse successfully! Status set to Accepted. You can now update the order status.', 4000)\n          } else {\n            // Fallback: just close escalation view and refresh\n            setCurrentView(null)\n            setSelectedOrderForEscalation(null)\n            setFulfillmentNote('')\n            fetchOrders()\n            success('Order fulfilled from warehouse successfully!', 3000)\n          }\n        } catch (detailsError) {\n          // If fetching order details fails, still show success and refresh\n          console.error('Failed to fetch order details after fulfill:', detailsError)\n          setCurrentView(null)\n          setSelectedOrderForEscalation(null)\n          setFulfillmentNote('')\n          fetchOrders()\n          success('Order fulfilled from warehouse successfully! Please refresh to see updated status.', 3000)\n        }\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to fulfill order'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to fulfill order', 5000)\n    }\n  }\n\n  const handleUpdateOrderStatus = async (orderId, updateData) => {\n    try {\n      const result = await updateOrderStatus(orderId, updateData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedOrderForStatusUpdate(null)\n        setSelectedStatus('')\n        setSelectedPaymentStatus('')\n        setStatusUpdateNotes('')\n        setIsRevert(false)\n        fetchOrders()\n        // Show message from backend (includes grace period info if applicable)\n        success(result.data.message || 'Order status updated successfully!', 3000)\n      } else if (result.error) {\n        showError(result.error.message || 'Failed to update order status', 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to update order status', 5000)\n    }\n  }\n\n  const handleOpenStatusUpdateModal = (order) => {\n    setSelectedOrderForStatusUpdate(order)\n    // Initialize status update form state\n    const currentStatus = (order?.status || '').toLowerCase()\n    const normalizedCurrentStatus = normalizeOrderStatus(currentStatus)\n    const isInStatusUpdateGracePeriod = order?.statusUpdateGracePeriod?.isActive\n    const previousStatus = order?.statusUpdateGracePeriod?.previousStatus\n    \n    if (isInStatusUpdateGracePeriod && previousStatus) {\n      const normalizedPrevious = normalizeOrderStatus(previousStatus)\n      setSelectedStatus(normalizedPrevious)\n      setIsRevert(true)\n    } else {\n      const nextStatus = getNextStatus(order)\n      setSelectedStatus(nextStatus || normalizedCurrentStatus)\n      setIsRevert(false)\n    }\n    setSelectedPaymentStatus('')\n    setStatusUpdateNotes('')\n    setCurrentView('statusUpdate')\n  }\n\n  const normalizeOrderStatus = (status) => {\n    if (!status) return 'awaiting'\n    const normalized = status.toLowerCase()\n    if (normalized === 'fully_paid') return 'fully_paid'\n    if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n    if (normalized === 'dispatched' || normalized === 'out_for_delivery' || normalized === 'ready_for_delivery') return 'dispatched'\n    if (normalized === 'delivered') return 'delivered'\n    if (normalized === 'pending' || normalized === 'awaiting') return 'awaiting'\n    return normalized\n  }\n\n  // Helper function to format status for display (replace underscores with spaces)\n  const formatStatusForDisplay = (status) => {\n    if (!status) return 'Unknown'\n    // Replace underscores with spaces and capitalize each word\n    return status\n      .split('_')\n      .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\n      .join(' ')\n  }\n\n  const getNextStatus = (order) => {\n    const currentStatus = normalizeOrderStatus(order?.status)\n    const paymentPreference = order?.paymentPreference || 'partial'\n    const isAlreadyPaid = order?.paymentStatus === 'fully_paid'\n\n    if (currentStatus === 'awaiting') return 'accepted'\n    if (currentStatus === 'accepted') return 'dispatched'\n    if (currentStatus === 'dispatched') return 'delivered'\n    if (currentStatus === 'delivered' && paymentPreference !== 'full' && !isAlreadyPaid) return 'fully_paid'\n    return null\n  }\n\n  const getStatusButtonConfig = (order) => {\n    const nextStatus = getNextStatus(order)\n    if (!nextStatus) return null\n\n    const configs = {\n      dispatched: {\n        label: 'Mark Dispatched',\n        icon: Truck,\n        className: 'border-blue-300 bg-blue-50 text-blue-700 hover:border-blue-500 hover:bg-blue-100',\n        title: 'Mark as Dispatched',\n      },\n      delivered: {\n        label: 'Mark Delivered',\n        icon: CheckCircle,\n        className: 'border-green-300 bg-green-50 text-green-700 hover:border-green-500 hover:bg-green-100',\n        title: 'Mark as Delivered',\n      },\n      fully_paid: {\n        label: 'Payment Done',\n        icon: CreditCard,\n        className: 'border-purple-300 bg-purple-50 text-purple-700 hover:border-purple-500 hover:bg-purple-100',\n        title: 'Mark Payment as Done',\n      },\n      accepted: {\n        label: 'Mark Accepted',\n        icon: CheckCircle,\n        className: 'border-blue-300 bg-blue-50 text-blue-700 hover:border-blue-500 hover:bg-blue-100',\n        title: 'Mark as Accepted',\n      },\n    }\n\n    return configs[nextStatus]\n  }\n\n  const tableColumns = columns.map((column) => {\n    if (column.accessor === 'status') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const originalOrder = ordersState.data?.orders?.find((o) => o.id === row.id) || row\n          const isEscalated = originalOrder.escalated || originalOrder.assignedTo === 'admin'\n          const status = row.status || 'Unknown'\n          const isPaid = row.isPaid || originalOrder.paymentStatus === 'fully_paid'\n          \n          if (isEscalated) {\n            return (\n              <div className=\"flex flex-col gap-1\">\n                <StatusBadge tone=\"warning\">Escalated</StatusBadge>\n                <span className=\"text-xs text-gray-500\">{formatStatusForDisplay(status)}</span>\n                {isPaid && (\n                  <StatusBadge tone=\"success\" className=\"mt-1\">Paid</StatusBadge>\n                )}\n              </div>\n            )\n          }\n          \n          const tone = status === 'Processing' || status === 'processing' ? 'warning' : status === 'Completed' || status === 'completed' ? 'success' : 'neutral'\n          return (\n            <div className=\"flex flex-col gap-1\">\n              <StatusBadge tone={tone}>{formatStatusForDisplay(status)}</StatusBadge>\n              {isPaid && (\n                <StatusBadge tone=\"success\" className=\"mt-1\">Paid</StatusBadge>\n              )}\n            </div>\n          )\n        },\n      }\n    }\n    if (column.accessor === 'advance') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const advance = row.advance || 'Unknown'\n          const tone = advance === 'Paid' || advance === 'paid' ? 'success' : 'warning'\n          return <StatusBadge tone={tone}>{advance}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'type') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const type = row.type || 'Unknown'\n          return (\n            <span className={cn(\n              'inline-flex items-center rounded-full px-3 py-1 text-xs font-bold',\n              type === 'User' || type === 'user' \n                ? 'bg-blue-100 text-blue-700' \n                : 'bg-green-100 text-green-700'\n            )}>\n              {type}\n            </span>\n          )\n        },\n      }\n    }\n    if (column.accessor === 'userLocation' || column.accessor === 'vendorLocation') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const location = row[column.accessor] || 'Not provided'\n          return (\n            <span className=\"text-sm text-gray-600\" title={location}>\n              {location}\n            </span>\n          )\n        },\n      }\n    }\n    if (column.accessor === 'actions') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const originalOrder = ordersState.data?.orders?.find((o) => o.id === row.id) || row\n          const isEscalated = originalOrder.escalated || originalOrder.assignedTo === 'admin'\n          const currentStatus = (originalOrder.status || row.status || '').toLowerCase()\n          const normalizedStatus = normalizeOrderStatus(currentStatus)\n          const isFulfilled = normalizedStatus === 'accepted' || normalizedStatus === 'dispatched' || normalizedStatus === 'delivered' || normalizedStatus === 'fully_paid'\n          const isPaid = row.isPaid || originalOrder.paymentStatus === 'fully_paid'\n          const paymentPreference = originalOrder.paymentPreference || 'partial'\n          const workflowCompleted = paymentPreference === 'partial'\n            ? normalizedStatus === 'fully_paid'\n            : normalizedStatus === 'delivered'\n          const isInStatusUpdateGracePeriod = row.statusUpdateGracePeriod?.isActive || originalOrder.statusUpdateGracePeriod?.isActive\n          const statusUpdateGracePeriodExpiresAt = row.statusUpdateGracePeriod?.expiresAt || originalOrder.statusUpdateGracePeriod?.expiresAt\n          const statusUpdateTimeRemaining = statusUpdateGracePeriodExpiresAt ? Math.max(0, Math.floor((new Date(statusUpdateGracePeriodExpiresAt) - new Date()) / 1000 / 60)) : 0\n          const previousStatus = row.statusUpdateGracePeriod?.previousStatus || originalOrder.statusUpdateGracePeriod?.previousStatus\n          const hideUpdateButton = workflowCompleted && !isInStatusUpdateGracePeriod\n          const statusButtonConfig = hideUpdateButton ? null : getStatusButtonConfig(originalOrder)\n          const isDropdownOpen = openActionsDropdown === row.id\n          \n          // Build action items list\n          const actionItems = []\n          \n          // Always show View Details\n          actionItems.push({\n            label: 'View Details',\n            icon: Eye,\n            onClick: () => {\n              handleViewOrderDetails(originalOrder)\n              setOpenActionsDropdown(null)\n            },\n            className: 'text-gray-700 hover:bg-gray-50'\n          })\n          \n          // Confirm Status Update - shown during grace period\n          if (isInStatusUpdateGracePeriod && !workflowCompleted) {\n            actionItems.push({\n              label: 'Confirm Status Update',\n              icon: CheckCircle,\n              onClick: async () => {\n                setOpenActionsDropdown(null)\n                const result = await updateOrderStatus(originalOrder.id, { finalizeGracePeriod: true })\n                if (result.data) {\n                  fetchOrders()\n                  success(result.data.message || 'Status update confirmed successfully!', 3000)\n                } else if (result.error) {\n                  showError(result.error.message || 'Failed to confirm status update', 5000)\n                }\n              },\n              className: 'text-green-700 hover:bg-green-50'\n            })\n          }\n          \n          // Revert button - shown during grace period\n          if (isInStatusUpdateGracePeriod && previousStatus && !workflowCompleted) {\n            actionItems.push({\n              label: `Revert to ${formatStatusForDisplay(previousStatus)}`,\n              icon: ArrowLeft,\n              onClick: () => {\n                handleOpenStatusUpdateModal(originalOrder)\n                setOpenActionsDropdown(null)\n              },\n              className: 'text-orange-700 hover:bg-orange-50'\n            })\n          }\n          \n          // Update Status button - hidden when workflow completed or during grace period\n          if (!hideUpdateButton && !isInStatusUpdateGracePeriod) {\n            actionItems.push({\n              label: 'Update Status',\n              icon: RefreshCw,\n              onClick: () => {\n                handleOpenStatusUpdateModal(originalOrder)\n                setOpenActionsDropdown(null)\n              },\n              disabled: !statusButtonConfig,\n              className: 'text-blue-700 hover:bg-blue-50'\n            })\n          }\n          \n          // Escalation actions - Show for escalated orders that are not fulfilled\n          if (isEscalated && !isFulfilled) {\n            actionItems.push({\n              label: 'Fulfill from Warehouse',\n              icon: Warehouse,\n              onClick: () => {\n                setSelectedOrderForEscalation(originalOrder)\n                setFulfillmentNote('')\n                setCurrentView('escalation')\n                setOpenActionsDropdown(null)\n              },\n              className: 'text-green-700 hover:bg-green-50'\n            })\n            actionItems.push({\n              label: 'Revert to Vendor',\n              icon: ArrowLeft,\n              onClick: () => {\n                setSelectedOrderForRevert(originalOrder)\n                setRevertReason('')\n                setCurrentView('revertEscalation')\n                setOpenActionsDropdown(null)\n              },\n              className: 'text-orange-700 hover:bg-orange-50'\n            })\n          }\n          \n          // Reassign button - Only show if escalated AND status is awaiting/pending\n          if (isEscalated && (normalizedStatus === 'awaiting' || normalizedStatus === 'pending')) {\n            actionItems.push({\n              label: 'Reassign Order',\n              icon: Recycle,\n              onClick: () => {\n                handleReassignOrder(originalOrder)\n                setOpenActionsDropdown(null)\n              },\n              className: 'text-gray-700 hover:bg-gray-50'\n            })\n          }\n          \n          return (\n            <div className=\"relative\">\n              {isInStatusUpdateGracePeriod && (\n                <div className=\"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded border border-blue-200 mb-1\">\n                  â° {statusUpdateTimeRemaining}m to revert\n                </div>\n              )}\n              {isPaid && (\n                <div className=\"mb-1\">\n                  <span className=\"inline-flex items-center gap-1.5 rounded-lg border border-green-300 bg-green-50 px-2.5 py-1 text-xs font-semibold text-green-700\">\n                    <CheckCircle className=\"h-3.5 w-3.5\" />\n                    Paid\n                  </span>\n                </div>\n              )}\n              <div className=\"relative\">\n                <button\n                  type=\"button\"\n                  onClick={(e) => {\n                    e.stopPropagation()\n                    setOpenActionsDropdown(isDropdownOpen ? null : row.id)\n                  }}\n                  className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-blue-500 hover:bg-blue-50 hover:text-blue-700\"\n                  title=\"Actions\"\n                >\n                  <MoreVertical className=\"h-4 w-4\" />\n                </button>\n                \n                {isDropdownOpen && (\n                  <>\n                    {/* Backdrop to close dropdown */}\n                    <div\n                      className=\"fixed inset-0 z-10\"\n                      onClick={() => setOpenActionsDropdown(null)}\n                    />\n                    {/* Dropdown menu */}\n                    <div className=\"absolute right-0 top-full mt-1 z-20 w-56 rounded-lg border border-gray-200 bg-white shadow-lg py-1\">\n                      {actionItems.map((item, index) => {\n                        const Icon = item.icon\n                        return (\n                          <button\n                            key={index}\n                            type=\"button\"\n                            onClick={(e) => {\n                              e.stopPropagation()\n                              if (!item.disabled) {\n                                item.onClick()\n                              }\n                            }}\n                            disabled={item.disabled}\n                            className={cn(\n                              'w-full flex items-center gap-2 px-4 py-2 text-sm font-medium transition-colors',\n                              item.className,\n                              item.disabled && 'opacity-50 cursor-not-allowed'\n                            )}\n                          >\n                            <Icon className=\"h-4 w-4\" />\n                            <span>{item.label}</span>\n                          </button>\n                        )\n                      })}\n                    </div>\n                  </>\n                )}\n              </div>\n            </div>\n          )\n        },\n      }\n    }\n    return column\n  })\n\n  // Helper functions for full-screen views\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') {\n      return value\n    }\n    if (value >= 100000) {\n      return `â‚¹${(value / 100000).toFixed(1)} L`\n    }\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  const formatDate = (dateValue) => {\n    if (!dateValue) return null\n    if (typeof dateValue === 'string') {\n      return dateValue\n    }\n    if (dateValue instanceof Date) {\n      return dateValue.toLocaleDateString('en-IN')\n    }\n    try {\n      return new Date(dateValue).toLocaleDateString('en-IN')\n    } catch {\n      return String(dateValue)\n    }\n  }\n\n  // Helper functions for extracting order data\n  const getVendorName = (order) => {\n    if (!order) return 'Unknown Vendor'\n    if (typeof order.vendor === 'string') return order.vendor\n    if (order.vendorId && typeof order.vendorId === 'object') return order.vendorId.name || 'Unknown Vendor'\n    if (order.vendor && typeof order.vendor === 'object') return order.vendor.name || 'Unknown Vendor'\n    return 'Unknown Vendor'\n  }\n\n  const getVendorId = (order) => {\n    if (!order) return null\n    if (typeof order.vendorId === 'string') return order.vendorId\n    if (order.vendorId && typeof order.vendorId === 'object') return order.vendorId._id || order.vendorId.id || null\n    if (order.vendor && typeof order.vendor === 'object') return order.vendor._id || order.vendor.id || null\n    return null\n  }\n\n  const getUserName = (order) => {\n    if (!order) return null\n    if (typeof order.user === 'string') return order.user\n    if (order.userId && typeof order.userId === 'object') return order.userId.name || 'Unknown User'\n    if (order.user && typeof order.user === 'object') return order.user.name || 'Unknown User'\n    return order.userName || null\n  }\n\n  const getOrderId = (order) => {\n    if (!order) return 'N/A'\n    if (typeof order.id === 'string') return order.id\n    if (order._id) return typeof order._id === 'string' ? order._id : String(order._id)\n    if (order.orderId) return typeof order.orderId === 'string' ? order.orderId : String(order.orderId)\n    if (order.id && typeof order.id === 'object' && order.id._id) return String(order.id._id)\n    return 'N/A'\n  }\n\n  // If a full-screen view is active, render it instead of the main list\n  // Order Detail View\n  if (currentView === 'orderDetail' && (orderDetails || selectedOrderForDetail)) {\n    const order = orderDetails || selectedOrderForDetail\n    const orderId = getOrderId(order)\n    const vendorName = getVendorName(order)\n    const vendorId = getVendorId(order)\n    const userName = getUserName(order)\n    const orderValue = typeof order.value === 'number' \n      ? order.value \n      : parseFloat(order.value?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n    const advanceAmount = typeof order.advance === 'number'\n      ? order.advance\n      : order.advanceStatus === 'paid' ? orderValue * 0.3 : 0\n    const pendingAmount = typeof order.pending === 'number'\n      ? order.pending\n      : orderValue - advanceAmount\n    const advanceStatus = order.advanceStatus || (order.advance === 'Paid' ? 'paid' : 'pending')\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-red-500 hover:bg-red-50 hover:text-red-700\"\n            title=\"Back to Orders\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Order Details - {orderId}</h2>\n        </div>\n        <div className=\"space-y-6\">\n          {/* Order Header */}\n          <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-red-500 to-red-600 text-white shadow-lg\">\n                  <Package className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">Order #{orderId}</h3>\n                  <p className=\"text-sm text-gray-600\">Type: {order.type || 'Unknown'}</p>\n                  <div className=\"mt-2 flex items-center gap-4 text-xs text-gray-500\">\n                    {(order.date || order.createdAt) && (\n                      <div className=\"flex items-center gap-1\">\n                        <Calendar className=\"h-3.5 w-3.5\" />\n                        <span>{formatDate(order.date || order.createdAt)}</span>\n                      </div>\n                    )}\n                    {order.region && <span>{order.region}</span>}\n                  </div>\n                  {userName && (\n                    <div className=\"mt-1 text-xs text-gray-500\">User: {userName}</div>\n                  )}\n                </div>\n              </div>\n              <StatusBadge tone={order.status === 'Processing' || order.status === 'processing' ? 'warning' : order.status === 'Completed' || order.status === 'completed' ? 'success' : 'neutral'}>\n                {formatStatusForDisplay(order.status)}\n              </StatusBadge>\n            </div>\n          </div>\n\n          {/* Vendor Information */}\n          {(vendorName || vendorId) && (\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n              <p className=\"text-xs text-gray-500 mb-1\">Vendor</p>\n              <p className=\"text-sm font-bold text-gray-900\">{vendorName}</p>\n              {vendorId && (\n                <p className=\"text-xs text-gray-600 mt-1\">Vendor ID: {vendorId}</p>\n              )}\n            </div>\n          )}\n\n          {/* Payment Summary */}\n          <div className=\"space-y-4\">\n            <h4 className=\"text-sm font-bold text-gray-900\">Payment Status</h4>\n            <div className=\"grid gap-4 sm:grid-cols-3\">\n              <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n                <p className=\"text-xs text-gray-500\">Order Value</p>\n                <p className=\"mt-1 text-lg font-bold text-gray-900\">{formatCurrency(orderValue)}</p>\n              </div>\n              <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n                <div className=\"flex items-center justify-between mb-1\">\n                  <p className=\"text-xs text-gray-500\">Advance (30%)</p>\n                  <StatusBadge tone={advanceStatus === 'paid' ? 'success' : 'warning'}>\n                    {advanceStatus === 'paid' ? 'Paid' : 'Pending'}\n                  </StatusBadge>\n                </div>\n                <p className=\"text-lg font-bold text-gray-900\">{formatCurrency(advanceAmount)}</p>\n              </div>\n              <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n                <p className=\"text-xs text-gray-500\">Pending (70%)</p>\n                <p className=\"mt-1 text-lg font-bold text-red-600\">{formatCurrency(pendingAmount)}</p>\n              </div>\n            </div>\n          </div>\n\n          {/* Order Items */}\n          {order.items && order.items.length > 0 && (\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <h4 className=\"mb-4 text-sm font-bold text-gray-900\">Order Items</h4>\n              <div className=\"space-y-3\">\n                {order.items.map((item, index) => {\n                  const getProductName = () => {\n                    if (item.name) return typeof item.name === 'string' ? item.name : String(item.name)\n                    if (item.productId && typeof item.productId === 'object') return item.productId.name || 'Unknown Product'\n                    if (item.product) return typeof item.product === 'string' ? item.product : String(item.product)\n                    return 'Unknown Product'\n                  }\n                  const getProductPrice = () => {\n                    if (item.price) return item.price\n                    if (item.amount) return item.amount\n                    if (item.productId && typeof item.productId === 'object' && item.productId.priceToUser) return item.productId.priceToUser\n                    return 0\n                  }\n                  const productName = getProductName()\n                  const productPrice = getProductPrice()\n                  return (\n                    <div key={item.id || item._id || index} className=\"flex items-center justify-between rounded-lg border border-gray-200 bg-gray-50 p-3\">\n                      <div>\n                        <p className=\"text-sm font-bold text-gray-900\">{productName}</p>\n                        <p className=\"text-xs text-gray-600\">Quantity: {item.quantity || 1} {item.unit || 'units'}</p>\n                      </div>\n                      <p className=\"text-sm font-bold text-gray-900\">{formatCurrency(productPrice)}</p>\n                    </div>\n                  )\n                })}\n              </div>\n            </div>\n          )}\n\n          {/* Payment Timeline */}\n          {order.paymentHistory && order.paymentHistory.length > 0 && (\n            <div className=\"rounded-xl border border-blue-200 bg-white p-5\">\n              <div className=\"mb-4 flex items-center gap-2\">\n                <CreditCard className=\"h-5 w-5 text-blue-600\" />\n                <h4 className=\"text-sm font-bold text-gray-900\">Payment Timeline</h4>\n              </div>\n              <Timeline\n                events={order.paymentHistory.map((payment, index) => ({\n                  id: payment.id || `payment-${index}`,\n                  title: payment.type || 'Payment',\n                  timestamp: payment.date || payment.timestamp || 'N/A',\n                  description: formatCurrency(payment.amount || 0),\n                  status: payment.status || 'completed',\n                }))}\n              />\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n            <button\n              type=\"button\"\n              onClick={handleBackToList}\n              className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n            >\n              Close\n            </button>\n            <div className=\"flex gap-3\">\n              <button\n                type=\"button\"\n                onClick={() => handleGenerateInvoice(order.id || order._id)}\n                disabled={loading}\n                className=\"flex items-center gap-2 rounded-xl border border-blue-300 bg-white px-6 py-3 text-sm font-bold text-blue-600 transition-all hover:bg-blue-50 disabled:opacity-50\"\n              >\n                <FileText className=\"h-4 w-4\" />\n                Generate Invoice\n              </button>\n              {order.escalated && (normalizeOrderStatus(order.status || '') === 'awaiting' || normalizeOrderStatus(order.status || '') === 'pending') && (\n                <button\n                  type=\"button\"\n                  onClick={() => handleReassignOrder(order)}\n                  className=\"flex items-center gap-2 rounded-xl border border-orange-300 bg-white px-6 py-3 text-sm font-bold text-orange-600 transition-all hover:bg-orange-50\"\n                >\n                  <Recycle className=\"h-4 w-4\" />\n                  Reassign Order\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Reassignment View\n  if (currentView === 'reassign' && selectedOrderForReassign) {\n    const order = selectedOrderForReassign\n    const handleReassignFormSubmit = (e) => {\n      e.preventDefault()\n      const newErrors = {}\n      if (!selectedVendorId) newErrors.vendor = 'Please select a vendor'\n      if (!reassignReason.trim()) newErrors.reason = 'Please provide a reason for reassignment'\n      setReassignErrors(newErrors)\n      if (Object.keys(newErrors).length === 0) {\n        handleReassignSubmit(order.id, {\n          vendorId: selectedVendorId,\n          reason: reassignReason.trim(),\n        })\n      }\n    }\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-orange-500 hover:bg-orange-50 hover:text-orange-700\"\n            title=\"Back to Orders\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Reassign Order</h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <form onSubmit={handleReassignFormSubmit} className=\"space-y-6\">\n            {/* Current Order Info */}\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n              <p className=\"text-xs text-gray-500 mb-2\">Current Order Details</p>\n              <p className=\"text-sm font-bold text-gray-900\">Order #{order.id}</p>\n              <p className=\"text-xs text-gray-600 mt-1\">Current Vendor: {getVendorName(order)}</p>\n              {order.region && (\n                <div className=\"mt-2 flex items-center gap-1 text-xs text-gray-600\">\n                  <MapPin className=\"h-3.5 w-3.5\" />\n                  <span>{order.region}</span>\n                </div>\n              )}\n            </div>\n\n            {/* Reason for Reassignment */}\n            <div>\n              <label htmlFor=\"reason\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                <AlertCircle className=\"mr-1 inline h-4 w-4\" />\n                Reason for Reassignment <span className=\"text-red-500\">*</span>\n              </label>\n              <textarea\n                id=\"reason\"\n                value={reassignReason}\n                onChange={(e) => {\n                  setReassignReason(e.target.value)\n                  if (reassignErrors.reason) setReassignErrors((prev) => ({ ...prev, reason: '' }))\n                }}\n                placeholder=\"e.g., Vendor unavailable, Stock shortage, Logistics delay...\"\n                rows={3}\n                className={cn(\n                  'w-full rounded-xl border px-4 py-3 text-sm transition-all focus:outline-none focus:ring-2',\n                  reassignErrors.reason\n                    ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                    : 'border-gray-300 bg-white focus:border-red-500 focus:ring-red-500/50',\n                )}\n              />\n              {reassignErrors.reason && <p className=\"mt-1 text-xs text-red-600\">{reassignErrors.reason}</p>}\n            </div>\n\n            {/* Select New Vendor */}\n            <div>\n              <label htmlFor=\"vendor\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                <Building2 className=\"mr-1 inline h-4 w-4\" />\n                Select New Vendor <span className=\"text-red-500\">*</span>\n              </label>\n              {availableVendors && availableVendors.length > 0 ? (\n                <select\n                  id=\"vendor\"\n                  value={selectedVendorId}\n                  onChange={(e) => {\n                    setSelectedVendorId(e.target.value)\n                    if (reassignErrors.vendor) setReassignErrors((prev) => ({ ...prev, vendor: '' }))\n                  }}\n                  className={cn(\n                    'w-full rounded-xl border px-4 py-3 text-sm font-semibold transition-all focus:outline-none focus:ring-2',\n                    reassignErrors.vendor\n                      ? 'border-red-300 bg-red-50 focus:ring-red-500/50'\n                      : 'border-gray-300 bg-white focus:border-red-500 focus:ring-red-500/50',\n                  )}\n                >\n                  <option value=\"\">Select a vendor...</option>\n                  {availableVendors.map((vendor) => (\n                    <option key={vendor.id} value={vendor.id}>\n                      {vendor.name} {vendor.region && `(${vendor.region})`}\n                    </option>\n                  ))}\n                </select>\n              ) : (\n                <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-4\">\n                  <p className=\"text-sm text-yellow-800\">No alternate vendors available in this region.</p>\n                </div>\n              )}\n              {reassignErrors.vendor && <p className=\"mt-1 text-xs text-red-600\">{reassignErrors.vendor}</p>}\n            </div>\n\n            {/* Info Box */}\n            <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n              <div className=\"flex items-start gap-3\">\n                <AlertCircle className=\"h-5 w-5 flex-shrink-0 text-blue-600\" />\n                <div className=\"text-xs text-blue-900\">\n                  <p className=\"font-bold\">Reassignment Guidelines</p>\n                  <ul className=\"mt-2 space-y-1 list-disc list-inside\">\n                    <li>Selected vendor must have sufficient stock and credit availability</li>\n                    <li>Order will be automatically updated with new vendor details</li>\n                    <li>Customer will be notified of the change</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                disabled={loading}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading || !selectedVendorId || !reassignReason.trim()}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-red-500 to-red-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(239,68,68,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(239,68,68,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <Recycle className=\"h-4 w-4\" />\n                {loading ? 'Reassigning...' : 'Reassign Order'}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  }\n\n  // Escalation View (Fulfill from Warehouse)\n  if (currentView === 'escalation' && selectedOrderForEscalation) {\n    const order = selectedOrderForEscalation\n    const handleFulfill = () => {\n      handleFulfillFromWarehouse(order.id, {\n        note: fulfillmentNote.trim() || 'Order fulfilled from master warehouse',\n      })\n    }\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-green-500 hover:bg-green-50 hover:text-green-700\"\n            title=\"Back to Orders\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Order Escalation - Manual Fulfillment</h2>\n        </div>\n        <div className=\"space-y-6\">\n          {/* Order Info */}\n          <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n            <div className=\"mb-3 flex items-center gap-2\">\n              <Package className=\"h-5 w-5 text-gray-600\" />\n              <p className=\"text-sm font-bold text-gray-900\">Order #{order.orderNumber || order.id}</p>\n            </div>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-600\">Vendor:</span>\n                <span className=\"font-bold text-gray-900\">{getVendorName(order)}</span>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-600\">Order Value:</span>\n                <span className=\"font-bold text-gray-900\">\n                  {formatCurrency(typeof order.value === 'number' ? order.value : parseFloat(order.value?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000)}\n                </span>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-600\">Status:</span>\n                <StatusBadge tone=\"warning\">Vendor Not Available</StatusBadge>\n              </div>\n            </div>\n          </div>\n\n          {/* Escalation Reason */}\n          <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-4\">\n            <div className=\"flex items-start gap-3\">\n              <AlertCircle className=\"h-5 w-5 flex-shrink-0 text-orange-600\" />\n              <div>\n                <p className=\"text-sm font-bold text-orange-900\">Escalation Reason</p>\n                <p className=\"mt-1 text-xs text-orange-700\">\n                  {order.escalationReason || order.escalation?.escalationReason || order.notes || 'Vendor marked this order as \"Not Available\". You can manually fulfill this order from the master warehouse.'}\n                </p>\n                {order.escalation?.escalatedAt && (\n                  <p className=\"mt-2 text-xs text-orange-600\">\n                    Escalated on: {new Date(order.escalation.escalatedAt).toLocaleString('en-IN')}\n                  </p>\n                )}\n              </div>\n            </div>\n          </div>\n\n          {/* Order Items */}\n          {order.items && order.items.length > 0 && (\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <p className=\"mb-3 text-sm font-bold text-gray-900\">Order Items</p>\n              <div className=\"space-y-2\">\n                {order.items.map((item, index) => {\n                  const itemId = item._id || item.id || index\n                  const productName = item.productName || item.productId?.name || item.name || item.product || 'Unknown Product'\n                  const quantity = item.quantity || 1\n                  const unitPrice = item.unitPrice || item.price || item.amount || 0\n                  const totalPrice = item.totalPrice || (unitPrice * quantity)\n                  return (\n                    <div key={itemId} className=\"flex items-center justify-between rounded-lg border border-gray-200 bg-gray-50 p-2\">\n                      <div>\n                        <p className=\"text-sm font-bold text-gray-900\">{productName}</p>\n                        <p className=\"text-xs text-gray-600\">Qty: {quantity} {item.unit || 'units'}</p>\n                      </div>\n                      <p className=\"text-sm font-bold text-gray-900\">{formatCurrency(totalPrice)}</p>\n                    </div>\n                  )\n                })}\n              </div>\n            </div>\n          )}\n\n          {/* Fulfillment Note */}\n          <div>\n            <label htmlFor=\"fulfillmentNote\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n              Fulfillment Note (Optional)\n            </label>\n            <textarea\n              id=\"fulfillmentNote\"\n              value={fulfillmentNote}\n              onChange={(e) => setFulfillmentNote(e.target.value)}\n              placeholder=\"Add any notes about this fulfillment...\"\n              rows={3}\n              className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\n            />\n          </div>\n\n          {/* Info Box */}\n          <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n            <div className=\"flex items-start gap-3\">\n              <Warehouse className=\"h-5 w-5 flex-shrink-0 text-blue-600\" />\n              <div className=\"text-xs text-blue-900\">\n                <p className=\"font-bold\">Master Warehouse Fulfillment</p>\n                <ul className=\"mt-2 space-y-1 list-disc list-inside\">\n                  <li>Order will be fulfilled from master warehouse inventory</li>\n                  <li>Vendor will be notified of the fulfillment</li>\n                  <li>Order status will be updated to \"Accepted\"</li>\n                  <li>You can then update status: Dispatched â†’ Delivered â†’ Fully Paid (if partial payment)</li>\n                </ul>\n              </div>\n            </div>\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n            <button\n              type=\"button\"\n              onClick={handleBackToList}\n              disabled={loading}\n              className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleFulfill}\n              disabled={loading}\n              className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n            >\n              <CheckCircle className=\"h-4 w-4\" />\n              {loading ? 'Fulfilling...' : 'Fulfill from Warehouse'}\n            </button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Revert Escalation View\n  if (currentView === 'revertEscalation' && selectedOrderForRevert) {\n    const order = selectedOrderForRevert\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-orange-500 hover:bg-orange-50 hover:text-orange-700\"\n            title=\"Back to Orders\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Revert Escalation</h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <div className=\"space-y-6\">\n            {order && (\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                <div className=\"mb-3 flex items-center gap-2\">\n                  <AlertCircle className=\"h-5 w-5 text-orange-600\" />\n                  <p className=\"text-sm font-bold text-gray-900\">Order #{order.orderNumber || order.id}</p>\n                </div>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-600\">Vendor:</span>\n                    <span className=\"font-bold text-gray-900\">{getVendorName(order)}</span>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-600\">Order Value:</span>\n                    <span className=\"font-bold text-gray-900\">\n                      {typeof order.value === 'number'\n                        ? formatCurrency(order.value)\n                        : order.value || 'N/A'}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            <div>\n              <label htmlFor=\"revertReason\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Reason for Reverting <span className=\"text-red-500\">*</span>\n              </label>\n              <textarea\n                id=\"revertReason\"\n                value={revertReason}\n                onChange={(e) => setRevertReason(e.target.value)}\n                placeholder=\"Why are you reverting this escalation back to the vendor?\"\n                rows={4}\n                className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-500/50\"\n              />\n            </div>\n\n            <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-4\">\n              <div className=\"flex items-start gap-3\">\n                <AlertCircle className=\"h-5 w-5 flex-shrink-0 text-orange-600\" />\n                <div className=\"text-xs text-orange-900\">\n                  <p className=\"font-bold\">Revert Escalation</p>\n                  <p className=\"mt-1\">\n                    This order will be assigned back to the original vendor. The vendor will receive a notification and can proceed with fulfillment.\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                disabled={loading}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleRevertEscalation}\n                disabled={loading || !revertReason.trim()}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(249,115,22,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(249,115,22,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <ArrowLeft className=\"h-4 w-4\" />\n                {loading ? 'Reverting...' : 'Revert to Vendor'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Status Update View - This is complex, so I'll add a simplified version\n  // The full implementation would mirror OrderStatusUpdateModal\n  if (currentView === 'statusUpdate' && selectedOrderForStatusUpdate) {\n    const order = selectedOrderForStatusUpdate\n    const currentStatus = (order?.status || '').toLowerCase()\n    const currentPaymentStatus = order?.paymentStatus || 'pending'\n    const isPaid = currentPaymentStatus === 'fully_paid'\n    const isInStatusUpdateGracePeriod = order?.statusUpdateGracePeriod?.isActive\n    const statusUpdateGracePeriodExpiresAt = order?.statusUpdateGracePeriod?.expiresAt\n    const statusUpdateTimeRemaining = statusUpdateGracePeriodExpiresAt \n      ? Math.max(0, Math.floor((new Date(statusUpdateGracePeriodExpiresAt) - new Date()) / 1000 / 60)) \n      : 0\n    const previousStatus = order?.statusUpdateGracePeriod?.previousStatus\n    const normalizedCurrentStatus = normalizeOrderStatus(currentStatus)\n\n    // Initialize selected status when view opens - using direct logic instead of useEffect\n    if (!selectedStatus && !selectedPaymentStatus && !statusUpdateNotes) {\n      if (isInStatusUpdateGracePeriod && previousStatus) {\n        const normalizedPrevious = normalizeOrderStatus(previousStatus)\n        setSelectedStatus(normalizedPrevious)\n        setIsRevert(true)\n      } else {\n        const nextStatus = getNextStatus(order)\n        setSelectedStatus(nextStatus || normalizedCurrentStatus)\n        setIsRevert(false)\n      }\n    }\n\n    const ORDER_STATUS_OPTIONS = [\n      { value: 'accepted', label: 'Accepted', description: 'Order has been accepted and is ready for dispatch' },\n      { value: 'dispatched', label: 'Dispatched', description: 'Order has been dispatched for delivery' },\n      { value: 'delivered', label: 'Delivered', description: 'Order has been delivered' },\n    ]\n\n    const PAYMENT_STATUS_OPTIONS = [\n      { value: 'fully_paid', label: 'Mark Payment as Done', description: 'Mark order payment as fully paid' },\n    ]\n\n    // Get payment preference from order\n    const paymentPreference = order?.paymentPreference || 'partial'\n    const isFullPayment = paymentPreference === 'full'\n\n    const normalizeStatusForDisplay = (status) => {\n      const normalized = (status || '').toLowerCase()\n      if (normalized === 'fully_paid') return 'delivered'\n      if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n      if (normalized === 'dispatched' || normalized === 'out_for_delivery' || normalized === 'ready_for_delivery') return 'dispatched'\n      if (normalized === 'delivered') return 'delivered'\n      return 'accepted'\n    }\n\n    const getAvailableStatusOptions = () => {\n      const options = []\n      if (isInStatusUpdateGracePeriod && previousStatus) {\n        const normalizedPrevious = normalizeStatusForDisplay(previousStatus)\n        const option = ORDER_STATUS_OPTIONS.find(opt => opt.value === normalizedPrevious)\n        if (option) {\n          return [{ value: normalizedPrevious, label: `Revert to ${option.label}`, description: 'Revert to previous status' }]\n        }\n      }\n      const statusFlow = ['accepted', 'dispatched', 'delivered']\n      const currentIndex = statusFlow.indexOf(normalizedCurrentStatus)\n      if (currentIndex >= 0) {\n        const currentOption = ORDER_STATUS_OPTIONS.find(opt => opt.value === statusFlow[currentIndex])\n        if (currentOption) options.push(currentOption)\n        const nextIndex = currentIndex + 1\n        if (nextIndex < statusFlow.length) {\n          const nextOption = ORDER_STATUS_OPTIONS.find(opt => opt.value === statusFlow[nextIndex])\n          if (nextOption) options.push(nextOption)\n        }\n      } else {\n        options.push(...ORDER_STATUS_OPTIONS)\n      }\n      return options\n    }\n\n    const handleStatusUpdateSubmit = () => {\n      if (!selectedStatus && !selectedPaymentStatus) return\n      const backendStatus = selectedPaymentStatus === 'fully_paid' \n        ? 'fully_paid' \n        : selectedStatus\n      const updateData = {\n        status: backendStatus,\n        notes: statusUpdateNotes.trim() || undefined,\n        isRevert: isRevert,\n      }\n      handleUpdateOrderStatus(order.id, updateData)\n    }\n\n    const canUpdate = () => {\n      if (isInStatusUpdateGracePeriod && previousStatus) {\n        const normalizedPrevious = normalizeStatusForDisplay(previousStatus)\n        return selectedStatus === normalizedPrevious\n      }\n      return selectedStatus || selectedPaymentStatus\n    }\n\n    const availableStatusOptions = getAvailableStatusOptions()\n    // Show payment option only if:\n    // 1. Order is delivered\n    // 2. Payment is not already fully paid\n    // 3. Payment preference is partial (not full payment)\n    const showPaymentOption = currentStatus === 'delivered' && !isPaid && !isFullPayment\n\n    // Remove the initialization logic from render - it's now in handleOpenStatusUpdateModal\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-blue-500 hover:bg-blue-50 hover:text-blue-700\"\n            title=\"Back to Orders\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Update Order Status</h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <div className=\"space-y-6\">\n            {/* Order Info */}\n            {order && (\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                <div className=\"mb-3 flex items-center gap-2\">\n                  <AlertCircle className=\"h-5 w-5 text-blue-600\" />\n                  <p className=\"text-sm font-bold text-gray-900\">Order #{order.orderNumber || order.id}</p>\n                </div>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-600\">Current Status:</span>\n                    <span className=\"font-bold text-gray-900 capitalize\">{availableStatusOptions.find(opt => opt.value === normalizedCurrentStatus)?.label || normalizedCurrentStatus || 'Unknown'}</span>\n                  </div>\n                  {!isInStatusUpdateGracePeriod && (\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-600\">Next Status:</span>\n                      <span className=\"font-bold text-blue-600 capitalize\">\n                        {(() => {\n                          const nextStatus = getNextStatus(order)\n                          if (nextStatus) {\n                            const nextOption = ORDER_STATUS_OPTIONS.find(opt => opt.value === nextStatus)\n                            return nextOption?.label || nextStatus\n                          }\n                          if (normalizedCurrentStatus === 'delivered' && !isPaid && !isFullPayment) {\n                            return 'Fully Paid'\n                          }\n                          return 'N/A'\n                        })()}\n                      </span>\n                    </div>\n                  )}\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-600\">Payment Status:</span>\n                    <span className=\"font-bold text-gray-900 capitalize\">\n                      {isPaid ? 'Paid' : currentPaymentStatus === 'partial_paid' ? 'Partial Paid' : 'Pending'}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-600\">Payment Type:</span>\n                    <span className=\"font-bold text-gray-900 capitalize\">\n                      {isFullPayment ? 'Full Payment (100%)' : 'Partial Payment (30% advance, 70% after delivery)'}\n                    </span>\n                  </div>\n                  {order.value && (\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-600\">Order Value:</span>\n                      <span className=\"font-bold text-gray-900\">\n                        {typeof order.value === 'number'\n                          ? formatCurrency(order.value)\n                          : order.value || 'N/A'}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n\n            {/* Grace Period Notice */}\n            {isInStatusUpdateGracePeriod && (\n              <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n                <div className=\"flex items-start gap-3\">\n                  <AlertCircle className=\"h-5 w-5 flex-shrink-0 text-blue-600\" />\n                  <div className=\"text-sm text-blue-900\">\n                    <p className=\"font-bold\">Status Update Grace Period Active</p>\n                    <p className=\"mt-1\">\n                      You have {statusUpdateTimeRemaining} minutes remaining to revert to \"{previousStatus}\" status.\n                      After this period, the current status will be finalized.\n                    </p>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Status Selection */}\n            {/* Show status selection if order is not fully paid OR if we're in grace period */}\n            {(!isPaid || isInStatusUpdateGracePeriod) && (\n              <div>\n                <label htmlFor=\"status\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                  Order Status <span className=\"text-red-500\">*</span>\n                </label>\n                <select\n                  id=\"status\"\n                  value={selectedStatus}\n                  onChange={(e) => {\n                    setSelectedStatus(e.target.value)\n                    setIsRevert(false)\n                  }}\n                  disabled={isInStatusUpdateGracePeriod && previousStatus}\n                  className={cn(\n                    'w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50',\n                    isInStatusUpdateGracePeriod && previousStatus && 'bg-gray-100 cursor-not-allowed'\n                  )}\n                >\n                  <option value=\"\">Select status...</option>\n                  {availableStatusOptions.map((option) => (\n                    <option key={option.value} value={option.value}>\n                      {option.label}\n                    </option>\n                  ))}\n                </select>\n                {selectedStatus && (\n                  <p className=\"mt-2 text-xs text-gray-600\">\n                    {availableStatusOptions.find(opt => opt.value === selectedStatus)?.description}\n                  </p>\n                )}\n              </div>\n            )}\n\n            {/* Payment Status Selection */}\n            {showPaymentOption && !isPaid && (\n              <div>\n                <label htmlFor=\"paymentStatus\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                  Payment Status\n                </label>\n                <select\n                  id=\"paymentStatus\"\n                  value={selectedPaymentStatus}\n                  onChange={(e) => setSelectedPaymentStatus(e.target.value)}\n                  className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n                >\n                  <option value=\"\">Select payment status...</option>\n                  {PAYMENT_STATUS_OPTIONS.map((option) => (\n                    <option key={option.value} value={option.value}>\n                      {option.label}\n                    </option>\n                  ))}\n                </select>\n                {selectedPaymentStatus && (\n                  <p className=\"mt-2 text-xs text-gray-600\">\n                    {PAYMENT_STATUS_OPTIONS.find(opt => opt.value === selectedPaymentStatus)?.description}\n                  </p>\n                )}\n              </div>\n            )}\n\n            {/* Notes */}\n            <div>\n              <label htmlFor=\"notes\" className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Notes (Optional)\n              </label>\n              <textarea\n                id=\"notes\"\n                value={statusUpdateNotes}\n                onChange={(e) => setStatusUpdateNotes(e.target.value)}\n                placeholder=\"Add any notes about this status update...\"\n                rows={3}\n                className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\n              />\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                disabled={loading}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleStatusUpdateSubmit}\n                disabled={loading || !canUpdate()}\n                className={cn(\n                  'flex items-center gap-2 rounded-xl px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(59,130,246,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(59,130,246,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50',\n                  isRevert ? 'bg-gradient-to-r from-orange-500 to-orange-600 shadow-[0_4px_15px_rgba(249,115,22,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] hover:shadow-[0_6px_20px_rgba(249,115,22,0.4),inset_0_1px_0_rgba(255,255,255,0.2)]' : 'bg-gradient-to-r from-blue-500 to-blue-600'\n                )}\n              >\n                {loading ? (\n                  <>\n                    <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                    Updating...\n                  </>\n                ) : isRevert ? (\n                  <>\n                    <ArrowLeft className=\"h-4 w-4\" />\n                    Confirm Revert\n                  </>\n                ) : (\n                  <>\n                    <RefreshCw className=\"h-4 w-4\" />\n                    Update Status\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  const getPageTitle = () => {\n    if (subRoute === 'escalated') return 'Escalated Orders'\n    if (subRoute === 'processing') return 'Processing Orders'\n    if (subRoute === 'completed') return 'Completed Orders'\n    return 'Unified Order Control'\n  }\n\n  const getPageDescription = () => {\n    if (subRoute === 'escalated') return 'View and manage orders that have been escalated and require admin attention.'\n    if (subRoute === 'processing') return 'View and manage orders that are accepted but not yet delivered.'\n    if (subRoute === 'completed') return 'View all completed orders that have been delivered and fully paid.'\n    return 'Track user + vendor orders, monitor payment collections, and reassign logistics within a single viewport.'\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 6 â€¢ Order & Payment Management</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">{getPageTitle()}</h2>\n          <p className=\"text-sm text-gray-600\">\n            {getPageDescription()}\n          </p>\n        </div>\n        <button className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-red-500 to-red-600 px-5 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(239,68,68,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all duration-200 hover:shadow-[0_6px_20px_rgba(239,68,68,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] hover:scale-105 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.2)]\">\n          <Truck className=\"h-4 w-4\" />\n          Assign Logistics\n        </button>\n      </header>\n\n      <FilterBar\n        filters={[\n          { id: 'region', label: filters.region === 'All' ? 'Region' : filters.region, active: filters.region !== 'All' },\n          { id: 'vendor', label: filters.vendor === 'All' ? 'Vendor' : filters.vendor, active: filters.vendor !== 'All' },\n          { id: 'date', label: filters.dateFrom ? 'Date range' : 'Date range', active: !!filters.dateFrom },\n          { id: 'status', label: filters.status === 'All' ? 'Order status' : filters.status, active: filters.status !== 'All' },\n        ]}\n        onChange={handleFilterChange}\n      />\n\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-lg font-bold text-gray-900\">Orders</h3>\n        </div>\n        <DataTable\n          columns={tableColumns}\n          rows={ordersList}\n          emptyState=\"No orders found for selected filters\"\n        />\n      </div>\n\n\n      <section className=\"grid gap-6 lg:grid-cols-2\">\n        <div className=\"space-y-4 rounded-3xl border border-red-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"text-lg font-bold text-red-700\">Reassignment Console</h3>\n              <p className=\"text-sm text-gray-600\">\n                Manage order routing when vendors are unavailable or stock thresholds are crossed.\n              </p>\n            </div>\n            <Recycle className=\"h-5 w-5 text-red-600\" />\n          </div>\n          <div className=\"space-y-3\">\n            {[\n              {\n                label: 'Vendor unavailable',\n                detail: 'Auto suggest alternate vendor based on stock + credit health.',\n              },\n              {\n                label: 'Logistics delay',\n                detail: 'Trigger alternate route with SLA compliance tracking.',\n              },\n              {\n                label: 'Payment mismatch',\n                detail: 'Reconcile advance vs pending amounts. Notify finance instantly.',\n              },\n            ].map((item) => (\n              <div key={item.label} className=\"rounded-2xl border border-gray-200 bg-white p-4 hover:-translate-y-1 hover:shadow-[0_6px_20px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <p className=\"text-sm font-bold text-gray-900\">{item.label}</p>\n                <p className=\"text-xs text-gray-600\">{item.detail}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n        <div className=\"space-y-4 rounded-3xl border border-blue-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"flex items-center gap-3\">\n            <CalendarRange className=\"h-5 w-5 text-blue-600\" />\n            <div>\n              <h3 className=\"text-lg font-bold text-blue-700\">Billing Timeline</h3>\n              <p className=\"text-sm text-gray-600\">Advance and pending payments tracked across the order lifecycle.</p>\n            </div>\n          </div>\n          <Timeline\n            events={[\n              {\n                id: 'billing-1',\n                title: 'Advance collection',\n                timestamp: 'Today â€¢ 09:10',\n                description: 'â‚¹2.6 Cr collected across 312 orders.',\n                status: 'completed',\n              },\n              {\n                id: 'billing-2',\n                title: 'Pending follow-up',\n                timestamp: 'Today â€¢ 12:40',\n                description: 'Automated reminder sent for â‚¹1.9 Cr outstanding.',\n                status: 'pending',\n              },\n              {\n                id: 'billing-3',\n                title: 'Invoice generation',\n                timestamp: 'Scheduled â€¢ 17:00',\n                description: 'Finance will generate GST-compliant invoices and export to PDF.',\n                status: 'pending',\n              },\n            ]}\n          />\n        </div>\n      </section>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\PaymentHistory.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'getOrders' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":56,"column":88,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":97,"suggestions":[{"messageId":"removeVar","data":{"varName":"getOrders"},"fix":{"range":[2751,2762],"text":""},"desc":"Remove unused variable 'getOrders'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\nimport { History, IndianRupee, Filter, Search, Calendar, TrendingUp, TrendingDown, Wallet, Factory, ShieldCheck, Users, X, Loader2 } from 'lucide-react'\nimport { DataTable } from '../components/DataTable'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { cn } from '../../../lib/cn'\n\nconst columns = [\n  { Header: 'Date', accessor: 'date' },\n  { Header: 'Activity Type', accessor: 'activityType' },\n  { Header: 'Entity', accessor: 'entity' },\n  { Header: 'Amount', accessor: 'amount' },\n  { Header: 'Status', accessor: 'status' },\n  { Header: 'Description', accessor: 'description' },\n]\n\n// All activity types from PaymentHistory model\nconst ACTIVITY_TYPES = [\n  { value: 'all', label: 'All Activities' },\n  // User Payments\n  { value: 'user_payment_advance', label: 'User Advance Payments' },\n  { value: 'user_payment_remaining', label: 'User Remaining Payments' },\n  // Vendor Payments\n  { value: 'vendor_earning_credited', label: 'Vendor Earnings Credited' },\n  { value: 'vendor_credit_repayment', label: 'Vendor Credit Repayments' },\n  { value: 'vendor_withdrawal_requested', label: 'Vendor Withdrawal Requests' },\n  { value: 'vendor_withdrawal_approved', label: 'Vendor Withdrawals Approved' },\n  { value: 'vendor_withdrawal_rejected', label: 'Vendor Withdrawals Rejected' },\n  { value: 'vendor_withdrawal_completed', label: 'Vendor Withdrawals Completed' },\n  // Seller Payments\n  { value: 'seller_commission_credited', label: 'Seller Commissions Credited' },\n  { value: 'seller_withdrawal_requested', label: 'Seller Withdrawal Requests' },\n  { value: 'seller_withdrawal_approved', label: 'Seller Withdrawals Approved' },\n  { value: 'seller_withdrawal_rejected', label: 'Seller Withdrawals Rejected' },\n  { value: 'seller_withdrawal_completed', label: 'Seller Withdrawals Completed' },\n  // Bank Account Operations\n  { value: 'bank_account_added', label: 'Bank Account Added' },\n  { value: 'bank_account_updated', label: 'Bank Account Updated' },\n  { value: 'bank_account_deleted', label: 'Bank Account Deleted' },\n]\n\nconst STATUS_OPTIONS = [\n  { value: 'all', label: 'All Status' },\n  { value: 'completed', label: 'Completed' },\n  { value: 'pending', label: 'Pending' },\n  { value: 'requested', label: 'Requested' },\n  { value: 'approved', label: 'Approved' },\n  { value: 'rejected', label: 'Rejected' },\n  { value: 'failed', label: 'Failed' },\n  { value: 'cancelled', label: 'Cancelled' },\n  { value: 'credited', label: 'Credited' },\n]\n\nexport function PaymentHistoryPage() {\n  const { getPaymentHistory, getPaymentHistoryStats, getUsers, getVendors, getSellers, getOrders, loading } = useAdminApi()\n  const { error: showError } = useToast()\n\n  const [history, setHistory] = useState([])\n  const [stats, setStats] = useState({\n    totalUserPayments: 0,\n    totalVendorEarnings: 0,\n    totalSellerCommissions: 0,\n    totalVendorWithdrawals: 0,\n    totalSellerWithdrawals: 0,\n    totalActivities: 0,\n  })\n  const [pagination, setPagination] = useState({\n    page: 1,\n    limit: 50,\n    total: 0,\n    totalPages: 0,\n  })\n  const [filters, setFilters] = useState({\n    activityType: 'all',\n    status: 'all',\n    search: '',\n    startDate: '',\n    endDate: '',\n    userId: '',\n    vendorId: '',\n    sellerId: '',\n    orderId: '',\n    minAmount: '',\n    maxAmount: '',\n  })\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false)\n  \n  // Options for entity filters\n  const [userOptions, setUserOptions] = useState([])\n  const [vendorOptions, setVendorOptions] = useState([])\n  const [sellerOptions, setSellerOptions] = useState([])\n  const [userSearchQuery, setUserSearchQuery] = useState('')\n  const [vendorSearchQuery, setVendorSearchQuery] = useState('')\n  const [sellerSearchQuery, setSellerSearchQuery] = useState('')\n\n  // Fetch entity options for filters\n  useEffect(() => {\n    const fetchEntityOptions = async () => {\n      try {\n        // Fetch users for filter dropdown\n        const usersResult = await getUsers({ limit: 100 })\n        if (usersResult.data?.users) {\n          setUserOptions(usersResult.data.users)\n        }\n\n        // Fetch vendors for filter dropdown\n        const vendorsResult = await getVendors({ limit: 100 })\n        if (vendorsResult.data?.vendors) {\n          setVendorOptions(vendorsResult.data.vendors)\n        }\n\n        // Fetch sellers for filter dropdown\n        const sellersResult = await getSellers({ limit: 100 })\n        if (sellersResult.data?.sellers) {\n          setSellerOptions(sellersResult.data.sellers)\n        }\n      } catch (error) {\n        console.error('Failed to fetch entity options:', error)\n      }\n    }\n    fetchEntityOptions()\n  }, [getUsers, getVendors, getSellers])\n\n  const fetchHistory = useCallback(async () => {\n    try {\n      const params = {\n        page: pagination.page,\n        limit: pagination.limit,\n        ...(filters.activityType !== 'all' && { activityType: filters.activityType }),\n        ...(filters.status !== 'all' && { status: filters.status }),\n        ...(filters.search && { search: filters.search }),\n        ...(filters.startDate && { startDate: filters.startDate }),\n        ...(filters.endDate && { endDate: filters.endDate }),\n        ...(filters.userId && { userId: filters.userId }),\n        ...(filters.vendorId && { vendorId: filters.vendorId }),\n        ...(filters.sellerId && { sellerId: filters.sellerId }),\n        ...(filters.orderId && { orderId: filters.orderId }),\n      }\n\n      console.log('ðŸ” [PaymentHistory Frontend] Fetching with params:', params);\n      const result = await getPaymentHistory(params)\n      console.log('ðŸ“Š [PaymentHistory Frontend] API Response:', {\n        success: result.success,\n        historyCount: result.data?.history?.length || 0,\n        pagination: result.data?.pagination,\n        summary: result.data?.summary,\n        hasData: !!result.data,\n        hasHistory: !!result.data?.history,\n      });\n      \n      // Check if we have data (either from result.data.history or result.data directly)\n      const historyData = result.data?.history || (Array.isArray(result.data) ? result.data : [])\n      \n      if (historyData.length > 0 || result.data) {\n        const originalTotal = result.data?.pagination?.total || historyData.length\n        let filteredHistoryData = [...historyData]\n        \n        // Apply amount range filter on frontend if provided\n        // Note: This filters only the current page of results\n        if (filters.minAmount || filters.maxAmount) {\n          const minAmount = filters.minAmount ? parseFloat(filters.minAmount) : 0\n          const maxAmount = filters.maxAmount ? parseFloat(filters.maxAmount) : Infinity\n          filteredHistoryData = filteredHistoryData.filter(item => {\n            const amount = item.amount || 0\n            return amount >= minAmount && amount <= maxAmount\n          })\n        }\n\n        console.log(`âœ… [PaymentHistory Frontend] Setting ${filteredHistoryData.length} history records (from ${historyData.length} total)`);\n        setHistory(filteredHistoryData)\n        setPagination((prev) => ({\n          ...prev,\n          // Note: When amount filter is active, total may not be accurate as it only filters current page\n          total: (filters.minAmount || filters.maxAmount) ? filteredHistoryData.length : originalTotal,\n          totalPages: (filters.minAmount || filters.maxAmount) \n            ? (filteredHistoryData.length > 0 ? 1 : 0) // Show as single page when filtering\n            : (result.data?.pagination?.totalPages || Math.ceil(originalTotal / prev.limit)),\n        }))\n      } else if (result.error) {\n        console.error('âŒ [PaymentHistory Frontend] API Error:', result.error);\n        showError(result.error.message || 'Failed to fetch payment history', 5000)\n        setHistory([])\n      } else {\n        console.warn('âš ï¸ [PaymentHistory Frontend] No data in response:', result);\n        setHistory([])\n      }\n    } catch (error) {\n      console.error('âŒ [PaymentHistory Frontend] Exception:', error)\n      showError(error.message || 'Failed to fetch payment history', 5000)\n    }\n  }, [getPaymentHistory, pagination.page, pagination.limit, filters, showError])\n\n  const fetchStats = useCallback(async () => {\n    try {\n      const params = {\n        ...(filters.startDate && { startDate: filters.startDate }),\n        ...(filters.endDate && { endDate: filters.endDate }),\n        ...(filters.status && filters.status !== 'all' && { status: filters.status }),\n      }\n      console.log('ðŸ“Š [PaymentHistory Frontend] Fetching stats with params:', params);\n      const result = await getPaymentHistoryStats(params)\n      console.log('ðŸ“Š [PaymentHistory Frontend] Stats response:', result);\n      if (result.success && result.data) {\n        console.log('âœ… [PaymentHistory Frontend] Setting stats:', result.data);\n        setStats(result.data)\n      } else {\n        console.warn('âš ï¸ [PaymentHistory Frontend] Stats response missing data:', result);\n      }\n    } catch (error) {\n      console.error('âŒ [PaymentHistory Frontend] Failed to fetch stats:', error)\n    }\n  }, [getPaymentHistoryStats, filters.startDate, filters.endDate, filters.status])\n\n  useEffect(() => {\n    fetchHistory()\n    fetchStats()\n  }, [fetchHistory, fetchStats])\n\n  const handleFilterChange = (key, value) => {\n    setFilters((prev) => ({ ...prev, [key]: value }))\n    setPagination((prev) => ({ ...prev, page: 1 }))\n  }\n\n  const clearFilters = () => {\n    setFilters({\n      activityType: 'all',\n      status: 'all',\n      search: '',\n      startDate: '',\n      endDate: '',\n      userId: '',\n      vendorId: '',\n      sellerId: '',\n      orderId: '',\n      minAmount: '',\n      maxAmount: '',\n    })\n    setPagination((prev) => ({ ...prev, page: 1 }))\n  }\n\n  const hasActiveFilters = () => {\n    return filters.activityType !== 'all' ||\n           filters.status !== 'all' ||\n           filters.search ||\n           filters.startDate ||\n           filters.endDate ||\n           filters.userId ||\n           filters.vendorId ||\n           filters.sellerId ||\n           filters.orderId ||\n           filters.minAmount ||\n           filters.maxAmount\n  }\n\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') return value\n    if (value >= 10000000) return `â‚¹${(value / 10000000).toFixed(1)} Cr`\n    if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\n    if (value >= 1000) return `â‚¹${(value / 1000).toFixed(1)}K`\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  const formatActivityType = (type) => {\n    const typeMap = {\n      user_payment_advance: 'User Advance Payment',\n      user_payment_remaining: 'User Remaining Payment',\n      vendor_earning_credited: 'Vendor Earning Credited',\n      vendor_credit_repayment: 'Vendor Credit Repayment',\n      seller_commission_credited: 'Seller Commission Credited',\n      vendor_withdrawal_requested: 'Vendor Withdrawal Request',\n      vendor_withdrawal_approved: 'Vendor Withdrawal Approved',\n      vendor_withdrawal_rejected: 'Vendor Withdrawal Rejected',\n      vendor_withdrawal_completed: 'Vendor Withdrawal Completed',\n      seller_withdrawal_requested: 'Seller Withdrawal Request',\n      seller_withdrawal_approved: 'Seller Withdrawal Approved',\n      seller_withdrawal_rejected: 'Seller Withdrawal Rejected',\n      seller_withdrawal_completed: 'Seller Withdrawal Completed',\n      bank_account_added: 'Bank Account Added',\n      bank_account_updated: 'Bank Account Updated',\n      bank_account_deleted: 'Bank Account Deleted',\n    }\n    return typeMap[type] || type\n  }\n\n  const getActivityIcon = (type) => {\n    if (type.includes('user_payment')) return Users\n    if (type.includes('vendor')) return Factory\n    if (type.includes('seller')) return ShieldCheck\n    if (type.includes('bank_account')) return Wallet\n    return Wallet\n  }\n\n  const getActivityColor = (type) => {\n    if (type.includes('user_payment')) return 'blue'\n    if (type.includes('vendor_earning')) return 'green'\n    if (type.includes('vendor_credit_repayment')) return 'teal'\n    if (type.includes('seller_commission')) return 'yellow'\n    if (type.includes('withdrawal')) return 'orange'\n    if (type.includes('bank_account')) return 'purple'\n    return 'gray'\n  }\n\n  const tableColumns = columns.map((column) => {\n    if (column.accessor === 'date') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const date = row.createdAt || row.processedAt\n          return date ? new Date(date).toLocaleString('en-IN') : 'N/A'\n        },\n      }\n    }\n    if (column.accessor === 'activityType') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const Icon = getActivityIcon(row.activityType)\n          const color = getActivityColor(row.activityType)\n          return (\n            <div className=\"flex items-center gap-2\">\n              <div className={cn('flex h-8 w-8 items-center justify-center rounded-lg', {\n                'bg-blue-100 text-blue-600': color === 'blue',\n                'bg-green-100 text-green-600': color === 'green',\n                'bg-teal-100 text-teal-600': color === 'teal',\n                'bg-yellow-100 text-yellow-600': color === 'yellow',\n                'bg-orange-100 text-orange-600': color === 'orange',\n                'bg-purple-100 text-purple-600': color === 'purple',\n                'bg-gray-100 text-gray-600': color === 'gray',\n              })}>\n                <Icon className=\"h-4 w-4\" />\n              </div>\n              <span className=\"text-sm font-medium\">{formatActivityType(row.activityType)}</span>\n            </div>\n          )\n        },\n      }\n    }\n    if (column.accessor === 'entity') {\n      return {\n        ...column,\n        Cell: (row) => {\n          if (row.vendor?.name) {\n            return <span className=\"text-sm\">Vendor: {row.vendor.name} ({row.vendor.vendorId || row.vendor.phone})</span>\n          }\n          if (row.seller?.name) {\n            return <span className=\"text-sm\">Seller: {row.seller.name} ({row.seller.sellerId || row.seller.phone})</span>\n          }\n          if (row.user?.name) {\n            return <span className=\"text-sm\">User: {row.user.name} ({row.user.userId || row.user.phone})</span>\n          }\n          if (row.order?.orderNumber) {\n            return <span className=\"text-sm\">Order: {row.order.orderNumber}</span>\n          }\n          return <span className=\"text-sm text-gray-400\">N/A</span>\n        },\n      }\n    }\n    if (column.accessor === 'amount') {\n      return {\n        ...column,\n        Cell: (row) => (\n          <span className={cn('text-sm font-bold', {\n            'text-green-600': row.activityType.includes('earning') || row.activityType.includes('commission'),\n            'text-teal-600': row.activityType.includes('credit_repayment'),\n            'text-red-600': row.activityType.includes('withdrawal'),\n            'text-blue-600': row.activityType.includes('payment'),\n            'text-gray-900': !row.activityType || row.activityType.includes('bank_account'),\n          })}>\n            {formatCurrency(row.amount || 0)}\n          </span>\n        ),\n      }\n    }\n    if (column.accessor === 'status') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const status = row.status || 'completed'\n          const tone = status === 'completed' || status === 'credited' || status === 'approved' ? 'success' \n            : status === 'pending' || status === 'requested' ? 'warning' \n            : status === 'rejected' || status === 'failed' || status === 'cancelled' ? 'neutral' \n            : 'default'\n          return <StatusBadge tone={tone}>{status.charAt(0).toUpperCase() + status.slice(1)}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'description') {\n      return {\n        ...column,\n        Cell: (row) => (\n          <span className=\"text-sm text-gray-600\">\n            {row.description || row.formattedDescription || row.metadata?.orderNumber || 'N/A'}\n          </span>\n        ),\n      }\n    }\n    return column\n  })\n\n  // Filter entity options based on search\n  const filteredUserOptions = userOptions.filter(user => \n    !userSearchQuery || \n    user.name?.toLowerCase().includes(userSearchQuery.toLowerCase()) ||\n    user.phone?.includes(userSearchQuery) ||\n    user.userId?.toLowerCase().includes(userSearchQuery.toLowerCase())\n  )\n\n  const filteredVendorOptions = vendorOptions.filter(vendor => \n    !vendorSearchQuery || \n    vendor.name?.toLowerCase().includes(vendorSearchQuery.toLowerCase()) ||\n    vendor.phone?.includes(vendorSearchQuery) ||\n    vendor.vendorId?.toLowerCase().includes(vendorSearchQuery.toLowerCase())\n  )\n\n  const filteredSellerOptions = sellerOptions.filter(seller => \n    !sellerSearchQuery || \n    seller.name?.toLowerCase().includes(sellerSearchQuery.toLowerCase()) ||\n    seller.phone?.includes(sellerSearchQuery) ||\n    seller.sellerId?.toLowerCase().includes(sellerSearchQuery.toLowerCase())\n  )\n\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Finance â€¢ History</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Payment History</h2>\n          <p className=\"text-sm text-gray-600\">Complete audit log of all payment, earnings, and withdrawal activities</p>\n        </div>\n      </header>\n\n      {/* Stats Cards */}\n      <div className=\"grid gap-6 md:grid-cols-3 lg:grid-cols-6\">\n        <div className=\"rounded-3xl border border-blue-200 bg-white p-4 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <Users className=\"h-4 w-4 text-blue-600\" />\n            <p className=\"text-xs text-gray-600\">User Payments</p>\n          </div>\n          <p className=\"text-xl font-bold text-gray-900\">{formatCurrency(stats.totalUserPayments || 0)}</p>\n        </div>\n        <div className=\"rounded-3xl border border-green-200 bg-white p-4 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <Factory className=\"h-4 w-4 text-green-600\" />\n            <p className=\"text-xs text-gray-600\">Vendor Earnings</p>\n          </div>\n          <p className=\"text-xl font-bold text-gray-900\">{formatCurrency(stats.totalVendorEarnings || 0)}</p>\n        </div>\n        <div className=\"rounded-3xl border border-yellow-200 bg-white p-4 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <ShieldCheck className=\"h-4 w-4 text-yellow-600\" />\n            <p className=\"text-xs text-gray-600\">Seller Commissions</p>\n          </div>\n          <p className=\"text-xl font-bold text-gray-900\">{formatCurrency(stats.totalSellerCommissions || 0)}</p>\n        </div>\n        <div className=\"rounded-3xl border border-orange-200 bg-white p-4 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <TrendingDown className=\"h-4 w-4 text-orange-600\" />\n            <p className=\"text-xs text-gray-600\">Vendor Withdrawals</p>\n          </div>\n          <p className=\"text-xl font-bold text-gray-900\">{formatCurrency(stats.totalVendorWithdrawals || 0)}</p>\n        </div>\n        <div className=\"rounded-3xl border border-orange-200 bg-white p-4 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <TrendingDown className=\"h-4 w-4 text-orange-600\" />\n            <p className=\"text-xs text-gray-600\">Seller Withdrawals</p>\n          </div>\n          <p className=\"text-xl font-bold text-gray-900\">{formatCurrency(stats.totalSellerWithdrawals || 0)}</p>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-4 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <History className=\"h-4 w-4 text-gray-600\" />\n            <p className=\"text-xs text-gray-600\">Total Activities</p>\n          </div>\n          <p className=\"text-xl font-bold text-gray-900\">{stats.totalActivities || 0}</p>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-4 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n        <div className=\"flex flex-wrap items-center gap-4 mb-4\">\n          <div className=\"flex items-center gap-2\">\n            <Filter className=\"h-4 w-4 text-gray-500\" />\n            <span className=\"text-sm font-semibold text-gray-700\">Filters</span>\n            {hasActiveFilters() && (\n              <button\n                type=\"button\"\n                onClick={clearFilters}\n                className=\"ml-2 inline-flex items-center gap-1 rounded-lg bg-gray-100 px-2 py-1 text-xs text-gray-600 hover:bg-gray-200\"\n              >\n                <X className=\"h-3 w-3\" />\n                Clear All\n              </button>\n            )}\n          </div>\n          <button\n            type=\"button\"\n            onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}\n            className=\"ml-auto text-sm text-indigo-600 hover:text-indigo-700 font-medium\"\n          >\n            {showAdvancedFilters ? 'Hide' : 'Show'} Advanced Filters\n          </button>\n        </div>\n\n        {/* Basic Filters */}\n        <div className=\"flex flex-wrap items-center gap-4\">\n          <div className=\"flex items-center gap-2\">\n            <select\n              value={filters.activityType}\n              onChange={(e) => handleFilterChange('activityType', e.target.value)}\n              className=\"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm min-w-[200px]\"\n            >\n              {ACTIVITY_TYPES.map((type) => (\n                <option key={type.value} value={type.value}>\n                  {type.label}\n                </option>\n              ))}\n            </select>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <select\n              value={filters.status}\n              onChange={(e) => handleFilterChange('status', e.target.value)}\n              className=\"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm min-w-[150px]\"\n            >\n              {STATUS_OPTIONS.map((status) => (\n                <option key={status.value} value={status.value}>\n                  {status.label}\n                </option>\n              ))}\n            </select>\n          </div>\n          <div className=\"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-2\">\n            <Calendar className=\"h-4 w-4 text-gray-500\" />\n            <input\n              type=\"date\"\n              value={filters.startDate}\n              onChange={(e) => handleFilterChange('startDate', e.target.value)}\n              className=\"border-none bg-transparent text-sm outline-none\"\n              placeholder=\"Start Date\"\n            />\n          </div>\n          <div className=\"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-2\">\n            <Calendar className=\"h-4 w-4 text-gray-500\" />\n            <input\n              type=\"date\"\n              value={filters.endDate}\n              onChange={(e) => handleFilterChange('endDate', e.target.value)}\n              className=\"border-none bg-transparent text-sm outline-none\"\n              placeholder=\"End Date\"\n            />\n          </div>\n          <div className=\"flex flex-1 items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-2 min-w-[250px]\">\n            <Search className=\"h-4 w-4 text-gray-500\" />\n            <input\n              type=\"text\"\n              placeholder=\"Search by description, order number, name...\"\n              value={filters.search}\n              onChange={(e) => handleFilterChange('search', e.target.value)}\n              className=\"flex-1 border-none bg-transparent text-sm outline-none\"\n            />\n          </div>\n        </div>\n\n        {/* Advanced Filters */}\n        {showAdvancedFilters && (\n          <div className=\"mt-4 pt-4 border-t border-gray-200 grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n            {/* User Filter */}\n            <div className=\"space-y-2\">\n              <label className=\"text-xs font-semibold text-gray-700\">Filter by User</label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Search user...\"\n                  value={userSearchQuery}\n                  onChange={(e) => setUserSearchQuery(e.target.value)}\n                  className=\"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm\"\n                />\n                {filters.userId && (\n                  <button\n                    type=\"button\"\n                    onClick={() => handleFilterChange('userId', '')}\n                    className=\"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                  >\n                    <X className=\"h-4 w-4\" />\n                  </button>\n                )}\n              </div>\n              {userSearchQuery && filteredUserOptions.length > 0 && (\n                <div className=\"absolute z-10 mt-1 max-h-48 w-full overflow-auto rounded-lg border border-gray-200 bg-white shadow-lg\">\n                  {filteredUserOptions.slice(0, 10).map((user) => (\n                    <button\n                      key={user.id}\n                      type=\"button\"\n                      onClick={() => {\n                        handleFilterChange('userId', user.id)\n                        setUserSearchQuery('')\n                      }}\n                      className=\"w-full px-3 py-2 text-left text-sm hover:bg-gray-50\"\n                    >\n                      {user.name} ({user.phone || user.userId})\n                    </button>\n                  ))}\n                </div>\n              )}\n              {filters.userId && (\n                <div className=\"mt-1 flex items-center gap-2 rounded bg-blue-50 px-2 py-1 text-xs\">\n                  <span className=\"text-blue-700\">\n                    {userOptions.find(u => u.id === filters.userId)?.name || 'Selected User'}\n                  </span>\n                  <button\n                    type=\"button\"\n                    onClick={() => handleFilterChange('userId', '')}\n                    className=\"text-blue-600 hover:text-blue-800\"\n                  >\n                    <X className=\"h-3 w-3\" />\n                  </button>\n                </div>\n              )}\n            </div>\n\n            {/* Vendor Filter */}\n            <div className=\"space-y-2\">\n              <label className=\"text-xs font-semibold text-gray-700\">Filter by Vendor</label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Search vendor...\"\n                  value={vendorSearchQuery}\n                  onChange={(e) => setVendorSearchQuery(e.target.value)}\n                  className=\"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm\"\n                />\n                {filters.vendorId && (\n                  <button\n                    type=\"button\"\n                    onClick={() => handleFilterChange('vendorId', '')}\n                    className=\"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                  >\n                    <X className=\"h-4 w-4\" />\n                  </button>\n                )}\n              </div>\n              {vendorSearchQuery && filteredVendorOptions.length > 0 && (\n                <div className=\"absolute z-10 mt-1 max-h-48 w-full overflow-auto rounded-lg border border-gray-200 bg-white shadow-lg\">\n                  {filteredVendorOptions.slice(0, 10).map((vendor) => (\n                    <button\n                      key={vendor.id}\n                      type=\"button\"\n                      onClick={() => {\n                        handleFilterChange('vendorId', vendor.id)\n                        setVendorSearchQuery('')\n                      }}\n                      className=\"w-full px-3 py-2 text-left text-sm hover:bg-gray-50\"\n                    >\n                      {vendor.name} ({vendor.phone || vendor.vendorId})\n                    </button>\n                  ))}\n                </div>\n              )}\n              {filters.vendorId && (\n                <div className=\"mt-1 flex items-center gap-2 rounded bg-green-50 px-2 py-1 text-xs\">\n                  <span className=\"text-green-700\">\n                    {vendorOptions.find(v => v.id === filters.vendorId)?.name || 'Selected Vendor'}\n                  </span>\n                  <button\n                    type=\"button\"\n                    onClick={() => handleFilterChange('vendorId', '')}\n                    className=\"text-green-600 hover:text-green-800\"\n                  >\n                    <X className=\"h-3 w-3\" />\n                  </button>\n                </div>\n              )}\n            </div>\n\n            {/* Seller Filter */}\n            <div className=\"space-y-2\">\n              <label className=\"text-xs font-semibold text-gray-700\">Filter by Seller</label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Search seller...\"\n                  value={sellerSearchQuery}\n                  onChange={(e) => setSellerSearchQuery(e.target.value)}\n                  className=\"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm\"\n                />\n                {filters.sellerId && (\n                  <button\n                    type=\"button\"\n                    onClick={() => handleFilterChange('sellerId', '')}\n                    className=\"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                  >\n                    <X className=\"h-4 w-4\" />\n                  </button>\n                )}\n              </div>\n              {sellerSearchQuery && filteredSellerOptions.length > 0 && (\n                <div className=\"absolute z-10 mt-1 max-h-48 w-full overflow-auto rounded-lg border border-gray-200 bg-white shadow-lg\">\n                  {filteredSellerOptions.slice(0, 10).map((seller) => (\n                    <button\n                      key={seller.id}\n                      type=\"button\"\n                      onClick={() => {\n                        handleFilterChange('sellerId', seller.id)\n                        setSellerSearchQuery('')\n                      }}\n                      className=\"w-full px-3 py-2 text-left text-sm hover:bg-gray-50\"\n                    >\n                      {seller.name} ({seller.phone || seller.sellerId})\n                    </button>\n                  ))}\n                </div>\n              )}\n              {filters.sellerId && (\n                <div className=\"mt-1 flex items-center gap-2 rounded bg-yellow-50 px-2 py-1 text-xs\">\n                  <span className=\"text-yellow-700\">\n                    {sellerOptions.find(s => s.id === filters.sellerId)?.name || 'Selected Seller'}\n                  </span>\n                  <button\n                    type=\"button\"\n                    onClick={() => handleFilterChange('sellerId', '')}\n                    className=\"text-yellow-600 hover:text-yellow-800\"\n                  >\n                    <X className=\"h-3 w-3\" />\n                  </button>\n                </div>\n              )}\n            </div>\n\n            {/* Order ID Filter */}\n            <div className=\"space-y-2\">\n              <label className=\"text-xs font-semibold text-gray-700\">Filter by Order ID</label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Enter order number...\"\n                  value={filters.orderId}\n                  onChange={(e) => handleFilterChange('orderId', e.target.value)}\n                  className=\"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm\"\n                />\n                {filters.orderId && (\n                  <button\n                    type=\"button\"\n                    onClick={() => handleFilterChange('orderId', '')}\n                    className=\"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                  >\n                    <X className=\"h-4 w-4\" />\n                  </button>\n                )}\n              </div>\n            </div>\n\n            {/* Amount Range Filters */}\n            <div className=\"space-y-2\">\n              <label className=\"text-xs font-semibold text-gray-700\">Min Amount (â‚¹)</label>\n              <input\n                type=\"number\"\n                placeholder=\"0\"\n                value={filters.minAmount}\n                onChange={(e) => handleFilterChange('minAmount', e.target.value)}\n                className=\"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm\"\n                min=\"0\"\n                step=\"0.01\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-xs font-semibold text-gray-700\">Max Amount (â‚¹)</label>\n              <input\n                type=\"number\"\n                placeholder=\"No limit\"\n                value={filters.maxAmount}\n                onChange={(e) => handleFilterChange('maxAmount', e.target.value)}\n                className=\"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm\"\n                min=\"0\"\n                step=\"0.01\"\n              />\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* History Table */}\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n        {loading && history.length === 0 ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-indigo-600\" />\n          </div>\n        ) : (\n          <>\n            <DataTable\n              columns={tableColumns}\n              rows={history}\n              emptyState=\"No payment history found matching your filters\"\n              loading={loading}\n            />\n            {pagination.totalPages > 1 && (\n              <div className=\"mt-4 flex items-center justify-between\">\n                <p className=\"text-sm text-gray-600\">\n                  Showing {((pagination.page - 1) * pagination.limit) + 1} to {Math.min(pagination.page * pagination.limit, pagination.total)} of {pagination.total} entries\n                </p>\n                <div className=\"flex gap-2\">\n                  <button\n                    type=\"button\"\n                    onClick={() => setPagination((prev) => ({ ...prev, page: Math.max(1, prev.page - 1) }))}\n                    disabled={pagination.page === 1 || loading}\n                    className=\"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50\"\n                  >\n                    Previous\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => setPagination((prev) => ({ ...prev, page: Math.min(prev.totalPages, prev.page + 1) }))}\n                    disabled={pagination.page >= pagination.totalPages || loading}\n                    className=\"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50\"\n                  >\n                    Next\n                  </button>\n                </div>\n              </div>\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Penalties.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Products.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Repayments.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[410,446],"text":""},"desc":"Remove unused variable 'cn'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'navigate' is defined but never used.","line":30,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"navigate"},"fix":{"range":[1247,1259],"text":""},"desc":"Remove unused variable 'navigate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'success' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":37,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"success"},"fix":{"range":[1383,1391],"text":""},"desc":"Remove unused variable 'success'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'pagination', 'showError', and 'summary'. Either include them or remove the dependency array. You can also do a functional update 'setPagination(p => ...)' if you only need 'pagination' in the 'setPagination' call.","line":161,"column":6,"nodeType":"ArrayExpression","endLine":161,"endColumn":79,"suggestions":[{"desc":"Update the dependencies array to be: [pagination, filters.status, filters.vendorId, filters.startDate, filters.endDate, getRepayments, summary, showError]","fix":{"range":[5509,5582],"text":"[pagination, filters.status, filters.vendorId, filters.startDate, filters.endDate, getRepayments, summary, showError]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":179,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":179,"endColumn":19}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\r\nimport { ArrowLeft, IndianRupee, Calendar, Building2, Eye, CheckCircle, XCircle, Clock, Filter, CreditCard } from 'lucide-react'\r\nimport { DataTable } from '../components/DataTable'\r\nimport { StatusBadge } from '../components/StatusBadge'\r\nimport { useAdminApi } from '../hooks/useAdminApi'\r\nimport { useToast } from '../components/ToastNotification'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nconst columns = [\r\n  { Header: 'Repayment ID', accessor: 'repaymentId' },\r\n  { Header: 'Vendor', accessor: 'vendorName' },\r\n  { Header: 'Amount', accessor: 'amount' },\r\n  { Header: 'Penalty', accessor: 'penaltyAmount' },\r\n  { Header: 'Total', accessor: 'totalAmount' },\r\n  { Header: 'Status', accessor: 'status' },\r\n  { Header: 'Payment Method', accessor: 'paymentMethod' },\r\n  { Header: 'Date', accessor: 'date' },\r\n  { Header: 'Actions', accessor: 'actions' },\r\n]\r\n\r\nconst STATUS_FILTERS = [\r\n  { value: '', label: 'All Status' },\r\n  { value: 'pending', label: 'Pending' },\r\n  { value: 'processing', label: 'Processing' },\r\n  { value: 'completed', label: 'Completed' },\r\n  { value: 'failed', label: 'Failed' },\r\n  { value: 'cancelled', label: 'Cancelled' },\r\n]\r\n\r\nexport function RepaymentsPage({ navigate }) {\r\n  const {\r\n    getRepayments,\r\n    getRepaymentDetails,\r\n    getVendors,\r\n    loading,\r\n  } = useAdminApi()\r\n  const { success, error: showError } = useToast()\r\n\r\n  const [repayments, setRepayments] = useState([])\r\n  const [summary, setSummary] = useState({\r\n    totalCompleted: 0,\r\n    totalPending: 0,\r\n    totalFailed: 0,\r\n    totalRepaid: 0,\r\n    totalPenaltyPaid: 0,\r\n  })\r\n  const [vendors, setVendors] = useState([])\r\n  const [selectedRepayment, setSelectedRepayment] = useState(null)\r\n  const [repaymentDetails, setRepaymentDetails] = useState(null)\r\n  const [showDetails, setShowDetails] = useState(false)\r\n\r\n  // Filters\r\n  const [filters, setFilters] = useState({\r\n    status: '',\r\n    vendorId: '',\r\n    startDate: '',\r\n    endDate: '',\r\n  })\r\n  const [pagination, setPagination] = useState({\r\n    currentPage: 1,\r\n    totalPages: 1,\r\n    totalItems: 0,\r\n    itemsPerPage: 20,\r\n  })\r\n\r\n  // Format currency\r\n  const formatCurrency = (value) => {\r\n    if (typeof value === 'string') return value\r\n    if (!value && value !== 0) return 'â‚¹0'\r\n    if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\r\n    return `â‚¹${Math.round(value).toLocaleString('en-IN')}`\r\n  }\r\n\r\n  // Format date\r\n  const formatDate = (dateString) => {\r\n    if (!dateString) return 'N/A'\r\n    try {\r\n      return new Date(dateString).toLocaleDateString('en-GB', {\r\n        day: '2-digit',\r\n        month: 'short',\r\n        year: 'numeric',\r\n      })\r\n    } catch {\r\n      return 'N/A'\r\n    }\r\n  }\r\n\r\n  // Format date with time\r\n  const formatDateTime = (dateString) => {\r\n    if (!dateString) return 'N/A'\r\n    try {\r\n      return new Date(dateString).toLocaleString('en-GB', {\r\n        day: '2-digit',\r\n        month: 'short',\r\n        year: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n      })\r\n    } catch {\r\n      return 'N/A'\r\n    }\r\n  }\r\n\r\n  // Fetch vendors for filter\r\n  const fetchVendors = useCallback(async () => {\r\n    try {\r\n      const result = await getVendors({ limit: 1000 })\r\n      if (result.data?.vendors) {\r\n        setVendors(result.data.vendors)\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch vendors:', error)\r\n    }\r\n  }, [getVendors])\r\n\r\n  // Fetch repayments\r\n  const fetchRepayments = useCallback(async () => {\r\n    try {\r\n      const params = {\r\n        page: pagination.currentPage,\r\n        limit: pagination.itemsPerPage,\r\n      }\r\n\r\n      if (filters.status) params.status = filters.status\r\n      if (filters.vendorId) params.vendorId = filters.vendorId\r\n      if (filters.startDate) params.startDate = filters.startDate\r\n      if (filters.endDate) params.endDate = filters.endDate\r\n\r\n      const result = await getRepayments(params)\r\n\r\n      if (result.data) {\r\n        // Transform repayments for display\r\n        const transformedRepayments = (result.data.repayments || []).map((repayment) => ({\r\n          id: repayment._id || repayment.id,\r\n          repaymentId: repayment.repaymentId || repayment._id?.toString().slice(-8) || 'N/A',\r\n          vendorId: repayment.vendorId?._id || repayment.vendorId?.id || repayment.vendorId,\r\n          vendorName: repayment.vendorId?.name || 'N/A',\r\n          vendorPhone: repayment.vendorId?.phone || 'N/A',\r\n          amount: repayment.amount || 0,\r\n          penaltyAmount: repayment.penaltyAmount || 0,\r\n          totalAmount: repayment.totalAmount || repayment.amount || 0,\r\n          status: repayment.status || 'pending',\r\n          paymentMethod: repayment.paymentMethod || 'razorpay',\r\n          creditUsedBefore: repayment.creditUsedBefore || 0,\r\n          creditUsedAfter: repayment.creditUsedAfter || 0,\r\n          date: repayment.createdAt || repayment.paidAt || new Date().toISOString(),\r\n          paidAt: repayment.paidAt,\r\n          bankAccount: repayment.bankAccountId,\r\n          razorpayOrderId: repayment.razorpayOrderId,\r\n          razorpayPaymentId: repayment.razorpayPaymentId,\r\n        }))\r\n\r\n        setRepayments(transformedRepayments)\r\n        setSummary(result.data.summary || summary)\r\n        setPagination(result.data.pagination || pagination)\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch repayments:', error)\r\n      showError('Failed to load repayments', 5000)\r\n    }\r\n  }, [getRepayments, filters, pagination.currentPage, pagination.itemsPerPage])\r\n\r\n  useEffect(() => {\r\n    fetchVendors()\r\n  }, [fetchVendors])\r\n\r\n  useEffect(() => {\r\n    fetchRepayments()\r\n  }, [fetchRepayments])\r\n\r\n  const handleViewDetails = async (repayment) => {\r\n    try {\r\n      const result = await getRepaymentDetails(repayment.id)\r\n      if (result.data?.repayment) {\r\n        setRepaymentDetails(result.data.repayment)\r\n        setSelectedRepayment(repayment)\r\n        setShowDetails(true)\r\n      }\r\n    } catch (error) {\r\n      showError('Failed to load repayment details', 5000)\r\n    }\r\n  }\r\n\r\n  const handleBackToList = () => {\r\n    setShowDetails(false)\r\n    setSelectedRepayment(null)\r\n    setRepaymentDetails(null)\r\n  }\r\n\r\n  const handleFilterChange = (key, value) => {\r\n    setFilters((prev) => ({ ...prev, [key]: value }))\r\n    setPagination((prev) => ({ ...prev, currentPage: 1 }))\r\n  }\r\n\r\n  const handlePageChange = (page) => {\r\n    setPagination((prev) => ({ ...prev, currentPage: page }))\r\n  }\r\n\r\n  const getStatusBadge = (status) => {\r\n    const statusMap = {\r\n      completed: { tone: 'success', label: 'Completed' },\r\n      pending: { tone: 'warning', label: 'Pending' },\r\n      processing: { tone: 'info', label: 'Processing' },\r\n      failed: { tone: 'error', label: 'Failed' },\r\n      cancelled: { tone: 'neutral', label: 'Cancelled' },\r\n    }\r\n    const statusInfo = statusMap[status] || { tone: 'neutral', label: status }\r\n    return <StatusBadge tone={statusInfo.tone}>{statusInfo.label}</StatusBadge>\r\n  }\r\n\r\n  const tableColumns = columns.map((column) => {\r\n    if (column.accessor === 'status') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => getStatusBadge(row.status),\r\n      }\r\n    }\r\n    if (column.accessor === 'amount' || column.accessor === 'penaltyAmount' || column.accessor === 'totalAmount') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => (\r\n          <span className=\"font-semibold text-gray-900\">\r\n            {formatCurrency(row[column.accessor])}\r\n          </span>\r\n        ),\r\n      }\r\n    }\r\n    if (column.accessor === 'date') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => (\r\n          <span className=\"text-sm text-gray-600\">\r\n            {formatDate(row.date)}\r\n          </span>\r\n        ),\r\n      }\r\n    }\r\n    if (column.accessor === 'paymentMethod') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => (\r\n          <span className=\"text-sm text-gray-600 capitalize\">\r\n            {row.paymentMethod === 'razorpay' ? 'Razorpay' : row.paymentMethod || 'N/A'}\r\n          </span>\r\n        ),\r\n      }\r\n    }\r\n    if (column.accessor === 'actions') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => (\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => handleViewDetails(row)}\r\n            className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-blue-500 hover:bg-blue-50 hover:text-blue-700\"\r\n            title=\"View repayment details\"\r\n          >\r\n            <Eye className=\"h-4 w-4\" />\r\n          </button>\r\n        ),\r\n      }\r\n    }\r\n    return column\r\n  })\r\n\r\n  // Show repayment details screen\r\n  if (showDetails && selectedRepayment && repaymentDetails) {\r\n    const repayment = repaymentDetails\r\n    const vendor = repayment.vendorId || {}\r\n    const bankAccount = repayment.bankAccountId || {}\r\n\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div>\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleBackToList}\r\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\r\n          >\r\n            <ArrowLeft className=\"h-4 w-4\" />\r\n            Back to Repayments\r\n          </button>\r\n          <div>\r\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Credit & Finance</p>\r\n            <h2 className=\"text-2xl font-bold text-gray-900\">Repayment Details</h2>\r\n            <p className=\"text-sm text-gray-600\">\r\n              View detailed information about repayment {repayment.repaymentId || selectedRepayment.repaymentId}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid gap-6 lg:grid-cols-3\">\r\n          {/* Main Details */}\r\n          <div className=\"lg:col-span-2 space-y-6\">\r\n            {/* Repayment Info */}\r\n            <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n              <h3 className=\"mb-4 text-lg font-bold text-gray-900\">Repayment Information</h3>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Repayment ID</p>\r\n                    <p className=\"mt-1 text-sm font-bold text-gray-900\">{repayment.repaymentId || 'N/A'}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Status</p>\r\n                    <div className=\"mt-1\">{getStatusBadge(repayment.status)}</div>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Amount</p>\r\n                    <p className=\"mt-1 text-lg font-bold text-gray-900\">{formatCurrency(repayment.amount)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Penalty</p>\r\n                    <p className=\"mt-1 text-lg font-bold text-red-600\">{formatCurrency(repayment.penaltyAmount || 0)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Total Amount</p>\r\n                    <p className=\"mt-1 text-lg font-bold text-green-600\">{formatCurrency(repayment.totalAmount || repayment.amount)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Payment Method</p>\r\n                    <p className=\"mt-1 text-sm font-semibold text-gray-900 capitalize\">\r\n                      {repayment.paymentMethod === 'razorpay' ? 'Razorpay' : repayment.paymentMethod || 'N/A'}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Created At</p>\r\n                    <p className=\"mt-1 text-sm text-gray-900\">{formatDateTime(repayment.createdAt)}</p>\r\n                  </div>\r\n                  {repayment.paidAt && (\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-500\">Paid At</p>\r\n                      <p className=\"mt-1 text-sm text-gray-900\">{formatDateTime(repayment.paidAt)}</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Vendor Info */}\r\n            <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n              <h3 className=\"mb-4 text-lg font-bold text-gray-900\">Vendor Information</h3>\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg\">\r\n                  <Building2 className=\"h-6 w-6\" />\r\n                </div>\r\n                <div className=\"flex-1\">\r\n                  <h4 className=\"text-lg font-bold text-gray-900\">{vendor.name || 'N/A'}</h4>\r\n                  <p className=\"text-sm text-gray-600\">Phone: {vendor.phone || 'N/A'}</p>\r\n                  {vendor.email && (\r\n                    <p className=\"text-sm text-gray-600\">Email: {vendor.email}</p>\r\n                  )}\r\n                  <div className=\"mt-3 grid gap-3 sm:grid-cols-2\">\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-500\">Credit Before</p>\r\n                      <p className=\"mt-1 text-sm font-bold text-gray-900\">{formatCurrency(repayment.creditUsedBefore || 0)}</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-500\">Credit After</p>\r\n                      <p className=\"mt-1 text-sm font-bold text-green-600\">{formatCurrency(repayment.creditUsedAfter || 0)}</p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Bank Account Info */}\r\n            {bankAccount && (\r\n              <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n                <h3 className=\"mb-4 text-lg font-bold text-gray-900\">Bank Account</h3>\r\n                <div className=\"space-y-3\">\r\n                  <div>\r\n                    <p className=\"text-xs text-gray-500\">Account Holder</p>\r\n                    <p className=\"mt-1 text-sm font-semibold text-gray-900\">{bankAccount.accountHolderName || 'N/A'}</p>\r\n                  </div>\r\n                  <div className=\"grid gap-3 sm:grid-cols-2\">\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-500\">Bank Name</p>\r\n                      <p className=\"mt-1 text-sm text-gray-900\">{bankAccount.bankName || 'N/A'}</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-500\">Account Number</p>\r\n                      <p className=\"mt-1 text-sm text-gray-900\">\r\n                        {bankAccount.accountNumber ? `****${bankAccount.accountNumber.slice(-4)}` : 'N/A'}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-500\">IFSC Code</p>\r\n                      <p className=\"mt-1 text-sm text-gray-900\">{bankAccount.ifscCode || 'N/A'}</p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Payment Gateway Info */}\r\n            {(repayment.razorpayOrderId || repayment.razorpayPaymentId) && (\r\n              <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n                <h3 className=\"mb-4 text-lg font-bold text-gray-900\">Payment Gateway Details</h3>\r\n                <div className=\"space-y-3\">\r\n                  {repayment.razorpayOrderId && (\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-500\">Razorpay Order ID</p>\r\n                      <p className=\"mt-1 text-sm font-mono text-gray-900\">{repayment.razorpayOrderId}</p>\r\n                    </div>\r\n                  )}\r\n                  {repayment.razorpayPaymentId && (\r\n                    <div>\r\n                      <p className=\"text-xs text-gray-500\">Razorpay Payment ID</p>\r\n                      <p className=\"mt-1 text-sm font-mono text-gray-900\">{repayment.razorpayPaymentId}</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Summary Sidebar */}\r\n          <div className=\"space-y-6\">\r\n            <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n              <h3 className=\"mb-4 text-lg font-bold text-gray-900\">Summary</h3>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-sm text-gray-600\">Repayment Amount</span>\r\n                  <span className=\"text-sm font-bold text-gray-900\">{formatCurrency(repayment.amount)}</span>\r\n                </div>\r\n                {repayment.penaltyAmount > 0 && (\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-sm text-gray-600\">Penalty</span>\r\n                    <span className=\"text-sm font-bold text-red-600\">{formatCurrency(repayment.penaltyAmount)}</span>\r\n                  </div>\r\n                )}\r\n                <div className=\"border-t border-gray-200 pt-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-sm font-bold text-gray-900\">Total Paid</span>\r\n                    <span className=\"text-lg font-bold text-green-600\">{formatCurrency(repayment.totalAmount || repayment.amount)}</span>\r\n                  </div>\r\n                </div>\r\n                <div className=\"rounded-lg bg-gray-50 p-3\">\r\n                  <p className=\"text-xs text-gray-500\">Credit Reduction</p>\r\n                  <p className=\"mt-1 text-sm font-bold text-gray-900\">\r\n                    {formatCurrency(repayment.creditUsedBefore || 0)} â†’ {formatCurrency(repayment.creditUsedAfter || 0)}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Main repayments list view\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\r\n        <div>\r\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Credit & Finance</p>\r\n          <h2 className=\"text-2xl font-bold text-gray-900\">Credit Repayments</h2>\r\n          <p className=\"text-sm text-gray-600\">\r\n            View and manage all vendor credit repayments. Track repayment status, amounts, and payment details.\r\n          </p>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Summary Cards */}\r\n      <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-5\">\r\n        <div className=\"rounded-xl border border-gray-200 bg-white p-4 shadow-sm\">\r\n          <p className=\"text-xs text-gray-500\">Total Completed</p>\r\n          <p className=\"mt-1 text-2xl font-bold text-green-600\">{summary.totalCompleted || 0}</p>\r\n        </div>\r\n        <div className=\"rounded-xl border border-gray-200 bg-white p-4 shadow-sm\">\r\n          <p className=\"text-xs text-gray-500\">Pending</p>\r\n          <p className=\"mt-1 text-2xl font-bold text-yellow-600\">{summary.totalPending || 0}</p>\r\n        </div>\r\n        <div className=\"rounded-xl border border-gray-200 bg-white p-4 shadow-sm\">\r\n          <p className=\"text-xs text-gray-500\">Failed</p>\r\n          <p className=\"mt-1 text-2xl font-bold text-red-600\">{summary.totalFailed || 0}</p>\r\n        </div>\r\n        <div className=\"rounded-xl border border-gray-200 bg-white p-4 shadow-sm\">\r\n          <p className=\"text-xs text-gray-500\">Total Repaid</p>\r\n          <p className=\"mt-1 text-lg font-bold text-gray-900\">{formatCurrency(summary.totalRepaid || 0)}</p>\r\n        </div>\r\n        <div className=\"rounded-xl border border-gray-200 bg-white p-4 shadow-sm\">\r\n          <p className=\"text-xs text-gray-500\">Penalty Collected</p>\r\n          <p className=\"mt-1 text-lg font-bold text-red-600\">{formatCurrency(summary.totalPenaltyPaid || 0)}</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"rounded-xl border border-gray-200 bg-white p-4 shadow-sm\">\r\n        <div className=\"flex flex-wrap items-center gap-4\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Filter className=\"h-4 w-4 text-gray-400\" />\r\n            <span className=\"text-sm font-semibold text-gray-700\">Filters:</span>\r\n          </div>\r\n          <div>\r\n            <select\r\n              value={filters.status}\r\n              onChange={(e) => handleFilterChange('status', e.target.value)}\r\n              className=\"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\r\n            >\r\n              {STATUS_FILTERS.map((filter) => (\r\n                <option key={filter.value} value={filter.value}>\r\n                  {filter.label}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <select\r\n              value={filters.vendorId}\r\n              onChange={(e) => handleFilterChange('vendorId', e.target.value)}\r\n              className=\"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\r\n            >\r\n              <option value=\"\">All Vendors</option>\r\n              {vendors.map((vendor) => (\r\n                <option key={vendor.id} value={vendor.id}>\r\n                  {vendor.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <input\r\n              type=\"date\"\r\n              value={filters.startDate}\r\n              onChange={(e) => handleFilterChange('startDate', e.target.value)}\r\n              className=\"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\r\n              placeholder=\"Start Date\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <input\r\n              type=\"date\"\r\n              value={filters.endDate}\r\n              onChange={(e) => handleFilterChange('endDate', e.target.value)}\r\n              className=\"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50\"\r\n              placeholder=\"End Date\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Repayments Table */}\r\n      {repayments.length === 0 ? (\r\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-12 text-center\">\r\n          <CreditCard className=\"mx-auto h-12 w-12 text-gray-400\" />\r\n          <p className=\"mt-4 text-sm font-bold text-gray-900\">No Repayments Found</p>\r\n          <p className=\"mt-2 text-xs text-gray-600\">\r\n            {Object.values(filters).some(f => f) \r\n              ? 'No repayments match the current filters. Try adjusting your search criteria.'\r\n              : 'No repayments have been made yet.'}\r\n          </p>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          <div className=\"rounded-3xl border border-gray-200 bg-white shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\r\n            <DataTable\r\n              columns={tableColumns}\r\n              rows={repayments}\r\n              emptyState=\"No repayments found\"\r\n            />\r\n          </div>\r\n\r\n          {/* Pagination */}\r\n          {pagination.totalPages > 1 && (\r\n            <div className=\"flex items-center justify-center gap-2\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => handlePageChange(pagination.currentPage - 1)}\r\n                disabled={pagination.currentPage === 1 || loading}\r\n                className=\"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\r\n              >\r\n                Previous\r\n              </button>\r\n              <span className=\"text-sm text-gray-600\">\r\n                Page {pagination.currentPage} of {pagination.totalPages}\r\n              </span>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => handlePageChange(pagination.currentPage + 1)}\r\n                disabled={pagination.currentPage >= pagination.totalPages || loading}\r\n                className=\"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\r\n              >\r\n                Next\r\n              </button>\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Reviews.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'subRoute' is assigned a value but never used.","line":21,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"subRoute"},"fix":{"range":[930,946],"text":""},"desc":"Remove unused variable 'subRoute'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'navigate' is defined but never used.","line":21,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":56,"suggestions":[{"messageId":"removeVar","data":{"varName":"navigate"},"fix":{"range":[945,955],"text":""},"desc":"Remove unused variable 'navigate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getReviewDetails' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"getReviewDetails"},"fix":{"range":[982,1000],"text":""},"desc":"Remove unused variable 'getReviewDetails'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'filters.hasResponse', 'filters.isApproved', 'filters.isVisible', 'filters.productId', 'filters.rating', and 'filters.userId'. Either include them or remove the dependency array.","line":74,"column":6,"nodeType":"ArrayExpression","endLine":74,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [filters.hasResponse, filters.isApproved, filters.isVisible, filters.productId, filters.rating, filters.userId, getReviews, showError]","fix":{"range":[3253,3291],"text":"[filters.hasResponse, filters.isApproved, filters.isVisible, filters.productId, filters.rating, filters.userId, getReviews, showError]"}}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\r\nimport { Star, MessageSquare, Eye, EyeOff, CheckCircle, XCircle, Send, Edit2, Trash2, Filter, Search, MoreVertical } from 'lucide-react'\r\nimport { DataTable } from '../components/DataTable'\r\nimport { StatusBadge } from '../components/StatusBadge'\r\nimport { FilterBar } from '../components/FilterBar'\r\nimport { useAdminApi } from '../hooks/useAdminApi'\r\nimport { useToast } from '../components/ToastNotification'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nconst columns = [\r\n  { Header: 'Product', accessor: 'product' },\r\n  { Header: 'User', accessor: 'user' },\r\n  { Header: 'Rating', accessor: 'rating' },\r\n  { Header: 'Comment', accessor: 'comment' },\r\n  { Header: 'Date', accessor: 'date' },\r\n  { Header: 'Status', accessor: 'status' },\r\n  { Header: 'Response', accessor: 'hasResponse' },\r\n  { Header: 'Actions', accessor: 'actions' },\r\n]\r\n\r\nexport function ReviewsPage({ subRoute = null, navigate }) {\r\n  const { getReviews, getReviewDetails, respondToReview, updateReviewResponse, deleteReviewResponse, moderateReview, deleteReview, loading } = useAdminApi()\r\n  const { success, error: showError } = useToast()\r\n\r\n  const [reviewsList, setReviewsList] = useState([])\r\n  const [allReviewsList, setAllReviewsList] = useState([])\r\n  const [selectedReview, setSelectedReview] = useState(null)\r\n  const [showResponseModal, setShowResponseModal] = useState(false)\r\n  const [responseText, setResponseText] = useState('')\r\n  const [editingResponse, setEditingResponse] = useState(false)\r\n  const [activeDropdown, setActiveDropdown] = useState(null)\r\n  const [filters, setFilters] = useState({\r\n    productId: '',\r\n    userId: '',\r\n    rating: '',\r\n    hasResponse: '',\r\n    isApproved: '',\r\n    isVisible: '',\r\n    search: '',\r\n  })\r\n\r\n  // Fetch reviews - only when server-side filters change\r\n  const serverFilters = JSON.stringify({\r\n    productId: filters.productId,\r\n    userId: filters.userId,\r\n    rating: filters.rating,\r\n    hasResponse: filters.hasResponse,\r\n    isApproved: filters.isApproved,\r\n    isVisible: filters.isVisible\r\n  })\r\n\r\n  const fetchReviews = useCallback(async () => {\r\n    try {\r\n      const params = {}\r\n      if (filters.productId && filters.productId.trim()) params.productId = filters.productId.trim()\r\n      if (filters.userId && filters.userId.trim()) params.userId = filters.userId.trim()\r\n      if (filters.rating && filters.rating.trim()) params.rating = filters.rating.trim()\r\n      if (filters.hasResponse && filters.hasResponse.trim()) params.hasResponse = filters.hasResponse.trim()\r\n      if (filters.isApproved !== '' && filters.isApproved !== undefined) params.isApproved = filters.isApproved\r\n      if (filters.isVisible !== '' && filters.isVisible !== undefined) params.isVisible = filters.isVisible\r\n\r\n      const result = await getReviews(params)\r\n      if (result.data?.reviews) {\r\n        const formatted = result.data.reviews.map(formatReviewForDisplay)\r\n        setAllReviewsList(formatted)\r\n      } else if (result.error) {\r\n        showError(result.error.message || 'Failed to fetch reviews')\r\n      } else {\r\n        setAllReviewsList([])\r\n      }\r\n    } catch (error) {\r\n      showError(error.message || 'Failed to fetch reviews')\r\n    }\r\n  }, [getReviews, serverFilters, showError])\r\n\r\n  // Format review for display\r\n  const formatReviewForDisplay = (review) => {\r\n    const productName = review.productId?.name || 'Unknown Product'\r\n    const userName = review.userId?.name || 'Anonymous'\r\n    const userPhone = review.userId?.phone || ''\r\n    const rating = review.rating || 0\r\n    const comment = review.comment || 'No comment'\r\n    const date = review.createdAt ? new Date(review.createdAt).toLocaleDateString('en-IN', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric'\r\n    }) : 'N/A'\r\n\r\n    const status = []\r\n    if (review.isApproved) status.push('Approved')\r\n    else status.push('Pending')\r\n    if (!review.isVisible) status.push('Hidden')\r\n\r\n    const hasResponse = review.adminResponse?.response ? 'Yes' : 'No'\r\n\r\n    return {\r\n      ...review,\r\n      product: productName,\r\n      user: `${userName}${userPhone ? ` (${userPhone})` : ''}`,\r\n      rating,\r\n      comment: comment.length > 50 ? comment.substring(0, 50) + '...' : comment,\r\n      fullComment: comment,\r\n      date,\r\n      status: status.join(', '),\r\n      hasResponse,\r\n      isApproved: review.isApproved,\r\n      isVisible: review.isVisible,\r\n    }\r\n  }\r\n\r\n  // Filter reviews based on search\r\n  useEffect(() => {\r\n    let filtered = allReviewsList\r\n\r\n    if (filters.search && filters.search.trim()) {\r\n      const searchLower = filters.search.toLowerCase()\r\n      filtered = filtered.filter(review =>\r\n        review.product?.toLowerCase().includes(searchLower) ||\r\n        review.user?.toLowerCase().includes(searchLower) ||\r\n        review.fullComment?.toLowerCase().includes(searchLower)\r\n      )\r\n    }\r\n\r\n    setReviewsList(filtered)\r\n  }, [filters.search, allReviewsList])\r\n\r\n  useEffect(() => {\r\n    fetchReviews()\r\n  }, [fetchReviews])\r\n\r\n  // Handle respond to review\r\n  const handleRespondToReview = async (review) => {\r\n    setSelectedReview(review)\r\n    setResponseText(review.adminResponse?.response || '')\r\n    setEditingResponse(!!review.adminResponse?.response)\r\n    setShowResponseModal(true)\r\n  }\r\n\r\n  // Submit response\r\n  const handleSubmitResponse = async () => {\r\n    if (!responseText.trim()) {\r\n      showError('Response text is required')\r\n      return\r\n    }\r\n\r\n    try {\r\n      let result\r\n      if (editingResponse) {\r\n        result = await updateReviewResponse(selectedReview._id, { response: responseText })\r\n      } else {\r\n        result = await respondToReview(selectedReview._id, { response: responseText })\r\n      }\r\n\r\n      if (result.data) {\r\n        success(editingResponse ? 'Response updated successfully' : 'Response added successfully')\r\n        setShowResponseModal(false)\r\n        setResponseText('')\r\n        setSelectedReview(null)\r\n        fetchReviews()\r\n      } else if (result.error) {\r\n        showError(result.error.message || 'Failed to submit response')\r\n      }\r\n    } catch (error) {\r\n      showError(error.message || 'Failed to submit response')\r\n    }\r\n  }\r\n\r\n  // Delete response\r\n  const handleDeleteResponse = async (review) => {\r\n    if (!confirm('Are you sure you want to delete this response?')) return\r\n\r\n    try {\r\n      const result = await deleteReviewResponse(review._id)\r\n      if (result.data) {\r\n        success('Response deleted successfully')\r\n        fetchReviews()\r\n      } else if (result.error) {\r\n        showError(result.error.message || 'Failed to delete response')\r\n      }\r\n    } catch (error) {\r\n      showError(error.message || 'Failed to delete response')\r\n    }\r\n  }\r\n\r\n  // Moderate review\r\n  const handleModerateReview = async (review, action) => {\r\n    let updateData = {}\r\n\r\n    if (action === 'approve') {\r\n      updateData.isApproved = true\r\n    } else if (action === 'reject') {\r\n      updateData.isApproved = false\r\n    } else if (action === 'hide') {\r\n      updateData.isVisible = false\r\n    } else if (action === 'show') {\r\n      updateData.isVisible = true\r\n    }\r\n\r\n    try {\r\n      const result = await moderateReview(review._id, updateData)\r\n      if (result.data) {\r\n        success('Review moderated successfully')\r\n        fetchReviews()\r\n      } else if (result.error) {\r\n        showError(result.error.message || 'Failed to moderate review')\r\n      }\r\n    } catch (error) {\r\n      showError(error.message || 'Failed to moderate review')\r\n    }\r\n  }\r\n\r\n  // Delete review\r\n  const handleDeleteReview = async (review) => {\r\n    if (!confirm('Are you sure you want to delete this review? This action cannot be undone.')) return\r\n\r\n    try {\r\n      const result = await deleteReview(review._id)\r\n      if (result.data) {\r\n        success('Review deleted successfully')\r\n        fetchReviews()\r\n      } else if (result.error) {\r\n        showError(result.error.message || 'Failed to delete review')\r\n      }\r\n    } catch (error) {\r\n      showError(error.message || 'Failed to delete review')\r\n    }\r\n  }\r\n\r\n  // Render rating stars\r\n  const renderStars = (rating) => {\r\n    return (\r\n      <div className=\"flex items-center gap-0.5\">\r\n        {[1, 2, 3, 4, 5].map((star) => (\r\n          <Star\r\n            key={star}\r\n            className={cn(\r\n              'h-4 w-4',\r\n              star <= rating ? 'fill-yellow-400 text-yellow-400' : 'text-gray-300'\r\n            )}\r\n          />\r\n        ))}\r\n        <span className=\"ml-1 text-sm font-semibold text-gray-700\">{rating}</span>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Format table columns with Cell functions\r\n  const tableColumns = columns.map((column) => {\r\n    if (column.accessor === 'product') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => (\r\n          <div className=\"font-semibold text-gray-900\">{row.product}</div>\r\n        ),\r\n      }\r\n    }\r\n    if (column.accessor === 'user') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => (\r\n          <div className=\"text-sm text-gray-700\">{row.user}</div>\r\n        ),\r\n      }\r\n    }\r\n    if (column.accessor === 'rating') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => renderStars(row.rating),\r\n      }\r\n    }\r\n    if (column.accessor === 'comment') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => (\r\n          <div className=\"max-w-xs text-sm text-gray-600\" title={row.fullComment}>\r\n            {row.comment}\r\n          </div>\r\n        ),\r\n      }\r\n    }\r\n    if (column.accessor === 'date') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => <div className=\"text-sm text-gray-600\">{row.date}</div>,\r\n      }\r\n    }\r\n    if (column.accessor === 'status') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => (\r\n          <div className=\"flex items-center gap-2\">\r\n            <StatusBadge\r\n              status={row.isApproved ? 'approved' : 'pending'}\r\n              label={row.isApproved ? 'Approved' : 'Pending'}\r\n            />\r\n            {!row.isVisible && (\r\n              <StatusBadge status=\"hidden\" label=\"Hidden\" />\r\n            )}\r\n          </div>\r\n        ),\r\n      }\r\n    }\r\n    if (column.accessor === 'hasResponse') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => (\r\n          <div className=\"flex items-center gap-1\">\r\n            {row.hasResponse === 'Yes' ? (\r\n              <>\r\n                <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n                <span className=\"text-sm text-green-600\">Yes</span>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <XCircle className=\"h-4 w-4 text-gray-400\" />\r\n                <span className=\"text-sm text-gray-400\">No</span>\r\n              </>\r\n            )}\r\n          </div>\r\n        ),\r\n      }\r\n    }\r\n    if (column.accessor === 'actions') {\r\n      return {\r\n        ...column,\r\n        Cell: (row) => {\r\n          const review = reviewsList.find(r => (r._id || r.id) === row.id) || row\r\n          const isOpen = activeDropdown === row.id\r\n\r\n          return (\r\n            <div className={cn(\"relative\", isOpen ? \"z-50\" : \"z-0\")}>\r\n              <button\r\n                onClick={(e) => {\r\n                  e.stopPropagation()\r\n                  setActiveDropdown(isOpen ? null : row.id)\r\n                }}\r\n                className=\"p-2 rounded-lg hover:bg-gray-100 transition-colors text-gray-500\"\r\n                title=\"View Actions\"\r\n              >\r\n                <MoreVertical className=\"h-5 w-5\" />\r\n              </button>\r\n\r\n              {isOpen && (\r\n                <>\r\n                  <div\r\n                    className=\"fixed inset-0 z-40\"\r\n                    onClick={() => setActiveDropdown(null)}\r\n                  />\r\n                  <div className=\"absolute right-0 mt-2 w-48 rounded-xl bg-white shadow-xl ring-1 ring-black ring-opacity-5 z-50 py-2 overflow-hidden border border-gray-100 animate-in fade-in zoom-in duration-200\">\r\n                    <button\r\n                      onClick={() => {\r\n                        handleRespondToReview(review)\r\n                        setActiveDropdown(null)\r\n                      }}\r\n                      className=\"w-full text-left px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2 transition-colors\"\r\n                    >\r\n                      <MessageSquare className=\"h-4 w-4\" />\r\n                      {review.hasResponse === 'Yes' ? 'Edit Response' : 'Respond'}\r\n                    </button>\r\n\r\n                    {review.hasResponse === 'Yes' && (\r\n                      <button\r\n                        onClick={() => {\r\n                          handleDeleteResponse(review)\r\n                          setActiveDropdown(null)\r\n                        }}\r\n                        className=\"w-full text-left px-4 py-2.5 text-sm font-medium text-red-600 hover:bg-red-50 flex items-center gap-2 transition-colors\"\r\n                      >\r\n                        <Trash2 className=\"h-4 w-4\" />\r\n                        Delete Response\r\n                      </button>\r\n                    )}\r\n\r\n                    <div className=\"h-px bg-gray-100 my-1\" />\r\n\r\n                    {review.isVisible ? (\r\n                      <button\r\n                        onClick={() => {\r\n                          handleModerateReview(review, 'hide')\r\n                          setActiveDropdown(null)\r\n                        }}\r\n                        className=\"w-full text-left px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 flex items-center gap-2 transition-colors\"\r\n                      >\r\n                        <EyeOff className=\"h-4 w-4\" />\r\n                        Hide Review\r\n                      </button>\r\n                    ) : (\r\n                      <button\r\n                        onClick={() => {\r\n                          handleModerateReview(review, 'show')\r\n                          setActiveDropdown(null)\r\n                        }}\r\n                        className=\"w-full text-left px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 flex items-center gap-2 transition-colors\"\r\n                      >\r\n                        <Eye className=\"h-4 w-4\" />\r\n                        Show Review\r\n                      </button>\r\n                    )}\r\n\r\n                    {!review.isApproved && (\r\n                      <button\r\n                        onClick={() => {\r\n                          handleModerateReview(review, 'approve')\r\n                          setActiveDropdown(null)\r\n                        }}\r\n                        className=\"w-full text-left px-4 py-2.5 text-sm font-medium text-green-700 hover:bg-green-50 flex items-center gap-2 transition-colors\"\r\n                      >\r\n                        <CheckCircle className=\"h-4 w-4\" />\r\n                        Approve Review\r\n                      </button>\r\n                    )}\r\n\r\n                    <button\r\n                      onClick={() => {\r\n                        handleDeleteReview(review)\r\n                        setActiveDropdown(null)\r\n                      }}\r\n                      className=\"w-full text-left px-4 py-2.5 text-sm font-medium text-red-600 hover:bg-red-50 flex items-center gap-2 transition-colors\"\r\n                    >\r\n                      <Trash2 className=\"h-4 w-4\" />\r\n                      Delete Review\r\n                    </button>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          )\r\n        },\r\n      }\r\n    }\r\n    return column\r\n  })\r\n\r\n  // Format table rows - ensure each row has an id\r\n  const tableRows = reviewsList.map((review) => ({\r\n    id: review._id || review.id, // DataTable needs an id field\r\n    ...review,\r\n  }))\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">Product Reviews</h1>\r\n          <p className=\"text-sm text-gray-600 mt-1\">Manage and respond to product reviews</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <FilterBar\r\n        filters={[\r\n          {\r\n            label: 'Search',\r\n            type: 'search',\r\n            value: filters.search,\r\n            onChange: (value) => setFilters(prev => ({ ...prev, search: value })),\r\n            placeholder: 'Search by product, user, or comment...',\r\n          },\r\n          {\r\n            label: 'Rating',\r\n            type: 'select',\r\n            value: filters.rating,\r\n            onChange: (value) => setFilters(prev => ({ ...prev, rating: value })),\r\n            options: [\r\n              { value: '', label: 'All Ratings' },\r\n              { value: '5', label: '5 Stars' },\r\n              { value: '4', label: '4 Stars' },\r\n              { value: '3', label: '3 Stars' },\r\n              { value: '2', label: '2 Stars' },\r\n              { value: '1', label: '1 Star' },\r\n            ],\r\n          },\r\n          {\r\n            label: 'Has Response',\r\n            type: 'select',\r\n            value: filters.hasResponse,\r\n            onChange: (value) => setFilters(prev => ({ ...prev, hasResponse: value })),\r\n            options: [\r\n              { value: '', label: 'All' },\r\n              { value: 'true', label: 'With Response' },\r\n              { value: 'false', label: 'Without Response' },\r\n            ],\r\n          },\r\n          {\r\n            label: 'Status',\r\n            type: 'select',\r\n            value: filters.isApproved,\r\n            onChange: (value) => setFilters(prev => ({ ...prev, isApproved: value })),\r\n            options: [\r\n              { value: '', label: 'All' },\r\n              { value: 'true', label: 'Approved' },\r\n              { value: 'false', label: 'Pending' },\r\n            ],\r\n          },\r\n        ]}\r\n      />\r\n\r\n      {/* Reviews Table */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\r\n        {loading ? (\r\n          <div className=\"p-8 text-center text-gray-500\">\r\n            Loading reviews...\r\n          </div>\r\n        ) : (\r\n          <DataTable\r\n            columns={tableColumns}\r\n            rows={tableRows}\r\n            emptyState=\"No reviews found\"\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Response Modal */}\r\n      {showResponseModal && selectedReview && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"p-6 border-b border-gray-200\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h2 className=\"text-xl font-bold text-gray-900\">\r\n                  {editingResponse ? 'Edit Response' : 'Respond to Review'}\r\n                </h2>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowResponseModal(false)\r\n                    setResponseText('')\r\n                    setSelectedReview(null)\r\n                    setEditingResponse(false)\r\n                  }}\r\n                  className=\"text-gray-400 hover:text-gray-600\"\r\n                >\r\n                  <XCircle className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-6 space-y-4\">\r\n              {/* Review Details */}\r\n              <div className=\"p-4 bg-gray-50 rounded-lg space-y-3\">\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div>\r\n                    <h3 className=\"font-semibold text-gray-900\">{selectedReview.product}</h3>\r\n                    <p className=\"text-sm text-gray-600 mt-1\">{selectedReview.user}</p>\r\n                  </div>\r\n                  {renderStars(selectedReview.rating)}\r\n                </div>\r\n                <p className=\"text-sm text-gray-700\">{selectedReview.fullComment}</p>\r\n                <p className=\"text-xs text-gray-500\">{selectedReview.date}</p>\r\n              </div>\r\n\r\n              {/* Response Textarea */}\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\r\n                  Your Response <span className=\"text-red-500\">*</span>\r\n                </label>\r\n                <textarea\r\n                  value={responseText}\r\n                  onChange={(e) => setResponseText(e.target.value)}\r\n                  placeholder=\"Write your response to this review...\"\r\n                  className=\"w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-blue-500 focus:outline-none resize-none\"\r\n                  rows={6}\r\n                  maxLength={1000}\r\n                />\r\n                <p className=\"text-xs text-gray-500 mt-1\">\r\n                  {responseText.length}/1000 characters\r\n                </p>\r\n              </div>\r\n\r\n              {/* Actions */}\r\n              <div className=\"flex items-center gap-3 pt-4 border-t border-gray-200\">\r\n                <button\r\n                  onClick={handleSubmitResponse}\r\n                  disabled={!responseText.trim() || loading}\r\n                  className={cn(\r\n                    'flex-1 py-3 px-6 rounded-lg font-semibold transition-all flex items-center justify-center gap-2',\r\n                    !responseText.trim() || loading\r\n                      ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n                      : 'bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:shadow-md'\r\n                  )}\r\n                >\r\n                  <Send className=\"h-4 w-4\" />\r\n                  {loading ? 'Submitting...' : editingResponse ? 'Update Response' : 'Send Response'}\r\n                </button>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowResponseModal(false)\r\n                    setResponseText('')\r\n                    setSelectedReview(null)\r\n                    setEditingResponse(false)\r\n                  }}\r\n                  className=\"py-3 px-6 rounded-lg border-2 border-gray-300 text-gray-700 font-semibold hover:bg-gray-50 transition-all\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\SellerWithdrawals.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[598,634],"text":""},"desc":"Remove unused variable 'cn'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getMaskedBankDetails' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"getMaskedBankDetails"},"fix":{"range":[635,706],"text":""},"desc":"Remove unused variable 'getMaskedBankDetails'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\nimport { Wallet, ShieldCheck, Eye, CheckCircle, XCircle, Calendar, IndianRupee, Filter, Search } from 'lucide-react'\nimport { DataTable } from '../components/DataTable'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { Modal } from '../components/Modal'\nimport { ConfirmationModal } from '../components/ConfirmationModal'\nimport { SellerWithdrawalApprovalScreen } from '../components/SellerWithdrawalApprovalScreen'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { cn } from '../../../lib/cn'\nimport { getMaskedBankDetails } from '../../../utils/maskSensitiveData'\n\nconst columns = [\n  { Header: 'IRA Partner', accessor: 'sellerName' },\n  { Header: 'Amount', accessor: 'amount' },\n  { Header: 'Request Date', accessor: 'date' },\n  { Header: 'Status', accessor: 'status' },\n  { Header: 'Actions', accessor: 'actions' },\n]\n\nexport function SellerWithdrawalsPage({ subRoute = null, navigate }) {\n  const {\n    getSellerWithdrawalRequests,\n    approveSellerWithdrawal,\n    rejectSellerWithdrawal,\n    loading,\n  } = useAdminApi()\n  const { success, error: showError } = useToast()\n\n  const [withdrawals, setWithdrawals] = useState([])\n  const [total, setTotal] = useState(0)\n  const [filters, setFilters] = useState({ status: 'all', search: '' })\n  const [selectedRequest, setSelectedRequest] = useState(null)\n  const [modalOpen, setModalOpen] = useState(false)\n  const [actionLoading, setActionLoading] = useState(false)\n  const [confirmationModalOpen, setConfirmationModalOpen] = useState(false)\n  const [pendingAction, setPendingAction] = useState(null) // { type: 'approve' | 'reject', requestId: string, reason?: string }\n  const [approvingRequest, setApprovingRequest] = useState(null) // Request being approved (for full-screen flow)\n\n  const fetchWithdrawals = useCallback(async () => {\n    try {\n      const params = {\n        limit: 50,\n        ...(filters.status !== 'all' && { status: filters.status }),\n        ...(filters.search && { search: filters.search }),\n      }\n      const result = await getSellerWithdrawalRequests(params)\n      if (result.data) {\n        setWithdrawals(result.data.withdrawals || [])\n        setTotal(result.data.total || 0)\n      }\n    } catch (error) {\n      console.error('Failed to fetch seller withdrawals:', error)\n    }\n  }, [getSellerWithdrawalRequests, filters])\n\n  useEffect(() => {\n    fetchWithdrawals()\n  }, [fetchWithdrawals])\n\n  const handleViewRequest = (request) => {\n    setSelectedRequest(request)\n    setModalOpen(true)\n  }\n\n  const handleApprove = () => {\n    if (!selectedRequest) return\n    // Navigate to full-screen approval page\n    if (navigate) {\n      setApprovingRequest(selectedRequest)\n      navigate(`seller-withdrawals/approve/${selectedRequest.requestId || selectedRequest.id}`)\n    } else {\n      // Fallback to modal if navigate not available\n      setPendingAction({ type: 'approve', requestId: selectedRequest.requestId || selectedRequest.id })\n      setConfirmationModalOpen(true)\n    }\n  }\n\n  const handleReject = (requestId, rejectionData) => {\n    setPendingAction({ type: 'reject', requestId, reason: rejectionData?.reason })\n    setConfirmationModalOpen(true)\n  }\n\n  const handleConfirmAction = async () => {\n    if (!pendingAction) return\n    setActionLoading(true)\n    try {\n      let result\n      if (pendingAction.type === 'approve') {\n        result = await approveSellerWithdrawal(pendingAction.requestId)\n      } else if (pendingAction.type === 'reject') {\n        result = await rejectSellerWithdrawal(pendingAction.requestId, { reason: pendingAction.reason })\n      }\n\n      if (result?.data) {\n        success(`Withdrawal ${pendingAction.type === 'approve' ? 'approved' : 'rejected'} successfully!`)\n        setModalOpen(false)\n        setConfirmationModalOpen(false)\n        setSelectedRequest(null)\n        setPendingAction(null)\n        fetchWithdrawals()\n      } else if (result?.error) {\n        showError(result.error.message || `Failed to ${pendingAction.type} withdrawal`)\n      }\n    } catch (error) {\n      showError(error.message || `Failed to ${pendingAction.type} withdrawal`)\n    } finally {\n      setActionLoading(false)\n    }\n  }\n\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') return value\n    if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  const tableColumns = columns.map((column) => {\n    if (column.accessor === 'status') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const status = row.status || 'pending'\n          const tone = status === 'approved' ? 'success' : status === 'rejected' ? 'neutral' : status === 'completed' ? 'success' : 'warning'\n          return <StatusBadge tone={tone}>{status.charAt(0).toUpperCase() + status.slice(1)}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'amount') {\n      return {\n        ...column,\n        Cell: (row) => <span className=\"text-sm font-bold text-gray-900\">{formatCurrency(row.amount || 0)}</span>,\n      }\n    }\n    if (column.accessor === 'date') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const date = row.date || row.createdAt\n          return date ? new Date(date).toLocaleDateString('en-IN') : 'N/A'\n        },\n      }\n    }\n    if (column.accessor === 'actions') {\n      return {\n        ...column,\n        Cell: (row) => (\n          <button\n            type=\"button\"\n            onClick={() => handleViewRequest(row)}\n            className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-yellow-500 hover:bg-yellow-50 hover:text-yellow-700\"\n            title=\"View details\"\n          >\n            <Eye className=\"h-4 w-4\" />\n          </button>\n        ),\n      }\n    }\n    return column\n  })\n\n  const pendingCount = withdrawals.filter((w) => w.status === 'pending').length\n  const pendingAmount = withdrawals.filter((w) => w.status === 'pending').reduce((sum, w) => sum + (w.amount || 0), 0)\n\n  // Handle sub-route for approval screen\n  useEffect(() => {\n    if (subRoute && subRoute.startsWith('approve/')) {\n      const requestId = subRoute.replace('approve/', '')\n      const request = withdrawals.find((w) => (w.requestId || w.id) === requestId)\n      if (request) {\n        setApprovingRequest(request)\n      }\n    } else {\n      setApprovingRequest(null)\n    }\n  }, [subRoute, withdrawals])\n\n  // If approving, show approval screen\n  if (approvingRequest && subRoute?.startsWith('approve/')) {\n    return (\n      <SellerWithdrawalApprovalScreen\n        request={approvingRequest}\n        onBack={() => {\n          setApprovingRequest(null)\n          if (navigate) {\n            navigate('seller-withdrawals')\n          }\n        }}\n        onSuccess={() => {\n          setApprovingRequest(null)\n          fetchWithdrawals()\n          if (navigate) {\n            navigate('seller-withdrawals')\n          }\n        }}\n      />\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Finance â€¢ Withdrawals</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">IRA Partner Withdrawal Requests</h2>\n          <p className=\"text-sm text-gray-600\">Manage IRA Partner (Seller) withdrawal requests and process payments</p>\n        </div>\n      </header>\n\n      {/* Stats Cards */}\n      <div className=\"grid gap-6 md:grid-cols-3\">\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-yellow-500 to-yellow-600 text-white shadow-lg\">\n              <Wallet className=\"h-6 w-6\" />\n            </div>\n            <div>\n              <p className=\"text-xs text-gray-600\">Total Requests</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{total}</p>\n            </div>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-orange-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-lg\">\n              <Calendar className=\"h-6 w-6\" />\n            </div>\n            <div>\n              <p className=\"text-xs text-gray-600\">Pending Requests</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{pendingCount}</p>\n            </div>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-blue-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg\">\n              <IndianRupee className=\"h-6 w-6\" />\n            </div>\n            <div>\n              <p className=\"text-xs text-gray-600\">Pending Amount</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{formatCurrency(pendingAmount)}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex flex-wrap items-center gap-4 rounded-3xl border border-gray-200 bg-white p-4\">\n        <div className=\"flex items-center gap-2\">\n          <Filter className=\"h-4 w-4 text-gray-500\" />\n          <select\n            value={filters.status}\n            onChange={(e) => setFilters((prev) => ({ ...prev, status: e.target.value }))}\n            className=\"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm\"\n          >\n            <option value=\"all\">All Status</option>\n            <option value=\"pending\">Pending</option>\n            <option value=\"approved\">Approved</option>\n            <option value=\"rejected\">Rejected</option>\n            <option value=\"completed\">Completed</option>\n          </select>\n        </div>\n        <div className=\"flex flex-1 items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-2\">\n          <Search className=\"h-4 w-4 text-gray-500\" />\n          <input\n            type=\"text\"\n            placeholder=\"Search by IRA Partner name...\"\n            value={filters.search}\n            onChange={(e) => setFilters((prev) => ({ ...prev, search: e.target.value }))}\n            className=\"flex-1 border-none bg-transparent text-sm outline-none\"\n          />\n        </div>\n      </div>\n\n      {/* Withdrawals Table */}\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n        <DataTable\n          columns={tableColumns}\n          rows={withdrawals}\n          emptyState=\"No withdrawal requests found\"\n          loading={loading}\n        />\n      </div>\n\n      {/* Request Detail Modal */}\n      {selectedRequest && (\n        <Modal\n          isOpen={modalOpen}\n          onClose={() => {\n            setModalOpen(false)\n            setSelectedRequest(null)\n          }}\n          title=\"Withdrawal Request Details\"\n        >\n          <div className=\"space-y-4\">\n            <div className=\"grid gap-4 md:grid-cols-2\">\n              <div>\n                <p className=\"text-xs text-gray-600 mb-1\">IRA Partner</p>\n                <p className=\"text-sm font-bold text-gray-900\">{selectedRequest.sellerName || selectedRequest.sellerId || 'N/A'}</p>\n              </div>\n              <div>\n                <p className=\"text-xs text-gray-600 mb-1\">Amount</p>\n                <p className=\"text-sm font-bold text-green-600\">{formatCurrency(selectedRequest.amount || 0)}</p>\n              </div>\n              <div>\n                <p className=\"text-xs text-gray-600 mb-1\">Request Date</p>\n                <p className=\"text-sm font-medium text-gray-900\">\n                  {selectedRequest.date || selectedRequest.createdAt\n                    ? new Date(selectedRequest.date || selectedRequest.createdAt).toLocaleDateString('en-IN')\n                    : 'N/A'}\n                </p>\n              </div>\n              <div>\n                <p className=\"text-xs text-gray-600 mb-1\">Status</p>\n                <StatusBadge tone={selectedRequest.status === 'approved' ? 'success' : selectedRequest.status === 'rejected' ? 'neutral' : 'warning'}>\n                  {selectedRequest.status?.charAt(0).toUpperCase() + selectedRequest.status?.slice(1) || 'Pending'}\n                </StatusBadge>\n              </div>\n            </div>\n            {selectedRequest.bankDetails && (\n              <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-4\">\n                <p className=\"text-xs font-bold text-gray-600 mb-2\">Bank Account Details</p>\n                <div className=\"grid gap-2 md:grid-cols-2 text-sm text-gray-700\">\n                  {selectedRequest.bankDetails.accountHolderName && (\n                    <div>\n                      <span className=\"text-gray-600\">Account Holder: </span>\n                      <span className=\"font-medium\">{selectedRequest.bankDetails.accountHolderName}</span>\n                    </div>\n                  )}\n                  {selectedRequest.bankDetails.accountNumber && (\n                    <div>\n                      <span className=\"text-gray-600\">Account: </span>\n                      <span className=\"font-medium\">{selectedRequest.bankDetails.accountNumber}</span>\n                    </div>\n                  )}\n                  {selectedRequest.bankDetails.ifscCode && (\n                    <div>\n                      <span className=\"text-gray-600\">IFSC: </span>\n                      <span className=\"font-medium\">{selectedRequest.bankDetails.ifscCode}</span>\n                    </div>\n                  )}\n                  {selectedRequest.bankDetails.bankName && (\n                    <div>\n                      <span className=\"text-gray-600\">Bank: </span>\n                      <span className=\"font-medium\">{selectedRequest.bankDetails.bankName}</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n            {selectedRequest.status === 'pending' && (\n              <div className=\"flex items-center gap-3 pt-4 border-t border-gray-200\">\n                <button\n                  type=\"button\"\n                  onClick={handleReject}\n                  className=\"flex-1 rounded-xl border border-red-300 bg-white px-4 py-2 text-sm font-semibold text-red-700 transition-all hover:bg-red-50\"\n                >\n                  Reject\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={handleApprove}\n                  className=\"flex-1 rounded-xl bg-green-600 px-4 py-2 text-sm font-semibold text-white transition-all hover:bg-green-700\"\n                >\n                  Approve\n                </button>\n              </div>\n            )}\n          </div>\n        </Modal>\n      )}\n\n      {/* Confirmation Modal */}\n      <ConfirmationModal\n        isOpen={confirmationModalOpen}\n        onClose={() => {\n          setConfirmationModalOpen(false)\n          setPendingAction(null)\n        }}\n        onConfirm={handleConfirmAction}\n        title={`Confirm Withdrawal ${pendingAction?.type === 'approve' ? 'Approval' : 'Rejection'}`}\n        message={`Please verify all details before ${pendingAction?.type === 'approve' ? 'approving' : 'rejecting'} this withdrawal request. This action cannot be undone.`}\n        type={pendingAction?.type === 'reject' ? 'danger' : 'warning'}\n        details={selectedRequest && pendingAction ? {\n          'IRA Partner': selectedRequest.sellerName || selectedRequest.sellerId || 'N/A',\n          'Amount': formatCurrency(selectedRequest.amount || 0),\n          'Request Date': selectedRequest.date || 'N/A',\n          ...(pendingAction.type === 'reject' && pendingAction.reason ? {\n            'Rejection Reason': pendingAction.reason,\n          } : {}),\n        } : null}\n        loading={actionLoading}\n        confirmLabel={pendingAction?.type === 'approve' ? 'Approve' : 'Reject'}\n      />\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Sellers.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'getSellerChangeRequestDetails' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":41,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"getSellerChangeRequestDetails"},"fix":{"range":[1730,1765],"text":""},"desc":"Remove unused variable 'getSellerChangeRequestDetails'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleDeleteSeller' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":238,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":238,"endColumn":27}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\nimport { Award, Gift, Users, Edit2, Eye, Wallet, CheckCircle, XCircle, ArrowLeft, User, Hash, Percent, Target, IndianRupee, TrendingUp, Calendar, Search, Phone, FileText } from 'lucide-react'\nimport { DataTable } from '../components/DataTable'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { ProgressList } from '../components/ProgressList'\nimport { SellerForm } from '../components/SellerForm'\nimport { SellerEditForm } from '../components/SellerEditForm'\nimport { useAdminState } from '../context/AdminContext'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { sellers as mockSellers } from '../services/adminData'\nimport { cn } from '../../../lib/cn'\nimport { getMaskedBankDetails } from '../../../utils/maskSensitiveData'\n\nconst columns = [\n  { Header: 'IRA Partner', accessor: 'name' },\n  { Header: 'IRA Partner ID', accessor: 'id' },\n  { Header: 'Cashback %', accessor: 'cashback' },\n  { Header: 'Commission %', accessor: 'commission' },\n  { Header: 'Monthly Target', accessor: 'target' },\n  { Header: 'Progress', accessor: 'achieved' },\n  { Header: 'Referred Users', accessor: 'referrals' },\n  { Header: 'Total Sales', accessor: 'sales' },\n  { Header: 'Status', accessor: 'status' },\n  { Header: 'Actions', accessor: 'actions' },\n]\n\nexport function SellersPage({ subRoute = null, navigate }) {\n  const { sellers: sellersState } = useAdminState()\n  const {\n    getSellers,\n    createSeller,\n    updateSeller,\n    approveSeller,\n    rejectSeller,\n    deleteSeller,\n    getSellerWithdrawalRequests,\n    approveSellerWithdrawal,\n    rejectSellerWithdrawal,\n    getSellerChangeRequests,\n    getSellerChangeRequestDetails,\n    approveSellerChangeRequest,\n    rejectSellerChangeRequest,\n    loading,\n  } = useAdminApi()\n  const { success, error: showError, warning: showWarning } = useToast()\n\n  const [sellersList, setSellersList] = useState([])\n  const [allSellersList, setAllSellersList] = useState([])\n  const [withdrawalRequests, setWithdrawalRequests] = useState([])\n  const [changeRequests, setChangeRequests] = useState([])\n  \n  // View states (replacing modals with full-screen views)\n  const [currentView, setCurrentView] = useState(null) // 'sellerForm', 'sellerDetail', 'withdrawalRequest', 'approveSeller', 'rejectSeller', 'editSeller', 'changeRequest', 'approveChangeRequest', 'rejectChangeRequest'\n  const [selectedSeller, setSelectedSeller] = useState(null)\n  const [selectedSellerForDetail, setSelectedSellerForDetail] = useState(null)\n  const [selectedWithdrawalRequest, setSelectedWithdrawalRequest] = useState(null)\n  const [selectedChangeRequest, setSelectedChangeRequest] = useState(null)\n  const [selectedSellerForAction, setSelectedSellerForAction] = useState(null)\n  const [selectedSellerForEdit, setSelectedSellerForEdit] = useState(null)\n  const [rejectReason, setRejectReason] = useState('')\n  const [withdrawalRejectReason, setWithdrawalRejectReason] = useState(null) // null = not showing, '' = showing input\n  const [changeRequestRejectReason, setChangeRequestRejectReason] = useState(null) // null = not showing, '' = showing input, string = has value\n  const [changeRequestLoading, setChangeRequestLoading] = useState(false) // Local loading state for change request operations\n  const [searchQuery, setSearchQuery] = useState('')\n\n  // Format seller data for display\n  const formatSellerForDisplay = (seller) => {\n    const monthlyTarget = typeof seller.monthlyTarget === 'number'\n      ? seller.monthlyTarget\n      : parseFloat(seller.target?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n\n    const totalSales = typeof seller.totalSales === 'number'\n      ? seller.totalSales\n      : parseFloat(seller.sales?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n\n    const achieved = typeof seller.achieved === 'number'\n      ? seller.achieved\n      : typeof seller.progress === 'number'\n      ? seller.progress\n      : monthlyTarget > 0 ? ((totalSales / monthlyTarget) * 100).toFixed(1) : 0\n\n    const cashbackRate = typeof seller.cashbackRate === 'number'\n      ? seller.cashbackRate\n      : parseFloat(seller.cashback?.replace(/[%\\s]/g, '') || '0')\n\n    const commissionRate = typeof seller.commissionRate === 'number'\n      ? seller.commissionRate\n      : parseFloat(seller.commission?.replace(/[%\\s]/g, '') || '0')\n\n    return {\n      ...seller,\n      cashback: `${cashbackRate}%`,\n      commission: `${commissionRate}%`,\n      target: monthlyTarget >= 100000 ? `â‚¹${(monthlyTarget / 100000).toFixed(1)} L` : `â‚¹${monthlyTarget.toLocaleString('en-IN')}`,\n      achieved: parseFloat(achieved),\n      sales: totalSales >= 100000 ? `â‚¹${(totalSales / 100000).toFixed(1)} L` : `â‚¹${totalSales.toLocaleString('en-IN')}`,\n      referrals: seller.referrals || seller.referredUsers || 0,\n    }\n  }\n\n  // Fetch sellers\n  const fetchSellers = useCallback(async () => {\n    const result = await getSellers()\n    if (result.data?.sellers) {\n      const formatted = result.data.sellers.map(formatSellerForDisplay)\n      setAllSellersList(formatted)\n    } else {\n      // Fallback to mock data\n      const formatted = mockSellers.map(formatSellerForDisplay)\n      setAllSellersList(formatted)\n    }\n  }, [getSellers])\n\n  // Filter sellers based on subRoute and search\n  useEffect(() => {\n    let filtered = allSellersList\n\n    // Filter by subRoute\n    if (subRoute === 'active') {\n      // Active IRA Partners: those with sales and commissions\n      filtered = filtered.filter((s) => {\n        const sales = typeof s.totalSales === 'number' ? s.totalSales : parseFloat(s.sales?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n        return sales > 0 && (s.status === 'approved' || s.status === 'On Track' || s.status === 'on_track')\n      })\n    } else if (subRoute === 'inactive') {\n      // Inactive IRA Partners: those not getting sales and commissions\n      filtered = filtered.filter((s) => {\n        const sales = typeof s.totalSales === 'number' ? s.totalSales : parseFloat(s.sales?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n        return sales === 0 || (s.status !== 'approved' && s.status !== 'On Track' && s.status !== 'on_track')\n      })\n    }\n\n    // Filter by search query\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase().trim()\n      filtered = filtered.filter((s) => {\n        const name = (s.name || '').toLowerCase()\n        const phone = (s.phone || '').replace(/\\D/g, '')\n        const email = (s.email || '').toLowerCase()\n        const sellerId = (s.sellerId || s.id || '').toLowerCase()\n        const searchPhone = query.replace(/\\D/g, '')\n        \n        return name.includes(query) || \n               phone.includes(searchPhone) || \n               email.includes(query) ||\n               sellerId.includes(query)\n      })\n    }\n\n    setSellersList(filtered)\n  }, [subRoute, allSellersList, searchQuery])\n\n  // Fetch withdrawal requests\n  const fetchWithdrawalRequests = useCallback(async () => {\n    const result = await getSellerWithdrawalRequests({ status: 'pending' })\n    if (result.data?.withdrawals) {\n      setWithdrawalRequests(result.data.withdrawals)\n    }\n  }, [getSellerWithdrawalRequests])\n\n  // Fetch change requests\n  const fetchChangeRequests = useCallback(async () => {\n    const result = await getSellerChangeRequests({ status: 'pending' })\n    if (result.data?.changeRequests) {\n      setChangeRequests(result.data.changeRequests)\n    }\n  }, [getSellerChangeRequests])\n\n  useEffect(() => {\n    fetchSellers()\n    fetchWithdrawalRequests()\n    fetchChangeRequests()\n  }, [fetchSellers, fetchWithdrawalRequests, fetchChangeRequests])\n\n  // Refresh when sellers are updated\n  useEffect(() => {\n    if (sellersState.updated) {\n      fetchSellers()\n      fetchWithdrawalRequests()\n    }\n  }, [sellersState.updated, fetchSellers, fetchWithdrawalRequests])\n\n  const handleCreateSeller = () => {\n    setSelectedSeller(null)\n    setCurrentView('sellerForm')\n  }\n\n  const handleEditSeller = (seller) => {\n    const originalSeller = sellersState.data?.sellers?.find((s) => s.id === seller.id) || seller\n    setSelectedSeller(originalSeller)\n    setCurrentView('sellerForm')\n  }\n\n  const handleViewSellerDetails = (seller) => {\n    const originalSeller = sellersState.data?.sellers?.find((s) => s.id === seller.id) || seller\n    setSelectedSellerForDetail(originalSeller)\n    setCurrentView('sellerDetail')\n  }\n\n  const handleBackToList = () => {\n    setCurrentView(null)\n    setSelectedSeller(null)\n    setSelectedSellerForDetail(null)\n    setSelectedWithdrawalRequest(null)\n    setSelectedSellerForAction(null)\n    setSelectedSellerForEdit(null)\n    setRejectReason('')\n    setWithdrawalRejectReason(null)\n    setChangeRequestRejectReason(null)\n    if (navigate) navigate('sellers')\n  }\n\n  const handleEditSellerBasicInfo = (seller) => {\n    const originalSeller = sellersState.data?.sellers?.find((s) => s.id === seller.id) || seller\n    setSelectedSellerForEdit(originalSeller)\n    setCurrentView('editSeller')\n  }\n\n  const handleSaveSeller = async (sellerData) => {\n    try {\n      const result = await updateSeller(selectedSellerForEdit.id, sellerData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedSellerForEdit(null)\n        fetchSellers()\n        success('IRA Partner information updated successfully!', 3000)\n        if (navigate) navigate('sellers')\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to update IRA partner'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to update IRA partner', 5000)\n    }\n  }\n\n  const handleDeleteSeller = async (sellerId) => {\n    if (window.confirm('Are you sure you want to delete this seller? This action cannot be undone.')) {\n      try {\n        const result = await deleteSeller(sellerId)\n        if (result.data) {\n          fetchSellers()\n          success('Seller deleted successfully!', 3000)\n        } else if (result.error) {\n          const errorMessage = result.error.message || 'Failed to delete seller'\n          if (errorMessage.includes('active') || errorMessage.includes('cannot')) {\n            showWarning(errorMessage, 6000)\n          } else {\n            showError(errorMessage, 5000)\n          }\n        }\n      } catch (error) {\n        showError(error.message || 'Failed to delete seller', 5000)\n      }\n    }\n  }\n\n  const handleFormSubmit = async (formData) => {\n    try {\n      if (selectedSeller) {\n        // Update existing seller\n        const result = await updateSeller(selectedSeller.id, formData)\n        if (result.data) {\n          setCurrentView(null)\n          setSelectedSeller(null)\n          fetchSellers()\n          success('Seller updated successfully!', 3000)\n        } else if (result.error) {\n          const errorMessage = result.error.message || 'Failed to update seller'\n          if (errorMessage.includes('validation') || errorMessage.includes('required') || errorMessage.includes('duplicate')) {\n            showWarning(errorMessage, 5000)\n          } else {\n            showError(errorMessage, 5000)\n          }\n        }\n      } else {\n        // Create new seller\n        const result = await createSeller(formData)\n        if (result.data) {\n          setCurrentView(null)\n          fetchSellers()\n          success('Seller created successfully!', 3000)\n        } else if (result.error) {\n          const errorMessage = result.error.message || 'Failed to create seller'\n          if (errorMessage.includes('validation') || errorMessage.includes('required') || errorMessage.includes('duplicate')) {\n            showWarning(errorMessage, 5000)\n          } else {\n            showError(errorMessage, 5000)\n          }\n        }\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to save seller', 5000)\n    }\n  }\n\n  const handleApproveWithdrawal = async (requestId) => {\n    try {\n      const result = await approveSellerWithdrawal(requestId)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedWithdrawalRequest(null)\n        setWithdrawalRejectReason(null)\n        fetchWithdrawalRequests()\n        success('Withdrawal request approved successfully!', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to approve withdrawal'\n        if (errorMessage.includes('insufficient') || errorMessage.includes('balance')) {\n          showWarning(errorMessage, 6000)\n        } else {\n          showError(errorMessage, 5000)\n        }\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to approve withdrawal', 5000)\n    }\n  }\n\n  const handleRejectWithdrawal = async (requestId, rejectionData) => {\n    try {\n      const result = await rejectSellerWithdrawal(requestId, rejectionData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedWithdrawalRequest(null)\n        setWithdrawalRejectReason(null)\n        fetchWithdrawalRequests()\n        success('Withdrawal request rejected.', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to reject withdrawal'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to reject withdrawal', 5000)\n    }\n  }\n\n  const handleApproveChangeRequest = async (requestId) => {\n    try {\n      setChangeRequestLoading(true)\n      const result = await approveSellerChangeRequest(requestId)\n      if (result && result.success && result.data) {\n        setCurrentView(null)\n        setSelectedChangeRequest(null)\n        setChangeRequestRejectReason(null)\n        fetchChangeRequests()\n        fetchSellers()\n        success('Change request approved successfully!', 3000)\n        // Navigate back to list if multiple requests exist, otherwise to sellers list\n        if (changeRequests.length > 1) {\n          setCurrentView('changeRequestList')\n        } else {\n          handleBackToList()\n        }\n      } else if (result && result.error) {\n        const errorMessage = result.error.message || 'Failed to approve change request'\n        showError(errorMessage, 5000)\n      } else {\n        showError('Failed to approve change request. Please try again.', 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to approve change request', 5000)\n    } finally {\n      setChangeRequestLoading(false)\n    }\n  }\n\n  const handleRejectChangeRequest = async (requestId, rejectionData) => {\n    try {\n      setChangeRequestLoading(true)\n      const result = await rejectSellerChangeRequest(requestId, rejectionData)\n      if (result && result.success && result.data) {\n        setCurrentView(null)\n        setSelectedChangeRequest(null)\n        setChangeRequestRejectReason(null)\n        fetchChangeRequests()\n        success('Change request rejected successfully.', 3000)\n        // Navigate back to list if multiple requests exist, otherwise to sellers list\n        if (changeRequests.length > 1) {\n          setCurrentView('changeRequestList')\n        } else {\n          handleBackToList()\n        }\n      } else if (result && result.error) {\n        const errorMessage = result.error.message || 'Failed to reject change request'\n        showError(errorMessage, 5000)\n      } else {\n        showError('Failed to reject change request. Please try again.', 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to reject change request', 5000)\n    } finally {\n      setChangeRequestLoading(false)\n    }\n  }\n\n  const handleApproveSeller = async (sellerId) => {\n    try {\n      const result = await approveSeller(sellerId)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedSellerForAction(null)\n        fetchSellers()\n        success('Seller approved successfully!', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to approve seller'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to approve seller', 5000)\n    }\n  }\n\n  const handleRejectSeller = async (sellerId, rejectionData) => {\n    try {\n      const result = await rejectSeller(sellerId, rejectionData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedSellerForAction(null)\n        setRejectReason('')\n        fetchSellers()\n        success('Seller rejected successfully.', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to reject seller'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to reject seller', 5000)\n    }\n  }\n\n  const tableColumns = columns.map((column) => {\n    if (column.accessor === 'achieved') {\n      return {\n        ...column,\n        Cell: (row) => (\n          <div className=\"w-32\">\n            <div className=\"flex items-center justify-between text-xs text-gray-600\">\n              <span>{row.achieved}%</span>\n              <span>{row.sales}</span>\n            </div>\n            <div className=\"mt-1 h-2.5 w-full overflow-hidden rounded-full bg-gray-100 shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)]\">\n              <div\n                className={cn(\n                  'h-full rounded-full shadow-[0_2px_8px_rgba(234,179,8,0.3)]',\n                  row.achieved >= 100\n                    ? 'bg-gradient-to-r from-green-500 to-green-600'\n                    : row.achieved >= 80\n                    ? 'bg-gradient-to-r from-yellow-500 to-yellow-600'\n                    : 'bg-gradient-to-r from-orange-500 to-orange-600',\n                )}\n                style={{ width: `${Math.min(row.achieved, 100)}%` }}\n              />\n            </div>\n          </div>\n        ),\n      }\n    }\n    if (column.accessor === 'status') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const status = row.status || 'Unknown'\n          let tone = 'warning'\n          if (status === 'approved' || status === 'On Track' || status === 'on_track') {\n            tone = 'success'\n          } else if (status === 'pending') {\n            tone = 'warning'\n          } else if (status === 'rejected') {\n            tone = 'error'\n          }\n          return <StatusBadge tone={tone}>{status === 'approved' ? 'Approved' : status === 'pending' ? 'Pending' : status === 'rejected' ? 'Rejected' : status}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'actions') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const originalSeller = sellersState.data?.sellers?.find((s) => s.id === row.id) || row\n          const sellerStatus = originalSeller.status || row.status || 'unknown'\n          const isPending = sellerStatus === 'pending'\n          \n          return (\n            <div className=\"flex items-center gap-2\">\n              <button\n                type=\"button\"\n                onClick={() => handleViewSellerDetails(originalSeller)}\n                className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-purple-500 hover:bg-purple-50 hover:text-purple-700\"\n                title=\"View details\"\n              >\n                <Eye className=\"h-4 w-4\" />\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => handleEditSellerBasicInfo(originalSeller)}\n                className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-yellow-500 hover:bg-yellow-50 hover:text-yellow-700\"\n                title=\"Edit IRA partner information\"\n              >\n                <Edit2 className=\"h-4 w-4\" />\n              </button>\n              {isPending && (\n                <>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedSellerForAction(originalSeller)\n                      setCurrentView('approveSeller')\n                    }}\n                    className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-green-300 bg-green-50 text-green-700 transition-all hover:border-green-500 hover:bg-green-100\"\n                    title=\"Approve seller\"\n                  >\n                    <CheckCircle className=\"h-4 w-4\" />\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedSellerForAction(originalSeller)\n                      setRejectReason('')\n                      setCurrentView('rejectSeller')\n                    }}\n                    className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-red-300 bg-red-50 text-red-700 transition-all hover:border-red-500 hover:bg-red-100\"\n                    title=\"Reject seller\"\n                  >\n                    <XCircle className=\"h-4 w-4\" />\n                  </button>\n                </>\n              )}\n              {!isPending && (\n                <button\n                  type=\"button\"\n                  onClick={() => handleEditSeller(originalSeller)}\n                  className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-yellow-500 hover:bg-yellow-50 hover:text-yellow-700\"\n                  title=\"Edit seller\"\n                >\n                  <Edit2 className=\"h-4 w-4\" />\n                </button>\n              )}\n            </div>\n          )\n        },\n      }\n    }\n    return column\n  })\n\n  const totalPendingWithdrawals = withdrawalRequests.reduce((sum, req) => sum + (req.amount || 0), 0)\n\n  // Helper functions for seller detail view\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') {\n      return value\n    }\n    if (value >= 100000) {\n      return `â‚¹${(value / 100000).toFixed(1)} L`\n    }\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  // Helper functions for withdrawal request view\n  const getRequestId = (request) => {\n    if (!request) return null\n    if (typeof request.id === 'string') {\n      return request.id\n    }\n    if (request._id) {\n      return typeof request._id === 'string' ? request._id : String(request._id)\n    }\n    if (request.requestId) {\n      return typeof request.requestId === 'string' ? request.requestId : String(request.requestId)\n    }\n    if (request.id && typeof request.id === 'object' && request.id._id) {\n      return String(request.id._id)\n    }\n    return null\n  }\n\n  const getSellerId = (request) => {\n    if (!request) return null\n    if (typeof request.sellerId === 'string') {\n      return request.sellerId\n    }\n    if (request.sellerId && typeof request.sellerId === 'object') {\n      return request.sellerId.sellerId || request.sellerId._id || request.sellerId.id\n    }\n    if (request.seller && typeof request.seller === 'object') {\n      return request.seller.sellerId || request.seller._id || request.seller.id\n    }\n    return null\n  }\n\n  const getSellerName = (request) => {\n    if (!request) return 'Unknown IRA Partner'\n    if (request.sellerName) {\n      return request.sellerName\n    }\n    if (request.sellerId && typeof request.sellerId === 'object') {\n      return request.sellerId.name\n    }\n    if (request.seller && typeof request.seller === 'object') {\n      return request.seller.name\n    }\n    return 'Unknown IRA Partner'\n  }\n\n  // If a full-screen view is active, render it instead of the main list\n  if (currentView === 'editSeller' && selectedSellerForEdit) {\n    return (\n      <SellerEditForm\n        seller={selectedSellerForEdit}\n        onSave={handleSaveSeller}\n        onCancel={handleBackToList}\n        loading={loading}\n      />\n    )\n  }\n\n  if (currentView === 'sellerForm') {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-purple-500 hover:bg-purple-50 hover:text-purple-700\"\n            title=\"Back to IRA Partners\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">\n            {selectedSeller ? 'Edit IRA Partner Profile' : 'Create New IRA Partner Profile'}\n          </h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <SellerForm\n            seller={selectedSeller}\n            onSubmit={handleFormSubmit}\n            onCancel={handleBackToList}\n            loading={loading}\n          />\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'sellerDetail' && selectedSellerForDetail) {\n    const seller = selectedSellerForDetail\n    const monthlyTarget = typeof seller.monthlyTarget === 'number'\n      ? seller.monthlyTarget\n      : parseFloat(seller.target?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n\n    const totalSales = typeof seller.totalSales === 'number'\n      ? seller.totalSales\n      : parseFloat(seller.sales?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n\n    const achieved = typeof seller.achieved === 'number'\n      ? seller.achieved\n      : typeof seller.progress === 'number'\n      ? seller.progress\n      : monthlyTarget > 0 ? ((totalSales / monthlyTarget) * 100).toFixed(1) : 0\n\n    const cashbackRate = typeof seller.cashbackRate === 'number'\n      ? seller.cashbackRate\n      : parseFloat(seller.cashback?.replace(/[%\\s]/g, '') || '0')\n\n    const commissionRate = typeof seller.commissionRate === 'number'\n      ? seller.commissionRate\n      : parseFloat(seller.commission?.replace(/[%\\s]/g, '') || '0')\n\n    const referrals = seller.referrals || seller.referredUsers || 0\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-purple-500 hover:bg-purple-50 hover:text-purple-700\"\n            title=\"Back to IRA Partners\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">IRA Partner Performance Details</h2>\n        </div>\n        <div className=\"space-y-6\">\n          {/* IRA Partner Header */}\n          <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-yellow-500 to-yellow-600 text-white shadow-lg\">\n                  <User className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{seller.name}</h3>\n                  <p className=\"text-sm text-gray-600\">IRA Partner ID: {seller.sellerId || seller.id}</p>\n                  {seller.area && (\n                    <p className=\"mt-1 text-xs text-gray-500\">{seller.area}</p>\n                  )}\n                </div>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <StatusBadge tone={seller.status === 'On Track' || seller.status === 'on_track' ? 'success' : 'warning'}>\n                  {seller.status || 'Unknown'}\n                </StatusBadge>\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setSelectedSeller(seller)\n                    setCurrentView('sellerForm')\n                  }}\n                  className=\"rounded-lg border border-yellow-300 bg-white px-4 py-2 text-xs font-bold text-yellow-700 transition-all hover:bg-yellow-50\"\n                >\n                  Edit Profile\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Performance Metrics */}\n          <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-4\">\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n                <Target className=\"h-4 w-4\" />\n                <span>Monthly Target</span>\n              </div>\n              <p className=\"mt-1 text-lg font-bold text-gray-900\">\n                {formatCurrency(monthlyTarget)}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n                <TrendingUp className=\"h-4 w-4\" />\n                <span>Total Sales</span>\n              </div>\n              <p className=\"mt-1 text-lg font-bold text-gray-900\">\n                {formatCurrency(totalSales)}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n                <Users className=\"h-4 w-4\" />\n                <span>Referred Users</span>\n              </div>\n              <p className=\"mt-1 text-lg font-bold text-gray-900\">\n                {referrals.toLocaleString('en-IN')}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n                <Award className=\"h-4 w-4\" />\n                <span>Progress</span>\n              </div>\n              <p className=\"mt-1 text-lg font-bold text-gray-900\">\n                {parseFloat(achieved).toFixed(1)}%\n              </p>\n            </div>\n          </div>\n\n          {/* Progress Bar */}\n          <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-5\">\n            <div className=\"mb-2 flex items-center justify-between text-sm\">\n              <span className=\"font-bold text-gray-900\">Target Achievement</span>\n              <span className=\"font-bold text-yellow-700\">{parseFloat(achieved).toFixed(1)}%</span>\n            </div>\n            <div className=\"h-4 w-full overflow-hidden rounded-full bg-gray-200 shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)]\">\n              <div\n                className={cn(\n                  'h-full rounded-full transition-all shadow-[0_2px_8px_rgba(234,179,8,0.3)]',\n                  parseFloat(achieved) >= 100\n                    ? 'bg-gradient-to-r from-green-500 to-green-600'\n                    : parseFloat(achieved) >= 80\n                    ? 'bg-gradient-to-r from-yellow-500 to-yellow-600'\n                    : 'bg-gradient-to-r from-orange-500 to-orange-600',\n                )}\n                style={{ width: `${Math.min(achieved, 100)}%` }}\n              />\n            </div>\n          </div>\n\n          {/* Incentive Settings */}\n          <div className=\"rounded-xl border border-yellow-200 bg-white p-5\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h4 className=\"text-sm font-bold text-gray-900\">Incentive Settings</h4>\n                <div className=\"mt-3 grid gap-3 text-sm sm:grid-cols-2\">\n                  <div>\n                    <span className=\"text-gray-500\">Cashback Rate: </span>\n                    <span className=\"font-bold text-gray-900\">{cashbackRate}%</span>\n                  </div>\n                  <div>\n                    <span className=\"text-gray-500\">Commission Rate: </span>\n                    <span className=\"font-bold text-gray-900\">{commissionRate}%</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Contact Information */}\n          {(seller.email || seller.phone) && (\n            <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-5\">\n              <h4 className=\"mb-3 text-sm font-bold text-gray-900\">Contact Information</h4>\n              <div className=\"grid gap-2 text-sm sm:grid-cols-2\">\n                {seller.email && (\n                  <div>\n                    <span className=\"text-gray-500\">Email: </span>\n                    <span className=\"text-gray-900\">{seller.email}</span>\n                  </div>\n                )}\n                {seller.phone && (\n                  <div>\n                    <span className=\"text-gray-500\">Phone: </span>\n                    <span className=\"text-gray-900\">{seller.phone}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'withdrawalRequest' && selectedWithdrawalRequest) {\n    const request = selectedWithdrawalRequest\n    const requestId = getRequestId(request)\n    const sellerId = getSellerId(request)\n    const sellerName = getSellerName(request)\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-purple-500 hover:bg-purple-50 hover:text-purple-700\"\n            title=\"Back to IRA Partners\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">IRA Partner Withdrawal Request Review</h2>\n        </div>\n        <div className=\"space-y-6\">\n          {/* Request Header */}\n          <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-yellow-500 to-yellow-600 text-white shadow-lg\">\n                  <Wallet className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">Request #{requestId || 'N/A'}</h3>\n                  <div className=\"mt-1 flex items-center gap-2 text-sm text-gray-600\">\n                    <User className=\"h-4 w-4\" />\n                    <span>{sellerName}</span>\n                  </div>\n                  {sellerId && (\n                    <p className=\"mt-1 text-xs text-gray-500\">IRA Partner ID: {sellerId}</p>\n                  )}\n                  {(request.date || request.createdAt) && (\n                    <div className=\"mt-2 flex items-center gap-1 text-xs text-gray-500\">\n                      <Calendar className=\"h-3.5 w-3.5\" />\n                      <span>\n                        {request.date \n                          ? (typeof request.date === 'string' ? request.date : new Date(request.date).toLocaleDateString('en-IN'))\n                          : request.createdAt \n                          ? (typeof request.createdAt === 'string' ? request.createdAt : new Date(request.createdAt).toLocaleDateString('en-IN'))\n                          : ''}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </div>\n              <StatusBadge tone={request.status === 'pending' ? 'warning' : request.status === 'approved' ? 'success' : 'neutral'}>\n                {request.status || 'Pending'}\n              </StatusBadge>\n            </div>\n          </div>\n\n          {/* Withdrawal Details */}\n          <div className=\"space-y-4\">\n            <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-5\">\n              <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\n                <IndianRupee className=\"h-4 w-4\" />\n                <span>Withdrawal Amount</span>\n              </div>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {formatCurrency(request.amount || 0)}\n              </p>\n            </div>\n\n            {request.bankDetails && (() => {\n              const maskedDetails = getMaskedBankDetails({\n                ...request.bankDetails,\n                ifscCode: request.bankDetails.ifsc || request.bankDetails.ifscCode,\n              })\n              return (\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <p className=\"mb-2 text-xs font-bold text-gray-500\">Bank Account Details (Masked for Privacy)</p>\n                  <div className=\"space-y-1 text-sm text-gray-700\">\n                    {maskedDetails.accountHolderName && (\n                      <p>Account Holder: {maskedDetails.accountHolderName}</p>\n                    )}\n                    {maskedDetails.accountNumber && (\n                      <p>Account: {maskedDetails.accountNumber}</p>\n                    )}\n                    {maskedDetails.ifscCode && (\n                      <p>IFSC: {maskedDetails.ifscCode}</p>\n                    )}\n                    {maskedDetails.bankName && (\n                      <p>Bank: {maskedDetails.bankName}</p>\n                    )}\n                  </div>\n                  <p className=\"mt-2 text-xs text-gray-500 italic\">\n                    Note: Account details are masked for security. Full details are available in payment history for processed transactions.\n                  </p>\n                </div>\n              )\n            })()}\n\n            {request.reason && (\n              <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                <p className=\"mb-2 text-xs font-bold text-gray-500\">Reason for Withdrawal</p>\n                <p className=\"text-sm text-gray-700\">{request.reason}</p>\n              </div>\n            )}\n\n            {request.sellerPerformance && (\n              <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n                <p className=\"mb-2 text-xs font-bold text-blue-900\">IRA Partner Performance Summary</p>\n                <div className=\"grid gap-2 text-xs text-blue-800 sm:grid-cols-2\">\n                  {request.sellerPerformance.totalSales && (\n                    <div>\n                      <span className=\"font-semibold\">Total Sales: </span>\n                      <span>{formatCurrency(request.sellerPerformance.totalSales)}</span>\n                    </div>\n                  )}\n                  {request.sellerPerformance.pendingEarnings && (\n                    <div>\n                      <span className=\"font-semibold\">Pending Earnings: </span>\n                      <span>{formatCurrency(request.sellerPerformance.pendingEarnings)}</span>\n                    </div>\n                  )}\n                  {request.sellerPerformance.targetAchievement && (\n                    <div>\n                      <span className=\"font-semibold\">Target Achievement: </span>\n                      <span>{request.sellerPerformance.targetAchievement}%</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n\n            {withdrawalRejectReason !== null && (\n              <div className=\"rounded-xl border border-red-200 bg-red-50 p-4\">\n                <label className=\"mb-2 block text-xs font-bold text-gray-700\">Rejection Reason</label>\n                <textarea\n                  value={withdrawalRejectReason}\n                  onChange={(e) => setWithdrawalRejectReason(e.target.value)}\n                  placeholder=\"Please provide a reason for rejection...\"\n                  className=\"w-full rounded-lg border border-red-300 bg-white p-3 text-sm text-gray-900 focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-200\"\n                  rows={3}\n                />\n              </div>\n            )}\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n            <button\n              type=\"button\"\n              onClick={handleBackToList}\n              disabled={loading}\n              className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n            >\n              Cancel\n            </button>\n            <div className=\"flex gap-3\">\n              {withdrawalRejectReason === null ? (\n                <button\n                  type=\"button\"\n                  onClick={() => setWithdrawalRejectReason('')}\n                  disabled={loading}\n                  className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50 disabled:opacity-50\"\n                >\n                  <XCircle className=\"h-4 w-4\" />\n                  Reject\n                </button>\n              ) : (\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    if (requestId) {\n                      handleRejectWithdrawal(requestId, { reason: withdrawalRejectReason || undefined })\n                    }\n                  }}\n                  disabled={loading}\n                  className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-red-600 px-6 py-3 text-sm font-bold text-white transition-all hover:bg-red-700 disabled:opacity-50\"\n                >\n                  <XCircle className=\"h-4 w-4\" />\n                  Confirm Rejection\n                </button>\n              )}\n              <button\n                type=\"button\"\n                onClick={() => {\n                  if (requestId) {\n                    handleApproveWithdrawal(requestId)\n                  }\n                }}\n                disabled={loading}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-yellow-500 to-yellow-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(234,179,8,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(234,179,8,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <CheckCircle className=\"h-4 w-4\" />\n                {loading ? 'Processing...' : 'Approve Withdrawal'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Change Request List View (when multiple requests exist)\n  if (currentView === 'changeRequestList' && changeRequests.length > 1) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-purple-500 hover:bg-purple-50 hover:text-purple-700\"\n            title=\"Back to IRA Partners\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Change Requests ({changeRequests.length})</h2>\n        </div>\n\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6 shadow-lg\">\n          <div className=\"space-y-4\">\n            {changeRequests.map((request) => {\n              const seller = request.sellerId || {}\n              const isNameChange = request.changeType === 'name'\n              const requestId = request._id || request.id\n              \n              return (\n                <div\n                  key={requestId}\n                  className=\"rounded-xl border border-gray-200 bg-white p-5 hover:border-purple-300 hover:shadow-md transition-all\"\n                >\n                  <div className=\"flex items-start justify-between gap-4\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <div className={`flex h-10 w-10 items-center justify-center rounded-lg ${\n                          isNameChange ? 'bg-blue-100 text-blue-600' : 'bg-green-100 text-green-600'\n                        }`}>\n                          {isNameChange ? <User className=\"h-5 w-5\" /> : <Phone className=\"h-5 w-5\" />}\n                        </div>\n                        <div>\n                          <h3 className=\"text-base font-bold text-gray-900\">\n                            {isNameChange ? 'Name Change Request' : 'Phone Change Request'}\n                          </h3>\n                          <p className=\"text-sm text-gray-600\">\n                            {seller.name || 'N/A'} ({seller.sellerId || request.sellerIdCode || 'N/A'})\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"ml-[52px] space-y-1\">\n                        <div className=\"flex items-center gap-2 text-sm\">\n                          <span className=\"text-gray-500\">Current:</span>\n                          <span className=\"font-semibold text-gray-900\">{request.currentValue || 'N/A'}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-sm\">\n                          <span className=\"text-gray-500\">Requested:</span>\n                          <span className=\"font-semibold text-green-700\">{request.requestedValue || 'N/A'}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-xs text-gray-400\">\n                          <Calendar className=\"h-3 w-3\" />\n                          <span>\n                            {request.createdAt ? new Date(request.createdAt).toLocaleDateString('en-IN', { \n                              day: 'numeric', \n                              month: 'short', \n                              year: 'numeric', \n                              hour: '2-digit', \n                              minute: '2-digit' \n                            }) : 'N/A'}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                    <button\n                      onClick={() => {\n                        setSelectedChangeRequest(request)\n                        setChangeRequestRejectReason(null)\n                        setCurrentView('changeRequest')\n                      }}\n                      className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-purple-500 to-purple-600 px-4 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(147,51,234,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(147,51,234,0.4),inset_0_1px_0_rgba(255,255,255,0.2)]\"\n                    >\n                      <Eye className=\"h-4 w-4\" />\n                      View Details\n                    </button>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Change Request Detail View\n  if (currentView === 'changeRequest' && selectedChangeRequest) {\n    const request = selectedChangeRequest\n    const requestId = request._id || request.id\n    const seller = request.sellerId || {}\n    const isNameChange = request.changeType === 'name'\n    const isPhoneChange = request.changeType === 'phone'\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={() => {\n              setChangeRequestRejectReason(null)\n              if (changeRequests.length > 1) {\n                setCurrentView('changeRequestList')\n                setSelectedChangeRequest(null)\n              } else {\n                handleBackToList()\n              }\n            }}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-purple-500 hover:bg-purple-50 hover:text-purple-700\"\n            title={changeRequests.length > 1 ? \"Back to Change Requests List\" : \"Back to IRA Partners\"}\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">\n            {isNameChange ? 'Name Change Request' : 'Phone Change Request'}\n          </h2>\n        </div>\n\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6 shadow-lg\">\n          <div className=\"space-y-6\">\n            {/* Seller Info */}\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-purple-500 to-purple-600 text-white shadow-lg\">\n                  <User className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{seller.name || 'N/A'}</h3>\n                  <p className=\"text-sm text-gray-600\">IRA Partner ID: {seller.sellerId || request.sellerIdCode || 'N/A'}</p>\n                  <p className=\"text-sm text-gray-600\">Phone: {seller.phone || request.currentValue || 'N/A'}</p>\n                </div>\n              </div>\n            </div>\n\n            {/* Change Details */}\n            <div className=\"rounded-xl border border-purple-200 bg-purple-50 p-5\">\n              <h4 className=\"mb-4 text-sm font-bold uppercase tracking-wide text-purple-900\">\n                Change Request Details\n              </h4>\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between rounded-lg border border-purple-200 bg-white p-4\">\n                  <div>\n                    <p className=\"text-xs font-semibold uppercase text-gray-500\">Current {isNameChange ? 'Name' : 'Phone'}</p>\n                    <p className=\"mt-1 text-lg font-bold text-gray-900\">{request.currentValue || 'N/A'}</p>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"mx-auto h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center\">\n                      <ArrowLeft className=\"h-4 w-4 text-purple-600 rotate-180\" />\n                    </div>\n                  </div>\n                  <div>\n                    <p className=\"text-xs font-semibold uppercase text-gray-500\">Requested {isNameChange ? 'Name' : 'Phone'}</p>\n                    <p className=\"mt-1 text-lg font-bold text-green-700\">{request.requestedValue || 'N/A'}</p>\n                  </div>\n                </div>\n\n                {request.description && (\n                  <div className=\"rounded-lg border border-purple-200 bg-white p-4\">\n                    <p className=\"text-xs font-semibold uppercase text-gray-500 mb-2\">Description</p>\n                    <p className=\"text-sm text-gray-700\">{request.description}</p>\n                  </div>\n                )}\n\n                <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n                  <Calendar className=\"h-3 w-3\" />\n                  <span>Requested on: {request.createdAt ? new Date(request.createdAt).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' }) : 'N/A'}</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Warning for phone change */}\n            {isPhoneChange && (\n              <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-4\">\n                <p className=\"text-sm text-yellow-800\">\n                  <strong>Note:</strong> Changing the phone number will require the seller to use the new number for future logins.\n                </p>\n              </div>\n            )}\n\n            {/* Action Buttons */}\n            <div className=\"flex flex-col-reverse gap-3 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              {changeRequestRejectReason === null ? (\n                <button\n                  type=\"button\"\n                  onClick={() => setChangeRequestRejectReason('')}\n                  disabled={changeRequestLoading}\n                  className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50 disabled:opacity-50\"\n                >\n                  <XCircle className=\"h-4 w-4\" />\n                  Reject\n                </button>\n              ) : (\n                <>\n                  <div className=\"flex-1 rounded-xl border border-red-200 bg-red-50 p-4\">\n                    <label className=\"block text-sm font-semibold text-red-900 mb-2\">\n                      Rejection Reason\n                    </label>\n                    <textarea\n                      value={changeRequestRejectReason || ''}\n                      onChange={(e) => setChangeRequestRejectReason(e.target.value)}\n                      placeholder=\"Enter reason for rejection...\"\n                      rows={3}\n                      className=\"w-full rounded-lg border border-red-300 bg-white p-3 text-sm focus:outline-none focus:ring-2 focus:ring-red-500\"\n                    />\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      if (requestId) {\n                        handleRejectChangeRequest(requestId, { reason: changeRequestRejectReason || undefined })\n                      }\n                    }}\n                    disabled={changeRequestLoading}\n                    className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-red-600 px-6 py-3 text-sm font-bold text-white transition-all hover:bg-red-700 disabled:opacity-50\"\n                  >\n                    <XCircle className=\"h-4 w-4\" />\n                    Confirm Rejection\n                  </button>\n                </>\n              )}\n              <button\n                type=\"button\"\n                onClick={() => {\n                  if (requestId) {\n                    handleApproveChangeRequest(requestId)\n                  }\n                }}\n                disabled={changeRequestLoading}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <CheckCircle className=\"h-4 w-4\" />\n                {changeRequestLoading ? 'Processing...' : `Approve ${isNameChange ? 'Name' : 'Phone'} Change`}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'approveSeller' && selectedSellerForAction) {\n    const seller = selectedSellerForAction\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-purple-500 hover:bg-purple-50 hover:text-purple-700\"\n            title=\"Back to IRA Partners\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Approve IRA Partner</h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <div className=\"space-y-6\">\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600 text-white shadow-lg\">\n                  <CheckCircle className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{seller.name}</h3>\n                  <p className=\"text-sm text-gray-600\">IRA Partner ID: {seller.sellerId || seller.id}</p>\n                  {seller.email && (\n                    <p className=\"mt-1 text-xs text-gray-500\">Email: {seller.email}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n            <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-5\">\n              <p className=\"text-sm text-gray-700\">\n                Are you sure you want to approve this IRA Partner? This action will activate their account and allow them to start earning commissions.\n              </p>\n            </div>\n            <div className=\"flex flex-col-reverse gap-3 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => handleApproveSeller(seller.id || seller._id)}\n                disabled={loading}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <CheckCircle className=\"h-4 w-4\" />\n                {loading ? 'Processing...' : 'Approve IRA Partner'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'rejectSeller' && selectedSellerForAction) {\n    const seller = selectedSellerForAction\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-purple-500 hover:bg-purple-50 hover:text-purple-700\"\n            title=\"Back to IRA Partners\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Reject IRA Partner</h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <div className=\"space-y-6\">\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-red-500 to-red-600 text-white shadow-lg\">\n                  <XCircle className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{seller.name}</h3>\n                  <p className=\"text-sm text-gray-600\">IRA Partner ID: {seller.sellerId || seller.id}</p>\n                  {seller.email && (\n                    <p className=\"mt-1 text-xs text-gray-500\">Email: {seller.email}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n            <div className=\"rounded-xl border border-red-200 bg-red-50 p-5\">\n              <label className=\"mb-2 block text-sm font-bold text-gray-700\">Rejection Reason (Optional)</label>\n              <textarea\n                value={rejectReason}\n                onChange={(e) => setRejectReason(e.target.value)}\n                placeholder=\"Please provide a reason for rejection (optional)...\"\n                className=\"w-full rounded-lg border border-red-300 bg-white p-3 text-sm text-gray-900 focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-200\"\n                rows={4}\n              />\n            </div>\n            <div className=\"flex flex-col-reverse gap-3 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => handleRejectSeller(seller.id || seller._id, { reason: rejectReason || undefined })}\n                disabled={loading}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-red-500 to-red-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(239,68,68,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(239,68,68,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <XCircle className=\"h-4 w-4\" />\n                {loading ? 'Processing...' : 'Reject IRA Partner'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  const getPageTitle = () => {\n    if (subRoute === 'active') return 'Active IRA Partners'\n    if (subRoute === 'inactive') return 'Inactive IRA Partners'\n    return 'Sales Network HQ'\n  }\n\n  const getPageDescription = () => {\n    if (subRoute === 'active') return 'View and manage IRA Partners who are actively getting sales and commissions.'\n    if (subRoute === 'inactive') return 'View and manage IRA Partners who are not getting sales and commissions.'\n    return 'Incentivise performance, track targets, and manage wallet payouts with clarity.'\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 4 â€¢ IRA Partner Management</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">{getPageTitle()}</h2>\n          <p className=\"text-sm text-gray-600\">\n            {getPageDescription()}\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          {changeRequests.length > 0 && (\n            <button\n              onClick={() => {\n                if (changeRequests.length === 1) {\n                  // If only one request, show it directly\n                  setSelectedChangeRequest(changeRequests[0])\n                  setChangeRequestRejectReason(null)\n                  setCurrentView('changeRequest')\n                } else {\n                  // If multiple requests, show list first\n                  setCurrentView('changeRequestList')\n                }\n              }}\n              className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-purple-500 to-purple-600 px-4 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(147,51,234,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all duration-200 hover:shadow-[0_6px_20px_rgba(147,51,234,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] hover:scale-105\"\n            >\n              <Edit2 className=\"h-4 w-4\" />\n              Change Requests ({changeRequests.length})\n            </button>\n          )}\n          {withdrawalRequests.length > 0 && (\n            <button\n              onClick={() => {\n                setSelectedWithdrawalRequest(withdrawalRequests[0])\n                setCurrentView('withdrawalRequest')\n              }}\n              className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(59,130,246,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all duration-200 hover:shadow-[0_6px_20px_rgba(59,130,246,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] hover:scale-105\"\n            >\n              <Wallet className=\"h-4 w-4\" />\n              Withdrawals ({withdrawalRequests.length})\n            </button>\n          )}\n          <button\n            onClick={handleCreateSeller}\n            className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-yellow-500 to-yellow-600 px-5 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(234,179,8,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all duration-200 hover:shadow-[0_6px_20px_rgba(234,179,8,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] hover:scale-105 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.2)]\"\n          >\n          <Award className=\"h-4 w-4\" />\n          Create IRA Partner Profile\n        </button>\n        </div>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-4 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n        <div className=\"relative\">\n          <Search className=\"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400\" />\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Search IRA partners by name, phone, email, or ID...\"\n            className=\"w-full rounded-xl border border-gray-300 bg-white pl-12 pr-4 py-3 text-sm font-semibold transition-all focus:border-yellow-500 focus:outline-none focus:ring-2 focus:ring-yellow-500/50\"\n          />\n          {searchQuery && (\n            <button\n              type=\"button\"\n              onClick={() => setSearchQuery('')}\n              className=\"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n            >\n              <XCircle className=\"h-5 w-5\" />\n            </button>\n          )}\n        </div>\n        {searchQuery && (\n          <p className=\"mt-2 text-xs text-gray-600\">\n            Found {sellersList.length} IRA partner{sellersList.length !== 1 ? 's' : ''} matching \"{searchQuery}\"\n          </p>\n        )}\n      </div>\n\n      <DataTable\n        columns={tableColumns}\n        rows={sellersList}\n        emptyState={searchQuery ? `No IRA partners found matching \"${searchQuery}\"` : \"No IRA Partners found in the network\"}\n      />\n\n      <section className=\"grid gap-6 lg:grid-cols-2\">\n        <div className=\"space-y-4 rounded-3xl border border-yellow-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <h3 className=\"text-lg font-bold text-yellow-700\">Incentive Engine</h3>\n          <p className=\"text-sm text-gray-600\">\n            Configure cashback tiers, commission slabs, and performance accelerators for each cohort.\n          </p>\n          <div className=\"space-y-3\">\n            {[\n              {\n                title: 'Cashback Tier Review',\n                description:\n                  'Upcoming payout cycle. Validate cashback % for top performing sellers before transfer.',\n                meta: 'â‚¹12.6 L to be credited',\n                icon: Gift,\n              },\n              {\n                title: 'Commission Accelerator',\n                description:\n                  'Approve additional 2% commission for sellers achieving 120% of monthly target.',\n                meta: 'Applies to 38 sellers',\n                icon: Award,\n              },\n              {\n                title: 'Seller Onboarding',\n                description:\n                  'Standardise KYC, training modules and assign unique seller IDs instantly.',\n                meta: '7 applicants pending KYC',\n                icon: Users,\n              },\n            ].map((item) => (\n              <div key={item.title} className=\"flex gap-4 rounded-2xl border border-gray-200 bg-white p-4 hover:-translate-y-1 hover:shadow-[0_6px_20px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <span className=\"flex h-12 w-12 flex-none items-center justify-center rounded-xl bg-gradient-to-br from-yellow-500 to-yellow-600 text-white shadow-[0_4px_15px_rgba(234,179,8,0.4),inset_0_1px_0_rgba(255,255,255,0.2)]\">\n                  <item.icon className=\"h-5 w-5\" />\n                </span>\n                <div>\n                  <p className=\"text-sm font-bold text-gray-900\">{item.title}</p>\n                  <p className=\"text-xs text-gray-600\">{item.description}</p>\n                  <p className=\"mt-2 text-xs font-bold text-yellow-700\">{item.meta}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n        <ProgressList\n          items={[\n            { \n              label: 'Seller Wallet Requests', \n              progress: withdrawalRequests.length > 0 ? Math.min((withdrawalRequests.length / 10) * 100, 100) : 42, \n              tone: 'warning', \n              meta: withdrawalRequests.length > 0 \n                ? `${withdrawalRequests.length} requests (${totalPendingWithdrawals >= 100000 ? `â‚¹${(totalPendingWithdrawals / 100000).toFixed(1)} L` : `â‚¹${totalPendingWithdrawals.toLocaleString('en-IN')}`} pending)` \n                : 'â‚¹8.2 L awaiting admin approval' \n            },\n            { label: 'Monthly Target Achievement', progress: 68, tone: 'success', meta: 'Average across all sellers' },\n            { label: 'Top Performer Retention', progress: 92, tone: 'success', meta: 'Proactive incentives reduce attrition' },\n          ]}\n        />\n      </section>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Tasks.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'filterList' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":24,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"filterList"},"fix":{"range":[1073,1083],"text":""},"desc":"Remove unused variable 'filterList'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setFilterList' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":24,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"setFilterList"},"fix":{"range":[1083,1098],"text":""},"desc":"Remove unused variable 'setFilterList'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\r\nimport { CheckCircle, Clock, AlertCircle, ExternalLink, Filter, Search, Calendar, User, ShoppingBag, Truck, Info } from 'lucide-react'\r\nimport { useAdminState } from '../context/AdminContext'\r\nimport { useAdminApi } from '../hooks/useAdminApi'\r\nimport { StatusBadge } from '../components/StatusBadge'\r\nimport { DataTable } from '../components/DataTable'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nconst columns = [\r\n    { Header: 'Task', accessor: 'title' },\r\n    { Header: 'Category', accessor: 'category' },\r\n    { Header: 'Priority', accessor: 'priority' },\r\n    { Header: 'Description', accessor: 'description' },\r\n    { Header: 'Created', accessor: 'createdAt' },\r\n    { Header: 'Status', accessor: 'status' },\r\n    { Header: 'Action', accessor: 'action' },\r\n]\r\n\r\nexport default function TasksPage({ navigate }) {\r\n    const { tasks } = useAdminState()\r\n    const { fetchTasks, markTaskViewed, markTaskCompleted, loading } = useAdminApi()\r\n\r\n    const [activeTab, setActiveTab] = useState('pending')\r\n    const [filterList, setFilterList] = useState([])\r\n\r\n    const loadTasks = useCallback(async () => {\r\n        await fetchTasks({ status: activeTab === 'all' ? '' : activeTab })\r\n    }, [fetchTasks, activeTab])\r\n\r\n    useEffect(() => {\r\n        loadTasks()\r\n    }, [loadTasks])\r\n\r\n    // Refresh when tasks are updated\r\n    useEffect(() => {\r\n        if (tasks.updated) {\r\n            loadTasks()\r\n        }\r\n    }, [tasks.updated, loadTasks])\r\n\r\n    const handleTaskAction = async (task) => {\r\n        // Navigate to the target screen\r\n        if (task.link) {\r\n            // Mark as viewed if it was pending\r\n            if (task.status === 'pending') {\r\n                await markTaskViewed(task._id)\r\n            }\r\n\r\n            // Navigate to the link (assuming navigate function works with string routes)\r\n            const route = task.link.startsWith('/') ? task.link.substring(1) : task.link\r\n            navigate(route)\r\n        }\r\n    }\r\n\r\n    const handleCompleteTask = async (taskId) => {\r\n        await markTaskCompleted(taskId)\r\n        loadTasks()\r\n    }\r\n\r\n    const getCategoryIcon = (category) => {\r\n        switch (category) {\r\n            case 'vendor': return <Truck className=\"h-4 w-4\" />\r\n            case 'seller': return <User className=\"h-4 w-4\" />\r\n            case 'user': return <User className=\"h-4 w-4\" />\r\n            case 'order': return <ShoppingBag className=\"h-4 w-4\" />\r\n            case 'finance': return <Info className=\"h-4 w-4\" />\r\n            default: return <Info className=\"h-4 w-4\" />\r\n        }\r\n    }\r\n\r\n    const getPriorityColor = (priority) => {\r\n        switch (priority) {\r\n            case 'urgent': return 'text-red-600 bg-red-50 border-red-200'\r\n            case 'high': return 'text-orange-600 bg-orange-50 border-orange-200'\r\n            case 'medium': return 'text-blue-600 bg-blue-50 border-blue-200'\r\n            case 'low': return 'text-gray-600 bg-gray-50 border-gray-200'\r\n            default: return 'text-gray-600 bg-gray-50 border-gray-200'\r\n        }\r\n    }\r\n\r\n    const tableColumns = columns.map(col => {\r\n        if (col.accessor === 'title') {\r\n            return {\r\n                ...col,\r\n                Cell: (row) => (\r\n                    <div className=\"flex flex-col\">\r\n                        <span className=\"font-bold text-gray-900\">{row.title}</span>\r\n                        <span className=\"text-xs text-gray-500 font-medium\">#{row.taskId}</span>\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n        if (col.accessor === 'category') {\r\n            return {\r\n                ...col,\r\n                Cell: (row) => (\r\n                    <div className=\"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-gray-100 text-gray-700 text-xs font-bold border border-gray-200 uppercase tracking-tight\">\r\n                        {getCategoryIcon(row.category)}\r\n                        {row.category}\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n        if (col.accessor === 'priority') {\r\n            return {\r\n                ...col,\r\n                Cell: (row) => (\r\n                    <div className={cn(\"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold uppercase border\", getPriorityColor(row.priority))}>\r\n                        {row.priority}\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n        if (col.accessor === 'status') {\r\n            return {\r\n                ...col,\r\n                Cell: (row) => (\r\n                    <StatusBadge\r\n                        status={row.status === 'pending' ? 'warning' : row.status === 'viewed' ? 'info' : 'success'}\r\n                        label={row.status}\r\n                    />\r\n                )\r\n            }\r\n        }\r\n        if (col.accessor === 'createdAt') {\r\n            return {\r\n                ...col,\r\n                Cell: (row) => (\r\n                    <div className=\"flex items-center gap-1.5 text-xs text-gray-600\">\r\n                        <Calendar className=\"h-3.5 w-3.5\" />\r\n                        {new Date(row.createdAt).toLocaleDateString()}\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n        if (col.accessor === 'action') {\r\n            return {\r\n                ...col,\r\n                Cell: (row) => (\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <button\r\n                            onClick={() => handleTaskAction(row)}\r\n                            className=\"p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 transition-all border border-blue-100 shadow-sm\"\r\n                            title=\"Go to Task\"\r\n                        >\r\n                            <ExternalLink className=\"h-4 w-4\" />\r\n                        </button>\r\n                        {row.status !== 'completed' && (\r\n                            <button\r\n                                onClick={() => handleCompleteTask(row._id)}\r\n                                className=\"p-2 rounded-lg bg-green-50 text-green-600 hover:bg-green-100 transition-all border border-green-100 shadow-sm\"\r\n                                title=\"Mark as Completed\"\r\n                            >\r\n                                <CheckCircle className=\"h-4 w-4\" />\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n        return col\r\n    })\r\n\r\n    const tableRows = (tasks.data || []).map(task => ({\r\n        id: task._id,\r\n        ...task\r\n    }))\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-extrabold text-gray-900 tracking-tight\">Admin TODO Center</h1>\r\n                    <p className=\"text-sm text-gray-600 mt-1 font-medium\">Manage and track your operational priorities</p>\r\n                </div>\r\n\r\n                {tasks.pendingCount > 0 && (\r\n                    <div className=\"bg-orange-50 border border-orange-200 px-4 py-2 rounded-2xl flex items-center gap-2 animate-pulse\">\r\n                        <AlertCircle className=\"h-5 w-5 text-orange-600\" />\r\n                        <span className=\"text-sm font-bold text-orange-700\">{tasks.pendingCount} Pending Tasks</span>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-1 p-1 bg-gray-100 rounded-2xl w-fit\">\r\n                {['pending', 'viewed', 'completed', 'all'].map(tab => (\r\n                    <button\r\n                        key={tab}\r\n                        onClick={() => setActiveTab(tab)}\r\n                        className={cn(\r\n                            \"px-6 py-2 rounded-xl text-sm font-bold capitalize transition-all duration-200\",\r\n                            activeTab === tab\r\n                                ? \"bg-white text-blue-700 shadow-[0_2px_8px_rgba(0,0,0,0.08)]\"\r\n                                : \"text-gray-500 hover:text-gray-700 hover:bg-gray-200/50\"\r\n                        )}\r\n                    >\r\n                        {tab}\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-3xl border border-gray-200 shadow-[0_4px_20px_rgba(0,0,0,0.05)] overflow-hidden\">\r\n                {loading && !tasks.data ? (\r\n                    <div className=\"p-20 text-center\">\r\n                        <div className=\"inline-block animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mb-4\"></div>\r\n                        <p className=\"text-gray-500 font-bold\">Synchronizing Tasks...</p>\r\n                    </div>\r\n                ) : (\r\n                    <DataTable\r\n                        columns={tableColumns}\r\n                        rows={tableRows}\r\n                        emptyState={`No ${activeTab} tasks found.`}\r\n                    />\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 p-6 rounded-3xl text-white shadow-xl\">\r\n                    <Clock className=\"h-8 w-8 mb-4 opacity-80\" />\r\n                    <h3 className=\"text-lg font-bold\">Operational Speed</h3>\r\n                    <p className=\"text-sm opacity-90 mt-1\">Faster task resolution improves partner satisfaction and platform growth.</p>\r\n                </div>\r\n                <div className=\"bg-gradient-to-br from-purple-500 to-purple-600 p-6 rounded-3xl text-white shadow-xl\">\r\n                    <Truck className=\"h-8 w-8 mb-4 opacity-80\" />\r\n                    <h3 className=\"text-lg font-bold\">Vendor Onboarding</h3>\r\n                    <p className=\"text-sm opacity-90 mt-1\">90% of tasks usually revolve around vendor verified application reviews.</p>\r\n                </div>\r\n                <div className=\"bg-gradient-to-br from-green-500 to-green-600 p-6 rounded-3xl text-white shadow-xl\">\r\n                    <ShoppingBag className=\"h-8 w-8 mb-4 opacity-80\" />\r\n                    <h3 className=\"text-lg font-bold\">Order Fulfillment</h3>\r\n                    <p className=\"text-sm opacity-90 mt-1\">Escalated orders require immediate attention to maintain delivery SLAs.</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Users.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'showWarning' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":34,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":58,"suggestions":[{"messageId":"removeVar","data":{"varName":"showWarning"},"fix":{"range":[1360,1382],"text":""},"desc":"Remove unused variable 'showWarning'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\nimport { Ban, Search, UserCheck, Eye, MessageSquare, ArrowLeft, User, Hash, MapPin, ShoppingBag, CreditCard, CheckCircle, Calendar, Send, XCircle } from 'lucide-react'\nimport { DataTable } from '../components/DataTable'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { Timeline } from '../components/Timeline'\nimport { useAdminState } from '../context/AdminContext'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { users as mockUsers } from '../services/adminData'\nimport { cn } from '../../../lib/cn'\n\nconst columns = [\n  { Header: 'User', accessor: 'name' },\n  { Header: 'User ID', accessor: 'id' },\n  { Header: 'Region', accessor: 'region' },\n  { Header: 'Linked Seller', accessor: 'sellerId' },\n  { Header: 'Orders', accessor: 'orders' },\n  { Header: 'Payments', accessor: 'payments' },\n  { Header: 'Support Tickets', accessor: 'supportTickets' },\n  { Header: 'Status', accessor: 'status' },\n  { Header: 'Actions', accessor: 'actions' },\n]\n\nexport function UsersPage({ subRoute = null, navigate }) {\n  const { users: usersState } = useAdminState()\n  const {\n    getUsers,\n    getUserDetails,\n    blockUser,\n    deactivateUser,\n    activateUser,\n    loading,\n  } = useAdminApi()\n  const { success, error: showError, warning: showWarning } = useToast()\n\n  const [usersList, setUsersList] = useState([])\n  const [allUsersList, setAllUsersList] = useState([])\n  \n  // View states (replacing modals with full-screen views)\n  const [currentView, setCurrentView] = useState(null) // 'userDetail', 'supportTickets', 'blockUser', 'deactivateUser', 'activateUser'\n  const [selectedUserForDetail, setSelectedUserForDetail] = useState(null)\n  const [userDetails, setUserDetails] = useState(null)\n  const [selectedUserForTickets, setSelectedUserForTickets] = useState(null)\n  const [userTickets, setUserTickets] = useState([])\n  const [selectedUserForAction, setSelectedUserForAction] = useState(null)\n  const [blockReason, setBlockReason] = useState('')\n  const [deactivateReason, setDeactivateReason] = useState('')\n  const [selectedTicket, setSelectedTicket] = useState(null)\n  const [replyText, setReplyText] = useState('')\n\n  // Fetch users\n  const fetchUsers = useCallback(async () => {\n    const result = await getUsers()\n    if (result.data?.users) {\n      setAllUsersList(result.data.users)\n    } else {\n      // Fallback to mock data\n      setAllUsersList(mockUsers)\n    }\n  }, [getUsers])\n\n  // Filter users based on subRoute\n  useEffect(() => {\n    if (subRoute === 'active') {\n      setUsersList(allUsersList.filter((u) => u.status === 'Active' || u.status === 'active'))\n    } else if (subRoute === 'inactive') {\n      setUsersList(allUsersList.filter((u) => u.status === 'Inactive' || u.status === 'inactive' || u.status === 'Blocked' || u.status === 'blocked'))\n    } else {\n      setUsersList(allUsersList)\n    }\n  }, [subRoute, allUsersList])\n\n  // Fetch user details\n  const fetchUserDetails = useCallback(async (userId) => {\n    const result = await getUserDetails(userId)\n    if (result.data) {\n      setUserDetails(result.data)\n      return result.data\n    }\n    return null\n  }, [getUserDetails])\n\n  useEffect(() => {\n    fetchUsers()\n  }, [fetchUsers])\n\n  // Refresh when users are updated\n  useEffect(() => {\n    if (usersState.updated) {\n      fetchUsers()\n    }\n  }, [usersState.updated, fetchUsers])\n\n  const handleViewUserDetails = async (user) => {\n    const originalUser = usersState.data?.users?.find((u) => u.id === user.id) || user\n    setSelectedUserForDetail(originalUser)\n    \n    // Fetch detailed user data\n    const details = await fetchUserDetails(user.id)\n    if (details) {\n      setUserDetails(details)\n    }\n    \n    setCurrentView('userDetail')\n  }\n\n  const handleViewSupportTickets = async (user) => {\n    const originalUser = usersState.data?.users?.find((u) => u.id === user.id) || user\n    setSelectedUserForTickets(originalUser)\n    \n    // Fetch user details to get tickets\n    const details = await fetchUserDetails(user.id)\n    if (details && details.supportTickets) {\n      setUserTickets(details.supportTickets)\n    } else {\n      // Mock tickets for demo\n      setUserTickets([\n        {\n          id: 'TKT-001',\n          ticketId: 'TKT-001',\n          subject: 'Order delivery issue',\n          description: 'Order #ORD-12345 was not delivered on time. Need assistance.',\n          status: 'open',\n          createdAt: '2024-01-15',\n          conversation: [\n            { from: 'User', message: 'Order #ORD-12345 was not delivered on time. Need assistance.', timestamp: '2024-01-15 10:00' },\n            { from: 'Admin', message: 'We are looking into this issue. Will update you soon.', timestamp: '2024-01-15 11:30' },\n          ],\n        },\n      ])\n    }\n    \n    setSelectedTicket(null)\n    setReplyText('')\n    setCurrentView('supportTickets')\n  }\n\n  const handleBackToList = () => {\n    setCurrentView(null)\n    setSelectedUserForDetail(null)\n    setUserDetails(null)\n    setSelectedUserForTickets(null)\n    setUserTickets([])\n    setSelectedUserForAction(null)\n    setBlockReason('')\n    setDeactivateReason('')\n    setSelectedTicket(null)\n    setReplyText('')\n    if (navigate) navigate('users')\n  }\n\n  const handleBlockUser = async (userId, reasonData) => {\n    try {\n      const result = await blockUser(userId, reasonData)\n      if (result.data) {\n        fetchUsers()\n        setCurrentView(null)\n        setSelectedUserForDetail(null)\n        setSelectedUserForAction(null)\n        setBlockReason('')\n        success('User blocked successfully!', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to block user'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to block user', 5000)\n    }\n  }\n\n  const handleDeactivateUser = async (userId, reasonData) => {\n    try {\n      const result = await deactivateUser(userId, reasonData)\n      if (result.data) {\n        fetchUsers()\n        setCurrentView(null)\n        setSelectedUserForDetail(null)\n        setSelectedUserForAction(null)\n        setDeactivateReason('')\n        success('User deactivated successfully!', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to deactivate user'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to deactivate user', 5000)\n    }\n  }\n\n  const handleActivateUser = async (userId) => {\n    try {\n      const result = await activateUser(userId)\n      if (result.data) {\n        fetchUsers()\n        setCurrentView(null)\n        setSelectedUserForDetail(null)\n        setSelectedUserForAction(null)\n        success('User activated successfully!', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to activate user'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to activate user', 5000)\n    }\n  }\n\n  const handleResolveTicket = async (ticketId) => {\n    // This would call an API to resolve the ticket\n    console.log('Resolving ticket:', ticketId)\n    // Update local state\n    setUserTickets((prev) =>\n      prev.map((ticket) =>\n        ticket.id === ticketId ? { ...ticket, status: 'resolved' } : ticket,\n      ),\n    )\n  }\n\n  const handleCloseTicket = async (ticketId) => {\n    // This would call an API to close the ticket\n    console.log('Closing ticket:', ticketId)\n    // Update local state\n    setUserTickets((prev) =>\n      prev.map((ticket) =>\n        ticket.id === ticketId ? { ...ticket, status: 'closed' } : ticket,\n      ),\n    )\n  }\n\n  const handleReply = () => {\n    if (replyText.trim() && selectedTicket) {\n      // Handle reply - this would call an API\n      console.log('Replying to ticket:', selectedTicket.id, replyText)\n      setReplyText('')\n    }\n  }\n\n  const tableColumns = columns.map((column) => {\n    if (column.accessor === 'payments') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const payments = row.payments || 'Unknown'\n          const tone = payments === 'On Time' || payments === 'on_time' ? 'success' : 'warning'\n          return <StatusBadge tone={tone}>{payments}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'status') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const status = row.status || 'Unknown'\n          const tone = status === 'Active' || status === 'active' ? 'success' : status === 'Blocked' || status === 'blocked' ? 'neutral' : 'warning'\n          return <StatusBadge tone={tone}>{status}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'supportTickets') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const count = row.supportTickets || 0\n          return (\n            <div className=\"flex items-center gap-2\">\n              <span className={count > 0 ? 'font-bold text-orange-600' : 'text-gray-600'}>\n                {count}\n              </span>\n              {count > 0 && (\n                <button\n                  type=\"button\"\n                  onClick={() => handleViewSupportTickets(row)}\n                  className=\"text-xs text-orange-600 hover:text-orange-700 font-semibold\"\n                >\n                  View\n                </button>\n              )}\n            </div>\n          )\n        },\n      }\n    }\n    if (column.accessor === 'actions') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const originalUser = usersState.data?.users?.find((u) => u.id === row.id) || row\n          return (\n            <div className=\"flex items-center gap-2\">\n              <button\n                type=\"button\"\n                onClick={() => handleViewUserDetails(originalUser)}\n                className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-orange-500 hover:bg-orange-50 hover:text-orange-700\"\n                title=\"View details\"\n              >\n                <Eye className=\"h-4 w-4\" />\n              </button>\n              {row.supportTickets > 0 && (\n                <button\n                  type=\"button\"\n                  onClick={() => handleViewSupportTickets(originalUser)}\n                  className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-orange-600 transition-all hover:border-orange-500 hover:bg-orange-50\"\n                  title=\"View support tickets\"\n                >\n                  <MessageSquare className=\"h-4 w-4\" />\n                </button>\n              )}\n            </div>\n          )\n        },\n      }\n    }\n    return column\n  })\n\n  // Helper function for currency formatting\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') {\n      return value\n    }\n    if (value >= 100000) {\n      return `â‚¹${(value / 100000).toFixed(1)} L`\n    }\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  // If a full-screen view is active, render it instead of the main list\n  if (currentView === 'userDetail' && (userDetails || selectedUserForDetail)) {\n    const user = userDetails || selectedUserForDetail\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-orange-500 hover:bg-orange-50 hover:text-orange-700\"\n            title=\"Back to Users\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">User Details & Activity</h2>\n        </div>\n        <div className=\"space-y-6\">\n          {/* User Header */}\n          <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-lg\">\n                  <User className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{user.name}</h3>\n                  <p className=\"text-sm text-gray-600\">User ID: {user.id}</p>\n                  <div className=\"mt-2 flex items-center gap-4 text-xs text-gray-500\">\n                    {user.region && (\n                      <div className=\"flex items-center gap-1\">\n                        <MapPin className=\"h-3.5 w-3.5\" />\n                        <span>{user.region}</span>\n                      </div>\n                    )}\n                    {user.phone && (\n                      <div>\n                        <span>{user.phone}</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n              <StatusBadge tone={user.status === 'Active' || user.status === 'active' ? 'success' : user.status === 'Blocked' || user.status === 'blocked' ? 'neutral' : 'warning'}>\n                {user.status || 'Unknown'}\n              </StatusBadge>\n            </div>\n          </div>\n\n          {/* Linked IRA Partner */}\n          {user.sellerId && (\n            <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  <Hash className=\"h-5 w-5 text-blue-600\" />\n                  <div>\n                    <p className=\"text-xs text-blue-500\">Linked IRA Partner ID</p>\n                    <p className=\"text-sm font-bold text-blue-900\">{user.sellerId}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Activity Summary */}\n          <div className=\"grid gap-4 sm:grid-cols-3\">\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\n                <ShoppingBag className=\"h-4 w-4\" />\n                <span>Total Orders</span>\n              </div>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {user.orders || user.totalOrders || 0}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\n                <CreditCard className=\"h-4 w-4\" />\n                <span>Payment Status</span>\n              </div>\n              <StatusBadge tone={user.payments === 'On Time' || user.payments === 'on_time' ? 'success' : 'warning'}>\n                {user.payments || 'Unknown'}\n              </StatusBadge>\n            </div>\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\n                <MessageSquare className=\"h-4 w-4\" />\n                <span>Support Tickets</span>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <p className=\"text-2xl font-bold text-gray-900\">\n                  {user.supportTickets || user.openTickets || 0}\n                </p>\n                {user.supportTickets > 0 && (\n                  <button\n                    type=\"button\"\n                    onClick={() => handleViewSupportTickets(user)}\n                    className=\"text-xs font-bold text-orange-600 hover:text-orange-700\"\n                  >\n                    View All\n                  </button>\n                )}\n              </div>\n            </div>\n          </div>\n\n          {/* Orders History */}\n          {user.ordersHistory && user.ordersHistory.length > 0 && (\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <div className=\"mb-4 flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  <ShoppingBag className=\"h-5 w-5 text-gray-600\" />\n                  <h4 className=\"text-sm font-bold text-gray-900\">Order History</h4>\n                </div>\n              </div>\n              <div className=\"space-y-3 max-h-64 overflow-y-auto\">\n                {user.ordersHistory.map((order, index) => (\n                  <div key={order.id || index} className=\"rounded-lg border border-gray-200 bg-gray-50 p-3\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"text-sm font-bold text-gray-900\">{order.id || `Order #${index + 1}`}</p>\n                        <p className=\"text-xs text-gray-600\">{order.date || order.createdAt}</p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-sm font-bold text-gray-900\">{formatCurrency(order.value || order.amount || 0)}</p>\n                        <StatusBadge tone={order.status === 'completed' ? 'success' : order.status === 'pending' ? 'warning' : 'neutral'}>\n                          {order.status || 'Unknown'}\n                        </StatusBadge>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Payment History */}\n          {user.paymentHistory && user.paymentHistory.length > 0 && (\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <div className=\"mb-4 flex items-center gap-2\">\n                <CreditCard className=\"h-5 w-5 text-gray-600\" />\n                <h4 className=\"text-sm font-bold text-gray-900\">Payment History</h4>\n              </div>\n              <Timeline\n                events={user.paymentHistory.map((payment, index) => ({\n                  id: payment.id || `payment-${index}`,\n                  title: payment.description || `Payment ${index + 1}`,\n                  timestamp: payment.date || payment.timestamp || 'N/A',\n                  description: formatCurrency(payment.amount || 0),\n                  status: payment.status || 'completed',\n                }))}\n              />\n            </div>\n          )}\n\n          {/* Support Tickets Summary */}\n          {user.supportTickets > 0 && (\n            <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-bold text-orange-900\">Active Support Tickets</p>\n                  <p className=\"text-xs text-orange-700\">{user.supportTickets} ticket(s) require attention</p>\n                </div>\n                <button\n                  type=\"button\"\n                  onClick={() => handleViewSupportTickets(user)}\n                  className=\"rounded-lg border border-orange-300 bg-white px-4 py-2 text-xs font-bold text-orange-700 transition-all hover:bg-orange-100\"\n                >\n                  View Tickets\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n            <button\n              type=\"button\"\n              onClick={handleBackToList}\n              className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n            >\n              Close\n            </button>\n            <div className=\"flex gap-3\">\n              {user.status === 'Active' || user.status === 'active' ? (\n                <>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedUserForAction(user)\n                      setDeactivateReason('')\n                      setCurrentView('deactivateUser')\n                    }}\n                    className=\"flex items-center gap-2 rounded-xl border border-orange-300 bg-white px-6 py-3 text-sm font-bold text-orange-600 transition-all hover:bg-orange-50\"\n                  >\n                    <Ban className=\"h-4 w-4\" />\n                    Deactivate\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedUserForAction(user)\n                      setBlockReason('')\n                      setCurrentView('blockUser')\n                    }}\n                    className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50\"\n                  >\n                    <Ban className=\"h-4 w-4\" />\n                    Block User\n                  </button>\n                </>\n              ) : (\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setSelectedUserForAction(user)\n                    setCurrentView('activateUser')\n                  }}\n                  className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)]\"\n                >\n                    <CheckCircle className=\"h-4 w-4\" />\n                    Activate User\n                  </button>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'supportTickets' && selectedUserForTickets) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-orange-500 hover:bg-orange-50 hover:text-orange-700\"\n            title=\"Back to Users\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Support Tickets - {selectedUserForTickets.name || 'User'}</h2>\n        </div>\n        <div className=\"space-y-6\">\n          {!userTickets || userTickets.length === 0 ? (\n            <div className=\"py-8 text-center rounded-2xl border border-gray-200 bg-white\">\n              <MessageSquare className=\"mx-auto h-12 w-12 text-gray-400\" />\n              <p className=\"mt-4 text-sm text-gray-600\">No support tickets found for this user.</p>\n            </div>\n          ) : (\n            <>\n              {/* Tickets List */}\n              <div className=\"space-y-3\">\n                {userTickets.map((ticket) => (\n                  <div\n                    key={ticket.id}\n                    className={cn(\n                      'rounded-xl border p-4 transition-all cursor-pointer',\n                      selectedTicket?.id === ticket.id\n                        ? 'border-orange-500 bg-orange-50'\n                        : 'border-gray-200 bg-white hover:border-orange-300 hover:bg-orange-50/50',\n                    )}\n                    onClick={() => setSelectedTicket(ticket)}\n                  >\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <p className=\"text-sm font-bold text-gray-900\">Ticket #{ticket.id || ticket.ticketId}</p>\n                          <StatusBadge tone={ticket.status === 'resolved' ? 'success' : ticket.status === 'closed' ? 'neutral' : 'warning'}>\n                            {ticket.status || 'Open'}\n                          </StatusBadge>\n                        </div>\n                        <p className=\"mt-1 text-sm text-gray-700\">{ticket.subject || ticket.title || 'No subject'}</p>\n                        <p className=\"mt-1 text-xs text-gray-500\">{ticket.description || ticket.message}</p>\n                        {ticket.createdAt && (\n                          <div className=\"mt-2 flex items-center gap-1 text-xs text-gray-400\">\n                            <Calendar className=\"h-3 w-3\" />\n                            <span>{ticket.createdAt}</span>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n\n              {/* Selected Ticket Details */}\n              {selectedTicket && (\n                <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-5\">\n                  <div className=\"mb-4\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <h4 className=\"text-sm font-bold text-gray-900\">Ticket #{selectedTicket.id || selectedTicket.ticketId}</h4>\n                      <StatusBadge tone={selectedTicket.status === 'resolved' ? 'success' : selectedTicket.status === 'closed' ? 'neutral' : 'warning'}>\n                        {selectedTicket.status || 'Open'}\n                      </StatusBadge>\n                    </div>\n                    <p className=\"text-sm font-semibold text-gray-900\">{selectedTicket.subject || selectedTicket.title}</p>\n                    <p className=\"mt-2 text-sm text-gray-700\">{selectedTicket.description || selectedTicket.message}</p>\n                  </div>\n\n                  {/* Ticket Timeline */}\n                  {selectedTicket.conversation && selectedTicket.conversation.length > 0 && (\n                    <div className=\"mb-4\">\n                      <h5 className=\"mb-2 text-xs font-bold text-gray-500\">Conversation</h5>\n                      <Timeline\n                        events={selectedTicket.conversation.map((msg, index) => ({\n                          id: `msg-${index}`,\n                          title: msg.from || 'User',\n                          timestamp: msg.timestamp || msg.date || 'N/A',\n                          description: msg.message || msg.text,\n                          status: msg.from === 'Admin' ? 'completed' : 'pending',\n                        }))}\n                      />\n                    </div>\n                  )}\n\n                  {/* Reply Section */}\n                  {selectedTicket.status !== 'resolved' && selectedTicket.status !== 'closed' && (\n                    <div className=\"space-y-3\">\n                      <textarea\n                        value={replyText}\n                        onChange={(e) => setReplyText(e.target.value)}\n                        placeholder=\"Type your reply...\"\n                        className=\"w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-500/50\"\n                        rows={3}\n                      />\n                      <div className=\"flex gap-2\">\n                        <button\n                          type=\"button\"\n                          onClick={handleReply}\n                          disabled={!replyText.trim() || loading}\n                          className=\"flex items-center gap-2 rounded-lg bg-gradient-to-r from-orange-500 to-orange-600 px-4 py-2 text-sm font-bold text-white shadow-[0_4px_15px_rgba(249,115,22,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(249,115,22,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n                        >\n                          <Send className=\"h-4 w-4\" />\n                          Send Reply\n                        </button>\n                        <button\n                          type=\"button\"\n                          onClick={() => handleResolveTicket(selectedTicket.id || selectedTicket.ticketId)}\n                          disabled={loading}\n                          className=\"flex items-center gap-2 rounded-lg border border-green-300 bg-white px-4 py-2 text-sm font-bold text-green-600 transition-all hover:bg-green-50 disabled:opacity-50\"\n                        >\n                          <CheckCircle className=\"h-4 w-4\" />\n                          Resolve\n                        </button>\n                        <button\n                          type=\"button\"\n                          onClick={() => handleCloseTicket(selectedTicket.id || selectedTicket.ticketId)}\n                          disabled={loading}\n                          className=\"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-bold text-gray-600 transition-all hover:bg-gray-50 disabled:opacity-50\"\n                        >\n                          <XCircle className=\"h-4 w-4\" />\n                          Close\n                        </button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'blockUser' && selectedUserForAction) {\n    const user = selectedUserForAction\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-orange-500 hover:bg-orange-50 hover:text-orange-700\"\n            title=\"Back to Users\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Block User</h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <div className=\"space-y-6\">\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-red-500 to-red-600 text-white shadow-lg\">\n                  <Ban className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{user.name}</h3>\n                  <p className=\"text-sm text-gray-600\">User ID: {user.id}</p>\n                  {user.email && (\n                    <p className=\"mt-1 text-xs text-gray-500\">Email: {user.email}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n            <div className=\"rounded-xl border border-red-200 bg-red-50 p-5\">\n              <label className=\"mb-2 block text-sm font-bold text-gray-700\">Reason for Blocking</label>\n              <textarea\n                value={blockReason}\n                onChange={(e) => setBlockReason(e.target.value)}\n                placeholder=\"Please provide a reason for blocking this user...\"\n                className=\"w-full rounded-lg border border-red-300 bg-white p-3 text-sm text-gray-900 focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-200\"\n                rows={4}\n              />\n            </div>\n            <div className=\"flex flex-col-reverse gap-3 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => handleBlockUser(user.id || user._id, { reason: blockReason || undefined })}\n                disabled={loading || !blockReason.trim()}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-red-500 to-red-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(239,68,68,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(239,68,68,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <Ban className=\"h-4 w-4\" />\n                {loading ? 'Processing...' : 'Block User'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'deactivateUser' && selectedUserForAction) {\n    const user = selectedUserForAction\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-orange-500 hover:bg-orange-50 hover:text-orange-700\"\n            title=\"Back to Users\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Deactivate User</h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <div className=\"space-y-6\">\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-lg\">\n                  <Ban className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{user.name}</h3>\n                  <p className=\"text-sm text-gray-600\">User ID: {user.id}</p>\n                  {user.email && (\n                    <p className=\"mt-1 text-xs text-gray-500\">Email: {user.email}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n            <div className=\"rounded-xl border border-orange-200 bg-orange-50 p-5\">\n              <label className=\"mb-2 block text-sm font-bold text-gray-700\">Reason for Deactivation</label>\n              <textarea\n                value={deactivateReason}\n                onChange={(e) => setDeactivateReason(e.target.value)}\n                placeholder=\"Please provide a reason for deactivating this user...\"\n                className=\"w-full rounded-lg border border-orange-300 bg-white p-3 text-sm text-gray-900 focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200\"\n                rows={4}\n              />\n            </div>\n            <div className=\"flex flex-col-reverse gap-3 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => handleDeactivateUser(user.id || user._id, { reason: deactivateReason || undefined })}\n                disabled={loading || !deactivateReason.trim()}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(249,115,22,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(249,115,22,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <Ban className=\"h-4 w-4\" />\n                {loading ? 'Processing...' : 'Deactivate User'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'activateUser' && selectedUserForAction) {\n    const user = selectedUserForAction\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={handleBackToList}\n            className=\"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-orange-500 hover:bg-orange-50 hover:text-orange-700\"\n            title=\"Back to Users\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Activate User</h2>\n        </div>\n        <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n          <div className=\"space-y-6\">\n            <div className=\"rounded-xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600 text-white shadow-lg\">\n                  <CheckCircle className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{user.name}</h3>\n                  <p className=\"text-sm text-gray-600\">User ID: {user.id}</p>\n                  {user.email && (\n                    <p className=\"mt-1 text-xs text-gray-500\">Email: {user.email}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n            <div className=\"rounded-xl border border-green-200 bg-green-50 p-5\">\n              <p className=\"text-sm text-gray-700\">\n                Are you sure you want to activate this user? This action will restore their account access and allow them to use the platform.\n              </p>\n            </div>\n            <div className=\"flex flex-col-reverse gap-3 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToList}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => handleActivateUser(user.id || user._id)}\n                disabled={loading}\n                className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n              >\n                <CheckCircle className=\"h-4 w-4\" />\n                {loading ? 'Processing...' : 'Activate User'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  const getPageTitle = () => {\n    if (subRoute === 'active') return 'Active Users'\n    if (subRoute === 'inactive') return 'Inactive Users'\n    return 'User Trust & Compliance'\n  }\n\n  const getPageDescription = () => {\n    if (subRoute === 'active') return 'View and manage all active user accounts.'\n    if (subRoute === 'inactive') return 'View and manage all inactive or blocked user accounts.'\n    return 'Monitor orders, payments, and support escalations. Disable risky accounts with a single action.'\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 5 â€¢ User Management</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">{getPageTitle()}</h2>\n          <p className=\"text-sm text-gray-600\">\n            {getPageDescription()}\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button className=\"inline-flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm text-gray-700 font-semibold shadow-[0_2px_8px_rgba(0,0,0,0.05),inset_0_1px_0_rgba(255,255,255,0.8)] transition hover:border-orange-300 hover:bg-orange-50 hover:text-orange-700 hover:shadow-[0_4px_12px_rgba(0,0,0,0.1),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n            <Search className=\"h-4 w-4\" />\n            Advanced Search\n          </button>\n          <button className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 px-4 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(249,115,22,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all duration-200 hover:shadow-[0_6px_20px_rgba(249,115,22,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] hover:scale-105 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.2)]\">\n            <UserCheck className=\"h-4 w-4\" />\n            Verify Account\n          </button>\n        </div>\n      </header>\n\n      <DataTable\n        columns={tableColumns}\n        rows={usersList}\n        emptyState=\"No user accounts found\"\n      />\n\n      <section className=\"grid gap-6 lg:grid-cols-2\">\n        <div className=\"space-y-4 rounded-3xl border border-orange-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <h3 className=\"text-lg font-bold text-orange-700\">User Verification Workflow</h3>\n          <p className=\"text-sm text-gray-600\">\n            Ensure every user is mapped to a seller, with payment visibility and support ticket insights.\n          </p>\n          <div className=\"space-y-3\">\n            {[\n              {\n                title: 'KYC Review',\n                description: 'Auto fetch KYC docs and ensure mapping to seller IDs before activation.',\n                status: 'Completed',\n              },\n              {\n                title: 'Risk Scoring',\n                description: 'Flag users with repeated payment delays or support escalations over SLA.',\n                status: 'In Progress',\n              },\n              {\n                title: 'Escalation Pipeline',\n                description: 'Route flagged accounts to fraud prevention with timeline tracking.',\n                status: 'Pending',\n              },\n            ].map((item) => (\n              <div key={item.title} className=\"rounded-2xl border border-gray-200 bg-white p-4 hover:-translate-y-1 hover:shadow-[0_6px_20px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <div className=\"flex items-center justify-between\">\n                  <p className=\"text-sm font-bold text-gray-900\">{item.title}</p>\n                  <StatusBadge tone={item.status === 'Completed' ? 'success' : item.status === 'In Progress' ? 'warning' : 'neutral'}>\n                    {item.status}\n                  </StatusBadge>\n                </div>\n                <p className=\"mt-2 text-xs text-gray-600\">{item.description}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n        <div className=\"space-y-4 rounded-3xl border border-red-200 bg-gradient-to-br from-red-50 to-red-100/50 p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"flex items-center gap-3\">\n            <Ban className=\"h-5 w-5 text-red-600\" />\n            <div>\n              <h3 className=\"text-lg font-bold text-gray-900\">Suspicious Accounts</h3>\n              <p className=\"text-sm text-red-700\">\n                Pattern-based alerts combining payment delays, refund rate, and support escalations.\n              </p>\n            </div>\n          </div>\n          <div className=\"space-y-3\">\n            {[\n              {\n                user: 'USR-7841 â€¢ SLR-552',\n                detail: 'Refund frequency above threshold. Review manual overrides and block if required.',\n              },\n              {\n                user: 'USR-9922 â€¢ SLR-713',\n                detail: 'Multiple support tickets unresolved. Investigate quality of service delivered.',\n              },\n              {\n                user: 'USR-8841 â€¢ SLR-883',\n                detail: 'Payment lapsed twice in 45 days. Credit risk flagged.',\n              },\n            ].map((item) => (\n              <div key={item.user} className=\"rounded-2xl border border-red-200 bg-white px-4 py-3 shadow-[0_2px_8px_rgba(0,0,0,0.05),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <p className=\"text-sm font-bold text-gray-900\">{item.user}</p>\n                <p className=\"text-xs text-red-700\">{item.detail}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\VendorWithdrawals.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[594,630],"text":""},"desc":"Remove unused variable 'cn'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\nimport { Wallet, Factory, Eye, CheckCircle, XCircle, Calendar, IndianRupee, Filter, Search } from 'lucide-react'\nimport { DataTable } from '../components/DataTable'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { Modal } from '../components/Modal'\nimport { ConfirmationModal } from '../components/ConfirmationModal'\nimport { VendorWithdrawalApprovalScreen } from '../components/VendorWithdrawalApprovalScreen'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { cn } from '../../../lib/cn'\nimport { getMaskedBankDetails } from '../../../utils/maskSensitiveData'\n\nconst columns = [\n  { Header: 'Vendor', accessor: 'vendorName' },\n  { Header: 'Amount', accessor: 'amount' },\n  { Header: 'Request Date', accessor: 'date' },\n  { Header: 'Status', accessor: 'status' },\n  { Header: 'Actions', accessor: 'actions' },\n]\n\nexport function VendorWithdrawalsPage({ subRoute = null, navigate }) {\n  const {\n    getVendorWithdrawalRequests,\n    approveVendorWithdrawal,\n    rejectVendorWithdrawal,\n    completeVendorWithdrawal,\n    loading,\n  } = useAdminApi()\n  const { success, error: showError } = useToast()\n\n  const [withdrawals, setWithdrawals] = useState([])\n  const [total, setTotal] = useState(0)\n  const [filters, setFilters] = useState({ status: 'all', search: '' })\n  const [selectedRequest, setSelectedRequest] = useState(null)\n  const [modalOpen, setModalOpen] = useState(false)\n  const [actionLoading, setActionLoading] = useState(false)\n  const [confirmationModalOpen, setConfirmationModalOpen] = useState(false)\n  const [pendingAction, setPendingAction] = useState(null) // { type: 'approve' | 'reject' | 'complete', requestId: string }\n  const [approvingRequest, setApprovingRequest] = useState(null) // Request being approved (for full-screen flow)\n\n  const fetchWithdrawals = useCallback(async () => {\n    try {\n      const params = {\n        limit: 50,\n        ...(filters.status !== 'all' && { status: filters.status }),\n        ...(filters.search && { search: filters.search }),\n      }\n      const result = await getVendorWithdrawalRequests(params)\n      if (result.data) {\n        setWithdrawals(result.data.withdrawals || [])\n        setTotal(result.data.total || 0)\n      }\n    } catch (error) {\n      console.error('Failed to fetch vendor withdrawals:', error)\n    }\n  }, [getVendorWithdrawalRequests, filters])\n\n  useEffect(() => {\n    fetchWithdrawals()\n  }, [fetchWithdrawals])\n\n  const handleViewRequest = (request) => {\n    setSelectedRequest(request)\n    setModalOpen(true)\n  }\n\n  const handleApprove = () => {\n    if (!selectedRequest) return\n    // Navigate to full-screen approval page\n    if (navigate) {\n      setApprovingRequest(selectedRequest)\n      navigate(`vendor-withdrawals/approve/${selectedRequest.requestId || selectedRequest.id}`)\n    } else {\n      // Fallback to modal if navigate not available\n    setPendingAction({ type: 'approve', requestId: selectedRequest.requestId || selectedRequest.id })\n    setConfirmationModalOpen(true)\n    }\n  }\n\n  const handleReject = () => {\n    if (!selectedRequest) return\n    const reason = window.prompt('Please provide a reason for rejection:')\n    if (!reason) return\n    setPendingAction({ type: 'reject', requestId: selectedRequest.requestId || selectedRequest.id, reason })\n    setConfirmationModalOpen(true)\n  }\n\n  const handleConfirmAction = async () => {\n    if (!pendingAction || !selectedRequest) return\n    setActionLoading(true)\n    try {\n      let result\n      if (pendingAction.type === 'approve') {\n        result = await approveVendorWithdrawal(pendingAction.requestId)\n      } else if (pendingAction.type === 'reject') {\n        result = await rejectVendorWithdrawal(pendingAction.requestId, { reason: pendingAction.reason })\n      } else if (pendingAction.type === 'complete') {\n        result = await completeVendorWithdrawal(pendingAction.requestId, pendingAction.data || {})\n      }\n\n      if (result?.data) {\n        success(`Withdrawal ${pendingAction.type === 'approve' ? 'approved' : pendingAction.type === 'reject' ? 'rejected' : 'completed'} successfully!`)\n        setModalOpen(false)\n        setConfirmationModalOpen(false)\n        setSelectedRequest(null)\n        setPendingAction(null)\n        fetchWithdrawals()\n      } else if (result?.error) {\n        showError(result.error.message || `Failed to ${pendingAction.type} withdrawal`)\n      }\n    } catch (error) {\n      showError(error.message || `Failed to ${pendingAction.type} withdrawal`)\n    } finally {\n      setActionLoading(false)\n    }\n  }\n\n  const handleComplete = () => {\n    if (!selectedRequest) return\n    const paymentReference = window.prompt('Enter payment reference number:')\n    if (!paymentReference) return\n    setPendingAction({\n      type: 'complete',\n      requestId: selectedRequest.requestId || selectedRequest.id,\n      data: {\n        paymentReference,\n        paymentDate: new Date().toISOString(),\n      },\n    })\n    setConfirmationModalOpen(true)\n  }\n\n  const formatCurrency = (value) => {\n    if (typeof value === 'string') return value\n    if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\n    return `â‚¹${value.toLocaleString('en-IN')}`\n  }\n\n  const tableColumns = columns.map((column) => {\n    if (column.accessor === 'status') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const status = row.status || 'pending'\n          const tone = status === 'approved' ? 'success' : status === 'rejected' ? 'neutral' : status === 'completed' ? 'success' : 'warning'\n          return <StatusBadge tone={tone}>{status.charAt(0).toUpperCase() + status.slice(1)}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'amount') {\n      return {\n        ...column,\n        Cell: (row) => <span className=\"text-sm font-bold text-gray-900\">{formatCurrency(row.amount || 0)}</span>,\n      }\n    }\n    if (column.accessor === 'date') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const date = row.date || row.createdAt\n          return date ? new Date(date).toLocaleDateString('en-IN') : 'N/A'\n        },\n      }\n    }\n    if (column.accessor === 'actions') {\n      return {\n        ...column,\n        Cell: (row) => (\n          <button\n            type=\"button\"\n            onClick={() => handleViewRequest(row)}\n            className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-green-500 hover:bg-green-50 hover:text-green-700\"\n            title=\"View details\"\n          >\n            <Eye className=\"h-4 w-4\" />\n          </button>\n        ),\n      }\n    }\n    return column\n  })\n\n  const pendingCount = withdrawals.filter((w) => w.status === 'pending').length\n  const pendingAmount = withdrawals.filter((w) => w.status === 'pending').reduce((sum, w) => sum + (w.amount || 0), 0)\n\n  // Handle sub-route for approval flow\n  useEffect(() => {\n    if (subRoute) {\n      const parts = subRoute.split('/')\n      if (parts[0] === 'approve' && parts[1]) {\n        // Find request by ID\n        const request = withdrawals.find(w => (w.requestId || w.id) === parts[1])\n        if (request) {\n          setApprovingRequest(request)\n        } else if (withdrawals.length > 0) {\n          // Request not found, might need to refetch\n          fetchWithdrawals()\n        }\n      }\n    } else {\n      // Reset when navigating back\n      setApprovingRequest(null)\n    }\n  }, [subRoute, withdrawals, fetchWithdrawals])\n\n  // If in approval flow, show approval screen\n  if (subRoute && subRoute.startsWith('approve/') && approvingRequest) {\n    return (\n      <VendorWithdrawalApprovalScreen\n        request={approvingRequest}\n        onBack={() => {\n          setApprovingRequest(null)\n          if (navigate) navigate('vendor-withdrawals')\n        }}\n        onSuccess={() => {\n          setApprovingRequest(null)\n          if (navigate) navigate('vendor-withdrawals')\n          fetchWithdrawals()\n        }}\n      />\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Finance â€¢ Withdrawals</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Vendor Withdrawal Requests</h2>\n          <p className=\"text-sm text-gray-600\">Manage vendor withdrawal requests and process payments</p>\n        </div>\n      </header>\n\n      {/* Stats Cards */}\n      <div className=\"grid gap-6 md:grid-cols-3\">\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600 text-white shadow-lg\">\n              <Wallet className=\"h-6 w-6\" />\n            </div>\n            <div>\n              <p className=\"text-xs text-gray-600\">Total Requests</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{total}</p>\n            </div>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-orange-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-lg\">\n              <Calendar className=\"h-6 w-6\" />\n            </div>\n            <div>\n              <p className=\"text-xs text-gray-600\">Pending Requests</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{pendingCount}</p>\n            </div>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-blue-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg\">\n              <IndianRupee className=\"h-6 w-6\" />\n            </div>\n            <div>\n              <p className=\"text-xs text-gray-600\">Pending Amount</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{formatCurrency(pendingAmount)}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex flex-wrap items-center gap-4 rounded-3xl border border-gray-200 bg-white p-4\">\n        <div className=\"flex items-center gap-2\">\n          <Filter className=\"h-4 w-4 text-gray-500\" />\n          <select\n            value={filters.status}\n            onChange={(e) => setFilters((prev) => ({ ...prev, status: e.target.value }))}\n            className=\"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm\"\n          >\n            <option value=\"all\">All Status</option>\n            <option value=\"pending\">Pending</option>\n            <option value=\"approved\">Approved</option>\n            <option value=\"rejected\">Rejected</option>\n            <option value=\"completed\">Completed</option>\n          </select>\n        </div>\n        <div className=\"flex flex-1 items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-2\">\n          <Search className=\"h-4 w-4 text-gray-500\" />\n          <input\n            type=\"text\"\n            placeholder=\"Search by vendor name...\"\n            value={filters.search}\n            onChange={(e) => setFilters((prev) => ({ ...prev, search: e.target.value }))}\n            className=\"flex-1 border-none bg-transparent text-sm outline-none\"\n          />\n        </div>\n      </div>\n\n      {/* Withdrawals Table */}\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08)]\">\n        <DataTable\n          columns={tableColumns}\n          rows={withdrawals}\n          emptyState=\"No withdrawal requests found\"\n          loading={loading}\n        />\n      </div>\n\n      {/* Request Detail Modal */}\n      {selectedRequest && (\n        <Modal\n          isOpen={modalOpen}\n          onClose={() => {\n            setModalOpen(false)\n            setSelectedRequest(null)\n          }}\n          title=\"Vendor Withdrawal Request Review\"\n          size=\"md\"\n        >\n          <div className=\"space-y-6\">\n            {/* Request Header */}\n            <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600 text-white shadow-lg\">\n                    <Factory className=\"h-6 w-6\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-bold text-gray-900\">Request #{selectedRequest.requestId || selectedRequest.id || 'N/A'}</h3>\n                    <div className=\"mt-1 flex items-center gap-2 text-sm text-gray-600\">\n                      <span>{selectedRequest.vendorName || 'Unknown Vendor'}</span>\n                    </div>\n                    {selectedRequest.date && (\n                      <div className=\"mt-2 flex items-center gap-1 text-xs text-gray-500\">\n                        <Calendar className=\"h-3.5 w-3.5\" />\n                        <span>{new Date(selectedRequest.date).toLocaleDateString('en-IN')}</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <StatusBadge\n                  tone={\n                    selectedRequest.status === 'approved' || selectedRequest.status === 'completed'\n                      ? 'success'\n                      : selectedRequest.status === 'rejected'\n                      ? 'neutral'\n                      : 'warning'\n                  }\n                >\n                  {selectedRequest.status || 'Pending'}\n                </StatusBadge>\n              </div>\n            </div>\n\n            {/* Withdrawal Details */}\n            <div className=\"space-y-4\">\n              <div className=\"rounded-xl border border-green-200 bg-green-50 p-5\">\n                <div className=\"flex items-center gap-2 text-xs text-gray-500 mb-2\">\n                  <IndianRupee className=\"h-4 w-4\" />\n                  <span>Withdrawal Amount</span>\n                </div>\n                <p className=\"text-2xl font-bold text-gray-900\">{formatCurrency(selectedRequest.amount || 0)}</p>\n              </div>\n\n              {selectedRequest.bankDetails && (() => {\n                const maskedDetails = getMaskedBankDetails(selectedRequest.bankDetails)\n                return (\n                  <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                    <p className=\"mb-2 text-xs font-bold text-gray-500\">Bank Account Details (Masked for Privacy)</p>\n                    <div className=\"space-y-1 text-sm text-gray-700\">\n                      {maskedDetails.accountHolderName && (\n                        <p>Account Holder: {maskedDetails.accountHolderName}</p>\n                      )}\n                      {maskedDetails.accountNumber && (\n                        <p>Account: {maskedDetails.accountNumber}</p>\n                      )}\n                      {maskedDetails.ifscCode && <p>IFSC: {maskedDetails.ifscCode}</p>}\n                      {maskedDetails.bankName && <p>Bank: {maskedDetails.bankName}</p>}\n                    </div>\n                    <p className=\"mt-2 text-xs text-gray-500 italic\">\n                      Note: Account details are masked for security. Full details are available in payment history for processed transactions.\n                    </p>\n                  </div>\n                )\n              })()}\n\n              {selectedRequest.reason && (\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <p className=\"mb-2 text-xs font-bold text-gray-500\">Rejection Reason</p>\n                  <p className=\"text-sm text-gray-700\">{selectedRequest.reason}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setModalOpen(false)\n                  setSelectedRequest(null)\n                }}\n                disabled={actionLoading}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50\"\n              >\n                Close\n              </button>\n              <div className=\"flex gap-3\">\n                {selectedRequest.status === 'pending' && (\n                  <>\n                    <button\n                      type=\"button\"\n                      onClick={handleReject}\n                      disabled={actionLoading}\n                      className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50 disabled:opacity-50\"\n                    >\n                      <XCircle className=\"h-4 w-4\" />\n                      Reject\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={handleApprove}\n                      disabled={actionLoading}\n                      className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4)] disabled:opacity-50\"\n                    >\n                      <CheckCircle className=\"h-4 w-4\" />\n                      {actionLoading ? 'Processing...' : 'Approve'}\n                    </button>\n                  </>\n                )}\n                {selectedRequest.status === 'approved' && (\n                  <button\n                    type=\"button\"\n                    onClick={handleComplete}\n                    disabled={actionLoading}\n                    className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(59,130,246,0.3)] transition-all hover:shadow-[0_6px_20px_rgba(59,130,246,0.4)] disabled:opacity-50\"\n                  >\n                    <CheckCircle className=\"h-4 w-4\" />\n                    {actionLoading ? 'Processing...' : 'Mark as Completed'}\n                  </button>\n                )}\n              </div>\n            </div>\n          </div>\n        </Modal>\n      )}\n\n      {/* Confirmation Modal */}\n      <ConfirmationModal\n        isOpen={confirmationModalOpen}\n        onClose={() => {\n          setConfirmationModalOpen(false)\n          setPendingAction(null)\n        }}\n        onConfirm={handleConfirmAction}\n        title={`Confirm Withdrawal ${pendingAction?.type === 'approve' ? 'Approval' : pendingAction?.type === 'reject' ? 'Rejection' : 'Completion'}`}\n        message={`Please verify all details before ${pendingAction?.type === 'approve' ? 'approving' : pendingAction?.type === 'reject' ? 'rejecting' : 'completing'} this withdrawal request. This action cannot be undone.`}\n        type={pendingAction?.type === 'reject' ? 'danger' : 'warning'}\n        details={selectedRequest && pendingAction ? {\n          'Vendor': selectedRequest.vendorName || 'N/A',\n          'Amount': formatCurrency(selectedRequest.amount || 0),\n          'Request Date': selectedRequest.date || 'N/A',\n          ...(pendingAction.type === 'complete' && pendingAction.data?.paymentReference ? {\n            'Payment Reference': pendingAction.data.paymentReference,\n          } : {}),\n          ...(pendingAction.type === 'reject' && pendingAction.reason ? {\n            'Rejection Reason': pendingAction.reason,\n          } : {}),\n        } : null}\n        loading={actionLoading}\n        confirmLabel={pendingAction?.type === 'approve' ? 'Approve' : pendingAction?.type === 'reject' ? 'Reject' : 'Complete'}\n      />\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\pages\\Vendors.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'actionData' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":111,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"actionData"},"fix":{"range":[4432,4442],"text":""},"desc":"Remove unused variable 'actionData'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react'\nimport { Building2, CreditCard, MapPin, ShieldAlert, Edit2, Eye, Package, Ban, Unlock, CheckCircle, XCircle, ArrowLeft, Calendar, FileText, ExternalLink, Search } from 'lucide-react'\nimport { DataTable } from '../components/DataTable'\nimport { StatusBadge } from '../components/StatusBadge'\nimport { Timeline } from '../components/Timeline'\nimport { VendorMap } from '../components/VendorMap'\nimport { CreditPolicyForm } from '../components/CreditPolicyForm'\nimport { VendorEditForm } from '../components/VendorEditForm'\nimport { useAdminState } from '../context/AdminContext'\nimport { useAdminApi } from '../hooks/useAdminApi'\nimport { useToast } from '../components/ToastNotification'\nimport { vendors as mockVendors } from '../services/adminData'\nimport { cn } from '../../../lib/cn'\n\nconst EARTH_RADIUS_KM = 6371\nconst COVERAGE_RADIUS_KM = 20\n\nconst calculateDistanceKm = (pointA, pointB) => {\n  if (!pointA?.lat || !pointA?.lng || !pointB?.lat || !pointB?.lng) {\n    return Infinity\n  }\n  const toRad = (value) => (value * Math.PI) / 180\n  const dLat = toRad(pointB.lat - pointA.lat)\n  const dLng = toRad(pointB.lng - pointA.lng)\n  const lat1 = toRad(pointA.lat)\n  const lat2 = toRad(pointB.lat)\n\n  const a =\n    Math.sin(dLat / 2) ** 2 +\n    Math.sin(dLng / 2) ** 2 * Math.cos(lat1) * Math.cos(lat2)\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\n  return EARTH_RADIUS_KM * c\n}\n\nconst computeCoverageReport = (vendors = []) => {\n  const geoVendors = vendors.filter((vendor) => vendor.location?.lat && vendor.location?.lng)\n  const conflicts = []\n  const flagged = new Set()\n\n  for (let i = 0; i < geoVendors.length; i += 1) {\n    for (let j = i + 1; j < geoVendors.length; j += 1) {\n      const vendorA = geoVendors[i]\n      const vendorB = geoVendors[j]\n      const distanceKm = calculateDistanceKm(vendorA.location, vendorB.location)\n      if (distanceKm < COVERAGE_RADIUS_KM) {\n        flagged.add(vendorA.id)\n        flagged.add(vendorB.id)\n        conflicts.push({\n          id: `${vendorA.id}-${vendorB.id}`,\n          vendorA,\n          vendorB,\n          distanceKm: Number(distanceKm.toFixed(2)),\n          overlapKm: Number(Math.max(COVERAGE_RADIUS_KM - distanceKm, 0).toFixed(2)),\n        })\n      }\n    }\n  }\n\n  return {\n    total: geoVendors.length,\n    coverageRadius: COVERAGE_RADIUS_KM,\n    conflicts,\n    flaggedVendors: Array.from(flagged),\n    compliantCount: Math.max(geoVendors.length - flagged.size, 0),\n  }\n}\n\nconst columns = [\n  { Header: 'Vendor', accessor: 'name' },\n  { Header: 'Region', accessor: 'region' },\n  { Header: 'Coverage', accessor: 'coverageRadius' },\n  { Header: 'Credit Limit', accessor: 'creditLimit' },\n  { Header: 'Repayment', accessor: 'repayment' },\n  { Header: 'Penalty Rate', accessor: 'penalty' },\n  { Header: 'Status', accessor: 'status' },\n  { Header: 'Outstanding Dues', accessor: 'dues' },\n  { Header: 'Actions', accessor: 'actions' },\n]\n\nexport function VendorsPage({ subRoute = null, navigate }) {\n  const { vendors: vendorsState } = useAdminState()\n  const {\n    getVendors,\n    approveVendor,\n    rejectVendor,\n    banVendor,\n    unbanVendor,\n    updateVendorCreditPolicy,\n    updateVendor,\n    getVendorPurchaseRequests,\n    approveVendorPurchase,\n    rejectVendorPurchase,\n    loading,\n  } = useAdminApi()\n  const { success, error: showError, warning: showWarning } = useToast()\n\n  const [vendorsList, setVendorsList] = useState([])\n  const [allVendorsList, setAllVendorsList] = useState([])\n  const [rawVendors, setRawVendors] = useState([])\n  const [purchaseRequests, setPurchaseRequests] = useState([])\n  const [coverageReport, setCoverageReport] = useState(null)\n  \n  // View states (replacing modals with full-screen views)\n  const [currentView, setCurrentView] = useState(null) // 'creditPolicy', 'vendorDetail', 'vendorMap', 'purchaseRequest', 'approveVendor', 'rejectVendor', 'banVendor', 'unbanVendor', 'editVendor'\n  const [selectedVendorForPolicy, setSelectedVendorForPolicy] = useState(null)\n  const [selectedPurchaseRequest, setSelectedPurchaseRequest] = useState(null)\n  const [selectedVendorForDetail, setSelectedVendorForDetail] = useState(null)\n  const [selectedVendorForMap, setSelectedVendorForMap] = useState(null)\n  const [selectedVendorForAction, setSelectedVendorForAction] = useState(null)\n  const [selectedVendorForEdit, setSelectedVendorForEdit] = useState(null)\n  const [actionData, setActionData] = useState(null) // For storing form data for actions like reject/ban\n  const [rejectReason, setRejectReason] = useState('')\n  const [banType, setBanType] = useState('temporary')\n  const [banReason, setBanReason] = useState('')\n  const [revocationReason, setRevocationReason] = useState('')\n  const [purchaseRejectReason, setPurchaseRejectReason] = useState(null) // null = not showing, '' = showing input\n  const [searchQuery, setSearchQuery] = useState('')\n  const [processingPurchase, setProcessingPurchase] = useState(false) // Local loading state for purchase actions\n  const [purchaseApprovalNotes, setPurchaseApprovalNotes] = useState('') // Notes for purchase approval\n  const [loadingPurchaseRequests, setLoadingPurchaseRequests] = useState(false) // Loading state for purchase requests\n\n  // Format vendor data for display\n  const formatVendorForDisplay = (vendor, flaggedVendorIds = new Set()) => {\n    const creditLimit = typeof vendor.creditLimit === 'number'\n      ? vendor.creditLimit\n      : parseFloat(vendor.creditLimit?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n\n    const dues = typeof vendor.dues === 'number'\n      ? vendor.dues\n      : parseFloat(vendor.dues?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n\n    const isFlagged = flaggedVendorIds.has(vendor.id)\n\n    return {\n      ...vendor,\n      creditLimit: creditLimit >= 100000 ? `â‚¹${(creditLimit / 100000).toFixed(1)} L` : `â‚¹${creditLimit.toLocaleString('en-IN')}`,\n      dues: dues >= 100000 ? `â‚¹${(dues / 100000).toFixed(1)} L` : `â‚¹${dues.toLocaleString('en-IN')}`,\n      repayment: vendor.repaymentDays ? `${vendor.repaymentDays} days` : vendor.repayment || 'N/A',\n      penalty: vendor.penaltyRate ? `${vendor.penaltyRate}%` : vendor.penalty || 'N/A',\n      coverageRadius: vendor.coverageRadius ? `${vendor.coverageRadius} km` : 'N/A',\n      coverageCompliance: isFlagged ? 'Conflict' : 'Compliant',\n    }\n  }\n\n  // Fetch vendors\n  const fetchVendors = useCallback(async () => {\n    const result = await getVendors()\n    const sourceVendors = result.data?.vendors || mockVendors\n    setRawVendors(sourceVendors)\n    const coverageInfo = computeCoverageReport(sourceVendors)\n    setCoverageReport(coverageInfo)\n    const flaggedSet = new Set(coverageInfo.flaggedVendors || [])\n    const formatted = sourceVendors.map((vendor) => formatVendorForDisplay(vendor, flaggedSet))\n    setAllVendorsList(formatted)\n  }, [getVendors])\n\n  // Filter vendors based on subRoute and search\n  useEffect(() => {\n    // Skip filtering if we're on purchase-requests subRoute\n    if (subRoute === 'purchase-requests') {\n      return\n    }\n\n    let filtered = allVendorsList\n\n    // Filter by subRoute\n    if (subRoute === 'on-track') {\n      filtered = filtered.filter((v) => {\n        const status = v.status?.toLowerCase() || ''\n        return status === 'on track' || status === 'approved' || status === 'active'\n      })\n    } else if (subRoute === 'out-of-track') {\n      filtered = filtered.filter((v) => {\n        const status = v.status?.toLowerCase() || ''\n        return status === 'delayed' || status === 'review' || status === 'pending' || status === 'rejected'\n      })\n    }\n\n    // Filter by search query\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase().trim()\n      filtered = filtered.filter((v) => {\n        const name = (v.name || '').toLowerCase()\n        const phone = (v.phone || '').replace(/\\D/g, '')\n        const email = (v.email || '').toLowerCase()\n        const searchPhone = query.replace(/\\D/g, '')\n        \n        return name.includes(query) || \n               phone.includes(searchPhone) || \n               email.includes(query) ||\n               (v.id && v.id.toLowerCase().includes(query))\n      })\n    }\n\n    setVendorsList(filtered)\n  }, [subRoute, allVendorsList, searchQuery])\n\n  // Fetch purchase requests\n  const fetchPurchaseRequests = useCallback(async () => {\n    setLoadingPurchaseRequests(true)\n    try {\n      const result = await getVendorPurchaseRequests({ status: 'pending' })\n      if (result.data?.purchases) {\n        setPurchaseRequests(result.data.purchases)\n      }\n    } catch (error) {\n      console.error('Failed to fetch purchase requests:', error)\n    } finally {\n      setLoadingPurchaseRequests(false)\n    }\n  }, [getVendorPurchaseRequests])\n\n  useEffect(() => {\n    fetchVendors()\n    fetchPurchaseRequests()\n  }, [fetchVendors, fetchPurchaseRequests])\n\n  // Handle purchase-requests subRoute - show purchase requests view\n  useEffect(() => {\n    if (subRoute === 'purchase-requests') {\n      fetchPurchaseRequests()\n      // Reset selected request when entering list view\n      if (!currentView || currentView !== 'purchaseRequest') {\n        setSelectedPurchaseRequest(null)\n        setCurrentView(null)\n      }\n    } else if (subRoute !== 'purchase-requests' && currentView === 'purchaseRequest') {\n      // Reset view when navigating away from purchase-requests\n      setCurrentView(null)\n      setSelectedPurchaseRequest(null)\n      setPurchaseApprovalNotes('')\n      setPurchaseRejectReason(null)\n    }\n  }, [subRoute, fetchPurchaseRequests, currentView])\n\n  // Refresh when vendors are updated\n  useEffect(() => {\n    if (vendorsState.updated) {\n      fetchVendors()\n      fetchPurchaseRequests()\n    }\n  }, [vendorsState.updated, fetchVendors, fetchPurchaseRequests])\n\n  const getVendorCoverageConflicts = (vendorId) => {\n    if (!coverageReport?.conflicts) {\n      return []\n    }\n    return coverageReport.conflicts.filter(\n      (conflict) => conflict.vendorA.id === vendorId || conflict.vendorB.id === vendorId,\n    )\n  }\n\n  const getRawVendorById = (vendorId) =>\n    rawVendors.find((vendor) => vendor.id === vendorId) ||\n    vendorsState.data?.vendors?.find((vendor) => vendor.id === vendorId)\n\n  const withCoverageMeta = (vendor) => {\n    if (!vendor) return vendor\n    return {\n      ...vendor,\n      coverageRadius: vendor.coverageRadius || COVERAGE_RADIUS_KM,\n      coverageConflicts: getVendorCoverageConflicts(vendor.id),\n    }\n  }\n\n  const handleBanVendor = async (vendorId, banData) => {\n    try {\n      const result = await banVendor(vendorId, banData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedVendorForAction(null)\n        setActionData(null)\n        fetchVendors()\n        success(`Vendor ${banData.banType === 'permanent' ? 'permanently' : 'temporarily'} banned successfully!`, 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to ban vendor'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to ban vendor', 5000)\n    }\n  }\n\n  const handleUnbanVendor = async (vendorId, unbanData) => {\n    try {\n      const result = await unbanVendor(vendorId, unbanData)\n      if (result.data) {\n        fetchVendors()\n        success('Vendor ban revoked successfully!', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to unban vendor'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to unban vendor', 5000)\n    }\n  }\n\n  const handleUpdateCreditPolicy = async (policyData) => {\n    try {\n      const result = await updateVendorCreditPolicy(selectedVendorForPolicy.id, policyData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedVendorForPolicy(null)\n        fetchVendors()\n        success('Credit policy updated successfully!', 4000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to update credit policy'\n        // Check if it's a warning about vendor not being approved\n        if (errorMessage.includes('approved') || errorMessage.includes('status')) {\n          showWarning(errorMessage, 6000)\n        } else {\n          showError(errorMessage, 5000)\n        }\n      }\n    } catch (error) {\n      const errorMessage = error.message || 'Failed to update credit policy'\n      showError(errorMessage, 5000)\n    }\n  }\n\n  const handleApproveVendor = async (vendorId) => {\n    try {\n      const result = await approveVendor(vendorId)\n      if (result.success || result.data) {\n        setCurrentView(null)\n        setSelectedVendorForAction(null)\n        success('Vendor approved successfully!', 3000)\n        // Refresh vendors list\n        const vendorsResult = await getVendors({})\n        if (vendorsResult.data) {\n          setRawVendors(vendorsResult.data.vendors || [])\n        }\n        fetchVendors()\n      } else {\n        const errorMessage = result.error?.message || 'Failed to approve vendor'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to approve vendor', 5000)\n    }\n  }\n\n  const handleRejectVendor = async (vendorId, rejectionData) => {\n    try {\n      const result = await rejectVendor(vendorId, rejectionData)\n      if (result.success || result.data) {\n        setCurrentView(null)\n        setSelectedVendorForAction(null)\n        setActionData(null)\n        success('Vendor application rejected.', 3000)\n        // Refresh vendors list\n        const vendorsResult = await getVendors({})\n        if (vendorsResult.data) {\n          setRawVendors(vendorsResult.data.vendors || [])\n        }\n        fetchVendors()\n      } else {\n        const errorMessage = result.error?.message || 'Failed to reject vendor'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to reject vendor', 5000)\n    }\n  }\n\n  const handleApprovePurchase = async (requestId, shortDescription) => {\n    // Use provided shortDescription or fallback to state\n    const notes = shortDescription || purchaseApprovalNotes || ''\n    const trimmedNotes = notes.trim()\n    if (!trimmedNotes) {\n      showError('Short description is required for approval', 3000)\n      return\n    }\n    \n    console.log('handleApprovePurchase called:', { requestId, shortDescription, trimmedNotes, stateValue: purchaseApprovalNotes })\n    \n    setProcessingPurchase(true)\n    try {\n      const result = await approveVendorPurchase(requestId, trimmedNotes)\n      if (result.success && result.data) {\n        setCurrentView(null)\n        setSelectedPurchaseRequest(null)\n        setPurchaseApprovalNotes('')\n        setPurchaseRejectReason(null)\n        fetchPurchaseRequests()\n        fetchVendors()\n        success('Vendor purchase request approved successfully!', 3000)\n      } else {\n        const errorMessage = result.error?.message || result.message || 'Failed to approve purchase request'\n        console.error('Purchase approval error:', result)\n        console.error('Error details:', {\n          success: result.success,\n          error: result.error,\n          message: result.message,\n          fullResult: JSON.stringify(result, null, 2)\n        })\n        console.error('Error message:', errorMessage)\n        if (errorMessage.includes('credit') || errorMessage.includes('limit') || errorMessage.includes('insufficient') || errorMessage.includes('stock')) {\n          showWarning(errorMessage, 6000)\n        } else {\n          showError(errorMessage, 5000)\n        }\n      }\n    } catch (error) {\n      console.error('Purchase approval exception:', error)\n      showError(error.message || 'Failed to approve purchase request', 5000)\n    } finally {\n      setProcessingPurchase(false)\n    }\n  }\n\n  const handleRejectPurchase = async (requestId, rejectionData) => {\n    setProcessingPurchase(true)\n    try {\n      const result = await rejectVendorPurchase(requestId, rejectionData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedPurchaseRequest(null)\n        setActionData(null)\n        setPurchaseRejectReason(null)\n        fetchPurchaseRequests()\n        fetchVendors()\n        success('Vendor purchase request rejected.', 3000)\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to reject purchase request'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to reject purchase request', 5000)\n    } finally {\n      setProcessingPurchase(false)\n    }\n  }\n\n  const handleViewVendorDetails = (vendor) => {\n    const originalVendor = withCoverageMeta(getRawVendorById(vendor.id) || vendor)\n    setSelectedVendorForDetail(originalVendor)\n    setCurrentView('vendorDetail')\n  }\n\n  const handleViewVendorMap = (vendor) => {\n    const originalVendor = withCoverageMeta(getRawVendorById(vendor.id) || vendor)\n    setSelectedVendorForMap(originalVendor)\n    setCurrentView('vendorMap')\n  }\n\n  const handleBackToList = () => {\n    setCurrentView(null)\n    setSelectedVendorForPolicy(null)\n    setSelectedPurchaseRequest(null)\n    setSelectedVendorForDetail(null)\n    setSelectedVendorForMap(null)\n    setSelectedVendorForAction(null)\n    setSelectedVendorForEdit(null)\n    setRejectReason('')\n    setBanType('temporary')\n    setBanReason('')\n    setRevocationReason('')\n    setPurchaseRejectReason(null)\n    if (navigate) navigate('vendors')\n  }\n\n  const handleEditVendor = (vendor) => {\n    const originalVendor = getRawVendorById(vendor.id) || vendor\n    setSelectedVendorForEdit(originalVendor)\n    setCurrentView('editVendor')\n  }\n\n  const handleSaveVendor = async (vendorData) => {\n    try {\n      const result = await updateVendor(selectedVendorForEdit.id, vendorData)\n      if (result.data) {\n        setCurrentView(null)\n        setSelectedVendorForEdit(null)\n        fetchVendors()\n        success('Vendor information updated successfully!', 3000)\n        if (navigate) navigate('vendors')\n      } else if (result.error) {\n        const errorMessage = result.error.message || 'Failed to update vendor'\n        showError(errorMessage, 5000)\n      }\n    } catch (error) {\n      showError(error.message || 'Failed to update vendor', 5000)\n    }\n  }\n\n\n  const tableColumns = columns.map((column) => {\n    if (column.accessor === 'status') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const originalVendor = vendorsState.data?.vendors?.find((v) => v.id === row.id) || row\n          const isBanned = originalVendor.banInfo?.isBanned || originalVendor.status === 'temporarily_banned' || originalVendor.status === 'permanently_banned'\n          const banType = originalVendor.banInfo?.banType || (originalVendor.status === 'permanently_banned' ? 'permanent' : 'temporary')\n          const status = isBanned ? (banType === 'permanent' ? 'Permanently Banned' : 'Temporarily Banned') : (row.status || 'Active')\n          let tone = 'neutral'\n          if (isBanned) {\n            tone = 'error'\n          } else if (status === 'approved' || status === 'active' || status === 'On Track' || status === 'on_track') {\n            tone = 'success'\n          } else if (status === 'Delayed' || status === 'delayed') {\n            tone = 'warning'\n          } else if (status === 'inactive' || status === 'blocked') {\n            tone = 'error'\n          }\n          // Capitalize first letter for display\n          const displayStatus = status.charAt(0).toUpperCase() + status.slice(1)\n          return <StatusBadge tone={tone}>{displayStatus}</StatusBadge>\n        },\n      }\n    }\n    if (column.accessor === 'region') {\n      return {\n        ...column,\n        Cell: (row) => (\n          <span className=\"inline-flex items-center gap-2 rounded-full border border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/50 px-3 py-1 text-xs text-blue-700 font-bold shadow-[0_2px_8px_rgba(59,130,246,0.2),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n            <MapPin className=\"h-3.5 w-3.5\" />\n            {row.region}\n          </span>\n        ),\n      }\n    }\n    if (column.accessor === 'coverageRadius') {\n      return {\n        ...column,\n        Cell: (row) => (\n          <div className=\"flex flex-col gap-1 text-xs\">\n            <span className=\"font-semibold text-gray-900\">{row.coverageRadius || 'N/A'}</span>\n            <StatusBadge tone={row.coverageCompliance === 'Conflict' ? 'warning' : 'success'}>\n              {row.coverageCompliance || 'Unknown'}\n            </StatusBadge>\n          </div>\n        ),\n      }\n    }\n    if (column.accessor === 'actions') {\n      return {\n        ...column,\n        Cell: (row) => {\n          const originalVendor = vendorsState.data?.vendors?.find((v) => v.id === row.id) || row\n          const vendorStatus = originalVendor.status?.toLowerCase() || 'active'\n          const isPending = vendorStatus === 'pending'\n          const isRejected = vendorStatus === 'rejected'\n          const isBanned = originalVendor.banInfo?.isBanned || originalVendor.status === 'temporarily_banned' || originalVendor.status === 'permanently_banned'\n          const banType = originalVendor.banInfo?.banType || (originalVendor.status === 'permanently_banned' ? 'permanent' : 'temporary')\n          return (\n            <div className=\"flex items-center gap-2\">\n              <button\n                type=\"button\"\n                onClick={() => handleViewVendorMap(originalVendor)}\n                className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-blue-500 hover:bg-blue-50 hover:text-blue-700\"\n                title=\"View location\"\n              >\n                <MapPin className=\"h-4 w-4\" />\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => handleViewVendorDetails(originalVendor)}\n                className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-purple-500 hover:bg-purple-50 hover:text-purple-700\"\n                title=\"View details\"\n              >\n                <Eye className=\"h-4 w-4\" />\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => handleEditVendor(originalVendor)}\n                className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-blue-500 hover:bg-blue-50 hover:text-blue-700\"\n                title=\"Edit vendor information\"\n              >\n                <Edit2 className=\"h-4 w-4\" />\n              </button>\n              \n              {/* Approve/Reject buttons for pending vendors */}\n              {isPending && (\n                <>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedVendorForAction(originalVendor)\n                      setCurrentView('approveVendor')\n                    }}\n                    className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-green-300 bg-green-50 text-green-700 transition-all hover:border-green-500 hover:bg-green-100 hover:text-green-800\"\n                    title=\"Approve vendor\"\n                  >\n                    <CheckCircle className=\"h-4 w-4\" />\n                  </button>\n                  <button\n                    type=\"button\"\n                  onClick={() => {\n                    setSelectedVendorForAction(originalVendor)\n                    setRejectReason('')\n                    setCurrentView('rejectVendor')\n                  }}\n                    className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-red-300 bg-red-50 text-red-700 transition-all hover:border-red-500 hover:bg-red-100 hover:text-red-800\"\n                    title=\"Reject vendor\"\n                  >\n                    <XCircle className=\"h-4 w-4\" />\n                  </button>\n                </>\n              )}\n\n              {/* Actions for approved vendors (not banned) */}\n              {!isBanned && !isPending && !isRejected && (\n                <>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedVendorForPolicy(originalVendor)\n                      setCurrentView('creditPolicy')\n                    }}\n                    className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:border-green-500 hover:bg-green-50 hover:text-green-700\"\n                    title=\"Update credit policy\"\n                  >\n                    <Edit2 className=\"h-4 w-4\" />\n                  </button>\n                  <button\n                    type=\"button\"\n                  onClick={() => {\n                    setSelectedVendorForAction(originalVendor)\n                    setBanType('temporary')\n                    setBanReason('')\n                    setCurrentView('banVendor')\n                  }}\n                    className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-red-300 bg-red-50 text-red-700 transition-all hover:border-red-500 hover:bg-red-100 hover:text-red-800\"\n                    title=\"Ban vendor\"\n                  >\n                    <Ban className=\"h-4 w-4\" />\n                  </button>\n                </>\n              )}\n              {isBanned && banType === 'temporary' && (\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setSelectedVendorForAction(originalVendor)\n                    setRevocationReason('')\n                    setCurrentView('unbanVendor')\n                  }}\n                  className=\"flex h-8 w-8 items-center justify-center rounded-lg border border-green-300 bg-green-50 text-green-700 transition-all hover:border-green-500 hover:bg-green-100 hover:text-green-800\"\n                  title=\"Unban vendor\"\n                >\n                  <Unlock className=\"h-4 w-4\" />\n                </button>\n              )}\n            </div>\n          )\n        },\n      }\n    }\n    return column\n  })\n\n  // Render full-screen views\n  if (currentView === 'editVendor' && selectedVendorForEdit) {\n    return (\n      <VendorEditForm\n        vendor={selectedVendorForEdit}\n        onSave={handleSaveVendor}\n        onCancel={handleBackToList}\n        loading={loading}\n      />\n    )\n  }\n\n  if (currentView === 'creditPolicy' && selectedVendorForPolicy) {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Vendors\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Update Credit Policy</h2>\n            <p className=\"text-sm text-gray-600\">\n              Configure credit limit, repayment terms, and penalty rates for {selectedVendorForPolicy.name}.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <CreditPolicyForm\n            vendor={selectedVendorForPolicy}\n            onSubmit={handleUpdateCreditPolicy}\n            onCancel={handleBackToList}\n            loading={loading}\n          />\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'vendorDetail' && selectedVendorForDetail) {\n    const vendor = selectedVendorForDetail\n    const formatCurrency = (value) => {\n      if (typeof value === 'string') return value\n      if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\n      return `â‚¹${value.toLocaleString('en-IN')}`\n    }\n    const creditLimit = typeof vendor.creditLimit === 'number' \n      ? vendor.creditLimit \n      : parseFloat(vendor.creditLimit?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n    const dues = typeof vendor.dues === 'number'\n      ? vendor.dues\n      : parseFloat(vendor.dues?.replace(/[â‚¹,\\sL]/g, '') || '0') * 100000\n    const creditUtilization = creditLimit > 0 ? ((dues / creditLimit) * 100).toFixed(1) : 0\n\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Vendors\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Vendor Details & Performance</h2>\n            <p className=\"text-sm text-gray-600\">\n              Comprehensive view of vendor information, credit status, and performance metrics.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-6\">\n            {/* Vendor Header */}\n            <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-green-500 to-green-600 text-white shadow-lg\">\n                    <Building2 className=\"h-6 w-6\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-bold text-gray-900\">{vendor.name}</h3>\n                    <p className=\"text-sm text-gray-600\">Vendor ID: {vendor.id}</p>\n                    <div className=\"mt-2 flex items-center gap-2\">\n                      <MapPin className=\"h-4 w-4 text-gray-400\" />\n                      <span className=\"text-sm text-gray-600\">{vendor.region}</span>\n                    </div>\n                  </div>\n                </div>\n                <StatusBadge tone={vendor.status === 'On Track' || vendor.status === 'on_track' ? 'success' : vendor.status === 'Delayed' || vendor.status === 'delayed' ? 'warning' : 'neutral'}>\n                  {vendor.status || 'Unknown'}\n                </StatusBadge>\n              </div>\n            </div>\n\n            {/* Credit Performance Metrics */}\n            <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-4\">\n              <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n                <p className=\"text-xs text-gray-500\">Credit Limit</p>\n                <p className=\"mt-1 text-lg font-bold text-gray-900\">{formatCurrency(creditLimit)}</p>\n              </div>\n              <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n                <p className=\"text-xs text-gray-500\">Outstanding Dues</p>\n                <p className=\"mt-1 text-lg font-bold text-red-600\">{formatCurrency(dues)}</p>\n              </div>\n              <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n                <p className=\"text-xs text-gray-500\">Credit Utilization</p>\n                <p className=\"mt-1 text-lg font-bold text-gray-900\">{creditUtilization}%</p>\n                <div className=\"mt-2 h-2 w-full overflow-hidden rounded-full bg-gray-100\">\n                  <div\n                    className={cn(\n                      'h-full rounded-full transition-all',\n                      parseFloat(creditUtilization) > 80 ? 'bg-gradient-to-r from-red-500 to-red-600' : parseFloat(creditUtilization) > 60 ? 'bg-gradient-to-r from-yellow-500 to-yellow-600' : 'bg-gradient-to-r from-green-500 to-green-600',\n                    )}\n                    style={{ width: `${Math.min(creditUtilization, 100)}%` }}\n                  />\n                </div>\n              </div>\n              <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n                <p className=\"text-xs text-gray-500\">Repayment Days</p>\n                <p className=\"mt-1 text-lg font-bold text-gray-900\">{vendor.repaymentDays || vendor.repayment || 'N/A'}</p>\n              </div>\n            </div>\n\n            {/* Coverage & Policy */}\n            <div className=\"grid gap-4 lg:grid-cols-2\">\n              <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-5\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h4 className=\"text-sm font-bold text-blue-900\">Coverage Radius</h4>\n                    <p className=\"mt-2 text-2xl font-bold text-blue-900\">\n                      {vendor.coverageRadius ? `${vendor.coverageRadius} km` : 'N/A'}\n                    </p>\n                    {vendor.serviceArea && <p className=\"text-xs text-blue-700\">{vendor.serviceArea}</p>}\n                  </div>\n                  <StatusBadge tone={vendor.coverageConflicts?.length ? 'warning' : 'success'}>\n                    {vendor.coverageConflicts?.length ? 'Conflict' : 'Compliant'}\n                  </StatusBadge>\n                </div>\n                {vendor.coverageConflicts?.length ? (\n                  <ul className=\"mt-4 space-y-2 text-xs text-blue-900\">\n                    {vendor.coverageConflicts.map((conflict) => {\n                      const otherVendor = conflict.vendorA.id === vendor.id ? conflict.vendorB : conflict.vendorA\n                      return (\n                        <li key={`${vendor.id}-${otherVendor.id}`} className=\"rounded-lg border border-blue-200 bg-white/80 px-3 py-2\">\n                          <p className=\"font-semibold\">{otherVendor.name}</p>\n                          <p className=\"text-[0.7rem] text-blue-700\">\n                            Distance: {conflict.distanceKm} km â€¢ Overlap: {conflict.overlapKm} km\n                          </p>\n                        </li>\n                      )\n                    })}\n                  </ul>\n                ) : (\n                  <p className=\"mt-4 text-xs text-blue-800\">\n                    No overlapping vendors detected within the 20 km exclusivity rule.\n                  </p>\n                )}\n              </div>\n\n              <div className=\"rounded-xl border border-green-200 bg-green-50 p-5\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h4 className=\"text-sm font-bold text-green-900\">Credit Policy</h4>\n                    <div className=\"mt-2 grid gap-2 text-xs text-green-800 sm:grid-cols-3\">\n                      <div>\n                        <span className=\"font-semibold\">Limit: </span>\n                        <span>{formatCurrency(creditLimit)}</span>\n                      </div>\n                      <div>\n                        <span className=\"font-semibold\">Repayment: </span>\n                        <span>{vendor.repaymentDays || vendor.repayment || 'N/A'}</span>\n                      </div>\n                      <div>\n                        <span className=\"font-semibold\">Penalty: </span>\n                        <span>{vendor.penaltyRate || vendor.penalty || 'N/A'}</span>\n                      </div>\n                    </div>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setSelectedVendorForPolicy(vendor)\n                      setCurrentView('creditPolicy')\n                    }}\n                    className=\"rounded-lg border border-green-300 bg-white px-4 py-2 text-xs font-bold text-green-700 transition-all hover:bg-green-100\"\n                  >\n                    Update Policy\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Performance Alerts */}\n            {parseFloat(creditUtilization) > 80 && (\n              <div className=\"rounded-xl border border-red-200 bg-red-50 p-4\">\n                <div className=\"flex items-start gap-3\">\n                  <ShieldAlert className=\"h-5 w-5 flex-shrink-0 text-red-600\" />\n                  <div>\n                    <p className=\"text-sm font-bold text-red-900\">High Credit Utilization Alert</p>\n                    <p className=\"mt-1 text-xs text-red-700\">\n                      This vendor has exceeded 80% credit utilization. Consider reviewing their credit limit or requesting immediate repayment.\n                    </p>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Verification Documents */}\n            <div className=\"space-y-4\">\n              <h4 className=\"text-sm font-bold text-gray-900\">Verification Documents</h4>\n              \n              <div className=\"grid gap-4 sm:grid-cols-2\">\n                {/* Aadhaar Card */}\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <div className=\"flex items-center gap-2\">\n                      <FileText className=\"h-4 w-4 text-gray-400\" />\n                      <p className=\"text-xs font-semibold text-gray-700\">Aadhaar Card</p>\n                    </div>\n                    {vendor.aadhaarCard?.url ? (\n                      <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                    ) : (\n                      <XCircle className=\"h-4 w-4 text-red-600\" />\n                    )}\n                  </div>\n                  {vendor.aadhaarCard?.url ? (\n                    <div className=\"space-y-2\">\n                      {vendor.aadhaarCard.format === 'pdf' ? (\n                        <div className=\"flex items-center gap-2 text-xs text-gray-600\">\n                          <FileText className=\"h-4 w-4 text-red-600\" />\n                          <span>PDF Document</span>\n                        </div>\n                      ) : (\n                        <div className=\"rounded-lg overflow-hidden border border-gray-300 bg-white\">\n                          <img \n                            src={vendor.aadhaarCard.url} \n                            alt=\"Aadhaar Card\"\n                            className=\"w-full h-auto max-h-40 object-contain\"\n                            onError={(e) => {\n                              e.target.style.display = 'none'\n                            }}\n                          />\n                        </div>\n                      )}\n                      <a\n                        href={vendor.aadhaarCard.url}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 font-semibold\"\n                      >\n                        <Eye className=\"h-3 w-3\" />\n                        View Document\n                        <ExternalLink className=\"h-3 w-3\" />\n                      </a>\n                    </div>\n                  ) : (\n                    <p className=\"text-xs text-red-600\">Not uploaded</p>\n                  )}\n                </div>\n\n                {/* PAN Card */}\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <div className=\"flex items-center gap-2\">\n                      <FileText className=\"h-4 w-4 text-gray-400\" />\n                      <p className=\"text-xs font-semibold text-gray-700\">PAN Card</p>\n                    </div>\n                    {vendor.panCard?.url ? (\n                      <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                    ) : (\n                      <XCircle className=\"h-4 w-4 text-red-600\" />\n                    )}\n                  </div>\n                  {vendor.panCard?.url ? (\n                    <div className=\"space-y-2\">\n                      {vendor.panCard.format === 'pdf' ? (\n                        <div className=\"flex items-center gap-2 text-xs text-gray-600\">\n                          <FileText className=\"h-4 w-4 text-red-600\" />\n                          <span>PDF Document</span>\n                        </div>\n                      ) : (\n                        <div className=\"rounded-lg overflow-hidden border border-gray-300 bg-white\">\n                          <img \n                            src={vendor.panCard.url} \n                            alt=\"PAN Card\"\n                            className=\"w-full h-auto max-h-40 object-contain\"\n                            onError={(e) => {\n                              e.target.style.display = 'none'\n                            }}\n                          />\n                        </div>\n                      )}\n                      <a\n                        href={vendor.panCard.url}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 font-semibold\"\n                      >\n                        <Eye className=\"h-3 w-3\" />\n                        View Document\n                        <ExternalLink className=\"h-3 w-3\" />\n                      </a>\n                    </div>\n                  ) : (\n                    <p className=\"text-xs text-red-600\">Not uploaded</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'vendorMap' && selectedVendorForMap) {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Vendors\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">{selectedVendorForMap.name} Location</h2>\n            <p className=\"text-sm text-gray-600\">\n              View vendor location and coverage area on the map.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <VendorMap vendor={selectedVendorForMap} className=\"h-[600px]\" />\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'purchaseRequest' && selectedPurchaseRequest) {\n    const request = selectedPurchaseRequest\n    const formatCurrency = (value) => {\n      if (typeof value === 'string') return value\n      if (value >= 100000) return `â‚¹${(value / 100000).toFixed(1)} L`\n      return `â‚¹${value.toLocaleString('en-IN')}`\n    }\n\n    const handleRejectWithReason = () => {\n      if (!purchaseRejectReason || !purchaseRejectReason.trim()) {\n        showError('Please provide a reason for rejection', 3000)\n        return\n      }\n      handleRejectPurchase(request.id, { reason: purchaseRejectReason.trim() })\n    }\n\n    const handleBackToVendors = () => {\n      setCurrentView(null)\n      setSelectedPurchaseRequest(null)\n      setPurchaseRejectReason(null)\n      setPurchaseApprovalNotes('')\n      if (navigate) {\n        navigate('vendors')\n      }\n    }\n\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToVendors}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Vendors\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Vendor Purchase Request Review</h2>\n            <p className=\"text-sm text-gray-600\">\n              Review and approve or reject vendor purchase requests (minimum â‚¹50,000).\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-6\">\n            {/* Request Header */}\n            <div className=\"rounded-2xl border border-gray-200 bg-white p-5\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg\">\n                    <Package className=\"h-6 w-6\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-bold text-gray-900\">\n                      Request #{request.id?.slice(-8) || request.requestId?.slice(-8) || 'N/A'}\n                    </h3>\n                    <p className=\"text-sm text-gray-600\">Vendor: {request.vendorName || request.vendor}</p>\n                    <div className=\"mt-2 flex items-center gap-4 text-xs text-gray-500\">\n                      {request.date && (\n                        <div className=\"flex items-center gap-1\">\n                          <Calendar className=\"h-3.5 w-3.5\" />\n                          <span>{new Date(request.date).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })}</span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n                <StatusBadge tone={request.status === 'pending' ? 'warning' : request.status === 'approved' ? 'success' : 'neutral'}>\n                  {request.status || 'Pending'}\n                </StatusBadge>\n              </div>\n            </div>\n\n            {/* Purchase Details */}\n            <div className=\"space-y-4\">\n              <h4 className=\"text-sm font-bold text-gray-900\">Purchase Details</h4>\n              <div className=\"grid gap-4 sm:grid-cols-2\">\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <p className=\"text-xs text-gray-500\">Request Amount</p>\n                  <p className=\"mt-1 text-lg font-bold text-gray-900\">\n                    {formatCurrency(request.amount || request.value || 0)}\n                  </p>\n                </div>\n                {request.advance && (\n                  <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                    <p className=\"text-xs text-gray-500\">Advance Payment (30%)</p>\n                    <p className=\"mt-1 text-lg font-bold text-gray-900\">{formatCurrency(request.advance)}</p>\n                  </div>\n                )}\n              </div>\n\n              {request.products && request.products.length > 0 && (\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <p className=\"mb-3 text-xs font-bold text-gray-500\">Products Requested</p>\n                  <div className=\"space-y-2\">\n                    {request.products.map((product, index) => {\n                      // Format attribute label\n                      const formatAttributeLabel = (key) => {\n                        return key\n                          .replace(/([A-Z])/g, ' $1')\n                          .replace(/^./, str => str.toUpperCase())\n                          .trim()\n                      }\n                      \n                      return (\n                        <div key={index} className=\"rounded-lg bg-white p-3\">\n                          <div className=\"flex items-center justify-between mb-1\">\n                            <span className=\"text-sm font-semibold text-gray-900\">{product.name || product}</span>\n                            {product.quantity && (\n                              <span className=\"text-xs text-gray-500\">\n                                Qty: {product.quantity} {product.unit || 'kg'}\n                              </span>\n                            )}\n                          </div>\n                          {/* Display variant attributes if present */}\n                          {product.attributeCombination && Object.keys(product.attributeCombination).length > 0 && (\n                            <div className=\"mt-2 space-y-1 pt-2 border-t border-gray-100\">\n                              {Object.entries(product.attributeCombination).map(([key, value]) => (\n                                <div key={key} className=\"flex items-center gap-2 text-xs\">\n                                  <span className=\"text-gray-600 font-medium\">{formatAttributeLabel(key)}:</span>\n                                  <span className=\"text-gray-900\">{value}</span>\n                                </div>\n                              ))}\n                            </div>\n                          )}\n                          {product.price && (\n                            <div className=\"mt-1 text-xs text-gray-500\">\n                              Price: â‚¹{product.price.toLocaleString('en-IN')}/{product.unit || 'kg'}\n                            </div>\n                          )}\n                        </div>\n                      )\n                    })}\n                  </div>\n                </div>\n              )}\n\n              {request.description && (\n                <div className=\"rounded-xl border border-gray-200 bg-gray-50 p-4\">\n                  <p className=\"mb-2 text-xs text-gray-500\">Description</p>\n                  <p className=\"text-sm text-gray-700\">{request.description}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Short Description Input (Required for Approval) */}\n            <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n              <label className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Short Description <span className=\"text-xs font-normal text-red-500\">*</span>\n                <span className=\"text-xs font-normal text-gray-500 ml-1\">(Required for approval)</span>\n              </label>\n              <textarea\n                value={purchaseApprovalNotes || ''}\n                onChange={(e) => {\n                  const value = e.target.value || ''\n                  setPurchaseApprovalNotes(value)\n                }}\n                placeholder=\"Enter a short description for this approval (max 150 characters)\"\n                rows={3}\n                maxLength={150}\n                required\n                className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/50\"\n              />\n              <p className=\"mt-1 text-xs text-gray-500\">\n                {(purchaseApprovalNotes || '').length}/150 characters\n              </p>\n            </div>\n\n            {/* Rejection Reason Input (shown when rejecting) */}\n            {purchaseRejectReason !== null && (\n              <div className=\"rounded-xl border border-gray-200 bg-white p-4\">\n                <label className=\"mb-2 block text-sm font-bold text-gray-900\">\n                  Rejection Reason <span className=\"text-xs font-normal text-gray-500\">(Required for rejection)</span>\n                </label>\n                <textarea\n                  value={purchaseRejectReason}\n                  onChange={(e) => setPurchaseRejectReason(e.target.value)}\n                  placeholder=\"Enter reason for rejection\"\n                  rows={3}\n                  className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-500/50\"\n                />\n              </div>\n            )}\n\n            {/* Action Buttons */}\n            <div className=\"flex flex-col-reverse gap-3 border-t border-gray-200 pt-6 sm:flex-row sm:justify-end\">\n              <button\n                type=\"button\"\n                onClick={handleBackToVendors}\n                disabled={processingPurchase}\n                className=\"rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Cancel\n              </button>\n              <div className=\"flex gap-3\">\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    if (purchaseRejectReason === null) {\n                      setPurchaseRejectReason('')\n                    } else {\n                      handleRejectWithReason()\n                    }\n                  }}\n                  disabled={processingPurchase}\n                  className=\"flex items-center gap-2 rounded-xl border border-red-300 bg-white px-6 py-3 text-sm font-bold text-red-600 transition-all hover:bg-red-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  <XCircle className=\"h-4 w-4\" />\n                  {purchaseRejectReason === null ? 'Reject' : 'Confirm Rejection'}\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={(e) => {\n                    e.preventDefault()\n                    e.stopPropagation()\n                    const notes = purchaseApprovalNotes || ''\n                    const trimmedNotes = notes.trim()\n                    console.log('Approve button clicked:', { notes, trimmedNotes, purchaseApprovalNotes })\n                    if (!trimmedNotes) {\n                      showError('Short description is required for approval', 3000)\n                      return\n                    }\n                    handleApprovePurchase(request.id, trimmedNotes)\n                  }}\n                  disabled={processingPurchase || !(purchaseApprovalNotes || '').trim()}\n                  className=\"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  <CheckCircle className=\"h-4 w-4\" />\n                  {processingPurchase ? 'Processing...' : 'Approve Request'}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Action views (Approve, Reject, Ban, Unban)\n  if (currentView === 'approveVendor' && selectedVendorForAction) {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Vendors\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Approve Vendor</h2>\n            <p className=\"text-sm text-gray-600\">\n              Approve vendor application for {selectedVendorForAction.name}.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-6\">\n            <div className=\"rounded-2xl border border-green-200 bg-green-50 p-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-br from-green-500 to-green-600 text-white shadow-lg\">\n                  <CheckCircle className=\"h-8 w-8\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{selectedVendorForAction.name}</h3>\n                  <p className=\"text-sm text-gray-600\">Vendor ID: {selectedVendorForAction.id}</p>\n                  <p className=\"text-sm text-gray-600\">Region: {selectedVendorForAction.region}</p>\n                </div>\n              </div>\n            </div>\n            <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n              <p className=\"text-sm font-bold text-gray-900 mb-4\">Are you sure you want to approve this vendor?</p>\n              <p className=\"text-sm text-gray-600 mb-6\">\n                Once approved, the vendor will be able to access their dashboard and start receiving orders.\n              </p>\n              <div className=\"flex gap-3\">\n                <button\n                  type=\"button\"\n                  onClick={handleBackToList}\n                  className=\"flex-1 rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => handleApproveVendor(selectedVendorForAction.id)}\n                  disabled={loading}\n                  className=\"flex-1 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n                >\n                  {loading ? 'Approving...' : 'Approve Vendor'}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'rejectVendor' && selectedVendorForAction) {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Vendors\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Reject Vendor</h2>\n            <p className=\"text-sm text-gray-600\">\n              Reject vendor application for {selectedVendorForAction.name}.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-6\">\n            <div className=\"rounded-2xl border border-red-200 bg-red-50 p-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-br from-red-500 to-red-600 text-white shadow-lg\">\n                  <XCircle className=\"h-8 w-8\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{selectedVendorForAction.name}</h3>\n                  <p className=\"text-sm text-gray-600\">Vendor ID: {selectedVendorForAction.id}</p>\n                  <p className=\"text-sm text-gray-600\">Region: {selectedVendorForAction.region}</p>\n                </div>\n              </div>\n            </div>\n            <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n              <label className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Rejection Reason <span className=\"text-red-500\">*</span>\n              </label>\n              <textarea\n                value={rejectReason}\n                onChange={(e) => setRejectReason(e.target.value)}\n                placeholder=\"Enter reason for rejection (optional)\"\n                rows={4}\n                className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-500/50\"\n              />\n              <div className=\"mt-6 flex gap-3\">\n                <button\n                  type=\"button\"\n                  onClick={handleBackToList}\n                  className=\"flex-1 rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => handleRejectVendor(selectedVendorForAction.id, { reason: rejectReason || 'Application rejected by admin' })}\n                  disabled={loading}\n                  className=\"flex-1 rounded-xl bg-gradient-to-r from-red-500 to-red-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(239,68,68,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(239,68,68,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n                >\n                  {loading ? 'Rejecting...' : 'Reject Vendor'}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'banVendor' && selectedVendorForAction) {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Vendors\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Ban Vendor</h2>\n            <p className=\"text-sm text-gray-600\">\n              Ban vendor {selectedVendorForAction.name} temporarily or permanently.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-6\">\n            <div className=\"rounded-2xl border border-red-200 bg-red-50 p-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-br from-red-500 to-red-600 text-white shadow-lg\">\n                  <Ban className=\"h-8 w-8\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{selectedVendorForAction.name}</h3>\n                  <p className=\"text-sm text-gray-600\">Vendor ID: {selectedVendorForAction.id}</p>\n                  <p className=\"text-sm text-gray-600\">Region: {selectedVendorForAction.region}</p>\n                </div>\n              </div>\n            </div>\n            <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n              <label className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Ban Type <span className=\"text-red-500\">*</span>\n              </label>\n              <div className=\"mb-4 flex gap-3\">\n                <button\n                  type=\"button\"\n                  onClick={() => setBanType('temporary')}\n                  className={cn(\n                    'flex-1 rounded-xl border px-4 py-3 text-sm font-bold transition-all',\n                    banType === 'temporary'\n                      ? 'border-yellow-500 bg-gradient-to-br from-yellow-500 to-yellow-600 text-white shadow-[0_4px_15px_rgba(234,179,8,0.3),inset_0_1px_0_rgba(255,255,255,0.2)]'\n                      : 'border-gray-300 bg-white text-gray-700 hover:border-yellow-300 hover:bg-yellow-50',\n                  )}\n                >\n                  Temporary\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setBanType('permanent')}\n                  className={cn(\n                    'flex-1 rounded-xl border px-4 py-3 text-sm font-bold transition-all',\n                    banType === 'permanent'\n                      ? 'border-red-500 bg-gradient-to-br from-red-500 to-red-600 text-white shadow-[0_4px_15px_rgba(239,68,68,0.3),inset_0_1px_0_rgba(255,255,255,0.2)]'\n                      : 'border-gray-300 bg-white text-gray-700 hover:border-red-300 hover:bg-red-50',\n                  )}\n                >\n                  Permanent\n                </button>\n              </div>\n              <label className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Ban Reason <span className=\"text-red-500\">*</span>\n              </label>\n              <textarea\n                value={banReason}\n                onChange={(e) => setBanReason(e.target.value)}\n                placeholder=\"Enter reason for banning this vendor\"\n                rows={4}\n                className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-500/50\"\n              />\n              <div className=\"mt-6 flex gap-3\">\n                <button\n                  type=\"button\"\n                  onClick={handleBackToList}\n                  className=\"flex-1 rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => handleBanVendor(selectedVendorForAction.id, { banType, banReason: banReason || 'Banned by admin' })}\n                  disabled={loading || !banReason.trim()}\n                  className=\"flex-1 rounded-xl bg-gradient-to-r from-red-500 to-red-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(239,68,68,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(239,68,68,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n                >\n                  {loading ? 'Banning...' : `Ban Vendor (${banType})`}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentView === 'unbanVendor' && selectedVendorForAction) {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={handleBackToList}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Vendors\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Unban Vendor</h2>\n            <p className=\"text-sm text-gray-600\">\n              Revoke ban for vendor {selectedVendorForAction.name}.\n            </p>\n          </div>\n        </div>\n        <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"space-y-6\">\n            <div className=\"rounded-2xl border border-green-200 bg-green-50 p-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-br from-green-500 to-green-600 text-white shadow-lg\">\n                  <Unlock className=\"h-8 w-8\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-bold text-gray-900\">{selectedVendorForAction.name}</h3>\n                  <p className=\"text-sm text-gray-600\">Vendor ID: {selectedVendorForAction.id}</p>\n                  <p className=\"text-sm text-gray-600\">Region: {selectedVendorForAction.region}</p>\n                </div>\n              </div>\n            </div>\n            <div className=\"rounded-2xl border border-gray-200 bg-white p-6\">\n              <label className=\"mb-2 block text-sm font-bold text-gray-900\">\n                Revocation Reason <span className=\"text-xs font-normal text-gray-500\">(Optional)</span>\n              </label>\n              <textarea\n                value={revocationReason}\n                onChange={(e) => setRevocationReason(e.target.value)}\n                placeholder=\"Enter reason for revoking ban (optional)\"\n                rows={4}\n                className=\"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm transition-all focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/50\"\n              />\n              <div className=\"mt-6 flex gap-3\">\n                <button\n                  type=\"button\"\n                  onClick={handleBackToList}\n                  className=\"flex-1 rounded-xl border border-gray-300 bg-white px-6 py-3 text-sm font-bold text-gray-700 transition-all hover:bg-gray-50\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => handleUnbanVendor(selectedVendorForAction.id, { revocationReason: revocationReason || 'Ban revoked by admin' })}\n                  disabled={loading}\n                  className=\"flex-1 rounded-xl bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 text-sm font-bold text-white shadow-[0_4px_15px_rgba(34,197,94,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all hover:shadow-[0_6px_20px_rgba(34,197,94,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] disabled:opacity-50\"\n                >\n                  {loading ? 'Unbanning...' : 'Unban Vendor'}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // Show purchase requests list view when subRoute is 'purchase-requests' and no specific request is selected\n  if (subRoute === 'purchase-requests' && !selectedPurchaseRequest && !currentView) {\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            type=\"button\"\n            onClick={() => navigate('vendors')}\n            className=\"mb-4 inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-bold text-gray-700 shadow-[0_2px_8px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)] transition-all duration-200 hover:bg-gray-50 hover:shadow-[0_4px_12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Vendors\n          </button>\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n            <h2 className=\"text-2xl font-bold text-gray-900\">Purchase Requests</h2>\n            <p className=\"text-sm text-gray-600\">\n              Review and approve vendor purchase requests.\n            </p>\n          </div>\n        </div>\n        {loadingPurchaseRequests ? (\n          <div className=\"rounded-3xl border border-gray-200 bg-white p-12 text-center\">\n            <p className=\"text-sm text-gray-600\">Loading purchase requests...</p>\n          </div>\n        ) : purchaseRequests.length === 0 ? (\n          <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n            <div className=\"text-center py-12\">\n              <Package className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n              <p className=\"text-sm font-semibold text-gray-900\">No Purchase Requests</p>\n              <p className=\"text-xs text-gray-600 mt-1\">There are no pending purchase requests at the moment.</p>\n            </div>\n          </div>\n        ) : (\n          <div className=\"rounded-3xl border border-gray-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n            <div className=\"space-y-3\">\n              {purchaseRequests.map((request) => (\n                <div\n                  key={request.id}\n                  className=\"flex items-center justify-between rounded-xl border border-gray-200 bg-gray-50 p-4 transition-all hover:border-blue-300 hover:bg-blue-50/50 cursor-pointer\"\n                  onClick={() => {\n                    setSelectedPurchaseRequest(request)\n                    setCurrentView('purchaseRequest')\n                  }}\n                >\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-3\">\n                      <p className=\"font-bold text-gray-900\">{request.vendorName || 'Unknown Vendor'}</p>\n                      <StatusBadge tone=\"warning\">Pending</StatusBadge>\n                    </div>\n                    <p className=\"mt-1 text-xs text-gray-600\">\n                      Request ID: {request.requestId || request.id} â€¢ Amount: â‚¹{(request.amount || request.value || 0).toLocaleString('en-IN')}\n                    </p>\n                    <p className=\"mt-1 text-xs text-gray-500\">\n                      {request.date ? new Date(request.date).toLocaleDateString('en-IN') : 'N/A'}\n                    </p>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      setSelectedPurchaseRequest(request)\n                      setCurrentView('purchaseRequest')\n                    }}\n                    className=\"ml-4 flex h-9 w-9 items-center justify-center rounded-lg border border-blue-300 bg-white text-blue-600 transition-all hover:border-blue-500 hover:bg-blue-50\"\n                    title=\"Review request\"\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </button>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Main vendors list view\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-wide text-gray-500 font-semibold\">Step 3 â€¢ Vendor Management</p>\n          <h2 className=\"text-2xl font-bold text-gray-900\">Credit Performance Dashboard</h2>\n          <p className=\"text-sm text-gray-600\">\n            Control approvals, credit policies, and vendor risk in real time with proactive alerts.\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          {purchaseRequests.length > 0 && (\n            <button\n              onClick={() => {\n                if (navigate) {\n                  navigate('vendors/purchase-requests')\n                } else {\n                  setSelectedPurchaseRequest(purchaseRequests[0])\n                  setCurrentView('purchaseRequest')\n                }\n              }}\n              disabled={loadingPurchaseRequests}\n              className=\"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-2.5 text-sm font-bold text-white shadow-[0_4px_15px_rgba(59,130,246,0.3),inset_0_1px_0_rgba(255,255,255,0.2)] transition-all duration-200 hover:shadow-[0_6px_20px_rgba(59,130,246,0.4),inset_0_1px_0_rgba(255,255,255,0.2)] hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              <Package className=\"h-4 w-4\" />\n              {loadingPurchaseRequests ? 'Loading...' : `Purchase Requests (${purchaseRequests.length})`}\n            </button>\n          )}\n        </div>\n      </header>\n\n      {/* Search Bar */}\n      <div className=\"rounded-3xl border border-gray-200 bg-white p-4 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n        <div className=\"relative\">\n          <Search className=\"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400\" />\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Search vendors by name, phone, email, or ID...\"\n            className=\"w-full rounded-xl border border-gray-300 bg-white pl-12 pr-4 py-3 text-sm font-semibold transition-all focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/50\"\n          />\n          {searchQuery && (\n            <button\n              type=\"button\"\n              onClick={() => setSearchQuery('')}\n              className=\"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n            >\n              <XCircle className=\"h-5 w-5\" />\n            </button>\n          )}\n        </div>\n        {searchQuery && (\n          <p className=\"mt-2 text-xs text-gray-600\">\n            Found {vendorsList.length} vendor{vendorsList.length !== 1 ? 's' : ''} matching \"{searchQuery}\"\n          </p>\n        )}\n      </div>\n\n      <DataTable\n        columns={tableColumns}\n        rows={vendorsList}\n        emptyState={searchQuery ? `No vendors found matching \"${searchQuery}\"` : \"No vendor records found\"}\n      />\n\n      {coverageReport && (\n        <section className=\"space-y-5 rounded-3xl border border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100/30 p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"flex flex-wrap items-center justify-between gap-2\">\n            <div>\n              <h3 className=\"text-lg font-bold text-blue-900\">Coverage Compliance (20 km rule)</h3>\n              <p className=\"text-sm text-blue-700\">\n                Ensure exclusive vendor coverage per 20 km radius. Automated monitoring across all mapped vendors.\n              </p>\n            </div>\n            <StatusBadge tone={coverageReport.conflicts.length ? 'warning' : 'success'}>\n              {coverageReport.conflicts.length ? `${coverageReport.conflicts.length} conflict(s)` : 'All zones compliant'}\n            </StatusBadge>\n          </div>\n\n          <div className=\"grid gap-4 sm:grid-cols-3\">\n            <div className=\"rounded-2xl border border-blue-200 bg-white p-4\">\n              <p className=\"text-xs text-blue-500\">Vendors with Geo Coverage</p>\n              <p className=\"mt-1 text-2xl font-bold text-blue-900\">{coverageReport.total}</p>\n              <p className=\"text-[0.7rem] text-blue-700\">Mapped with latitude & longitude</p>\n            </div>\n            <div className=\"rounded-2xl border border-yellow-200 bg-yellow-50 p-4\">\n              <p className=\"text-xs text-yellow-600\">Conflict Zones</p>\n              <p className=\"mt-1 text-2xl font-bold text-yellow-800\">{coverageReport.flaggedVendors?.length || 0}</p>\n              <p className=\"text-[0.7rem] text-yellow-700\">Vendors requiring reassignment</p>\n            </div>\n            <div className=\"rounded-2xl border border-green-200 bg-green-50 p-4\">\n              <p className=\"text-xs text-green-600\">Compliant Zones</p>\n              <p className=\"mt-1 text-2xl font-bold text-green-800\">{coverageReport.compliantCount}</p>\n              <p className=\"text-[0.7rem] text-green-700\">Operating within exclusive radius</p>\n            </div>\n          </div>\n\n          {coverageReport.conflicts.length > 0 ? (\n            <div className=\"space-y-3\">\n              {coverageReport.conflicts.map((conflict) => (\n                <div\n                  key={conflict.id}\n                  className=\"flex flex-wrap items-center justify-between gap-3 rounded-2xl border border-red-200 bg-red-50 p-4\"\n                >\n                  <div>\n                    <p className=\"text-sm font-bold text-red-900\">\n                      {conflict.vendorA.name} â†” {conflict.vendorB.name}\n                    </p>\n                    <p className=\"text-xs text-red-700\">\n                      Distance: {conflict.distanceKm} km â€¢ Overlap risk: {conflict.overlapKm} km inside 20 km rule\n                    </p>\n                  </div>\n                  <div className=\"flex flex-wrap gap-2\">\n                    <button\n                      type=\"button\"\n                      onClick={() => handleViewVendorMap(conflict.vendorA)}\n                      className=\"rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-xs font-semibold text-gray-700 transition hover:border-blue-500 hover:text-blue-700\"\n                    >\n                      View {conflict.vendorA.name}\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => handleViewVendorMap(conflict.vendorB)}\n                      className=\"rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-xs font-semibold text-gray-700 transition hover:border-blue-500 hover:text-blue-700\"\n                    >\n                      View {conflict.vendorB.name}\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"rounded-2xl border border-green-200 bg-white p-4 text-xs text-green-700\">\n              All vendor coverage areas comply with the 20 km exclusivity policy.\n            </div>\n          )}\n        </section>\n      )}\n\n      <section className=\"grid gap-6 lg:grid-cols-2\">\n        <div className=\"space-y-4 rounded-3xl border border-green-200 bg-white p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <h3 className=\"text-lg font-bold text-green-700\">Credit Policy Playbook</h3>\n          <p className=\"text-sm text-gray-600\">\n            Configure region-wise credit strategies, repayment cycles, and penalty protocols.\n          </p>\n          <div className=\"space-y-4\">\n            {[\n              {\n                title: 'Credit Limit Review',\n                description:\n                  'Identify vendors nearing 80% credit utilization. Initiate auto alerts and escalate to finance for manual override.',\n                meta: 'Updated daily at 09:00',\n              },\n              {\n                title: 'Repayment Monitoring',\n                description:\n                  'Flag repayments that exceed threshold by >7 days. Auto-calculate penalties and generate repayment reminders.',\n                meta: 'SLA: 24h resolution',\n              },\n              {\n                title: 'Purchase Approval (â‰¥â‚¹50,000)',\n                description:\n                  'Streamline manual approvals with supporting documents. Auto populate vendor performance insights before approval.',\n                meta: `Pending approvals: ${purchaseRequests.length}`,\n              },\n            ].map((item) => (\n              <div key={item.title} className=\"rounded-2xl border border-gray-200 bg-white p-4 transition hover:-translate-y-1 hover:shadow-[0_6px_20px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n                <div className=\"flex items-center justify-between text-sm font-bold text-gray-900\">\n                  <span>{item.title}</span>\n                  <CreditCard className=\"h-4 w-4 text-green-600\" />\n                </div>\n                <p className=\"mt-2 text-xs text-gray-600\">{item.description}</p>\n                <p className=\"mt-3 text-xs font-bold text-green-700\">{item.meta}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n        <div className=\"space-y-4 rounded-3xl border border-red-200 bg-gradient-to-br from-red-50 to-red-100/50 p-6 shadow-[0_4px_15px_rgba(0,0,0,0.08),inset_0_1px_0_rgba(255,255,255,0.8)]\">\n          <div className=\"flex items-center gap-3\">\n            <ShieldAlert className=\"h-5 w-5 text-red-600\" />\n            <div>\n              <h3 className=\"text-lg font-bold text-gray-900\">High Risk Alerts</h3>\n              <p className=\"text-sm text-red-700\">\n                Automatic penalty application and collections follow-up. Review overdue repayments immediately.\n              </p>\n            </div>\n          </div>\n          <Timeline\n            events={[\n              {\n                id: 'risk-1',\n                title: 'HarvestLink Pvt Ltd',\n                timestamp: 'Due in 2 days',\n                description: 'â‚¹19.6 L pending. Escalated to finance with penalty rate 2%.',\n                status: 'pending',\n              },\n              {\n                id: 'risk-2',\n                title: 'GrowSure Traders',\n                timestamp: 'Settled today',\n                description: 'Repayment received. Credit reinstated with new limit â‚¹28 L.',\n                status: 'completed',\n              },\n              {\n                id: 'risk-3',\n                title: 'AgroSphere Logistics',\n                timestamp: 'Overdue by 5 days',\n                description: 'Penalty 1.5% applied. Legal notice scheduled.',\n                status: 'pending',\n              },\n            ]}\n          />\n        </div>\n      </section>\n\n\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\routes\\AdminDashboardRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\services\\adminApi.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'summary' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":166,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":166,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"summary"},"fix":{"range":[4150,4159],"text":""},"desc":"Remove unused variable 'summary'."}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":253,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":268,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":311,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":353,"endColumn":4},{"ruleId":"no-unused-vars","severity":2,"message":"'visibilityData' is defined but never used.","line":593,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":593,"endColumn":72,"suggestions":[{"messageId":"removeVar","data":{"varName":"visibilityData"},"fix":{"range":[19680,19696],"text":""},"desc":"Remove unused variable 'visibilityData'."}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":659,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":695,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":1219,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":1252,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":1344,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":1380,"endColumn":4},{"ruleId":"no-unused-vars","severity":2,"message":"'sellerId' is defined but never used.","line":1568,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":1568,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"sellerId"},"fix":{"range":[52754,52762],"text":""},"desc":"Remove unused variable 'sellerId'."}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":1687,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":1716,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":1843,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":1876,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":1887,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":1900,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":1970,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":1991,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":2009,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":2021,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":2063,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":2112,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":2266,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":2313,"endColumn":4},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":2510,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":2510,"endColumn":19},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":2552,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":2632,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":2691,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":2729,"endColumn":4},{"ruleId":"no-unused-vars","severity":2,"message":"'vendorId' is defined but never used.","line":2739,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":2739,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"vendorId"},"fix":{"range":[92681,92689],"text":""},"desc":"Remove unused variable 'vendorId'."}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":2759,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":2804,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":2815,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":2873,"endColumn":4},{"ruleId":"no-unused-vars","severity":2,"message":"'vendorId' is defined but never used.","line":2884,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":2884,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"vendorId"},"fix":{"range":[97656,97665],"text":""},"desc":"Remove unused variable 'vendorId'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'penaltyData' is defined but never used.","line":2884,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":2884,"endColumn":63,"suggestions":[{"messageId":"removeVar","data":{"varName":"penaltyData"},"fix":{"range":[97664,97677],"text":""},"desc":"Remove unused variable 'penaltyData'."}]},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":2961,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3004,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":3016,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3040,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":3052,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3074,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":3086,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3112,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":3255,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3308,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":3326,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3353,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":3364,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3379,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":3391,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3415,"endColumn":4},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":3438,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3542,"endColumn":4},{"ruleId":"no-unused-vars","severity":2,"message":"'topSeller' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3465,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":3465,"endColumn":22},{"ruleId":"no-useless-catch","severity":2,"message":"Unnecessary try/catch wrapper.","line":3560,"column":3,"nodeType":"TryStatement","messageId":"unnecessaryCatch","endLine":3601,"endColumn":4}],"suppressedMessages":[],"errorCount":34,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Admin API Service\n * \n * This file contains all API endpoints for the Admin dashboard.\n * All endpoints are backend-ready and will work once the backend is implemented.\n * \n * Base URL should be configured in environment variables:\n * - Development: http://localhost:3000/api\n * - Production: https://api.irasathi.com/api\n */\n\nconst API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000/api'\n\n/**\n * API Response Handler\n */\nasync function handleResponse(response) {\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({\n      success: false,\n      message: `HTTP error! status: ${response.status}`\n    }))\n    const errorObj = {\n      success: false,\n      error: {\n        message: error.message || error.error?.message || `HTTP error! status: ${response.status}`,\n        status: response.status,\n        ...error\n      }\n    }\n    return errorObj\n  }\n  return response.json()\n}\n\n/**\n * API Request Helper\n */\nasync function apiRequest(endpoint, options = {}) {\n  const token = localStorage.getItem('admin_token') // Admin authentication token\n\n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n      ...(token && { Authorization: `Bearer ${token}` }),\n      ...options.headers,\n    },\n    ...options,\n  }\n\n  try {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, config)\n    return handleResponse(response)\n  } catch (error) {\n    // If handleResponse throws, catch it and return error format\n    return {\n      success: false,\n      error: {\n        message: error.message || 'An error occurred',\n        status: 500,\n      }\n    }\n  }\n}\n\n// ============================================================================\n// AUTHENTICATION APIs\n// ============================================================================\n\n/**\n * Admin Login (Step 1: Phone only)\n * POST /admin/auth/login\n * \n * @param {Object} credentials - { phone }\n * @returns {Promise<Object>} - { requiresOtp: true, message: 'OTP sent to phone' }\n */\nexport async function loginAdmin(credentials) {\n  return apiRequest('/admin/auth/login', {\n    method: 'POST',\n    body: JSON.stringify(credentials),\n  })\n}\n\n/**\n * Request OTP for Admin\n * POST /admin/auth/request-otp\n * \n * @param {Object} data - { phone }\n * @returns {Promise<Object>} - { message: 'OTP sent successfully', expiresIn: 300 }\n */\nexport async function requestAdminOTP(data) {\n  return apiRequest('/admin/auth/request-otp', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Verify Admin OTP and Complete Login\n * POST /admin/auth/verify-otp\n * \n * @param {Object} data - { phone, otp }\n * @returns {Promise<Object>} - { token, admin: { id, name, phone, role } }\n */\nexport async function verifyAdminOTP(data) {\n  return apiRequest('/admin/auth/verify-otp', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Admin Logout\n * POST /admin/auth/logout\n * \n * @returns {Promise<Object>} - { message: 'Logged out successfully' }\n */\nexport async function logoutAdmin() {\n  return apiRequest('/admin/auth/logout', {\n    method: 'POST',\n  })\n}\n\n/**\n * Get Admin Profile\n * GET /admin/auth/profile\n * \n * @returns {Promise<Object>} - Admin profile data\n */\nexport async function getAdminProfile() {\n  return apiRequest('/admin/auth/profile')\n}\n\n// ============================================================================\n// DASHBOARD APIs\n// ============================================================================\n\n/**\n * Format number with commas\n */\nfunction formatNumber(num) {\n  return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\n}\n\n/**\n * Format currency (INR)\n */\nfunction formatCurrency(amount) {\n  if (amount >= 10000000) {\n    // Crores\n    return `â‚¹${(amount / 10000000).toFixed(1)} Cr`\n  } else if (amount >= 100000) {\n    // Lakhs\n    return `â‚¹${(amount / 100000).toFixed(1)} L`\n  } else if (amount >= 1000) {\n    // Thousands\n    return `â‚¹${(amount / 1000).toFixed(1)}K`\n  }\n  return `â‚¹${formatNumber(Math.round(amount))}`\n}\n\n/**\n * Transform backend dashboard data to frontend format\n */\nfunction transformDashboardData(backendData) {\n  const { overview, summary } = backendData\n\n  // Calculate trends (simplified - using placeholder for now since backend doesn't provide historical data)\n  const headline = [\n    {\n      id: 'users',\n      title: 'Total Users',\n      value: formatNumber(overview.users.total),\n      subtitle: `${formatNumber(overview.users.active)} active`,\n      trend: {\n        direction: 'up',\n        value: '+0',\n        message: 'No historical data available',\n      },\n    },\n    {\n      id: 'vendors',\n      title: 'Verified Vendors',\n      value: formatNumber(overview.vendors.approved),\n      subtitle: `${formatNumber(overview.vendors.pending)} pending approvals`,\n      trend: {\n        direction: overview.vendors.pending > 0 ? 'warning' : 'up',\n        value: overview.vendors.pending > 0 ? `${overview.vendors.pending} pending` : 'All approved',\n        message: 'vendor approval status',\n      },\n    },\n    {\n      id: 'orders',\n      title: 'Orders (User + Vendor)',\n      value: formatNumber(overview.orders.total),\n      subtitle: `${formatNumber(overview.orders.pending)} pending`,\n      trend: {\n        direction: overview.orders.pending > 0 ? 'warning' : 'success',\n        value: `${formatNumber(overview.orders.delivered)} delivered`,\n        message: 'order status overview',\n      },\n    },\n    {\n      id: 'revenue',\n      title: 'Gross Revenue',\n      value: formatCurrency(overview.revenue.total),\n      subtitle: `Avg order: ${formatCurrency(overview.revenue.averageOrderValue || 0)}`,\n      trend: {\n        direction: 'up',\n        value: formatCurrency(overview.revenue.last7Days || 0),\n        message: 'last 7 days revenue',\n      },\n    },\n  ]\n\n  // Calculate payables\n  // Note: Backend provides pendingPaymentAmount (which may include remaining 70% payments)\n  // For advance (30%), we estimate based on total revenue pattern\n  // TODO: Enhance backend to provide actual advance vs remaining breakdown from orders\n  const pendingPaymentsAmount = overview.payments.pendingAmount || 0\n  const totalRevenue = overview.revenue.total || 0\n\n  // Estimate: Assuming orders with partial payment, calculate 30% advance from revenue\n  // This is an approximation - backend should ideally aggregate from Order.upfrontAmount and Order.remainingAmount\n  const estimatedAdvanceAmount = Math.round(totalRevenue * 0.3) // Estimate: 30% of revenue as advance\n  const remainingPaymentAmount = pendingPaymentsAmount || 0 // Backend provides this as pending payments (70% remaining)\n  const outstandingCredits = overview.credits.outstanding || 0\n\n  const payables = {\n    advance: formatCurrency(estimatedAdvanceAmount),\n    pending: formatCurrency(remainingPaymentAmount),\n    outstanding: formatCurrency(outstandingCredits),\n  }\n\n  return {\n    headline,\n    payables,\n  }\n}\n\n/**\n * Get Dashboard Overview\n * GET /admin/dashboard\n * \n * @param {Object} params - { period: 'day' | 'week' | 'month', region?: string }\n * @returns {Promise<Object>} - {\n *   headline: Array<{ id, title, value, subtitle, trend }>,\n *   payables: { advance, pending, outstanding },\n *   recentActivity: Array\n * }\n */\nexport async function getDashboardData(params = {}) {\n  try {\n    const queryParams = new URLSearchParams(params).toString()\n    const response = await apiRequest(`/admin/dashboard?${queryParams}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: transformDashboardData(response.data),\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n// ============================================================================\n// PRODUCT MANAGEMENT APIs\n// ============================================================================\n\n/**\n * Transform backend product to frontend format\n */\nfunction transformProduct(backendProduct) {\n  return {\n    id: backendProduct._id?.toString() || backendProduct.id,\n    name: backendProduct.name,\n    description: backendProduct.description,\n    category: backendProduct.category,\n    stock: backendProduct.stock || 0,\n    actualStock: backendProduct.actualStock !== undefined ? backendProduct.actualStock : (backendProduct.stock || 0),\n    displayStock: backendProduct.displayStock !== undefined ? backendProduct.displayStock : (backendProduct.stock || 0),\n    stockUnit: backendProduct.weight?.unit || backendProduct.stockUnit || 'kg',\n    vendorPrice: backendProduct.priceToVendor || 0,\n    userPrice: backendProduct.priceToUser || 0,\n    expiry: backendProduct.expiry ? new Date(backendProduct.expiry).toISOString().split('T')[0] : null,\n    visibility: backendProduct.isActive !== false ? 'active' : 'inactive', // Default to active\n    batchNumber: backendProduct.batchNumber || '',\n    images: backendProduct.images || [],\n    sku: backendProduct.sku,\n    brand: backendProduct.brand,\n    tags: backendProduct.tags || [],\n    specifications: backendProduct.specifications,\n    // Keep all original fields for reference\n    ...backendProduct,\n  }\n}\n\n/**\n * Get All Products\n * GET /admin/products\n * \n * @param {Object} params - { page, limit, category, isActive, search, sortBy, sortOrder, region, status }\n * @returns {Promise<Object>} - { products: Array, total: number, pagination?: Object }\n */\nexport async function getProducts(params = {}) {\n  try {\n    // Convert frontend params to backend query params\n    const queryParams = new URLSearchParams()\n\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.category) queryParams.append('category', params.category)\n    if (params.status || params.isActive !== undefined) {\n      // Frontend uses 'status' (active/inactive), backend uses 'isActive' (true/false)\n      const isActive = params.isActive !== undefined\n        ? params.isActive\n        : (params.status === 'active' ? true : params.status === 'inactive' ? false : undefined)\n      if (isActive !== undefined) queryParams.append('isActive', isActive.toString())\n    }\n    if (params.search) queryParams.append('search', params.search)\n    if (params.sortBy) queryParams.append('sortBy', params.sortBy)\n    if (params.sortOrder) queryParams.append('sortOrder', params.sortOrder)\n    if (params.offset) {\n      // Convert offset to page\n      const page = Math.floor((params.offset / (params.limit || 20)) + 1)\n      queryParams.append('page', page.toString())\n    }\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/products${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      const transformedProducts = response.data.products.map(transformProduct)\n      return {\n        success: true,\n        data: {\n          products: transformedProducts,\n          total: response.data.pagination?.totalItems || response.data.products.length,\n          pagination: response.data.pagination, // Keep pagination object for future use\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Product Details\n * GET /admin/products/:productId\n * \n * @param {string} productId - Product ID\n * @returns {Promise<Object>} - { product: Object, assignments: Array }\n */\nexport async function getProductDetails(productId) {\n  const response = await apiRequest(`/admin/products/${productId}`)\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        product: transformProduct(response.data.product),\n        assignments: response.data.assignments || [],\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Transform frontend product data to backend format\n */\nfunction transformProductForBackend(frontendData) {\n  // Handle both naming conventions: vendorPrice/userPrice or priceToVendor/priceToUser\n  const vendorPrice = frontendData.priceToVendor ?? frontendData.vendorPrice\n  const userPrice = frontendData.priceToUser ?? frontendData.userPrice\n\n  // Parse prices - ensure they are valid numbers\n  const parsedVendorPrice = vendorPrice != null && vendorPrice !== '' ? parseFloat(vendorPrice) : null\n  const parsedUserPrice = userPrice != null && userPrice !== '' ? parseFloat(userPrice) : null\n\n  const backendData = {\n    name: frontendData.name,\n    description: frontendData.description || frontendData.longDescription || frontendData.name, // Use name as description if not provided\n    shortDescription: frontendData.shortDescription || frontendData.description?.substring(0, 150) || frontendData.name.substring(0, 150),\n    category: frontendData.category || 'fertilizer', // Default category\n    // Only set isActive if visibility is explicitly provided, otherwise default to true (active)\n    isActive: frontendData.visibility !== undefined\n      ? (frontendData.visibility === 'active' || frontendData.visibility === 'Active')\n      : true, // Default to active\n  }\n\n  // Handle stock fields - prioritize actualStock/displayStock over legacy stock\n  // Always include actualStock and displayStock if they exist (even if 0)\n  if (frontendData.actualStock !== undefined && frontendData.actualStock !== null) {\n    const actualStockValue = frontendData.actualStock === '' ? 0 : parseFloat(frontendData.actualStock)\n    if (!isNaN(actualStockValue)) {\n      backendData.actualStock = actualStockValue\n    }\n  }\n  if (frontendData.displayStock !== undefined && frontendData.displayStock !== null) {\n    const displayStockValue = frontendData.displayStock === '' ? 0 : parseFloat(frontendData.displayStock)\n    if (!isNaN(displayStockValue)) {\n      backendData.displayStock = displayStockValue\n      // Also set legacy stock field for backward compatibility\n      backendData.stock = displayStockValue\n    }\n  } else if (frontendData.stock !== undefined && frontendData.stock !== null) {\n    // Fallback to legacy stock field\n    const stockValue = frontendData.stock === '' ? 0 : parseFloat(frontendData.stock)\n    if (!isNaN(stockValue)) {\n      backendData.stock = stockValue\n      if (backendData.displayStock === undefined) {\n        backendData.displayStock = stockValue\n      }\n      if (backendData.actualStock === undefined) {\n        backendData.actualStock = stockValue\n      }\n    }\n  }\n\n  // Only add prices if they are valid positive numbers\n  if (parsedVendorPrice != null && !isNaN(parsedVendorPrice) && parsedVendorPrice > 0) {\n    backendData.priceToVendor = parsedVendorPrice\n  }\n  if (parsedUserPrice != null && !isNaN(parsedUserPrice) && parsedUserPrice > 0) {\n    backendData.priceToUser = parsedUserPrice\n  }\n\n  // Add weight if stockUnit provided\n  if (frontendData.stockUnit) {\n    backendData.stockUnit = frontendData.stockUnit\n    backendData.weight = {\n      value: backendData.actualStock || backendData.displayStock || 0,\n      unit: frontendData.stockUnit.toLowerCase(),\n    }\n  }\n\n  // Add expiry date if provided\n  if (frontendData.expiry) {\n    backendData.expiry = frontendData.expiry\n  }\n\n  // Add batchNumber if provided\n  if (frontendData.batchNumber !== undefined && frontendData.batchNumber !== null && frontendData.batchNumber !== '') {\n    backendData.batchNumber = frontendData.batchNumber.trim()\n  }\n\n  // Add expiry if provided\n  if (frontendData.expiry) {\n    backendData.expiry = frontendData.expiry\n  }\n\n  // Add other optional fields\n  if (frontendData.brand) backendData.brand = frontendData.brand\n  if (frontendData.sku) backendData.sku = frontendData.sku.toUpperCase()\n  // Always include tags array (even if empty) - tags are used for product searchability\n  if (frontendData.tags !== undefined) {\n    backendData.tags = Array.isArray(frontendData.tags) ? frontendData.tags : []\n  }\n  if (frontendData.specifications) backendData.specifications = frontendData.specifications\n  if (frontendData.images && Array.isArray(frontendData.images)) backendData.images = frontendData.images\n\n  // Add attributeStocks if provided\n  if (frontendData.attributeStocks && Array.isArray(frontendData.attributeStocks) && frontendData.attributeStocks.length > 0) {\n    backendData.attributeStocks = frontendData.attributeStocks\n  }\n\n  return backendData\n}\n\n/**\n * Create Product\n * POST /admin/products\n * \n * @param {Object} productData - {\n *   name: string,\n *   vendorPrice: number,\n *   userPrice: number,\n *   stock: number,\n *   stockUnit: string,\n *   expiry: string,\n *   visibility: 'active' | 'inactive'\n * }\n * @returns {Promise<Object>} - { product: Object, message: string }\n */\nexport async function createProduct(productData) {\n  const backendData = transformProductForBackend(productData)\n  const response = await apiRequest('/admin/products', {\n    method: 'POST',\n    body: JSON.stringify(backendData),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.product) {\n    return {\n      success: true,\n      data: {\n        product: transformProduct(response.data.product),\n        message: response.data.message || 'Product created successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Update Product\n * PUT /admin/products/:productId\n * \n * @param {string} productId - Product ID\n * @param {Object} productData - Product data to update\n * @returns {Promise<Object>} - { product: Object, message: string }\n */\nexport async function updateProduct(productId, productData) {\n  const backendData = transformProductForBackend(productData)\n  const response = await apiRequest(`/admin/products/${productId}`, {\n    method: 'PUT',\n    body: JSON.stringify(backendData),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.product) {\n    return {\n      success: true,\n      data: {\n        product: transformProduct(response.data.product),\n        message: response.data.message || 'Product updated successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Delete Product\n * DELETE /admin/products/:productId\n * \n * @param {string} productId - Product ID\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function deleteProduct(productId) {\n  return apiRequest(`/admin/products/${productId}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Assign Product to Vendor\n * POST /admin/products/:productId/assign\n * \n * @param {string} productId - Product ID\n * @param {Object} assignmentData - { vendorId: string, region: string, quantity?: number, notes?: string }\n * @returns {Promise<Object>} - { message: string, assignment: Object }\n */\nexport async function assignProductToVendor(productId, assignmentData) {\n  // Backend expects: vendorId, region, notes (quantity is not used yet in backend)\n  const backendData = {\n    vendorId: assignmentData.vendorId,\n    region: assignmentData.region,\n    notes: assignmentData.notes || assignmentData.quantity ? `Quantity: ${assignmentData.quantity}` : undefined,\n  }\n\n  return apiRequest(`/admin/products/${productId}/assign`, {\n    method: 'POST',\n    body: JSON.stringify(backendData),\n  })\n}\n\n/**\n * Toggle Product Visibility\n * PUT /admin/products/:productId/visibility\n * \n * Note: Backend automatically toggles isActive regardless of request body\n * Frontend sends visibility for reference, but backend will toggle current state\n * \n * @param {string} productId - Product ID\n * @param {Object} visibilityData - { visibility: 'active' | 'inactive' } (for reference, backend toggles)\n * @returns {Promise<Object>} - { product: Object, message: string }\n */\nexport async function toggleProductVisibility(productId, visibilityData) {\n  // Backend toggles isActive automatically, but we send empty body or visibility for consistency\n  const response = await apiRequest(`/admin/products/${productId}/visibility`, {\n    method: 'PUT',\n    body: JSON.stringify({}), // Backend doesn't use body, but sending empty object for consistency\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.product) {\n    return {\n      success: true,\n      data: {\n        product: transformProduct(response.data.product),\n        message: response.data.message || 'Product visibility updated successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n// ============================================================================\n// VENDOR MANAGEMENT APIs\n// ============================================================================\n\n/**\n * Transform backend vendor to frontend format\n */\nfunction transformVendor(backendVendor) {\n  return {\n    id: backendVendor._id?.toString() || backendVendor.id,\n    name: backendVendor.name,\n    phone: backendVendor.phone,\n    email: backendVendor.email,\n    region: backendVendor.location?.state || backendVendor.location?.city || 'Unknown',\n    location: {\n      lat: backendVendor.location?.coordinates?.lat,\n      lng: backendVendor.location?.coordinates?.lng,\n      address: backendVendor.location?.address,\n      city: backendVendor.location?.city,\n      state: backendVendor.location?.state,\n      pincode: backendVendor.location?.pincode,\n    },\n    coverageRadius: backendVendor.location?.coverageRadius || 20,\n    status: backendVendor.status || 'pending',\n    isActive: backendVendor.isActive || false,\n    creditLimit: backendVendor.creditPolicy?.limit || backendVendor.creditLimit || 0,\n    repaymentDays: backendVendor.creditPolicy?.repaymentDays || 30,\n    penaltyRate: backendVendor.creditPolicy?.penaltyRate || 0,\n    dues: backendVendor.creditUsed || 0, // Outstanding credit used\n    creditUsed: backendVendor.creditUsed || 0,\n    approvedAt: backendVendor.approvedAt,\n    approvedBy: backendVendor.approvedBy,\n    // Keep all original fields for reference\n    ...backendVendor,\n  }\n}\n\n/**\n * Get All Vendors\n * GET /admin/vendors\n * \n * @param {Object} params - { page, limit, status, isActive, search, sortBy, sortOrder, region, offset }\n * @returns {Promise<Object>} - { vendors: Array, total: number, pagination?: Object }\n */\nexport async function getVendors(params = {}) {\n  try {\n    // Convert frontend params to backend query params\n    const queryParams = new URLSearchParams()\n\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.status) queryParams.append('status', params.status)\n    if (params.isActive !== undefined) queryParams.append('isActive', params.isActive.toString())\n    if (params.search) queryParams.append('search', params.search)\n    if (params.sortBy) queryParams.append('sortBy', params.sortBy)\n    if (params.sortOrder) queryParams.append('sortOrder', params.sortOrder)\n    if (params.offset) {\n      // Convert offset to page\n      const page = Math.floor((params.offset / (params.limit || 20)) + 1)\n      queryParams.append('page', page.toString())\n    }\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/vendors${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      const transformedVendors = response.data.vendors.map(transformVendor)\n      return {\n        success: true,\n        data: {\n          vendors: transformedVendors,\n          total: response.data.pagination?.totalItems || response.data.vendors.length,\n          pagination: response.data.pagination, // Keep pagination object for future use\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Vendor Details\n * GET /admin/vendors/:vendorId\n * \n * @param {string} vendorId - Vendor ID\n * @returns {Promise<Object>} - { vendor: Object, creditInfo: Object, purchases: Array, assignments: Array }\n */\nexport async function getVendorDetails(vendorId) {\n  const response = await apiRequest(`/admin/vendors/${vendorId}`)\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        vendor: transformVendor(response.data.vendor),\n        creditInfo: response.data.creditInfo || {},\n        purchases: response.data.purchases || [],\n        assignments: response.data.assignments || [],\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Approve Vendor Application\n * POST /admin/vendors/:vendorId/approve\n * \n * Note: Backend automatically approves vendor and performs 20km radius check\n * If credit policy needs to be set, use updateVendorCreditPolicy after approval\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} approvalData - { creditLimit, repaymentDays, penaltyRate } (optional, can set via credit-policy endpoint)\n * @returns {Promise<Object>} - { vendor: Object, message: string }\n */\nexport async function approveVendor(vendorId, approvalData) {\n  const response = await apiRequest(`/admin/vendors/${vendorId}/approve`, {\n    method: 'POST',\n    body: JSON.stringify({}), // Backend doesn't use body for approval\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.vendor) {\n    // If credit policy data is provided, update it after approval\n    if (approvalData && (approvalData.creditLimit || approvalData.repaymentDays || approvalData.penaltyRate)) {\n      try {\n        await updateVendorCreditPolicy(vendorId, {\n          limit: approvalData.creditLimit,\n          repaymentDays: approvalData.repaymentDays,\n          penaltyRate: approvalData.penaltyRate,\n        })\n      } catch (error) {\n        console.warn('Failed to set credit policy after approval:', error)\n        // Continue with approval response even if credit policy update fails\n      }\n    }\n\n    return {\n      success: true,\n      data: {\n        vendor: transformVendor(response.data.vendor),\n        message: response.data.message || 'Vendor approved successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Reject Vendor Application\n * POST /admin/vendors/:vendorId/reject\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} rejectionData - { reason?: string }\n * @returns {Promise<Object>} - { vendor: Object, message: string }\n */\nexport async function rejectVendor(vendorId, rejectionData) {\n  const response = await apiRequest(`/admin/vendors/${vendorId}/reject`, {\n    method: 'POST',\n    body: JSON.stringify(rejectionData || {}),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.vendor) {\n    return {\n      success: true,\n      data: {\n        vendor: transformVendor(response.data.vendor),\n        message: response.data.message || 'Vendor application rejected',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Update Vendor Credit Policy\n * PUT /admin/vendors/:vendorId/credit-policy\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} policyData - { limit: number, repaymentDays: number, penaltyRate: number }\n * @returns {Promise<Object>} - { vendor: Object, message: string }\n */\nexport async function updateVendorCreditPolicy(vendorId, policyData) {\n  // Backend expects: limit, repaymentDays, penaltyRate\n  const backendData = {\n    limit: policyData.limit || policyData.creditLimit,\n    repaymentDays: policyData.repaymentDays,\n    penaltyRate: policyData.penaltyRate,\n  }\n\n  const response = await apiRequest(`/admin/vendors/${vendorId}/credit-policy`, {\n    method: 'PUT',\n    body: JSON.stringify(backendData),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.vendor) {\n    return {\n      success: true,\n      data: {\n        vendor: transformVendor(response.data.vendor),\n        message: response.data.message || 'Credit policy updated successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Update Vendor Basic Information\n * PUT /admin/vendors/:vendorId\n * \n * This endpoint updates vendor information in the database.\n * Backend should persist: name, phone, email, and location (address, city, state, pincode, coordinates).\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} vendorData - { name?: string, phone?: string, email?: string, location?: Object }\n * @param {Object} vendorData.location - { address: string, city: string, state: string, pincode: string, lat?: number, lng?: number }\n * @returns {Promise<Object>} - { vendor: Object, message: string }\n * @note This function sends a PUT request that updates the vendor record in the database\n */\nexport async function updateVendor(vendorId, vendorData) {\n  // Allow updating name, phone, email, and location\n  const backendData = {}\n  if (vendorData.name) backendData.name = vendorData.name\n  if (vendorData.phone) backendData.phone = vendorData.phone\n  if (vendorData.email) backendData.email = vendorData.email\n\n  // Handle location update\n  if (vendorData.location) {\n    backendData.location = {\n      address: vendorData.location.address,\n      city: vendorData.location.city,\n      state: vendorData.location.state,\n      pincode: vendorData.location.pincode,\n    }\n\n    // Add coordinates if provided\n    if (vendorData.location.lat && vendorData.location.lng) {\n      backendData.location.coordinates = {\n        lat: parseFloat(vendorData.location.lat),\n        lng: parseFloat(vendorData.location.lng),\n      }\n    }\n  }\n\n  const response = await apiRequest(`/admin/vendors/${vendorId}`, {\n    method: 'PUT',\n    body: JSON.stringify(backendData),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.vendor) {\n    return {\n      success: true,\n      data: {\n        vendor: transformVendor(response.data.vendor),\n        message: response.data.message || 'Vendor updated successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Ban Vendor (temporary or permanent)\n * PUT /admin/vendors/:vendorId/ban\n * \n * Note: Requires vendor to have >3 escalations\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} banData - { banType: 'temporary' | 'permanent', reason?: string, banDurationDays?: number }\n * @returns {Promise<Object>} - { vendor: Object, message: string, escalationCount: number }\n */\nexport async function banVendor(vendorId, banData) {\n  const response = await apiRequest(`/admin/vendors/${vendorId}/ban`, {\n    method: 'PUT',\n    body: JSON.stringify({\n      banType: banData.banType || 'temporary',\n      reason: banData.reason,\n      banDurationDays: banData.banDurationDays,\n    }),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        vendor: response.data.vendor ? transformVendor(response.data.vendor) : undefined,\n        escalationCount: response.data.escalationCount || 0,\n        message: response.data.message || 'Vendor banned successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Unban Vendor (revoke temporary ban)\n * PUT /admin/vendors/:vendorId/unban\n * \n * Note: Only works for temporary bans. Permanent bans require delete operation.\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} unbanData - { reason?: string }\n * @returns {Promise<Object>} - { vendor: Object, message: string }\n */\nexport async function unbanVendor(vendorId, unbanData = {}) {\n  const response = await apiRequest(`/admin/vendors/${vendorId}/unban`, {\n    method: 'PUT',\n    body: JSON.stringify({\n      reason: unbanData.reason,\n    }),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        vendor: response.data.vendor ? transformVendor(response.data.vendor) : undefined,\n        message: response.data.message || 'Temporary ban revoked successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Delete Vendor (permanent ban with soft delete)\n * DELETE /admin/vendors/:vendorId\n * \n * Note: Requires vendor to have >3 escalations. Soft delete - activities persist for viewing.\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} deleteData - { reason?: string }\n * @returns {Promise<Object>} - { vendor: Object, message: string, escalationCount: number }\n */\nexport async function deleteVendor(vendorId, deleteData = {}) {\n  const response = await apiRequest(`/admin/vendors/${vendorId}`, {\n    method: 'DELETE',\n    body: JSON.stringify({\n      reason: deleteData.reason,\n    }),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        vendor: response.data.vendor ? transformVendor(response.data.vendor) : undefined,\n        escalationCount: response.data.escalationCount || 0,\n        message: response.data.message || 'Vendor permanently deleted. Activities preserved for historical viewing.',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Transform backend purchase request to frontend format\n */\nfunction transformPurchaseRequest(backendPurchase) {\n  // Handle populated vendorId (object) or vendorId (string)\n  const vendorName = typeof backendPurchase.vendorId === 'object'\n    ? backendPurchase.vendorId?.name\n    : backendPurchase.vendor?.name || backendPurchase.vendorName || ''\n\n  const vendorId = typeof backendPurchase.vendorId === 'object'\n    ? backendPurchase.vendorId?._id?.toString() || backendPurchase.vendorId?.id\n    : backendPurchase.vendorId?.toString() || backendPurchase.vendorId\n\n  return {\n    id: backendPurchase._id?.toString() || backendPurchase.id,\n    requestId: backendPurchase._id?.toString() || backendPurchase.id,\n    vendorId: vendorId,\n    vendor: vendorName,\n    vendorName: vendorName,\n    amount: backendPurchase.totalAmount || 0,\n    value: backendPurchase.totalAmount || 0,\n    date: backendPurchase.createdAt ? new Date(backendPurchase.createdAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n    status: backendPurchase.status || 'pending',\n    description: backendPurchase.notes || '',\n    products: backendPurchase.items?.map(item => {\n      // Handle populated productId (object) or productId (string)\n      const productName = typeof item.productId === 'object'\n        ? item.productId?.name\n        : item.productName || 'Unknown Product'\n\n      // Handle attributeCombination (variants)\n      let attributeCombination = null\n      if (item.attributeCombination) {\n        // Convert Map to object if needed\n        if (item.attributeCombination instanceof Map) {\n          attributeCombination = Object.fromEntries(item.attributeCombination)\n        } else if (typeof item.attributeCombination === 'object') {\n          attributeCombination = item.attributeCombination\n        }\n      }\n\n      return {\n        name: productName,\n        quantity: item.quantity || 0,\n        price: item.unitPrice || item.pricePerUnit || 0,\n        unit: item.unit || 'kg',\n        attributeCombination: attributeCombination,\n      }\n    }) || [],\n    documents: [], // Backend doesn't store documents yet\n    vendorPerformance: {\n      creditUsed: typeof backendPurchase.vendorId === 'object' ? backendPurchase.vendorId?.creditUsed || 0 : 0,\n      creditLimit: typeof backendPurchase.vendorId === 'object' ? backendPurchase.vendorId?.creditLimit || 0 : 0,\n      creditUtilization: (typeof backendPurchase.vendorId === 'object' && backendPurchase.vendorId?.creditLimit > 0)\n        ? (backendPurchase.vendorId.creditUsed / backendPurchase.vendorId.creditLimit) * 100\n        : 0,\n      hasOutstandingDues: backendPurchase.hasOutstandingDues || false,\n      outstandingAmount: backendPurchase.outstandingDuesAmount || 0,\n    },\n    // Keep all original fields for reference\n    ...backendPurchase,\n  }\n}\n\n/**\n * Approve Vendor Purchase Request\n * POST /admin/vendors/purchases/:requestId/approve\n * \n * @param {string} requestId - Purchase request ID\n * @param {string} shortDescription - Short description for approval (optional)\n * @returns {Promise<Object>} - { message: string, purchase: Object, vendor: Object }\n */\nexport async function approveVendorPurchase(requestId, shortDescription = '') {\n  const trimmedDesc = shortDescription ? shortDescription.trim() : ''\n  if (!trimmedDesc) {\n    return {\n      success: false,\n      error: {\n        message: 'Short description is required',\n        status: 400,\n      }\n    }\n  }\n\n  const requestBody = { shortDescription: trimmedDesc }\n  const bodyString = JSON.stringify(requestBody)\n  console.log('Sending approve request:', {\n    requestId,\n    shortDescription: trimmedDesc,\n    body: requestBody,\n    stringified: bodyString,\n    bodyLength: bodyString.length\n  })\n\n  const response = await apiRequest(`/admin/vendors/purchases/${requestId}/approve`, {\n    method: 'POST',\n    body: bodyString,\n  })\n\n  console.log('Approve response received:', response)\n  console.log('Response success:', response.success)\n  console.log('Response error:', response.error)\n  console.log('Response message:', response.message)\n\n  // Check for error response\n  if (!response.success) {\n    return {\n      success: false,\n      error: {\n        message: response.error?.message || response.message || 'Failed to approve purchase request',\n        status: response.error?.status || 400,\n      }\n    }\n  }\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        purchase: transformPurchaseRequest(response.data.purchase),\n        vendor: response.data.vendor ? transformVendor(response.data.vendor) : undefined,\n        message: response.data.message || 'Purchase request approved successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Reject Vendor Purchase Request\n * POST /admin/vendors/purchases/:requestId/reject\n * \n * @param {string} requestId - Purchase request ID\n * @param {Object} rejectionData - { reason?: string }\n * @returns {Promise<Object>} - { message: string, purchase: Object }\n */\nexport async function rejectVendorPurchase(requestId, rejectionData) {\n  const response = await apiRequest(`/admin/vendors/purchases/${requestId}/reject`, {\n    method: 'POST',\n    body: JSON.stringify(rejectionData || {}),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        purchase: response.data.purchase ? transformPurchaseRequest(response.data.purchase) : undefined,\n        message: response.data.message || 'Purchase request rejected',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Send Stock for Vendor Purchase\n * POST /admin/vendors/purchases/:requestId/send\n * \n * @param {string} requestId - Purchase request ID\n * @param {Object} deliveryData - { deliveryNotes?: string }\n * @returns {Promise<Object>} - { message: string, purchase: Object }\n */\nexport async function sendVendorPurchaseStock(requestId, deliveryData) {\n  const response = await apiRequest(`/admin/vendors/purchases/${requestId}/send`, {\n    method: 'POST',\n    body: JSON.stringify(deliveryData || {}),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        purchase: response.data.purchase ? transformPurchaseRequest(response.data.purchase) : undefined,\n        message: response.data.message || 'Stock marked as sent',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Confirm Delivery for Vendor Purchase\n * POST /admin/vendors/purchases/:requestId/confirm-delivery\n * \n * @param {string} requestId - Purchase request ID\n * @param {Object} deliveryData - { deliveryNotes?: string }\n * @returns {Promise<Object>} - { message: string, purchase: Object }\n */\nexport async function confirmVendorPurchaseDelivery(requestId, deliveryData) {\n  const response = await apiRequest(`/admin/vendors/purchases/${requestId}/confirm-delivery`, {\n    method: 'POST',\n    body: JSON.stringify(deliveryData || {}),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        purchase: response.data.purchase ? transformPurchaseRequest(response.data.purchase) : undefined,\n        message: response.data.message || 'Delivery confirmed and inventory updated',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Get Vendor Purchase Requests\n * GET /admin/vendors/purchases (global) or GET /admin/vendors/:vendorId/purchases (vendor-specific)\n * \n * @param {Object} params - { \n *   status?: 'pending' | 'approved' | 'rejected', \n *   vendorId?: string, \n *   page?: number, \n *   limit?: number,\n *   search?: string,\n *   sortBy?: string,\n *   sortOrder?: 'asc' | 'desc'\n * }\n * @returns {Promise<Object>} - { purchases: Array, total: number, pagination?: Object }\n */\nexport async function getVendorPurchaseRequests(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n\n    if (params.status) queryParams.append('status', params.status)\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.search) queryParams.append('search', params.search)\n    if (params.sortBy) queryParams.append('sortBy', params.sortBy)\n    if (params.sortOrder) queryParams.append('sortOrder', params.sortOrder)\n    if (params.vendorId) queryParams.append('vendorId', params.vendorId)\n\n    const queryString = queryParams.toString()\n\n    // Use global endpoint (supports vendorId as query param for filtering)\n    // Backend endpoint: GET /admin/vendors/purchases\n    const endpoint = `/admin/vendors/purchases${queryString ? `?${queryString}` : ''}`\n    const response = await apiRequest(endpoint)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          purchases: response.data.purchases.map(transformPurchaseRequest),\n          total: response.data.pagination?.totalItems || response.data.purchases.length,\n          pagination: response.data.pagination,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n// ============================================================================\n// SELLER MANAGEMENT APIs\n// ============================================================================\n\n/**\n * Transform backend seller to frontend format\n */\nfunction transformSeller(backendSeller) {\n  // Calculate progress (this would ideally come from backend based on actual sales)\n  const monthlyTarget = backendSeller.monthlyTarget || 0\n  // Note: Backend doesn't currently provide achieved/progress - would need to calculate from orders\n  // For now, we'll use wallet balance as a proxy or calculate from commissions\n  const achieved = 0 // TODO: Calculate from actual sales/commissions\n  const progress = monthlyTarget > 0 ? (achieved / monthlyTarget) * 100 : 0\n\n  return {\n    id: backendSeller._id?.toString() || backendSeller.id,\n    sellerId: backendSeller.sellerId || backendSeller.id,\n    name: backendSeller.name,\n    phone: backendSeller.phone,\n    email: backendSeller.email,\n    area: backendSeller.area,\n    monthlyTarget: monthlyTarget,\n    achieved: achieved,\n    progress: Math.round(progress * 100) / 100,\n    referrals: 0, // TODO: Count from User.sellerId references\n    totalSales: achieved, // Same as achieved for now\n    status: backendSeller.status || 'pending',\n    isActive: backendSeller.isActive || false,\n    cashbackRate: 0, // Backend doesn't have this - might need commissionRates.low as proxy\n    commissionRate: backendSeller.commissionRates?.low || 2, // Default 2%\n    walletBalance: backendSeller.wallet?.balance || 0,\n    walletPending: backendSeller.wallet?.pending || 0,\n    // Keep all original fields for reference\n    ...backendSeller,\n  }\n}\n\n/**\n * Transform backend withdrawal request to frontend format\n */\nfunction transformWithdrawalRequest(backendWithdrawal) {\n  // Extract bank details from bankAccountId if populated, otherwise use paymentDetails\n  const bankDetails = backendWithdrawal.bankAccountId\n    ? {\n      accountHolderName: backendWithdrawal.bankAccountId.accountHolderName || '',\n      accountNumber: backendWithdrawal.bankAccountId.accountNumber || '',\n      ifscCode: backendWithdrawal.bankAccountId.ifscCode || '',\n      bankName: backendWithdrawal.bankAccountId.bankName || '',\n    }\n    : backendWithdrawal.paymentDetails || {}\n\n  // Extract seller name from populated sellerId or direct field\n  const sellerName = backendWithdrawal.sellerId?.name ||\n    backendWithdrawal.sellerId?.sellerId ||\n    backendWithdrawal.seller?.name ||\n    backendWithdrawal.sellerName ||\n    ''\n\n  return {\n    id: backendWithdrawal._id?.toString() || backendWithdrawal.id,\n    requestId: backendWithdrawal._id?.toString() || backendWithdrawal.id,\n    sellerId: backendWithdrawal.sellerId?._id?.toString() || backendWithdrawal.sellerId?.toString() || backendWithdrawal.sellerId,\n    seller: sellerName,\n    sellerName: sellerName,\n    amount: backendWithdrawal.amount || 0,\n    date: backendWithdrawal.createdAt ? new Date(backendWithdrawal.createdAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n    createdAt: backendWithdrawal.createdAt,\n    status: backendWithdrawal.status || 'pending',\n    reason: backendWithdrawal.reason || backendWithdrawal.rejectionReason || '',\n    bankDetails: bankDetails,\n    sellerPerformance: {\n      totalSales: 0, // TODO: Calculate from commissions\n      pendingEarnings: backendWithdrawal.sellerId?.wallet?.balance || 0,\n      targetAchievement: 0, // TODO: Calculate\n    },\n    // Keep all original fields for reference\n    ...backendWithdrawal,\n  }\n}\n\n/**\n * Get All Sellers\n * GET /admin/sellers\n * \n * @param {Object} params - { page, limit, status, isActive, search, sortBy, sortOrder, offset }\n * @returns {Promise<Object>} - { sellers: Array, total: number, pagination?: Object }\n */\nexport async function getSellers(params = {}) {\n  try {\n    // Convert frontend params to backend query params\n    const queryParams = new URLSearchParams()\n\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.status) queryParams.append('status', params.status)\n    if (params.isActive !== undefined) queryParams.append('isActive', params.isActive.toString())\n    if (params.search) queryParams.append('search', params.search)\n    if (params.sortBy) queryParams.append('sortBy', params.sortBy)\n    if (params.sortOrder) queryParams.append('sortOrder', params.sortOrder)\n    if (params.offset) {\n      // Convert offset to page\n      const page = Math.floor((params.offset / (params.limit || 20)) + 1)\n      queryParams.append('page', page.toString())\n    }\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/sellers${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      const transformedSellers = response.data.sellers.map(transformSeller)\n      return {\n        success: true,\n        data: {\n          sellers: transformedSellers,\n          total: response.data.pagination?.totalItems || response.data.sellers.length,\n          pagination: response.data.pagination, // Keep pagination object for future use\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Seller Details\n * GET /admin/sellers/:sellerId\n * \n * @param {string} sellerId - Seller ID\n * @returns {Promise<Object>} - { seller: Object, wallet: Object, withdrawals: Array }\n */\nexport async function getSellerDetails(sellerId) {\n  const response = await apiRequest(`/admin/sellers/${sellerId}`)\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        seller: transformSeller(response.data.seller),\n        wallet: response.data.wallet || {},\n        withdrawals: response.data.withdrawals || [],\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Transform frontend seller data to backend format\n */\nfunction transformSellerForBackend(frontendData) {\n  const backendData = {\n    name: frontendData.name,\n    phone: frontendData.phone,\n    email: frontendData.email,\n  }\n\n  // Optional fields - only include if provided\n  if (frontendData.area !== undefined) backendData.area = frontendData.area\n  if (frontendData.monthlyTarget !== undefined) {\n    backendData.monthlyTarget = parseFloat(frontendData.monthlyTarget) || 0\n  }\n  if (frontendData.location) backendData.location = frontendData.location\n  if (frontendData.assignedVendor) backendData.assignedVendor = frontendData.assignedVendor\n  if (frontendData.sellerId) backendData.sellerId = frontendData.sellerId.toUpperCase()\n\n  // Note: Backend doesn't support cashbackRate/commissionRate directly\n  // These are managed via commissionRates (low/high/threshold) in Seller model\n  // Frontend might send these but they won't be set unless we add them to backend\n\n  return backendData\n}\n\n/**\n * Create Seller\n * POST /admin/sellers\n * \n * @param {Object} sellerData - {\n *   name: string,\n *   phone: string,\n *   email?: string,\n *   area?: string,\n *   monthlyTarget?: number,\n *   sellerId?: string,\n *   location?: Object,\n *   assignedVendor?: string\n * }\n * @returns {Promise<Object>} - { seller: Object, message: string }\n */\nexport async function createSeller(sellerData) {\n  const backendData = transformSellerForBackend(sellerData)\n  const response = await apiRequest('/admin/sellers', {\n    method: 'POST',\n    body: JSON.stringify(backendData),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.seller) {\n    return {\n      success: true,\n      data: {\n        seller: transformSeller(response.data.seller),\n        message: response.data.message || 'Seller created successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Update Seller\n * PUT /admin/sellers/:sellerId\n * \n * This endpoint updates seller information in the database.\n * Backend should persist: name, phone, email, and other seller fields.\n * \n * @param {string} sellerId - Seller ID\n * @param {Object} sellerData - Seller data to update (name, phone, email, etc.)\n * @returns {Promise<Object>} - { seller: Object, message: string }\n * @note This function sends a PUT request that updates the seller record in the database\n */\nexport async function updateSeller(sellerId, sellerData) {\n  const backendData = transformSellerForBackend(sellerData)\n  const response = await apiRequest(`/admin/sellers/${sellerId}`, {\n    method: 'PUT',\n    body: JSON.stringify(backendData),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.seller) {\n    return {\n      success: true,\n      data: {\n        seller: transformSeller(response.data.seller),\n        message: response.data.message || 'Seller updated successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Approve Seller Registration\n * POST /admin/sellers/:sellerId/approve\n * \n * @param {string} sellerId - Seller ID\n * @returns {Promise<Object>} - { seller: Object, message: string }\n */\nexport async function approveSeller(sellerId) {\n  const response = await apiRequest(`/admin/sellers/${sellerId}/approve`, {\n    method: 'POST',\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.seller) {\n    return {\n      success: true,\n      data: {\n        seller: transformSeller(response.data.seller),\n        message: response.data.message || 'Seller approved successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Reject Seller Registration\n * POST /admin/sellers/:sellerId/reject\n * \n * @param {string} sellerId - Seller ID\n * @param {Object} rejectionData - { reason?: string }\n * @returns {Promise<Object>} - { seller: Object, message: string }\n */\nexport async function rejectSeller(sellerId, rejectionData = {}) {\n  const response = await apiRequest(`/admin/sellers/${sellerId}/reject`, {\n    method: 'POST',\n    body: JSON.stringify(rejectionData),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data?.seller) {\n    return {\n      success: true,\n      data: {\n        seller: transformSeller(response.data.seller),\n        message: response.data.message || 'Seller rejected successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Delete Seller\n * DELETE /admin/sellers/:sellerId\n * \n * Note: Backend doesn't have a delete endpoint currently\n * This would need to be implemented or we can deactivate the seller instead\n * \n * @param {string} sellerId - Seller ID\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function deleteSeller(sellerId) {\n  // For now, deactivate instead of delete (if backend supports it)\n  // Or return an error if deletion is not supported\n  return {\n    success: false,\n    message: 'Delete seller endpoint not yet implemented. Please deactivate the seller instead.',\n  }\n}\n\n/**\n * Create Payment Intent for Seller Withdrawal\n * POST /admin/sellers/withdrawals/:requestId/payment-intent\n * \n * @param {string} requestId - Withdrawal request ID\n * @param {Object} data - { amount?: number }\n * @returns {Promise<Object>} - { paymentIntent: Object }\n */\nexport async function createSellerWithdrawalPaymentIntent(requestId, data = {}) {\n  const response = await apiRequest(`/admin/sellers/withdrawals/${requestId}/payment-intent`, {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n\n  return response\n}\n\n/**\n * Approve Seller Withdrawal\n * POST /admin/sellers/withdrawals/:requestId/approve\n * \n * @param {string} requestId - Withdrawal request ID\n * @param {Object} data - { paymentReference?, paymentMethod?, paymentDate?, adminRemarks?, gatewayPaymentId?, gatewayOrderId?, gatewaySignature? }\n * @returns {Promise<Object>} - { message: string, withdrawal: Object, seller: Object }\n */\nexport async function approveSellerWithdrawal(requestId, data = {}) {\n  const response = await apiRequest(`/admin/sellers/withdrawals/${requestId}/approve`, {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        withdrawal: response.data.withdrawal ? transformWithdrawalRequest(response.data.withdrawal) : undefined,\n        seller: response.data.seller ? transformSeller(response.data.seller) : undefined,\n        message: response.data.message || 'Withdrawal approved successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Reject Seller Withdrawal\n * POST /admin/sellers/withdrawals/:requestId/reject\n * \n * @param {string} requestId - Withdrawal request ID\n * @param {Object} rejectionData - { reason?: string }\n * @returns {Promise<Object>} - { message: string, withdrawal: Object }\n */\nexport async function rejectSellerWithdrawal(requestId, rejectionData) {\n  const response = await apiRequest(`/admin/sellers/withdrawals/${requestId}/reject`, {\n    method: 'POST',\n    body: JSON.stringify(rejectionData || {}),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        withdrawal: response.data.withdrawal ? transformWithdrawalRequest(response.data.withdrawal) : undefined,\n        message: response.data.message || 'Withdrawal request rejected',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Transform backend vendor withdrawal request to frontend format\n */\nfunction transformVendorWithdrawalRequest(backendWithdrawal) {\n  return {\n    id: backendWithdrawal._id?.toString() || backendWithdrawal.id,\n    requestId: backendWithdrawal._id?.toString() || backendWithdrawal.id,\n    vendorId: backendWithdrawal.vendorId?.toString() || backendWithdrawal.vendorId,\n    vendor: backendWithdrawal.vendorId?.name || backendWithdrawal.vendor?.name || backendWithdrawal.vendorName || '',\n    vendorName: backendWithdrawal.vendorId?.name || backendWithdrawal.vendor?.name || backendWithdrawal.vendorName || '',\n    amount: backendWithdrawal.amount || 0,\n    date: backendWithdrawal.createdAt ? new Date(backendWithdrawal.createdAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n    status: backendWithdrawal.status || 'pending',\n    reason: backendWithdrawal.rejectionReason || backendWithdrawal.reason || '',\n    bankDetails: backendWithdrawal.paymentDetails || backendWithdrawal.bankAccountId || {},\n    userType: 'vendor',\n    ...backendWithdrawal,\n  }\n}\n\n/**\n * Get Vendor Withdrawal Requests\n * GET /admin/vendors/withdrawals\n * \n * @param {Object} params - { \n *   status?: 'pending' | 'approved' | 'rejected' | 'completed', \n *   vendorId?: string, \n *   page?: number, \n *   limit?: number,\n *   search?: string,\n *   sortBy?: string,\n *   sortOrder?: 'asc' | 'desc'\n * }\n * @returns {Promise<Object>} - { withdrawals: Array, total: number, pagination?: Object }\n */\nexport async function getVendorWithdrawalRequests(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n\n    if (params.status) queryParams.append('status', params.status)\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.search) queryParams.append('search', params.search)\n    if (params.sortBy) queryParams.append('sortBy', params.sortBy)\n    if (params.sortOrder) queryParams.append('sortOrder', params.sortOrder)\n    if (params.vendorId) queryParams.append('vendorId', params.vendorId)\n\n    const queryString = queryParams.toString()\n    const endpoint = `/admin/vendors/withdrawals${queryString ? `?${queryString}` : ''}`\n    const response = await apiRequest(endpoint)\n\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          withdrawals: response.data.withdrawals?.map(transformVendorWithdrawalRequest) || [],\n          total: response.data.pagination?.totalItems || response.data.withdrawals?.length || 0,\n          pagination: response.data.pagination,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Approve Vendor Withdrawal\n * POST /admin/vendors/withdrawals/:requestId/approve\n * \n * @param {string} requestId - Withdrawal request ID\n * @param {Object} data - Optional approval data (notes, etc.)\n * @returns {Promise<Object>} - { message: string, withdrawal: Object, vendor: Object }\n */\nexport async function approveVendorWithdrawal(requestId, data = {}) {\n  const response = await apiRequest(`/admin/vendors/withdrawals/${requestId}/approve`, {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        withdrawal: response.data.withdrawal ? transformVendorWithdrawalRequest(response.data.withdrawal) : undefined,\n        vendor: response.data.vendor,\n        message: response.data.message || 'Withdrawal approved successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Create Payment Intent for Vendor Withdrawal\n * POST /admin/vendors/withdrawals/:requestId/payment-intent\n * \n * @param {string} requestId - Withdrawal request ID\n * @param {Object} data - { amount: number }\n * @returns {Promise<Object>} - { paymentIntent: Object }\n */\nexport async function createVendorWithdrawalPaymentIntent(requestId, data = {}) {\n  const response = await apiRequest(`/admin/vendors/withdrawals/${requestId}/payment-intent`, {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        paymentIntent: response.data.paymentIntent,\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Reject Vendor Withdrawal\n * POST /admin/vendors/withdrawals/:requestId/reject\n * \n * @param {string} requestId - Withdrawal request ID\n * @param {Object} rejectionData - { reason: string, notes?: string }\n * @returns {Promise<Object>} - { message: string, withdrawal: Object }\n */\nexport async function rejectVendorWithdrawal(requestId, rejectionData) {\n  const response = await apiRequest(`/admin/vendors/withdrawals/${requestId}/reject`, {\n    method: 'POST',\n    body: JSON.stringify(rejectionData),\n  })\n\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        withdrawal: response.data.withdrawal ? transformVendorWithdrawalRequest(response.data.withdrawal) : undefined,\n        message: response.data.message || 'Withdrawal request rejected',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Complete Vendor Withdrawal\n * PUT /admin/vendors/withdrawals/:requestId/complete\n * \n * @param {string} requestId - Withdrawal request ID\n * @param {Object} completionData - { paymentReference: string, paymentDate: Date, notes?: string }\n * @returns {Promise<Object>} - { message: string, withdrawal: Object }\n */\nexport async function completeVendorWithdrawal(requestId, completionData) {\n  const response = await apiRequest(`/admin/vendors/withdrawals/${requestId}/complete`, {\n    method: 'PUT',\n    body: JSON.stringify(completionData),\n  })\n\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        withdrawal: response.data.withdrawal ? transformVendorWithdrawalRequest(response.data.withdrawal) : undefined,\n        message: response.data.message || 'Withdrawal marked as completed',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Get Seller Withdrawal Requests\n * GET /admin/sellers/withdrawals (global) or GET /admin/sellers/:sellerId/withdrawals (seller-specific)\n * \n * @param {Object} params - { \n *   status?: 'pending' | 'approved' | 'rejected', \n *   sellerId?: string, \n *   page?: number, \n *   limit?: number,\n *   search?: string,\n *   sortBy?: string,\n *   sortOrder?: 'asc' | 'desc'\n * }\n * @returns {Promise<Object>} - { withdrawals: Array, total: number, pagination?: Object }\n */\nexport async function getSellerWithdrawalRequests(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n\n    if (params.status) queryParams.append('status', params.status)\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.search) queryParams.append('search', params.search)\n    if (params.sortBy) queryParams.append('sortBy', params.sortBy)\n    if (params.sortOrder) queryParams.append('sortOrder', params.sortOrder)\n    if (params.sellerId) queryParams.append('sellerId', params.sellerId)\n\n    const queryString = queryParams.toString()\n\n    // Use global endpoint (supports sellerId as query param for filtering)\n    // Backend endpoint: GET /admin/sellers/withdrawals\n    const endpoint = `/admin/sellers/withdrawals${queryString ? `?${queryString}` : ''}`\n    const response = await apiRequest(endpoint)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          withdrawals: response.data.withdrawals.map(transformWithdrawalRequest),\n          total: response.data.pagination?.totalItems || response.data.withdrawals.length,\n          pagination: response.data.pagination,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Seller Change Requests\n * GET /admin/sellers/change-requests\n * \n * @param {Object} params - { status, changeType, page, limit }\n * @returns {Promise<Object>} - { changeRequests: Array, pagination: Object }\n */\nexport async function getSellerChangeRequests(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n    if (params.status) queryParams.append('status', params.status)\n    if (params.changeType) queryParams.append('changeType', params.changeType)\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/sellers/change-requests${queryString ? `?${queryString}` : ''}`)\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Seller Change Request Details\n * GET /admin/sellers/change-requests/:requestId\n * \n * @param {string} requestId - Change request ID\n * @returns {Promise<Object>} - { changeRequest: Object }\n */\nexport async function getSellerChangeRequestDetails(requestId) {\n  return apiRequest(`/admin/sellers/change-requests/${requestId}`)\n}\n\n/**\n * Approve Seller Change Request\n * POST /admin/sellers/change-requests/:requestId/approve\n * \n * @param {string} requestId - Change request ID\n * @returns {Promise<Object>} - { changeRequest: Object, seller: Object, message: string }\n */\nexport async function approveSellerChangeRequest(requestId) {\n  const response = await apiRequest(`/admin/sellers/change-requests/${requestId}/approve`, {\n    method: 'POST',\n  })\n\n  return response\n}\n\n/**\n * Reject Seller Change Request\n * POST /admin/sellers/change-requests/:requestId/reject\n * \n * @param {string} requestId - Change request ID\n * @param {Object} rejectionData - { reason?: string }\n * @returns {Promise<Object>} - { changeRequest: Object, message: string }\n */\nexport async function rejectSellerChangeRequest(requestId, rejectionData = {}) {\n  const response = await apiRequest(`/admin/sellers/change-requests/${requestId}/reject`, {\n    method: 'POST',\n    body: JSON.stringify(rejectionData || {}),\n  })\n\n  return response\n}\n\n// ============================================================================\n// PAYMENT HISTORY APIs\n// ============================================================================\n\n/**\n * Get Payment History\n * GET /admin/payment-history\n * \n * @param {Object} params - {\n *   activityType?: string,\n *   userId?: string,\n *   vendorId?: string,\n *   sellerId?: string,\n *   orderId?: string,\n *   startDate?: string,\n *   endDate?: string,\n *   status?: string,\n *   page?: number,\n *   limit?: number,\n *   search?: string\n * }\n * @returns {Promise<Object>} - { history: Array, pagination: Object, summary: Array }\n */\nexport async function getPaymentHistory(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n\n    if (params.activityType) queryParams.append('activityType', params.activityType)\n    if (params.userId) queryParams.append('userId', params.userId)\n    if (params.vendorId) queryParams.append('vendorId', params.vendorId)\n    if (params.sellerId) queryParams.append('sellerId', params.sellerId)\n    if (params.orderId) queryParams.append('orderId', params.orderId)\n    if (params.startDate) queryParams.append('startDate', params.startDate)\n    if (params.endDate) queryParams.append('endDate', params.endDate)\n    if (params.status) queryParams.append('status', params.status)\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.search) queryParams.append('search', params.search)\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/payment-history${queryString ? `?${queryString}` : ''}`)\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Payment History Statistics\n * GET /admin/payment-history/stats\n * \n * @param {Object} params - { startDate?: string, endDate?: string }\n * @returns {Promise<Object>} - {\n *   totalUserPayments: number,\n *   totalVendorEarnings: number,\n *   totalSellerCommissions: number,\n *   totalVendorWithdrawals: number,\n *   totalSellerWithdrawals: number,\n *   totalActivities: number\n * }\n */\nexport async function getPaymentHistoryStats(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n\n    if (params.startDate) queryParams.append('startDate', params.startDate)\n    if (params.endDate) queryParams.append('endDate', params.endDate)\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/payment-history/stats${queryString ? `?${queryString}` : ''}`)\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n// ============================================================================\n// USER MANAGEMENT APIs\n// ============================================================================\n\n/**\n * Transform backend user to frontend format\n */\nfunction transformUser(backendUser) {\n  const isBlocked = backendUser.isBlocked || false\n  const isActive = backendUser.isActive && !isBlocked\n\n  return {\n    id: backendUser._id?.toString() || backendUser.id,\n    name: backendUser.name,\n    phone: backendUser.phone,\n    email: backendUser.email,\n    region: backendUser.location?.city || backendUser.location?.state || 'Unknown',\n    sellerId: backendUser.seller?.sellerId || backendUser.sellerId || '',\n    orders: 0, // TODO: Count from orders when available\n    payments: 'on_time', // TODO: Calculate from payment history\n    supportTickets: 0, // TODO: Count from support tickets\n    status: isBlocked ? 'blocked' : (isActive ? 'active' : 'inactive'),\n    isBlocked,\n    isActive,\n    location: backendUser.location || {},\n    assignedVendor: backendUser.assignedVendor || null,\n    // Keep all original fields for reference\n    ...backendUser,\n  }\n}\n\n/**\n * Get All Users\n * GET /admin/users\n * \n * @param {Object} params - { page, limit, isActive, isBlocked, sellerId, search, sortBy, sortOrder, offset }\n * @returns {Promise<Object>} - { users: Array, total: number, pagination?: Object }\n */\nexport async function getUsers(params = {}) {\n  try {\n    // Convert frontend params to backend query params\n    const queryParams = new URLSearchParams()\n\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.isActive !== undefined) queryParams.append('isActive', params.isActive.toString())\n    if (params.isBlocked !== undefined) queryParams.append('isBlocked', params.isBlocked.toString())\n    if (params.sellerId) queryParams.append('sellerId', params.sellerId)\n    if (params.search) queryParams.append('search', params.search)\n    if (params.sortBy) queryParams.append('sortBy', params.sortBy)\n    if (params.sortOrder) queryParams.append('sortOrder', params.sortOrder)\n    if (params.offset) {\n      // Convert offset to page\n      const page = Math.floor((params.offset / (params.limit || 20)) + 1)\n      queryParams.append('page', page.toString())\n    }\n\n    // Map frontend status to backend params\n    if (params.status) {\n      if (params.status === 'blocked') {\n        queryParams.append('isBlocked', 'true')\n      } else if (params.status === 'active') {\n        queryParams.append('isActive', 'true')\n        queryParams.append('isBlocked', 'false')\n      } else if (params.status === 'inactive') {\n        queryParams.append('isActive', 'false')\n      }\n    }\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/users${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      const transformedUsers = response.data.users.map(transformUser)\n      return {\n        success: true,\n        data: {\n          users: transformedUsers,\n          total: response.data.pagination?.totalItems || response.data.users.length,\n          pagination: response.data.pagination,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get User Details\n * GET /admin/users/:userId\n * \n * @param {string} userId - User ID\n * @returns {Promise<Object>} - { user: Object, stats: Object }\n */\nexport async function getUserDetails(userId) {\n  const response = await apiRequest(`/admin/users/${userId}`)\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    const user = transformUser(response.data.user)\n    return {\n      success: true,\n      data: {\n        ...user,\n        stats: response.data.stats || {},\n        // TODO: Add ordersHistory, paymentHistory, supportTickets when backend provides them\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Block User\n * PUT /admin/users/:userId/block\n * \n * @param {string} userId - User ID\n * @param {Object} blockData - { reason?: string, block?: boolean } (block: true to block, false to unblock)\n * @returns {Promise<Object>} - { user: Object, message: string }\n */\nexport async function blockUser(userId, blockData = {}) {\n  const response = await apiRequest(`/admin/users/${userId}/block`, {\n    method: 'PUT',\n    body: JSON.stringify({\n      block: blockData.block !== undefined ? blockData.block : true,\n      reason: blockData.reason,\n    }),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        user: response.data.user ? transformUser(response.data.user) : undefined,\n        message: response.data.message || 'User blocked successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Deactivate User\n * PUT /admin/users/:userId/block (with block: true)\n * \n * @param {string} userId - User ID\n * @param {Object} deactivateData - { reason?: string }\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function deactivateUser(userId, deactivateData = {}) {\n  // Use blockUser with block: true (which also deactivates)\n  return blockUser(userId, {\n    block: true,\n    reason: deactivateData.reason || 'User deactivated by admin',\n  })\n}\n\n/**\n * Activate User (Unblock)\n * PUT /admin/users/:userId/block (with block: false)\n * \n * @param {string} userId - User ID\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function activateUser(userId) {\n  // Use blockUser with block: false (unblocks and activates)\n  return blockUser(userId, {\n    block: false,\n    reason: 'User activated by admin',\n  })\n}\n\n// ============================================================================\n// ORDER MANAGEMENT APIs\n// ============================================================================\n\n/**\n * Transform backend order to frontend format\n */\nfunction transformOrder(backendOrder) {\n  const isEscalated = backendOrder.assignedTo === 'admin'\n  const region = backendOrder.vendorId?.location?.state ||\n    backendOrder.vendorId?.location?.city ||\n    backendOrder.userId?.location?.state ||\n    'Unknown'\n\n  // User location details\n  const userLocation = backendOrder.userId?.location || {}\n  const userLocationDisplay = userLocation.city && userLocation.state\n    ? `${userLocation.city}, ${userLocation.state}`\n    : userLocation.city || userLocation.state || 'Not provided'\n\n  // Vendor location details\n  const vendorLocation = backendOrder.vendorId?.location || {}\n  const vendorLocationDisplay = vendorLocation.city && vendorLocation.state\n    ? `${vendorLocation.city}, ${vendorLocation.state}`\n    : vendorLocation.city || vendorLocation.state || 'N/A'\n\n  return {\n    id: backendOrder._id?.toString() || backendOrder.id,\n    orderNumber: backendOrder.orderNumber || backendOrder.id,\n    type: backendOrder.assignedTo || 'vendor',\n    vendorId: backendOrder.vendorId?._id?.toString() || backendOrder.vendorId?.toString() || null,\n    vendor: backendOrder.vendorId?.name || 'Admin',\n    vendorLocation: vendorLocationDisplay,\n    vendorPhone: backendOrder.vendorId?.phone || 'N/A',\n    region,\n    value: backendOrder.totalAmount || 0,\n    advance: backendOrder.upfrontAmount || 0,\n    advanceStatus: backendOrder.paymentStatus === 'fully_paid' ? 'paid' :\n      backendOrder.paymentStatus === 'partial_paid' ? 'partial' : 'pending',\n    pending: backendOrder.remainingAmount || (backendOrder.totalAmount - (backendOrder.upfrontAmount || 0)),\n    status: backendOrder.status || 'pending',\n    paymentStatus: backendOrder.paymentStatus || 'pending',\n    userId: backendOrder.userId?._id?.toString() || backendOrder.userId?.toString(),\n    userName: backendOrder.userId?.name || 'Unknown',\n    userPhone: backendOrder.userId?.phone || 'N/A',\n    userLocation: userLocationDisplay,\n    userLocationDetails: userLocation,\n    assignedTo: backendOrder.assignedTo || 'vendor',\n    escalated: isEscalated,\n    createdAt: backendOrder.createdAt,\n    // Keep all original fields for reference\n    ...backendOrder,\n  }\n}\n\n/**\n * Get All Orders\n * GET /admin/orders\n * \n * @param {Object} params - { page, limit, status, paymentStatus, vendorId, userId, assignedTo, dateFrom, dateTo, search, sortBy, sortOrder, offset }\n * @returns {Promise<Object>} - { orders: Array, total: number, pagination?: Object }\n */\nexport async function getOrders(params = {}) {\n  try {\n    // Convert frontend params to backend query params\n    const queryParams = new URLSearchParams()\n\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.status) queryParams.append('status', params.status)\n    if (params.paymentStatus) queryParams.append('paymentStatus', params.paymentStatus)\n    if (params.vendorId) queryParams.append('vendorId', params.vendorId)\n    if (params.userId) queryParams.append('userId', params.userId)\n    if (params.assignedTo) queryParams.append('assignedTo', params.assignedTo)\n    if (params.dateFrom) queryParams.append('dateFrom', params.dateFrom)\n    if (params.dateTo) queryParams.append('dateTo', params.dateTo)\n    if (params.search) queryParams.append('search', params.search)\n    if (params.sortBy) queryParams.append('sortBy', params.sortBy)\n    if (params.sortOrder) queryParams.append('sortOrder', params.sortOrder)\n    if (params.offset) {\n      // Convert offset to page\n      const page = Math.floor((params.offset / (params.limit || 20)) + 1)\n      queryParams.append('page', page.toString())\n    }\n\n    // Map frontend type to backend assignedTo\n    if (params.type) {\n      if (params.type === 'vendor') queryParams.append('assignedTo', 'vendor')\n      else if (params.type === 'admin') queryParams.append('assignedTo', 'admin')\n    }\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/orders${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      const transformedOrders = response.data.orders.map(transformOrder)\n      return {\n        success: true,\n        data: {\n          orders: transformedOrders,\n          total: response.data.pagination?.totalItems || response.data.orders.length,\n          pagination: response.data.pagination,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Order Details\n * GET /admin/orders/:orderId\n * \n * @param {string} orderId - Order ID\n * @returns {Promise<Object>} - { order: Object, payments: Array, paymentSummary: Object }\n */\nexport async function getOrderDetails(orderId) {\n  const response = await apiRequest(`/admin/orders/${orderId}`)\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    const order = response.data.order\n    const isEscalated = order.assignedTo === 'admin'\n    const region = order.vendorId?.location?.state ||\n      order.vendorId?.location?.city ||\n      order.userId?.location?.state ||\n      'Unknown'\n\n    return {\n      success: true,\n      data: {\n        id: order._id?.toString() || order.id,\n        orderNumber: order.orderNumber,\n        type: order.assignedTo === 'admin' ? 'Admin' : 'Vendor',\n        vendorId: order.vendorId?._id?.toString() || order.vendorId?.toString() || null,\n        vendor: order.vendorId?.name || 'Admin',\n        region,\n        date: order.createdAt ? new Date(order.createdAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n        value: order.totalAmount || 0,\n        advance: order.upfrontAmount || 0,\n        advanceStatus: order.paymentStatus === 'fully_paid' ? 'paid' :\n          order.paymentStatus === 'partial_paid' ? 'partial' : 'pending',\n        pending: response.data.paymentSummary?.remaining || order.remainingAmount || 0,\n        status: order.status || 'pending',\n        items: order.items?.map(item => ({\n          id: item._id?.toString() || item.id,\n          name: item.productId?.name || item.productName,\n          quantity: item.quantity,\n          unit: 'bags', // TODO: Get from product weight unit\n          price: item.unitPrice * item.quantity,\n        })) || [],\n        paymentHistory: response.data.payments?.map(payment => ({\n          id: payment._id?.toString() || payment.id,\n          paymentId: payment.paymentId,\n          type: payment.paymentType === 'advance' ? 'Advance Payment' :\n            payment.paymentType === 'remaining' ? 'Remaining Payment' : 'Full Payment',\n          amount: payment.amount,\n          date: payment.createdAt ? new Date(payment.createdAt).toISOString().split('T')[0] : null,\n          status: payment.status === 'fully_paid' ? 'completed' : payment.status,\n        })) || [],\n        paymentSummary: response.data.paymentSummary || {},\n        escalated: isEscalated,\n        escalationReason: isEscalated ? (order.notes || 'Order escalated to admin') : null,\n        userId: order.userId?._id?.toString() || order.userId?.toString(),\n        userName: order.userId?.name,\n        // Keep all original fields for reference\n        ...order,\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Reassign Order\n * PUT /admin/orders/:orderId/reassign\n * \n * @param {string} orderId - Order ID\n * @param {Object} reassignData - { vendorId: string, reason?: string }\n * @returns {Promise<Object>} - { message: string, order: Object, oldVendorId: string, newVendor: Object }\n */\nexport async function reassignOrder(orderId, reassignData) {\n  const response = await apiRequest(`/admin/orders/${orderId}/reassign`, {\n    method: 'PUT',\n    body: JSON.stringify({\n      vendorId: reassignData.vendorId,\n      reason: reassignData.reason,\n    }),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        order: response.data.order ? transformOrder(response.data.order) : undefined,\n        oldVendorId: response.data.oldVendorId,\n        newVendor: response.data.newVendor,\n        message: response.data.message || 'Order reassigned successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Generate Invoice\n * POST /admin/orders/:orderId/invoice\n * \n * @param {string} orderId - Order ID\n * @returns {Promise<Object>} - { invoiceUrl: string, invoiceId: string }\n */\n/**\n * Generate Invoice for Order\n * GET /admin/orders/:orderId/invoice\n * \n * @param {string} orderId - Order ID\n * @returns {Promise<Object>} - Downloads invoice as HTML (can be printed to PDF)\n */\nexport async function generateInvoice(orderId) {\n  try {\n    // Use the same token key as other API calls\n    const token = localStorage.getItem('admin_token')\n    if (!token) {\n      return {\n        success: false,\n        error: { message: 'Authentication required. Please log in again.' },\n      }\n    }\n\n    // Use the same API base URL as other API calls\n    const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000/api'\n    const response = await fetch(`${API_BASE_URL}/admin/orders/${orderId}/invoice`, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Bearer ${token}`,\n      },\n    })\n\n    if (!response.ok) {\n      // Try to parse as JSON first (for API errors), otherwise use status text\n      let errorData\n      const contentType = response.headers.get('content-type')\n      if (contentType && contentType.includes('application/json')) {\n        errorData = await response.json().catch(() => null)\n      }\n\n      if (!errorData) {\n        // If not JSON, create error object from status\n        if (response.status === 401) {\n          errorData = { message: 'Authentication required. Please log in again.' }\n        } else if (response.status === 404) {\n          errorData = { message: 'Order not found.' }\n        } else {\n          errorData = { message: `Failed to generate invoice: ${response.statusText || 'Unknown error'}` }\n        }\n      }\n\n      return {\n        success: false,\n        error: errorData,\n      }\n    }\n\n    // Get the HTML content\n    const htmlContent = await response.text()\n\n    // Create a blob from the HTML content\n    const blob = new Blob([htmlContent], { type: 'text/html' })\n    const url = window.URL.createObjectURL(blob)\n\n    // Open in new tab for viewing and printing to PDF\n    const printWindow = window.open('', '_blank')\n    if (!printWindow) {\n      // If pop-up blocked, trigger download instead\n      const link = document.createElement('a')\n      link.href = url\n      link.download = `invoice-${orderId}.html`\n      document.body.appendChild(link)\n      link.click()\n      document.body.removeChild(link)\n\n      return {\n        success: true,\n        data: {\n          invoiceUrl: url,\n          invoiceId: `INV-${orderId}`,\n          message: 'Invoice downloaded! Please open it and use Print (Ctrl+P) to save as PDF.',\n        },\n      }\n    }\n\n    // Write HTML content to new window\n    printWindow.document.write(htmlContent)\n    printWindow.document.close()\n\n    // Wait for content to load, then trigger print dialog (with slight delay to ensure content is rendered)\n    setTimeout(() => {\n      try {\n        printWindow.focus()\n        printWindow.print()\n      } catch (err) {\n        // Print dialog blocked or failed - user can still print manually\n        console.log('Print dialog could not be opened automatically. Please use Ctrl+P to print.')\n      }\n    }, 500)\n\n    return {\n      success: true,\n      data: {\n        invoiceUrl: url,\n        invoiceId: `INV-${orderId}`,\n        message: 'Invoice opened in new tab. Use browser print (Ctrl+P) to save as PDF.',\n      },\n    }\n  } catch (error) {\n    return {\n      success: false,\n      error: {\n        message: error.message || 'Failed to generate invoice',\n      },\n    }\n  }\n}\n\n// ============================================================================\n// FINANCE & CREDIT MANAGEMENT APIs\n// ============================================================================\n\n/**\n * Get Finance Overview\n * GET /admin/finance/parameters + /admin/finance/credits + /admin/finance/recovery\n * \n * Composite function that combines multiple finance endpoints\n * \n * @returns {Promise<Object>} - {\n *   creditPolicies: Array,\n *   outstandingCredits: Array,\n *   totalOutstanding: number,\n *   recoveryStatus: Object\n * }\n */\nexport async function getFinanceData() {\n  try {\n    // Fetch all finance data in parallel\n    const [paramsResponse, creditsResponse, recoveryResponse] = await Promise.all([\n      getFinancialParameters(),\n      apiRequest('/admin/finance/credits'),\n      getRecoveryStatus(),\n    ])\n\n    // Combine responses\n    const params = paramsResponse.success ? paramsResponse.data : {}\n    const credits = creditsResponse.success ? creditsResponse.data : {}\n    const recovery = recoveryResponse.success ? recoveryResponse.data : {}\n\n    // Build credit policies from parameters\n    const creditPolicies = [\n      {\n        id: 'advance',\n        label: 'Advance %',\n        value: `${params.userAdvancePaymentPercent || 30}%`,\n        meta: 'Default advance for all vendors',\n      },\n      {\n        id: 'user-min',\n        label: 'Minimum User Order',\n        value: `â‚¹${(params.minimumUserOrder || 2000).toLocaleString('en-IN')}`,\n        meta: 'Effective since Apr 2024',\n      },\n      {\n        id: 'vendor-min',\n        label: 'Minimum Vendor Purchase',\n        value: `â‚¹${((params.minimumVendorPurchase || 50000) / 1000).toFixed(0)}K`,\n        meta: 'Applies to all vendor types',\n      },\n    ]\n\n    // Build outstanding credits from credits summary\n    const summary = credits.summary || {}\n    const totalOutstanding = summary.totalOutstanding || 0\n    const totalLimit = summary.totalLimit || 0\n    const overdueCount = summary.overdueCount || 0\n    const dueSoonCount = summary.dueSoonCount || 0\n\n    const outstandingCredits = [\n      {\n        label: 'Total Outstanding',\n        progress: totalLimit > 0 ? Math.round((totalOutstanding / totalLimit) * 100) : 0,\n        tone: 'warning',\n        meta: `â‚¹${(totalOutstanding / 10000000).toFixed(2)} Cr in recovery process`,\n      },\n      {\n        label: 'Current Cycle Recovery',\n        progress: recovery.recovery?.recoveryRate || 54,\n        tone: 'success',\n        meta: `â‚¹${((recovery.recovery?.recoveredAmount || 0) / 100000).toFixed(0)} L collected`,\n      },\n      {\n        label: 'Delayed Accounts',\n        progress: overdueCount > 0 ? Math.round((overdueCount / (credits.totalVendors || 1)) * 100) : 0,\n        meta: `${overdueCount + dueSoonCount} vendors flagged for follow-up`,\n      },\n    ]\n\n    // Build recovery status\n    const recoveryStatus = recovery.recovery || {\n      total: totalOutstanding,\n      collected: recovery.recovery?.recoveredAmount || 0,\n      pending: recovery.recovery?.pendingAmount || totalOutstanding,\n    }\n\n    return {\n      success: true,\n      data: {\n        creditPolicies,\n        outstandingCredits,\n        totalOutstanding,\n        recoveryStatus,\n      },\n    }\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Financial Parameters\n * GET /admin/finance/parameters\n * \n * @returns {Promise<Object>} - { userAdvancePaymentPercent, minimumUserOrder, minimumVendorPurchase }\n */\nexport async function getFinancialParameters() {\n  const response = await apiRequest('/admin/finance/parameters')\n\n  // Backend returns: { userAdvancePaymentPercent, minimumUserOrder, minimumVendorPurchase }\n  return response\n}\n\n/**\n * Update Financial Parameters\n * PUT /admin/finance/parameters\n * \n * Note: Backend currently returns 501 (read-only). Parameters are stored in constants.js\n * This endpoint can be used to update a Settings collection in the future\n * \n * @param {Object} parameters - {\n *   userAdvancePaymentPercent: number,\n *   minimumUserOrder: number,\n *   minimumVendorPurchase: number\n * }\n * @returns {Promise<Object>} - { parameters: Object, message: string }\n */\nexport async function updateFinancialParameters(parameters) {\n  const response = await apiRequest('/admin/finance/parameters', {\n    method: 'PUT',\n    body: JSON.stringify(parameters),\n  })\n\n  // Backend may return 501 with message about read-only status\n  return response\n}\n\n/**\n * Get Vendor Credit Balances\n * GET /admin/finance/credits (all vendors) or GET /admin/finance/vendors/:vendorId/history (specific vendor)\n * \n * @param {Object} params - { vendorId?, page?, limit? }\n * @returns {Promise<Object>} - { credits: Array, creditData?: Object }\n */\nexport async function getVendorCreditBalances(params = {}) {\n  if (params.vendorId) {\n    // Get detailed credit history for a specific vendor\n    return getVendorCreditHistory(params.vendorId, {\n      page: params.page,\n      limit: params.limit,\n      startDate: params.startDate,\n      endDate: params.endDate,\n    })\n  }\n\n  // Get all vendor credits\n  try {\n    const queryParams = new URLSearchParams()\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.status) queryParams.append('status', params.status)\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/finance/credits${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      const credits = response.data.credits?.map(credit => ({\n        id: credit.vendorId?.toString() || credit.vendorId,\n        vendorId: credit.vendorId?.toString() || credit.vendorId,\n        name: credit.vendorName || '',\n        creditLimit: credit.creditLimit || 0,\n        usedCredit: credit.creditUsed || 0,\n        overdue: credit.isOverdue ? credit.creditUsed : 0,\n        penalty: credit.penalty || 0,\n        status: credit.status === 'overdue' ? 'warning' :\n          credit.status === 'dueSoon' ? 'warning' : 'success',\n        // Keep all original fields for reference\n        ...credit,\n      })) || []\n\n      return {\n        success: true,\n        data: {\n          credits,\n          summary: response.data.summary || {},\n          pagination: response.data.pagination,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Apply Penalty\n * POST /admin/finance/vendors/:vendorId/penalty\n * \n * @param {string} vendorId - Vendor ID\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function applyPenalty(vendorId) {\n  // Simulate API call\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve({\n        success: true,\n        data: { message: 'Penalty applied successfully' },\n      })\n    }, 1000)\n  })\n}\n\n/**\n * Get Outstanding Credits\n * GET /admin/finance/credits (uses same endpoint as getVendorCreditBalances, but transforms to outstanding credits format)\n * \n * @returns {Promise<Object>} - { credits: Array }\n */\nexport async function getOutstandingCredits() {\n  // Use getCredits endpoint and transform to outstanding credits format\n  try {\n    const response = await apiRequest('/admin/finance/credits')\n\n    // Transform backend response to frontend format\n    if (response.success && response.data?.summary) {\n      const summary = response.data.summary\n      const totalOutstanding = summary.totalOutstanding || 0\n      const totalLimit = summary.totalLimit || 0\n      const overdueCount = summary.overdueCount || 0\n      const dueSoonCount = summary.dueSoonCount || 0\n\n      // Calculate progress percentages (mock calculation for now)\n      const totalOutstandingProgress = totalLimit > 0 ? (totalOutstanding / totalLimit) * 100 : 0\n      const recoveryProgress = 54 // TODO: Calculate from actual recovery data\n      const delayedProgress = totalLimit > 0 ? ((overdueCount * 1000000) / totalLimit) * 100 : 0 // Rough estimate\n\n      return {\n        success: true,\n        data: {\n          credits: [\n            {\n              label: 'Total Outstanding',\n              progress: Math.round(totalOutstandingProgress),\n              tone: 'warning',\n              meta: `â‚¹${(totalOutstanding / 10000000).toFixed(2)} Cr in recovery process`,\n            },\n            {\n              label: 'Current Cycle Recovery',\n              progress: Math.round(recoveryProgress),\n              tone: 'success',\n              meta: 'Recovery in progress',\n            },\n            {\n              label: 'Delayed Accounts',\n              progress: Math.round(delayedProgress),\n              meta: `${overdueCount + dueSoonCount} vendors flagged for follow-up`,\n            },\n          ],\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Recovery Status\n * GET /admin/finance/recovery\n * \n * @param {Object} params - { period?: number } (days, default 30)\n * @returns {Promise<Object>} - { recovery: Object, statistics: Object }\n */\nexport async function getRecoveryStatus(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n    if (params.period) queryParams.append('period', params.period.toString())\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/finance/recovery${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      const recovery = response.data.recovery || {}\n      const stats = response.data.statistics || {}\n\n      // Calculate progress from recovery data\n      const total = recovery.totalOutstanding || 0\n      const collected = recovery.recoveredAmount || 0\n      const progress = total > 0 ? (collected / total) * 100 : 0\n\n      return {\n        success: true,\n        data: {\n          recoveries: [\n            {\n              id: 'REC-001',\n              title: 'Total Outstanding Recovery',\n              description: `â‚¹${((recovery.totalOutstanding || 0) / 10000000).toFixed(2)} Cr in recovery process`,\n              amount: recovery.totalOutstanding || 0,\n              progress: Math.round(progress),\n              status: recovery.pendingAmount > 0 ? 'in_progress' : 'completed',\n              vendorCount: stats.totalVendorsWithCredit || 0,\n            },\n            {\n              id: 'REC-002',\n              title: 'Current Cycle Recovery',\n              description: `â‚¹${((recovery.recoveredAmount || 0) / 100000).toFixed(0)} L collected`,\n              amount: recovery.recoveredAmount || 0,\n              progress: Math.round(progress),\n              status: 'in_progress',\n              vendorCount: stats.completedPurchases || 0,\n            },\n            {\n              id: 'REC-003',\n              title: 'Delayed Accounts',\n              description: `${stats.overdueVendors || 0} vendors flagged for follow-up`,\n              amount: recovery.overdueAmount || 0,\n              progress: total > 0 ? Math.round(((recovery.overdueAmount || 0) / total) * 100) : 0,\n              status: 'overdue',\n              vendorCount: stats.overdueVendors || 0,\n            },\n          ],\n          recovery,\n          statistics: stats,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Apply Penalty to Vendor\n * POST /admin/finance/vendors/:vendorId/penalty\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} penaltyData - { amount: number, reason: string }\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function applyVendorPenalty(vendorId, penaltyData) {\n  // Simulate API call\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve({\n        success: true,\n        data: { message: 'Penalty applied successfully' },\n      })\n    }, 1000)\n  })\n}\n\n// ============================================================================\n// OPERATIONAL CONTROLS APIs\n// ============================================================================\n\n/**\n * Get Logistics Settings\n * GET /admin/operations/logistics-settings\n * \n * @returns {Promise<Object>} - { defaultDeliveryTime, availableDeliveryOptions, ... }\n */\n/**\n * Get Logistics Settings\n * GET /admin/operations/logistics-settings\n * \n * @returns {Promise<Object>} - { settings: Object }\n */\nexport async function getLogisticsSettings() {\n  const response = await apiRequest('/admin/operations/logistics-settings')\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: response.data,\n    }\n  }\n\n  return response\n}\n\n/**\n * Update Logistics Settings\n * PUT /admin/operations/logistics-settings\n * \n * @param {Object} settings - Logistics settings object\n * @returns {Promise<Object>} - { settings: Object, message: string }\n */\nexport async function updateLogisticsSettings(settings) {\n  const response = await apiRequest('/admin/operations/logistics-settings', {\n    method: 'PUT',\n    body: JSON.stringify(settings),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        ...response.data,\n        message: response.message || 'Logistics settings updated successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Get Escalated Orders\n * GET /admin/orders/escalated\n * \n * @param {Object} params - { page?, limit?, status?, dateFrom?, dateTo?, search?, sortBy?, sortOrder? }\n * @returns {Promise<Object>} - { orders: Array, pagination?: Object }\n */\nexport async function getEscalatedOrders(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.status) queryParams.append('status', params.status)\n    if (params.dateFrom) queryParams.append('dateFrom', params.dateFrom)\n    if (params.dateTo) queryParams.append('dateTo', params.dateTo)\n    if (params.search) queryParams.append('search', params.search)\n    if (params.sortBy) queryParams.append('sortBy', params.sortBy)\n    if (params.sortOrder) queryParams.append('sortOrder', params.sortOrder)\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/orders/escalated${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          orders: response.data.orders.map(order => ({\n            id: order.id,\n            orderNumber: order.orderNumber,\n            vendor: order.vendor || 'N/A',\n            vendorId: order.vendorId,\n            value: order.value || order.orderValue || 0,\n            orderValue: order.orderValue || order.value || 0,\n            escalatedAt: order.escalatedAt ? new Date(order.escalatedAt).toISOString() : new Date().toISOString(),\n            status: order.status || 'escalated',\n            items: order.items || [],\n            userId: order.userId,\n            userName: order.userName,\n            deliveryAddress: order.deliveryAddress,\n            notes: order.notes,\n          })),\n          total: response.data.pagination?.totalItems || response.data.orders.length,\n          pagination: response.data.pagination,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Fulfill Order from Warehouse\n * POST /admin/orders/:orderId/fulfill\n * \n * @param {string} orderId - Order ID\n * @param {Object} fulfillmentData - { note?: string, deliveryDate?: string (ISO), trackingNumber?: string }\n * @returns {Promise<Object>} - { message: string, order: Object }\n */\nexport async function fulfillOrderFromWarehouse(orderId, fulfillmentData = {}) {\n  try {\n    const response = await apiRequest(`/admin/orders/${orderId}/fulfill`, {\n      method: 'POST',\n      body: JSON.stringify({\n        note: fulfillmentData.note,\n        deliveryDate: fulfillmentData.deliveryDate,\n        trackingNumber: fulfillmentData.trackingNumber,\n      }),\n    })\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          order: response.data.order ? transformOrder(response.data.order) : undefined,\n          message: response.data.message || 'Order fulfilled from warehouse successfully',\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Revert Escalation\n * POST /admin/orders/:orderId/revert-escalation\n * \n * @param {string} orderId - Order ID\n * @param {Object} revertData - { reason: string }\n * @returns {Promise<Object>} - { order: Object, message: string }\n */\nexport async function revertEscalation(orderId, revertData = {}) {\n  try {\n    const response = await apiRequest(`/admin/orders/${orderId}/revert-escalation`, {\n      method: 'POST',\n      body: JSON.stringify({\n        reason: revertData.reason,\n      }),\n    })\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          order: response.data.order ? transformOrder(response.data.order) : undefined,\n          message: response.data.message || 'Escalation reverted successfully',\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Update Order Status (for admin-fulfilled orders)\n * PUT /admin/orders/:orderId/status\n * \n * @param {string} orderId - Order ID\n * @param {Object} statusData - { status: string, notes?: string }\n * @returns {Promise<Object>} - { order: Object, message: string }\n */\nexport async function updateOrderStatus(orderId, statusData = {}) {\n  try {\n    const requestBody = {}\n    if (statusData.status) requestBody.status = statusData.status\n    if (statusData.paymentStatus) requestBody.paymentStatus = statusData.paymentStatus\n    if (statusData.notes) requestBody.notes = statusData.notes\n    if (statusData.isRevert !== undefined) requestBody.isRevert = statusData.isRevert\n\n    const response = await apiRequest(`/admin/orders/${orderId}/status`, {\n      method: 'PUT',\n      body: JSON.stringify(requestBody),\n    })\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          order: response.data.order ? transformOrder(response.data.order) : undefined,\n          message: response.data.message || 'Order status updated successfully',\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Notifications\n * GET /admin/operations/notifications\n * \n * @returns {Promise<Object>} - { notifications: Array }\n */\nexport async function getNotifications() {\n  const response = await apiRequest('/admin/operations/notifications')\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    return {\n      success: true,\n      data: {\n        notifications: response.data.notifications.map(notif => ({\n          id: notif._id || notif.id,\n          title: notif.title,\n          message: notif.message,\n          targetAudience: notif.targetAudience,\n          priority: notif.priority,\n          isActive: notif.isActive,\n          createdAt: notif.createdAt ? new Date(notif.createdAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n          actionUrl: notif.actionUrl,\n          actionText: notif.actionText,\n        })),\n        pagination: response.data.pagination,\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Create Notification\n * POST /admin/operations/notifications\n * \n * @param {Object} notificationData - Notification object\n * @returns {Promise<Object>} - { notification: Object, message: string }\n */\nexport async function createNotification(notificationData) {\n  const response = await apiRequest('/admin/operations/notifications', {\n    method: 'POST',\n    body: JSON.stringify(notificationData),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    const notif = response.data.notification\n    return {\n      success: true,\n      data: {\n        notification: {\n          id: notif._id || notif.id,\n          title: notif.title,\n          message: notif.message,\n          targetAudience: notif.targetAudience,\n          priority: notif.priority,\n          isActive: notif.isActive,\n          createdAt: notif.createdAt ? new Date(notif.createdAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n        },\n        message: response.message || 'Notification created successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Update Notification\n * PUT /admin/operations/notifications/:notificationId\n * \n * @param {string} notificationId - Notification ID\n * @param {Object} notificationData - Updated notification object\n * @returns {Promise<Object>} - { notification: Object, message: string }\n */\nexport async function updateNotification(notificationId, notificationData) {\n  const response = await apiRequest(`/admin/operations/notifications/${notificationId}`, {\n    method: 'PUT',\n    body: JSON.stringify(notificationData),\n  })\n\n  // Transform backend response to frontend format\n  if (response.success && response.data) {\n    const notif = response.data.notification\n    return {\n      success: true,\n      data: {\n        notification: {\n          id: notif._id || notif.id,\n          title: notif.title,\n          message: notif.message,\n          targetAudience: notif.targetAudience,\n          priority: notif.priority,\n          isActive: notif.isActive,\n          createdAt: notif.createdAt ? new Date(notif.createdAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n        },\n        message: response.message || 'Notification updated successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Delete Notification\n * DELETE /admin/operations/notifications/:notificationId\n * \n * @param {string} notificationId - Notification ID\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function deleteNotification(notificationId) {\n  const response = await apiRequest(`/admin/operations/notifications/${notificationId}`, {\n    method: 'DELETE',\n  })\n\n  // Transform backend response to frontend format\n  if (response.success) {\n    return {\n      success: true,\n      data: {\n        message: response.message || 'Notification deleted successfully',\n      },\n    }\n  }\n\n  return response\n}\n\n/**\n * Get Vendor Credit History\n * GET /admin/finance/vendors/:vendorId/history\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} params - { page?, limit?, startDate?, endDate? }\n * @returns {Promise<Object>} - { vendor: Object, history: Array, pagination?: Object }\n */\nexport async function getVendorCreditHistory(vendorId, params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.startDate) queryParams.append('startDate', params.startDate)\n    if (params.endDate) queryParams.append('endDate', params.endDate)\n    if (params.offset) {\n      // Convert offset to page\n      const page = Math.floor((params.offset / (params.limit || 20)) + 1)\n      queryParams.append('page', page.toString())\n    }\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/finance/vendors/${vendorId}/history${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      // Transform history items\n      const history = response.data.history?.map(item => ({\n        id: item.id?.toString() || item._id?.toString(),\n        type: item.type, // 'credit_purchase' or 'repayment'\n        amount: item.amount || 0,\n        date: item.date || item.createdAt ? new Date(item.date || item.createdAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\n        description: item.description || '',\n        status: item.status || 'pending',\n        products: item.products || [],\n        orderNumber: item.orderNumber,\n      })) || []\n\n      return {\n        success: true,\n        data: {\n          vendor: response.data.vendor || {},\n          creditData: {\n            creditLimit: response.data.vendor?.creditLimit || 0,\n            usedCredit: response.data.vendor?.creditUsed || 0,\n            availableCredit: response.data.vendor?.creditRemaining || 0,\n            overdueAmount: 0, // TODO: Calculate from history\n            penaltyAmount: 0, // TODO: Calculate from history\n            repaymentHistory: history.filter(item => item.type === 'repayment'),\n            overduePayments: [], // TODO: Calculate from history\n          },\n          history,\n          transactions: history, // Alias for compatibility\n          pagination: response.data.pagination,\n          total: response.data.pagination?.totalItems || history.length,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get All Vendor Credit Repayments\n * GET /admin/finance/repayments\n * \n * @param {Object} params - { \n *   page?: number, \n *   limit?: number,\n *   status?: 'pending' | 'processing' | 'completed' | 'failed' | 'cancelled',\n *   vendorId?: string,\n *   startDate?: string,\n *   endDate?: string\n * }\n * @returns {Promise<Object>} - { repayments: Array, summary: Object, pagination: Object }\n */\nexport async function getRepayments(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.status) queryParams.append('status', params.status)\n    if (params.vendorId) queryParams.append('vendorId', params.vendorId)\n    if (params.startDate) queryParams.append('startDate', params.startDate)\n    if (params.endDate) queryParams.append('endDate', params.endDate)\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/finance/repayments${queryString ? `?${queryString}` : ''}`)\n\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          repayments: response.data.repayments || [],\n          summary: response.data.summary || {},\n          statusBreakdown: response.data.statusBreakdown || [],\n          pagination: response.data.pagination || {},\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Repayment Details\n * GET /admin/finance/repayments/:repaymentId\n * \n * @param {string} repaymentId - Repayment ID\n * @returns {Promise<Object>} - { repayment: Object }\n */\nexport async function getRepaymentDetails(repaymentId) {\n  try {\n    const response = await apiRequest(`/admin/finance/repayments/${repaymentId}`)\n\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          repayment: response.data.repayment || {},\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Get Vendor Repayments\n * GET /admin/finance/vendors/:vendorId/repayments\n * \n * @param {string} vendorId - Vendor ID\n * @param {Object} params - { page?: number, limit?: number, status?: string }\n * @returns {Promise<Object>} - { vendor: Object, repayments: Array, summary: Object, pagination: Object }\n */\nexport async function getVendorRepayments(vendorId, params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n    if (params.page) queryParams.append('page', params.page)\n    if (params.limit) queryParams.append('limit', params.limit)\n    if (params.status) queryParams.append('status', params.status)\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/finance/vendors/${vendorId}/repayments${queryString ? `?${queryString}` : ''}`)\n\n    if (response.success && response.data) {\n      return {\n        success: true,\n        data: {\n          vendor: response.data.vendor || {},\n          repayments: response.data.repayments || [],\n          summary: response.data.summary || {},\n          pagination: response.data.pagination || {},\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n// ============================================================================\n// ANALYTICS & REPORTS APIs\n// ============================================================================\n\n/**\n * Get Analytics Data\n * GET /admin/analytics\n * \n * @param {Object} params - { period?: number (days, default 30), region?: string }\n * @returns {Promise<Object>} - {\n *   highlights: Array,\n *   timeline: Array,\n *   regionWise: Array,\n *   topVendors: Array,\n *   topSellers: Array,\n *   revenueTrends: Array,\n *   orderTrends: Array\n * }\n */\nexport async function getAnalyticsData(params = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n    if (params.period) {\n      // Convert period string to days if needed\n      const periodDays = typeof params.period === 'number'\n        ? params.period\n        : params.period === 'day' ? 1\n          : params.period === 'week' ? 7\n            : params.period === 'month' ? 30\n              : params.period === 'year' ? 365\n                : 30\n      queryParams.append('period', periodDays.toString())\n    } else {\n      queryParams.append('period', '30') // Default 30 days\n    }\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/analytics${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data?.analytics) {\n      const analytics = response.data.analytics\n\n      // Calculate highlights from analytics data\n      const totalOrders = analytics.orderTrends?.reduce((sum, day) => sum + (day.count || 0), 0) || 0\n      const totalRevenue = analytics.revenueTrends?.reduce((sum, day) => sum + (day.revenue || 0), 0) || 0\n      const topVendor = analytics.topVendors?.[0]\n      const topSeller = analytics.topSellers?.[0]\n\n      // Calculate region-wise data (simplified - would need region aggregation in backend)\n      // For now, using mock data structure but placeholder for future enhancement\n      const regionWise = [] // TODO: Backend needs to provide region-wise aggregation\n\n      // Build highlights\n      const highlights = [\n        {\n          label: 'Total Orders',\n          value: totalOrders.toLocaleString('en-IN'),\n          change: '+12%', // TODO: Calculate change from previous period\n        },\n        {\n          label: 'Total Revenue',\n          value: `â‚¹${(totalRevenue / 10000000).toFixed(1)} Cr`,\n          change: '+9.6%', // TODO: Calculate change from previous period\n        },\n        {\n          label: 'Top Region',\n          value: 'N/A', // TODO: Calculate from region-wise data\n          change: 'N/A',\n        },\n        {\n          label: 'Top Vendor',\n          value: topVendor?.vendorName || 'N/A',\n          change: `â‚¹${((topVendor?.revenue || 0) / 10000000).toFixed(1)} Cr`,\n        },\n      ]\n\n      // Build timeline (simplified - would need actual event tracking)\n      const timeline = [\n        // TODO: Add actual timeline events when backend provides them\n        {\n          id: 'event-1',\n          title: 'Analytics updated',\n          timestamp: 'Just now',\n          description: 'Analytics data refreshed for the selected period.',\n          status: 'completed',\n        },\n      ]\n\n      // Transform top vendors\n      const topVendors = analytics.topVendors?.map(vendor => ({\n        name: vendor.vendorName || vendor.name,\n        revenue: vendor.revenue || 0,\n        change: '+0%', // TODO: Calculate change from previous period\n        orderCount: vendor.orderCount || 0,\n      })) || []\n\n      // Transform top sellers\n      const topSellers = analytics.topSellers?.map(seller => ({\n        name: seller.sellerId || 'Unknown Seller',\n        sales: seller.revenue || 0,\n        referrals: seller.referralCount || 0,\n        orderCount: seller.orderCount || 0,\n      })) || []\n\n      return {\n        success: true,\n        data: {\n          highlights,\n          timeline,\n          regionWise,\n          topVendors,\n          topSellers,\n          revenueTrends: analytics.revenueTrends || [],\n          orderTrends: analytics.orderTrends || [],\n          topProducts: analytics.topProducts || [],\n          period: response.data.period || 30,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n/**\n * Export Reports\n * GET /admin/reports\n * \n * Note: Backend endpoint is GET (not POST) and returns JSON format for now\n * CSV/PDF export returns 501 (not yet implemented)\n * \n * @param {Object} exportData - {\n *   format?: 'json' | 'csv' | 'pdf' (default: 'json'),\n *   period?: 'daily' | 'weekly' | 'monthly' | 'yearly' (default: 'monthly'),\n *   type?: 'summary' | 'full' (default: 'summary')\n * }\n * @returns {Promise<Object>} - { report: Object, generatedAt: Date, format: string }\n */\nexport async function exportReports(exportData = {}) {\n  try {\n    const queryParams = new URLSearchParams()\n\n    queryParams.append('format', exportData.format || 'json')\n    queryParams.append('period', exportData.period || 'monthly')\n    queryParams.append('type', exportData.type || 'summary')\n\n    const queryString = queryParams.toString()\n    const response = await apiRequest(`/admin/reports${queryString ? `?${queryString}` : ''}`)\n\n    // Transform backend response to frontend format\n    if (response.success && response.data) {\n      // If CSV/PDF, backend returns 501 - handle gracefully\n      if (response.status === 501 || !response.success) {\n        return {\n          success: false,\n          message: response.message || 'CSV/PDF export functionality will be implemented later',\n          data: {\n            downloadUrl: null,\n            reportId: null,\n          },\n        }\n      }\n\n      // For JSON format, return report data\n      // For CSV/PDF (when implemented), return download URL\n      return {\n        success: true,\n        data: {\n          report: response.data.report || {},\n          generatedAt: response.data.generatedAt || new Date(),\n          format: response.data.format || 'json',\n          downloadUrl: response.data.format !== 'json' ? response.data.downloadUrl : null,\n          reportId: `RPT-${Date.now()}`,\n        },\n      }\n    }\n\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\n// ============================================================================\n// REAL-TIME NOTIFICATIONS\n// ============================================================================\n\n/**\n * Initialize Real-time Connection\n * Sets up WebSocket or polling connection for real-time updates\n * \n * @param {Function} onNotification - Callback function for notifications\n * @returns {Function} - Cleanup function\n */\nexport function initializeRealtimeConnection(onNotification) {\n  // Simulate real-time connection\n  const interval = setInterval(() => {\n    // Simulate various notification types\n    const notifications = [\n      {\n        type: 'vendor_application',\n        title: 'New Vendor Application',\n        message: 'New vendor application received from Green Valley Hub',\n        timestamp: new Date().toISOString(),\n        data: { vendorId: 'VND-500', vendorName: 'Green Valley Hub' },\n      },\n      {\n        type: 'vendor_purchase_request',\n        title: 'Vendor Purchase Request',\n        message: 'HarvestLink Pvt Ltd requested credit purchase of â‚¹50,000',\n        timestamp: new Date().toISOString(),\n        data: { requestId: 'CR-123', vendorId: 'VND-131', amount: 50000 },\n      },\n      {\n        type: 'seller_withdrawal_request',\n        title: 'Seller Withdrawal Request',\n        message: 'Priya Nair requested withdrawal of â‚¹25,000',\n        timestamp: new Date().toISOString(),\n        data: { requestId: 'WD-456', sellerId: 'SLR-883', amount: 25000 },\n      },\n      {\n        type: 'order_escalated',\n        title: 'Order Escalated',\n        message: 'Order #ORD-78289 escalated to Admin for fulfillment',\n        timestamp: new Date().toISOString(),\n        data: { orderId: 'ORD-78289', reason: 'Vendor unavailable' },\n      },\n      {\n        type: 'payment_delayed',\n        title: 'Payment Delayed',\n        message: '14 vendors have delayed payments requiring attention',\n        timestamp: new Date().toISOString(),\n        data: { count: 14 },\n      },\n      {\n        type: 'low_stock_alert',\n        title: 'Low Stock Alert',\n        message: 'Micro Nutrient Mix stock is running low (2,900 kg)',\n        timestamp: new Date().toISOString(),\n        data: { productId: 'MICRO-12', productName: 'Micro Nutrient Mix', stock: 2900 },\n      },\n    ]\n\n    // Randomly send notifications (simulate real-time behavior)\n    if (Math.random() < 0.1) {\n      const notification = notifications[Math.floor(Math.random() * notifications.length)]\n      onNotification(notification)\n    }\n  }, 10000) // Check every 10 seconds\n\n  return () => clearInterval(interval)\n}\n\n/**\n * Handle Real-time Notification\n * Processes incoming notifications and dispatches appropriate actions\n * \n * @param {Object} notification - Notification object\n * @param {Function} dispatch - Context dispatch function\n * @param {Function} showToast - Toast notification function\n */\nexport function handleRealtimeNotification(notification, dispatch, showToast) {\n  switch (notification.type) {\n    case 'vendor_application':\n      dispatch({ type: 'ADD_NOTIFICATION', payload: notification })\n      dispatch({ type: 'SET_VENDORS_UPDATED', payload: true })\n      showToast(notification.message, 'info')\n      break\n\n    case 'vendor_purchase_request':\n      dispatch({ type: 'ADD_NOTIFICATION', payload: notification })\n      dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n      showToast(notification.message, 'info')\n      break\n\n    case 'seller_withdrawal_request':\n      dispatch({ type: 'ADD_NOTIFICATION', payload: notification })\n      dispatch({ type: 'SET_SELLERS_UPDATED', payload: true })\n      showToast(notification.message, 'info')\n      break\n\n    case 'order_escalated':\n      dispatch({ type: 'ADD_NOTIFICATION', payload: notification })\n      dispatch({ type: 'SET_ORDERS_UPDATED', payload: true })\n      showToast(notification.message, 'warning')\n      break\n\n    case 'payment_delayed':\n      dispatch({ type: 'ADD_NOTIFICATION', payload: notification })\n      dispatch({ type: 'SET_FINANCE_UPDATED', payload: true })\n      showToast(notification.message, 'warning')\n      break\n\n    case 'low_stock_alert':\n      dispatch({ type: 'ADD_NOTIFICATION', payload: notification })\n      dispatch({ type: 'SET_PRODUCTS_UPDATED', payload: true })\n      showToast(notification.message, 'warning')\n      break\n\n    default:\n      dispatch({ type: 'ADD_NOTIFICATION', payload: notification })\n      break\n  }\n}\n\n// ============================================================================\n// OFFERS MANAGEMENT APIs\n// ============================================================================\n\n/**\n * Get All Offers\n * GET /admin/offers\n * \n * @param {Object} params - { type, isActive }\n * @returns {Promise<Object>} - { offers: Array, carouselCount: number, maxCarousels: number }\n */\nexport async function getOffers(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/admin/offers?${queryParams}`)\n}\n\n/**\n * Get Single Offer\n * GET /admin/offers/:id\n * \n * @param {string} id - Offer ID\n * @returns {Promise<Object>} - { offer: Object }\n */\nexport async function getOffer(id) {\n  return apiRequest(`/admin/offers/${id}`)\n}\n\n/**\n * Create Offer\n * POST /admin/offers\n * \n * @param {Object} data - Offer data (type, title, description, etc.)\n * @returns {Promise<Object>} - { offer: Object }\n */\nexport async function createOffer(data) {\n  return apiRequest('/admin/offers', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Update Offer\n * PUT /admin/offers/:id\n * \n * @param {string} id - Offer ID\n * @param {Object} data - Updated offer data\n * @returns {Promise<Object>} - { offer: Object }\n */\nexport async function updateOffer(id, data) {\n  return apiRequest(`/admin/offers/${id}`, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Delete Offer\n * DELETE /admin/offers/:id\n * \n * @param {string} id - Offer ID\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function deleteOffer(id) {\n  return apiRequest(`/admin/offers/${id}`, {\n    method: 'DELETE',\n  })\n}\n\n// ============================================================================\n// REVIEW MANAGEMENT APIs\n// ============================================================================\n\n/**\n * Get All Reviews\n * GET /admin/reviews\n * \n * @param {Object} params - { productId, userId, rating, hasResponse, isApproved, isVisible, page, limit, sort }\n * @returns {Promise<Object>} - { reviews: Array, pagination: Object }\n */\nexport async function getReviews(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/admin/reviews?${queryParams}`)\n}\n\n/**\n * Get Review Details\n * GET /admin/reviews/:reviewId\n * \n * @param {string} reviewId - Review ID\n * @returns {Promise<Object>} - { review: Object }\n */\nexport async function getReviewDetails(reviewId) {\n  return apiRequest(`/admin/reviews/${reviewId}`)\n}\n\n/**\n * Respond to Review\n * POST /admin/reviews/:reviewId/respond\n * \n * @param {string} reviewId - Review ID\n * @param {Object} data - { response: string }\n * @returns {Promise<Object>} - { review: Object, message: string }\n */\nexport async function respondToReview(reviewId, data) {\n  return apiRequest(`/admin/reviews/${reviewId}/respond`, {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Update Review Response\n * PUT /admin/reviews/:reviewId/respond\n * \n * @param {string} reviewId - Review ID\n * @param {Object} data - { response: string }\n * @returns {Promise<Object>} - { review: Object, message: string }\n */\nexport async function updateReviewResponse(reviewId, data) {\n  return apiRequest(`/admin/reviews/${reviewId}/respond`, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Delete Review Response\n * DELETE /admin/reviews/:reviewId/respond\n * \n * @param {string} reviewId - Review ID\n * @returns {Promise<Object>} - { review: Object, message: string }\n */\nexport async function deleteReviewResponse(reviewId) {\n  return apiRequest(`/admin/reviews/${reviewId}/respond`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Moderate Review\n * PUT /admin/reviews/:reviewId/moderate\n * \n * @param {string} reviewId - Review ID\n * @param {Object} data - { isApproved: boolean, isVisible: boolean }\n * @returns {Promise<Object>} - { review: Object, message: string }\n */\nexport async function moderateReview(reviewId, data) {\n  return apiRequest(`/admin/reviews/${reviewId}/moderate`, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Delete Review\n * DELETE /admin/reviews/:reviewId\n * \n * @param {string} reviewId - Review ID\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function deleteReview(reviewId) {\n  return apiRequest(`/admin/reviews/${reviewId}`, {\n    method: 'DELETE',\n  })\n}\n\n// ============================================================================\n// TASK (TODO) MANAGEMENT APIs\n// ============================================================================\n\n/**\n * Get All Admin Tasks\n * GET /admin/tasks\n * \n * @param {Object} params - { status, category, priority, limit }\n * @returns {Promise<Object>} - { tasks: Array, totalPending: number }\n */\nexport async function getAdminTasks(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/admin/tasks?${queryParams}`)\n}\n\n/**\n * Mark Task as Viewed\n * PUT /admin/tasks/:taskId/view\n * \n * @param {string} taskId - Task ID\n * @returns {Promise<Object>} - { success: true, data: Object }\n */\nexport async function markTaskAsViewed(taskId) {\n  return apiRequest(`/admin/tasks/${taskId}/view`, {\n    method: 'PUT',\n  })\n}\n\n/**\n * Mark Task as Completed\n * PUT /admin/tasks/:taskId/complete\n * \n * @param {string} taskId - Task ID\n * @returns {Promise<Object>} - { success: true, data: Object }\n */\nexport async function markTaskAsCompleted(taskId) {\n  return apiRequest(`/admin/tasks/${taskId}/complete`, {\n    method: 'PUT',\n  })\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Admin\\services\\adminData.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\BankAccountForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\BottomNavItem.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\ConfirmationModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\MenuList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\MobileShell.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\NotificationPanel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\NotificationsDropdown.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\ShareSellerIdPanel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\ToastNotification.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[9,19],"text":""},"desc":"Remove unused variable 'useEffect'."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":42,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":42,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react'\r\nimport { createContext, useContext } from 'react'\r\nimport { cn } from '../../../lib/cn'\r\nimport { CheckCircleIcon, XIcon, BellIcon } from './icons'\r\n\r\nconst ToastContext = createContext(null)\r\n\r\nexport function ToastProvider({ children }) {\r\n  const [toasts, setToasts] = useState([])\r\n\r\n  const addToast = (message, type = 'info', duration = 3000) => {\r\n    const id = Date.now() + Math.random()\r\n    const toast = { id, message, type }\r\n    setToasts((prev) => [...prev, toast])\r\n\r\n    if (duration > 0) {\r\n      setTimeout(() => {\r\n        dismissToast(id)\r\n      }, duration)\r\n    }\r\n\r\n    return id\r\n  }\r\n\r\n  const dismissToast = (id) => {\r\n    setToasts((prev) => prev.filter((toast) => toast.id !== id))\r\n  }\r\n\r\n  const success = (message, duration) => addToast(message, 'success', duration)\r\n  const error = (message, duration) => addToast(message, 'error', duration)\r\n  const warning = (message, duration) => addToast(message, 'warning', duration)\r\n  const info = (message, duration) => addToast(message, 'info', duration)\r\n\r\n  return (\r\n    <ToastContext.Provider value={{ toasts, addToast, dismissToast, success, error, warning, info }}>\r\n      {children}\r\n      <ToastContainer toasts={toasts} onDismiss={dismissToast} />\r\n    </ToastContext.Provider>\r\n  )\r\n}\r\n\r\nexport function useToast() {\r\n  const context = useContext(ToastContext)\r\n  if (!context) {\r\n    return {\r\n      toasts: [],\r\n      addToast: () => {},\r\n      dismissToast: () => {},\r\n      success: () => {},\r\n      error: () => {},\r\n      warning: () => {},\r\n      info: () => {},\r\n    }\r\n  }\r\n  return context\r\n}\r\n\r\nexport function ToastContainer({ toasts, onDismiss }) {\r\n  return (\r\n    <div className=\"seller-toast-container\">\r\n      {toasts.map((toast) => (\r\n        <div\r\n          key={toast.id}\r\n          className={cn(\r\n            'seller-toast',\r\n            `is-${toast.type}`,\r\n            'flex items-center gap-3.5 p-3.5 rounded-2xl cursor-pointer'\r\n          )}\r\n          onClick={() => onDismiss(toast.id)}\r\n        >\r\n          <div className={cn(\r\n            'flex items-center justify-center w-8 h-8 rounded-xl flex-shrink-0 text-[1.1rem] font-bold',\r\n            toast.type === 'success' && 'bg-gradient-to-br from-[rgba(43,118,79,0.18)] to-[rgba(43,118,79,0.08)] text-[#1b8f5b]',\r\n            toast.type === 'error' && 'bg-gradient-to-br from-[rgba(220,38,38,0.18)] to-[rgba(220,38,38,0.08)] text-[#dc2626]',\r\n            toast.type === 'warning' && 'bg-gradient-to-br from-[rgba(224,160,73,0.18)] to-[rgba(224,160,73,0.08)] text-[#9b6532]',\r\n            toast.type === 'info' && 'bg-gradient-to-br from-[rgba(33,150,173,0.18)] to-[rgba(33,150,173,0.08)] text-[rgba(16,102,112,0.9)]'\r\n          )}>\r\n            {toast.type === 'success' && <CheckCircleIcon className=\"h-4 w-4\" />}\r\n            {toast.type === 'error' && <XIcon className=\"h-4 w-4\" />}\r\n            {toast.type === 'warning' && <BellIcon className=\"h-4 w-4\" />}\r\n            {toast.type === 'info' && <span>â„¹</span>}\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <p className=\"text-[0.85rem] font-semibold leading-relaxed text-[#172022] m-0\">{toast.message}</p>\r\n          </div>\r\n          <button\r\n            type=\"button\"\r\n            className=\"flex items-center justify-center w-6 h-6 rounded-lg border-none bg-transparent text-[rgba(26,42,34,0.5)] text-[0.9rem] cursor-pointer transition-colors hover:bg-[rgba(26,42,34,0.08)] hover:text-[rgba(26,42,34,0.75)] flex-shrink-0\"\r\n            onClick={(e) => {\r\n              e.stopPropagation()\r\n              onDismiss(toast.id)\r\n            }}\r\n            aria-label=\"Dismiss\"\r\n          >\r\n            <XIcon className=\"h-3 w-3\" />\r\n          </button>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\WithdrawalRequestPanel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\components\\icons.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":14,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[486,501],"text":""},"desc":"Remove unused variable 'active'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":27,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[1184,1199],"text":""},"desc":"Remove unused variable 'active'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":37,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[1581,1596],"text":""},"desc":"Remove unused variable 'active'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":242,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":242,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[9020,9035],"text":""},"desc":"Remove unused variable 'active'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export function HomeIcon({ active = false, className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke={active ? 'currentColor' : 'currentColor'}>\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M3 10.5 11.469 3a1 1 0 0 1 1.333 0L21 10.5M5.5 9.5V20a1 1 0 0 0 1 1H10v-5a2 2 0 0 1 4 0v5h3.5a1 1 0 0 0 1-1V9.5\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function UsersIcon({ active = false, className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function WalletIcon({ active = false, className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\r\n      <rect x=\"3\" y=\"6\" width=\"18\" height=\"12\" rx=\"3\" strokeWidth=\"1.5\" />\r\n      <path d=\"M16 12h3\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\r\n      <circle cx=\"15\" cy=\"12\" r=\"1\" fill=\"currentColor\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function BellIcon({ active = false, className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function MenuIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path strokeLinecap=\"round\" strokeWidth=\"1.5\" d=\"M4 7h16M4 12h16M4 17h10\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function SearchIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\r\n      <circle cx=\"11\" cy=\"11\" r=\"6\" strokeWidth=\"1.5\" />\r\n      <path d=\"m17 17 3 3\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function MapPinIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M12 21c4.5-4.2 6.75-7.533 6.75-10.05A6.75 6.75 0 1 0 5.25 10.95C5.25 13.467 7.5 16.8 12 21Z\"\r\n      />\r\n      <circle cx=\"12\" cy=\"10.5\" r=\"1.8\" fill=\"currentColor\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function SparkIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\">\r\n      <path\r\n        d=\"M12 3 9.4 9.4 3 12l6.4 2.6L12 21l2.6-6.4L21 12l-6.4-2.6L12 3Z\"\r\n        fill=\"currentColor\"\r\n        fillOpacity=\".9\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function ChartIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\r\n      <path d=\"M4 19V5\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\r\n      <path d=\"M9 19V9\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\r\n      <path d=\"M14 19v-6\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\r\n      <path d=\"M19 19v-3\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function ShareIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.935-2.186 2.25 2.25 0 0 0-3.935 2.186Z\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function TargetIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\r\n      <circle cx=\"12\" cy=\"12\" r=\"10\" strokeWidth=\"1.5\" />\r\n      <circle cx=\"12\" cy=\"12\" r=\"6\" strokeWidth=\"1.5\" />\r\n      <circle cx=\"12\" cy=\"12\" r=\"2\" fill=\"currentColor\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function TrendingUpIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.28m5.94 2.28-2.28 5.94\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function TrendingDownIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M2.25 6 9 12.75l4.306-4.306a11.95 11.95 0 0 1 5.814 5.518l2.74 1.22m0 0 5.94-2.28m-5.94 2.28 2.28-5.94\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function CloseIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path strokeLinecap=\"round\" strokeWidth=\"1.5\" d=\"m6 6 12 12M18 6 6 18\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function XIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"m6 6 12 12M18 6 6 18\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function CheckCircleIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function EditIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function BuildingIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3.75h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Z\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function ShieldCheckIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function HelpCircleIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function CheckIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"M5 13l4 4L19 7\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function UserIcon({ active = false, className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M16 7a4 4 0 1 1-8 0 4 4 0 0 1 8 0ZM12 14a7 7 0 0 0-7 7h14a7 7 0 0 0-7-7Z\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function GiftIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H4.5a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625v2.625m0 0V21m-2.625-13.5H7.5a1.5 1.5 0 0 0-1.5 1.5v8.25a1.5 1.5 0 0 0 1.5 1.5h1.875m0 0H12m-2.625 0H12m2.625-13.5H16.5a1.5 1.5 0 0 1 1.5 1.5v8.25a1.5 1.5 0 0 1-1.5 1.5h-1.875m0 0H12m-2.625 0H12\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function CreditIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function BankIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"M2.25 18.75a60.07 60.07 0 0 1 15.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 0 1 3 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25c.621 0 1.125.504 1.125 1.125v.375m-8.25-3v1.5m8.25-1.5v1.5m-8.25 0v1.5m8.25 0v1.5m-8.25 0h3.75m-3.75 0h3.75m-3.75 0h3.75m-3.75 0h3.75M3.75 8.25h15m-15 0v7.5m15-7.5v7.5m-15 0h15\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function PlusIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"M12 4.5v15m7.5-7.5h-15\" />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport function TrashIcon({ className = 'h-5 w-5' }) {\r\n  return (\r\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"1.5\"\r\n        d=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\context\\SellerContext.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'isInitialized' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":206,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"isInitialized"},"fix":{"range":[5342,5355],"text":""},"desc":"Remove unused variable 'isInitialized'."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":409,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":409,"endColumn":31},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":424,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":424,"endColumn":34}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useMemo, useReducer, useEffect, useState } from 'react'\nimport { initializeRealtimeConnection, handleRealtimeNotification, getSellerProfile } from '../services/sellerApi'\n\nconst initialState = {\n  language: 'en',\n  role: null,\n  authenticated: false,\n  profile: {\n    name: 'Guest Seller',\n    sellerId: '',\n    area: '',\n    phone: '',\n    email: '',\n    commissionRate: '',\n    cashbackRate: '',\n    assignedVendor: '',\n  },\n  notifications: [],\n  dashboard: {\n    overview: null,\n    wallet: null,\n    referrals: null,\n    performance: null,\n    loading: false,\n    error: null,\n  },\n  targetIncentives: [],\n  realtimeConnected: false,\n}\n\n// Use a symbol to detect if context is actually provided\nconst SELLER_CONTEXT_SYMBOL = Symbol('SellerContextProvided')\n\nconst SellerStateContext = createContext(null)\nconst SellerDispatchContext = createContext(null)\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'SET_LANGUAGE':\n      return { ...state, language: action.payload }\n    case 'SET_ROLE':\n      return { ...state, role: action.payload }\n    case 'AUTH_LOGIN':\n      return {\n        ...state,\n        authenticated: true,\n        profile: {\n          ...state.profile,\n          ...action.payload,\n        },\n      }\n    case 'AUTH_LOGOUT':\n      return {\n        ...state,\n        authenticated: false,\n        profile: initialState.profile,\n        notifications: [],\n        dashboard: initialState.dashboard,\n        targetIncentives: [],\n      }\n    case 'UPDATE_PROFILE':\n      return {\n        ...state,\n        profile: {\n          ...state.profile,\n          ...action.payload,\n        },\n      }\n    case 'SET_DASHBOARD_LOADING':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          loading: action.payload,\n        },\n      }\n    case 'SET_DASHBOARD_ERROR':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          error: action.payload,\n          loading: false,\n        },\n      }\n    case 'SET_DASHBOARD_OVERVIEW':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          overview: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'SET_WALLET_DATA':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          wallet: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'SET_REFERRALS_DATA':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          referrals: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'SET_PERFORMANCE_DATA':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          performance: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'SET_TARGET_INCENTIVES':\n      return {\n        ...state,\n        targetIncentives: action.payload,\n      }\n    case 'ADD_NOTIFICATION': {\n      // Check if notification already exists (prevent duplicates)\n      const existingIndex = state.notifications.findIndex(\n        (n) => n.id === action.payload.id || (n.type === action.payload.type && n.orderId === action.payload.orderId),\n      )\n      if (existingIndex >= 0) {\n        return state\n      }\n      return {\n        ...state,\n        notifications: [\n          {\n            id: action.payload.id || Date.now().toString(),\n            ...action.payload,\n            read: action.payload.read || false,\n            timestamp: action.payload.timestamp || new Date().toISOString(),\n          },\n          ...state.notifications,\n        ],\n      }\n    }\n    case 'MARK_NOTIFICATION_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) =>\n          notif.id === action.payload.id ? { ...notif, read: true } : notif,\n        ),\n      }\n    case 'MARK_ALL_NOTIFICATIONS_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) => ({ ...notif, read: true })),\n      }\n    case 'SET_REALTIME_CONNECTED':\n      return {\n        ...state,\n        realtimeConnected: action.payload,\n      }\n    case 'UPDATE_WALLET_BALANCE': {\n      const currentBalance = state.dashboard.wallet?.balance || 0\n      const newBalance = action.payload.isIncrement\n        ? currentBalance + action.payload.balance\n        : action.payload.balance\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          wallet: {\n            ...state.dashboard.wallet,\n            balance: newBalance,\n            pending: action.payload.pending !== undefined ? action.payload.pending : state.dashboard.wallet?.pending,\n          },\n        },\n      }\n    }\n    case 'UPDATE_TARGET_PROGRESS':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          overview: {\n            ...state.dashboard.overview,\n            targetProgress: action.payload.progress,\n            thisMonthSales: action.payload.thisMonthSales,\n            status: action.payload.status,\n          },\n        },\n      }\n    default:\n      return state\n  }\n}\n\nexport function SellerProvider({ children }) {\n  const [state, dispatch] = useReducer(reducer, initialState)\n  const [isInitialized, setIsInitialized] = useState(false)\n\n  // Initialize seller profile from token on mount\n  useEffect(() => {\n    const initializeSeller = async () => {\n      const token = localStorage.getItem('seller_token')\n      if (token && !state.authenticated) {\n        try {\n          const profileResult = await getSellerProfile()\n\n          if (profileResult.success && profileResult.data?.seller) {\n            const seller = profileResult.data.seller\n            dispatch({\n              type: 'AUTH_LOGIN',\n              payload: {\n                id: seller.id || seller._id,\n                name: seller.name,\n                phone: seller.phone,\n                email: seller.email,\n                sellerId: seller.sellerId,\n                area: seller.area,\n                status: seller.status,\n                isActive: seller.isActive,\n              },\n            })\n          } else {\n            // Token is invalid, remove it\n            localStorage.removeItem('seller_token')\n          }\n        } catch (error) {\n          console.error('Failed to initialize seller:', error)\n          // Token might be invalid, remove it\n          localStorage.removeItem('seller_token')\n        }\n      }\n      setIsInitialized(true)\n    }\n\n    initializeSeller()\n  }, [state.authenticated])\n\n  // Initialize real-time connection when authenticated\n  useEffect(() => {\n    if (state.authenticated && state.profile.sellerId) {\n      const cleanup = initializeRealtimeConnection((notification) => {\n        const processedNotification = handleRealtimeNotification(notification)\n\n        // Handle different notification types\n        switch (processedNotification.type) {\n          case 'cashback_added':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'cashback',\n                title: 'Cashback Added',\n                message: `You earned â‚¹${processedNotification.amount} for User Order #${processedNotification.orderId}`,\n                amount: processedNotification.amount,\n                orderId: processedNotification.orderId,\n                read: false,\n              },\n            })\n            // Update wallet balance - will be handled by reducer using current state\n            dispatch({\n              type: 'UPDATE_WALLET_BALANCE',\n              payload: {\n                balance: processedNotification.amount, // Amount to add\n                isIncrement: true, // Flag to indicate increment\n              },\n            })\n            break\n\n          case 'target_achieved':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'target',\n                title: 'Target Achieved!',\n                message: 'Congratulations! You reached your monthly goal.',\n                read: false,\n              },\n            })\n            break\n\n          case 'announcement':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'announcement',\n                title: processedNotification.title,\n                message: processedNotification.message,\n                read: false,\n              },\n            })\n            break\n\n          case 'withdrawal_approved':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'withdrawal',\n                title: 'Withdrawal Approved',\n                message: `Your withdrawal request of â‚¹${processedNotification.amount} has been approved`,\n                amount: processedNotification.amount,\n                read: false,\n              },\n            })\n            break\n\n          case 'withdrawal_rejected':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'withdrawal',\n                title: 'Withdrawal Rejected',\n                message: `Your withdrawal request was rejected. Reason: ${processedNotification.reason}`,\n                read: false,\n              },\n            })\n            break\n\n          case 'commission_rate_change':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'commission_rate_change',\n                title: 'Commission Rate Updated',\n                message: `Your commission rate has been updated from ${processedNotification.oldRate}% to ${processedNotification.newRate}%`,\n                oldRate: processedNotification.oldRate,\n                newRate: processedNotification.newRate,\n                read: false,\n              },\n            })\n            break\n\n          case 'policy_update':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'policy_update',\n                title: 'Policy Updated',\n                message: processedNotification.message || 'Commission policy has been updated. Please review the changes.',\n                read: false,\n              },\n            })\n            break\n\n          case 'commission_added':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'commission',\n                title: 'Commission Earned',\n                message: `You earned â‚¹${processedNotification.amount} commission from order #${processedNotification.orderId}`,\n                amount: processedNotification.amount,\n                orderId: processedNotification.orderId,\n                read: false,\n              },\n            })\n            break\n\n          default:\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                ...processedNotification,\n                read: false,\n              },\n            })\n        }\n      })\n\n      dispatch({ type: 'SET_REALTIME_CONNECTED', payload: true })\n\n      return () => {\n        cleanup()\n        dispatch({ type: 'SET_REALTIME_CONNECTED', payload: false })\n      }\n    }\n  }, [state.authenticated, state.profile.sellerId, dispatch])\n\n  const value = useMemo(() => ({ ...state, [SELLER_CONTEXT_SYMBOL]: true }), [state])\n  const dispatchWithSymbol = useMemo(() => {\n    const wrappedDispatch = (action) => dispatch(action)\n    wrappedDispatch[SELLER_CONTEXT_SYMBOL] = true\n    return wrappedDispatch\n  }, [dispatch])\n\n  return (\n    <SellerStateContext.Provider value={value}>\n      <SellerDispatchContext.Provider value={dispatchWithSymbol}>{children}</SellerDispatchContext.Provider>\n    </SellerStateContext.Provider>\n  )\n}\n\nexport function useSellerState() {\n  const context = useContext(SellerStateContext)\n  if (!context || !context[SELLER_CONTEXT_SYMBOL]) {\n    if (import.meta.env.DEV) {\n      console.error('useSellerState must be used within SellerProvider')\n      throw new Error('useSellerState must be used within SellerProvider')\n    }\n    // In production, return initial state to prevent crashes\n    return initialState\n  }\n  // Remove the symbol before returning\n  const { [SELLER_CONTEXT_SYMBOL]: _, ...state } = context\n  return state\n}\n\nexport function useSellerDispatch() {\n  const dispatch = useContext(SellerDispatchContext)\n  if (!dispatch) {\n    if (import.meta.env.DEV) {\n      console.error('useSellerDispatch must be used within SellerProvider')\n      throw new Error('useSellerDispatch must be used within SellerProvider')\n    }\n    // In production, return a no-op function to prevent crashes\n    return () => {\n      if (import.meta.env.DEV) {\n        console.warn('SellerDispatch called outside SellerProvider')\n      }\n    }\n  }\n  // Check for symbol to ensure it's the wrapped dispatch\n  if (!dispatch[SELLER_CONTEXT_SYMBOL]) {\n    if (import.meta.env.DEV) {\n      console.error('useSellerDispatch must be used within SellerProvider')\n      throw new Error('useSellerDispatch must be used within SellerProvider')\n    }\n    // In production, return a no-op function to prevent crashes\n    return () => {\n      if (import.meta.env.DEV) {\n        console.warn('SellerDispatch called outside SellerProvider')\n      }\n    }\n  }\n  // Return the dispatch function directly\n  return dispatch\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\hooks\\useSellerApi.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\SellerAuth.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\SellerDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'location' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":61,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":66,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":66,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[2419,2426],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'info' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":66,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":66,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"info"},"fix":{"range":[2426,2432],"text":""},"desc":"Remove unused variable 'info'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'warning' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":66,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":66,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"warning"},"fix":{"range":[2432,2441],"text":""},"desc":"Remove unused variable 'warning'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'validTabs'. Either include it or remove the dependency array.","line":88,"column":6,"nodeType":"ArrayExpression","endLine":88,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [urlTab, navigate, validTabs]","fix":{"range":[3306,3324],"text":"[urlTab, navigate, validTabs]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'validTabs'. Either include it or remove the dependency array.","line":98,"column":6,"nodeType":"ArrayExpression","endLine":98,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [navigate, validTabs]","fix":{"range":[3627,3637],"text":"[navigate, validTabs]"}}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":182,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":182,"endColumn":46,"suggestions":[{"messageId":"addBrackets","fix":{"range":[5745,6179],"text":"{ const wallet = dashboard.wallet || {}\n        const balance = data?.availableBalance !== undefined \n          ? data.availableBalance \n          : (typeof wallet.balance === 'number' ? wallet.balance : parseFloat((wallet.balance || '0').toString().replace(/[â‚¹,\\s]/g, '')) || 0)\n          setPanelData(data || {})\n          setPanelMounted(true)\n          requestAnimationFrame(() => setActivePanel('request-withdrawal'))\n        break }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":183,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":185,"endColumn":143,"suggestions":[{"messageId":"addBrackets","fix":{"range":[5745,6179],"text":"{ const wallet = dashboard.wallet || {}\n        const balance = data?.availableBalance !== undefined \n          ? data.availableBalance \n          : (typeof wallet.balance === 'number' ? wallet.balance : parseFloat((wallet.balance || '0').toString().replace(/[â‚¹,\\s]/g, '')) || 0)\n          setPanelData(data || {})\n          setPanelMounted(true)\n          requestAnimationFrame(() => setActivePanel('request-withdrawal'))\n        break }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'balance' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":183,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":183,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'text' is defined but never used.","line":223,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":223,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"text"},"fix":{"range":[7073,7077],"text":""},"desc":"Remove unused variable 'text'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'bankAccount' is defined but never used.","line":227,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":227,"endColumn":54,"suggestions":[{"messageId":"removeVar","data":{"varName":"bankAccount"},"fix":{"range":[7167,7178],"text":""},"desc":"Remove unused variable 'bankAccount'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":264,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":264,"endColumn":17}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useMemo, useState, useRef, useCallback } from 'react'\nimport { useNavigate, useLocation, useParams } from 'react-router-dom'\nimport { useSellerDispatch, useSellerState } from '../context/SellerContext'\nimport { useSellerApi } from '../hooks/useSellerApi'\nimport { MobileShell } from '../components/MobileShell'\nimport { BottomNavItem } from '../components/BottomNavItem'\nimport { MenuList } from '../components/MenuList'\nimport { HomeIcon, UsersIcon, WalletIcon, BellIcon, MenuIcon, SearchIcon, UserIcon } from '../components/icons'\nimport { sellerSnapshot } from '../services/sellerData'\nimport { cn } from '../../../lib/cn'\nimport { useToast } from '../components/ToastNotification'\nimport { OverviewView } from './views/OverviewView'\nimport { ReferralsView } from './views/ReferralsView'\nimport { WalletView } from './views/WalletView'\nimport { AnnouncementsView } from './views/AnnouncementsView'\nimport { PerformanceView } from './views/PerformanceView'\nimport { ProfileView } from './views/ProfileView'\nimport { WithdrawalRequestPanel } from '../components/WithdrawalRequestPanel'\nimport { ShareSellerIdPanel } from '../components/ShareSellerIdPanel'\nimport { BankAccountForm } from '../components/BankAccountForm'\nimport { NotificationPanel } from '../components/NotificationPanel'\nimport '../seller.css'\n\nconst NAV_ITEMS = [\n  {\n    id: 'overview',\n    label: 'Overview',\n    description: 'Target, wallet, stats',\n    icon: HomeIcon,\n  },\n  {\n    id: 'referrals',\n    label: 'Referrals',\n    description: 'Your referral network',\n    icon: UsersIcon,\n  },\n  {\n    id: 'wallet',\n    label: 'Wallet',\n    description: 'Balance & transactions',\n    icon: WalletIcon,\n  },\n  {\n    id: 'announcements',\n    label: 'Updates',\n    description: 'Admin announcements',\n    icon: BellIcon,\n  },\n  {\n    id: 'profile',\n    label: 'Profile',\n    description: 'Settings & account',\n    icon: UserIcon,\n  },\n]\n\nexport function SellerDashboard({ onLogout }) {\n  const { profile, notifications, dashboard } = useSellerState()\n  const dispatch = useSellerDispatch()\n  const navigate = useNavigate()\n  const location = useLocation()\n  const { tab: urlTab } = useParams()\n  const { fetchDashboardOverview, fetchWalletData } = useSellerApi()\n  const [activeTab, setActiveTab] = useState('overview')\n  const welcomeName = (profile?.name || sellerSnapshot.profile.name || 'Seller').split(' ')[0]\n  const { success, error, info, warning } = useToast()\n  const [searchMounted, setSearchMounted] = useState(false)\n  const [searchOpen, setSearchOpen] = useState(false)\n  const [searchQuery, setSearchQuery] = useState('')\n  const searchInputRef = useRef(null)\n  const [activePanel, setActivePanel] = useState(null)\n  const [panelMounted, setPanelMounted] = useState(false)\n\n  // Valid tabs for navigation\n  const validTabs = ['overview', 'referrals', 'wallet', 'announcements', 'profile', 'performance']\n\n  // Initialize tab from URL parameter on mount or when URL changes\n  useEffect(() => {\n    const tab = urlTab || 'overview'\n    if (validTabs.includes(tab)) {\n      setActiveTab(tab)\n      // Close panels when navigating to a different tab\n      setActivePanel(null)\n    } else {\n      // Invalid tab, redirect to overview\n      navigate('/seller/dashboard/overview', { replace: true })\n    }\n  }, [urlTab, navigate])\n\n  // Navigate function that updates both state and URL\n  const navigateToTab = useCallback((tab) => {\n    if (validTabs.includes(tab)) {\n      setActiveTab(tab)\n      navigate(`/seller/dashboard/${tab}`, { replace: false })\n      // Close panels when navigating\n      setActivePanel(null)\n    }\n  }, [navigate])\n\n  // Scroll to top when tab changes\n  useEffect(() => {\n    window.scrollTo(0, 0)\n  }, [activeTab])\n\n  // Initialize seller data if not present\n  useEffect(() => {\n    if (!profile.name || profile.name === 'Guest Seller') {\n      dispatch({\n        type: 'AUTH_LOGIN',\n        payload: sellerSnapshot.profile,\n      })\n    }\n    // Initialize notifications if empty\n    if (notifications.length === 0 && sellerSnapshot.announcements.length > 0) {\n      sellerSnapshot.announcements.forEach((announcement) => {\n        dispatch({ type: 'ADD_NOTIFICATION', payload: { ...announcement, read: announcement.read } })\n      })\n    }\n  }, [dispatch, profile, notifications.length])\n\n  const handleLogout = () => {\n    dispatch({ type: 'AUTH_LOGOUT' })\n    onLogout?.()\n  }\n\n  const navigateTo = (target) => {\n    navigateToTab(target)\n  }\n\n  const buildMenuItems = (close) => [\n    ...NAV_ITEMS.map((item) => ({\n      id: item.id,\n      label: item.label,\n      description: item.description,\n      icon: <item.icon className=\"h-4 w-4\" />,\n      onSelect: () => {\n        navigateToTab(item.id)\n        close()\n      },\n    })),\n    {\n      id: 'logout',\n      label: 'Sign out',\n      icon: <MenuIcon className=\"h-4 w-4\" />,\n      description: 'Log out from IRA Partner account',\n      onSelect: () => {\n        handleLogout()\n        close()\n      },\n    },\n  ]\n\n  const openSearch = () => {\n    setSearchMounted(true)\n    requestAnimationFrame(() => setSearchOpen(true))\n  }\n\n  const closeSearch = () => {\n    setSearchOpen(false)\n    setTimeout(() => {\n      setSearchMounted(false)\n      setSearchQuery('')\n    }, 260)\n  }\n\n  useEffect(() => {\n    if (searchOpen && searchInputRef.current) {\n      searchInputRef.current.focus()\n      searchInputRef.current.select()\n    }\n  }, [searchOpen])\n\n  const [panelData, setPanelData] = useState({})\n\n  const handlePanelAction = (actionType, data) => {\n    switch (actionType) {\n      case 'share-seller-id':\n        setPanelMounted(true)\n        requestAnimationFrame(() => setActivePanel('share-seller-id'))\n        break\n      case 'request-withdrawal':\n        const wallet = dashboard.wallet || {}\n        const balance = data?.availableBalance !== undefined \n          ? data.availableBalance \n          : (typeof wallet.balance === 'number' ? wallet.balance : parseFloat((wallet.balance || '0').toString().replace(/[â‚¹,\\s]/g, '')) || 0)\n          setPanelData(data || {})\n          setPanelMounted(true)\n          requestAnimationFrame(() => setActivePanel('request-withdrawal'))\n        break\n      case 'add-bank-account':\n      case 'edit-bank-account':\n      case 'delete-bank-account':\n        setPanelData(data || {})\n        setPanelMounted(true)\n        requestAnimationFrame(() => setActivePanel(actionType))\n        break\n      case 'view-performance':\n        navigateToTab('performance')\n        break\n      default:\n        break\n    }\n  }\n\n  const closePanel = () => {\n    setActivePanel(null)\n    setTimeout(() => {\n      setPanelMounted(false)\n    }, 260)\n  }\n\n  const handleWithdrawalSuccess = async (data) => {\n    success(`Withdrawal request of â‚¹${data.amount.toLocaleString('en-IN')} submitted successfully!`)\n    // Refresh wallet data and dashboard\n    await fetchWalletData()\n    await fetchDashboardOverview()\n    // Navigate to wallet tab if not already there\n    if (activeTab !== 'wallet') {\n      navigateToTab('wallet')\n    }\n  }\n\n  const handleShareCopy = (text) => {\n    success('Copied to clipboard!')\n  }\n\n  const handleBankAccountSuccess = async (bankAccount) => {\n    success('Bank account added successfully!')\n    // Refresh wallet data and dashboard\n    await fetchWalletData()\n    await fetchDashboardOverview()\n    // Trigger refresh in WalletView\n    window.dispatchEvent(new CustomEvent('seller-refresh-bank-accounts'))\n    // Navigate to wallet tab if not already there\n    if (activeTab !== 'wallet') {\n      navigateToTab('wallet')\n    }\n  }\n\n  const unreadNotificationsCount = useMemo(() => (notifications || []).filter((n) => !n.read).length, [notifications])\n  const [isNotificationAnimating, setIsNotificationAnimating] = useState(false)\n  const [notificationPanelOpen, setNotificationPanelOpen] = useState(false)\n  const previousNotificationsCountRef = useRef(0)\n\n  // Play notification sound\n  const playNotificationSound = useCallback(() => {\n    try {\n      // Create a simple notification sound using Web Audio API\n      const audioContext = new (window.AudioContext || window.webkitAudioContext)()\n      const oscillator = audioContext.createOscillator()\n      const gainNode = audioContext.createGain()\n\n      oscillator.connect(gainNode)\n      gainNode.connect(audioContext.destination)\n\n      oscillator.frequency.value = 800\n      oscillator.type = 'sine'\n\n      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime)\n      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3)\n\n      oscillator.start(audioContext.currentTime)\n      oscillator.stop(audioContext.currentTime + 0.3)\n    } catch (err) {\n      // Fallback: try HTML5 audio if Web Audio API is not available\n      console.log('Notification sound played (fallback)')\n    }\n  }, [])\n\n  // Trigger bell animation and sound when new notification arrives\n  useEffect(() => {\n    const currentUnreadCount = unreadNotificationsCount\n    const previousUnreadCount = previousNotificationsCountRef.current\n\n    if (currentUnreadCount > previousUnreadCount) {\n      // New notification arrived\n      playNotificationSound()\n      setIsNotificationAnimating(true)\n      \n      // Stop animation after 3 seconds\n      const animationTimer = setTimeout(() => {\n        setIsNotificationAnimating(false)\n      }, 3000)\n\n      return () => clearTimeout(animationTimer)\n    }\n\n    previousNotificationsCountRef.current = currentUnreadCount\n  }, [unreadNotificationsCount, playNotificationSound])\n\n  // Handle notification panel open/close\n  const handleNotificationClick = () => {\n    setNotificationPanelOpen(true)\n  }\n\n  const handleNotificationPanelClose = () => {\n    setNotificationPanelOpen(false)\n  }\n\n  // Mark notification as read\n  const handleMarkNotificationAsRead = useCallback((notificationId) => {\n    dispatch({ type: 'MARK_NOTIFICATION_READ', payload: { id: notificationId } })\n  }, [dispatch])\n\n  // Mark all notifications as read\n  const handleMarkAllNotificationsAsRead = useCallback(() => {\n    dispatch({ type: 'MARK_ALL_NOTIFICATIONS_READ' })\n  }, [dispatch])\n  \n  const tabLabels = useMemo(() => {\n    return NAV_ITEMS.reduce((acc, item) => {\n      acc[item.id] = item.label\n      return acc\n    }, {})\n  }, [])\n  \n  const searchCatalog = useMemo(\n    () =>\n      [\n        {\n          id: 'search-overview-hero',\n          label: 'My Earnings',\n          keywords: ['earnings', 'wallet', 'balance', 'money', 'income', 'revenue'],\n          tab: 'overview',\n          targetId: 'seller-overview-hero',\n        },\n        {\n          id: 'search-overview-services',\n          label: 'Quick Actions',\n          keywords: ['actions', 'shortcuts', 'share', 'referrals', 'quick'],\n          tab: 'overview',\n          targetId: 'seller-overview-services',\n        },\n        {\n          id: 'search-overview-activity',\n          label: 'Recent Activity',\n          keywords: ['activity', 'recent', 'transactions', 'updates', 'history'],\n          tab: 'overview',\n          targetId: 'seller-overview-activity',\n        },\n        {\n          id: 'search-overview-snapshot',\n          label: 'My Stats',\n          keywords: ['stats', 'summary', 'metrics', 'numbers', 'performance'],\n          tab: 'overview',\n          targetId: 'seller-overview-snapshot',\n        },\n        {\n          id: 'search-overview-target',\n          label: 'My Target',\n          keywords: ['target', 'goal', 'progress', 'monthly', 'aim'],\n          tab: 'overview',\n          targetId: 'seller-target-progress',\n        },\n        {\n          id: 'search-referrals',\n          label: 'My Referrals',\n          keywords: ['referrals', 'users', 'people', 'commission', 'sales'],\n          tab: 'referrals',\n          targetId: null,\n        },\n        {\n          id: 'search-wallet',\n          label: 'My Wallet',\n          keywords: ['wallet', 'balance', 'money', 'transactions', 'withdrawal', 'commission'],\n          tab: 'wallet',\n          targetId: null,\n        },\n        {\n          id: 'search-announcements',\n          label: 'Updates',\n          keywords: ['updates', 'announcements', 'news', 'notifications', 'messages'],\n          tab: 'announcements',\n          targetId: null,\n        },\n        {\n          id: 'search-performance',\n          label: 'My Performance',\n          keywords: ['performance', 'reports', 'analytics', 'insights', 'progress'],\n          tab: 'performance',\n          targetId: null,\n        },\n        {\n          id: 'search-profile',\n          label: 'My Profile',\n          keywords: ['profile', 'account', 'settings', 'seller id', 'info'],\n          tab: 'profile',\n          targetId: null,\n        },\n      ].map((item) => ({\n        ...item,\n        tabLabel: tabLabels[item.tab],\n      })),\n    [tabLabels],\n  )\n  \n  const [pendingScroll, setPendingScroll] = useState(null)\n  \n  const searchResults = useMemo(() => {\n    const query = searchQuery.trim().toLowerCase()\n    if (!query) {\n      return searchCatalog.slice(0, 7)\n    }\n    const tokens = query.split(/\\s+/).filter(Boolean)\n    const results = searchCatalog\n      .map((item) => {\n        const haystack = `${item.label} ${item.tabLabel} ${item.keywords.join(' ')}`.toLowerCase()\n        const directIndex = haystack.indexOf(query)\n        const directScore = directIndex >= 0 ? 200 - directIndex : 0\n        const tokenScore = tokens.reduce((score, token) => (haystack.includes(token) ? score + 20 : score), 0)\n        const score = directScore + tokenScore\n        return { ...item, score }\n      })\n      .filter((item) => item.score > 0)\n      .sort((a, b) => b.score - a.score)\n    return results.length ? results : searchCatalog.slice(0, 5)\n  }, [searchCatalog, searchQuery])\n  \n  const handleSearchNavigate = (item) => {\n    if (!item) return\n    const delay = item.tab === activeTab ? 150 : 420\n    navigateToTab(item.tab)\n    if (item.targetId) {\n      setPendingScroll({ id: item.targetId, delay })\n    }\n    closeSearch()\n  }\n  \n  const handleSearchSubmit = () => {\n    if (searchResults.length) {\n      handleSearchNavigate(searchResults[0])\n    } else {\n      closeSearch()\n    }\n  }\n  \n  useEffect(() => {\n    if (!pendingScroll) return\n    const { id, delay } = pendingScroll\n    const timer = setTimeout(() => {\n      const element = document.getElementById(id)\n      if (element) {\n        element.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' })\n      }\n      setPendingScroll(null)\n    }, delay)\n    return () => clearTimeout(timer)\n  }, [pendingScroll, activeTab])\n\n  return (\n    <>\n      <MobileShell\n        title={`Hello ${welcomeName}`}\n        subtitle={profile.area || profile.location?.area || 'Location not set'}\n        onSearchClick={openSearch}\n        onProfileClick={() => navigateToTab('profile')}\n        onNotificationClick={handleNotificationClick}\n        notificationsCount={unreadNotificationsCount}\n        notifications={notifications}\n        isNotificationAnimating={isNotificationAnimating}\n        navigation={NAV_ITEMS.map((item) => (\n          <BottomNavItem\n            key={item.id}\n            label={item.label}\n            active={activeTab === item.id}\n            onClick={() => navigateToTab(item.id)}\n            icon={<item.icon active={activeTab === item.id} className=\"h-5 w-5\" />}\n          />\n        ))}\n        menuContent={({ close }) => <MenuList items={buildMenuItems(close)} active={activeTab} />}\n      >\n        <section className=\"space-y-6\">\n          {activeTab === 'overview' && (\n            <OverviewView onNavigate={navigateTo} openPanel={handlePanelAction} />\n          )}\n          {activeTab === 'referrals' && <ReferralsView onNavigate={navigateTo} />}\n          {activeTab === 'wallet' && <WalletView openPanel={handlePanelAction} />}\n          {activeTab === 'announcements' && <AnnouncementsView />}\n          {activeTab === 'performance' && (\n            <PerformanceView onBack={() => navigateToTab('overview')} />\n          )}\n          {activeTab === 'profile' && <ProfileView onLogout={handleLogout} onNavigate={navigateTo} />}\n        </section>\n      </MobileShell>\n\n      {searchMounted ? (\n        <div className={cn('seller-search-sheet', searchOpen && 'is-open')}>\n          <div className={cn('seller-search-sheet__overlay', searchOpen && 'is-open')} onClick={closeSearch} />\n          <div className={cn('seller-search-sheet__panel', searchOpen && 'is-open')}>\n            <div className=\"seller-search-sheet__header\">\n              <input\n                ref={searchInputRef}\n                value={searchQuery}\n                onChange={(event) => setSearchQuery(event.target.value)}\n                onKeyDown={(event) => {\n                  if (event.key === 'Enter') {\n                    event.preventDefault()\n                    handleSearchSubmit()\n                  }\n                  if (event.key === 'Escape') {\n                    event.preventDefault()\n                    closeSearch()\n                  }\n                }}\n                placeholder=\"Search for referrals, wallet, earnings...\"\n                className=\"seller-search-input\"\n                aria-label=\"Search seller console\"\n              />\n              <button type=\"button\" className=\"seller-search-cancel\" onClick={closeSearch}>\n                Cancel\n              </button>\n            </div>\n            <div className=\"seller-search-sheet__body\">\n              {searchResults.length ? (\n                searchResults.map((item) => (\n                  <button\n                    key={item.id}\n                    type=\"button\"\n                    onClick={() => handleSearchNavigate(item)}\n                    className=\"seller-search-result\"\n                  >\n                    <span className=\"seller-search-result__label\">{item.label}</span>\n                    <span className=\"seller-search-result__meta\">{item.tabLabel}</span>\n                  </button>\n                ))\n              ) : (\n                <p className=\"seller-search-empty\">No matches yet. Try another keyword.</p>\n              )}\n            </div>\n          </div>\n        </div>\n      ) : null}\n\n      {/* Action Panels */}\n      {panelMounted && (\n        <>\n          {activePanel === 'request-withdrawal' && (\n            <WithdrawalRequestPanel\n              isOpen={activePanel === 'request-withdrawal'}\n              onClose={closePanel}\n              onSuccess={handleWithdrawalSuccess}\n              availableBalance={panelData.availableBalance}\n              bankAccounts={panelData.bankAccounts || []}\n            />\n          )}\n          {activePanel === 'share-seller-id' && (\n            <ShareSellerIdPanel\n              isOpen={activePanel === 'share-seller-id'}\n              onClose={closePanel}\n              onCopy={handleShareCopy}\n            />\n          )}\n          {activePanel === 'add-bank-account' && (\n            <BankAccountForm\n              isOpen={activePanel === 'add-bank-account'}\n              onClose={closePanel}\n              onSuccess={handleBankAccountSuccess}\n            />\n          )}\n        </>\n      )}\n\n      {/* Notification Panel */}\n      <NotificationPanel\n        isOpen={notificationPanelOpen}\n        onClose={handleNotificationPanelClose}\n        notifications={notifications}\n        onMarkAsRead={handleMarkNotificationAsRead}\n        onMarkAllAsRead={handleMarkAllNotificationsAsRead}\n      />\n    </>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\SellerLogin.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":172,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":172,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\nimport * as sellerApi from '../services/sellerApi'\nimport { useSellerDispatch } from '../context/SellerContext'\n\nexport function SellerLogin({ onSuccess, onSubmit, onSwitchToRegister }) {\n  const [step, setStep] = useState('phone') // 'phone' | 'otp' | 'pending'\n  const [form, setForm] = useState({ phone: '' })\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n  const [sellerId, setSellerId] = useState(null)\n  const dispatch = useSellerDispatch()\n\n  // OTP bypass configuration for specific test seller\n  const BYPASS_PHONE = '9981331318'\n  const BYPASS_OTP = '123456'\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setForm((prev) => ({ ...prev, [name]: value }))\n    setError(null)\n  }\n\n  const handleRequestOtp = async (e) => {\n    e.preventDefault()\n    setError(null)\n    setLoading(true)\n\n    try {\n      if (!form.phone.trim()) {\n        setError('Contact number is required')\n        setLoading(false)\n        return\n      }\n      if (form.phone.length < 10) {\n        setError('Please enter a valid contact number')\n        setLoading(false)\n        return\n      }\n\n      // Bypass OTP screen for the configured seller phone\n      if (form.phone === BYPASS_PHONE) {\n        try {\n          const result = await sellerApi.loginSellerWithOtp({ phone: form.phone, otp: BYPASS_OTP })\n\n          if (result.success || result.data) {\n            // Check if seller requires approval (pending status)\n            if (result.data?.requiresApproval || result.data?.seller?.status === 'pending') {\n              setSellerId(result.data?.seller?.sellerId || result.data?.sellerId)\n              setStep('pending')\n              return\n            }\n\n            // Check if seller is rejected\n            if (result.data?.seller?.status === 'rejected') {\n              setError('Your account has been rejected by the admin. Please contact support.')\n              return\n            }\n\n            // If approved, proceed with login\n            if (result.data?.token) {\n              localStorage.setItem('seller_token', result.data.token)\n            }\n\n            // Update context with seller data\n            if (result.data?.seller) {\n              dispatch({\n                type: 'AUTH_LOGIN',\n                payload: {\n                  id: result.data.seller.id || result.data.seller._id,\n                  name: result.data.seller.name,\n                  phone: result.data.seller.phone,\n                  sellerId: result.data.seller.sellerId,\n                  area: result.data.seller.area,\n                  status: result.data.seller.status,\n                  isActive: result.data.seller.isActive,\n                },\n              })\n            }\n\n            // Call both onSuccess and onSubmit for backward compatibility\n            onSuccess?.(result.data?.seller || { phone: form.phone })\n            onSubmit?.(result.data?.seller || { phone: form.phone })\n          } else {\n            setError(result.error?.message || 'Failed to login with bypass OTP. Please try again.')\n          }\n        } catch (err) {\n          setError(err.message || 'Failed to login with bypass OTP. Please try again.')\n        } finally {\n          setLoading(false)\n        }\n\n        // Stop normal OTP flow for this phone\n        return\n      }\n\n      const result = await sellerApi.requestSellerOTP({ phone: form.phone })\n      \n      if (result.success || result.data) {\n        setStep('otp')\n      } else {\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Failed to send OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleVerifyOtp = async (otpCode) => {\n    setError(null)\n    setLoading(true)\n\n    try {\n      const result = await sellerApi.loginSellerWithOtp({ phone: form.phone, otp: otpCode })\n\n      if (result.success || result.data) {\n        // Check if seller requires approval (pending status)\n        if (result.data?.requiresApproval || result.data?.seller?.status === 'pending') {\n          setSellerId(result.data?.seller?.sellerId || result.data?.sellerId)\n          setStep('pending')\n          setLoading(false)\n          return\n        }\n\n        // Check if seller is rejected\n        if (result.data?.seller?.status === 'rejected') {\n          setError('Your account has been rejected by the admin. Please contact support.')\n          setLoading(false)\n          return\n        }\n\n        // If approved, proceed with login\n        if (result.data?.token) {\n          localStorage.setItem('seller_token', result.data.token)\n        }\n        \n        // Update context with seller data\n        if (result.data?.seller) {\n          dispatch({\n            type: 'AUTH_LOGIN',\n            payload: {\n              id: result.data.seller.id || result.data.seller._id,\n              name: result.data.seller.name,\n              phone: result.data.seller.phone,\n              sellerId: result.data.seller.sellerId,\n              area: result.data.seller.area,\n              status: result.data.seller.status,\n              isActive: result.data.seller.isActive,\n            },\n          })\n        }\n        \n        // Call both onSuccess and onSubmit for backward compatibility\n        onSuccess?.(result.data?.seller || { phone: form.phone })\n        onSubmit?.(result.data?.seller || { phone: form.phone })\n      } else {\n        setError(result.error?.message || 'Invalid OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Verification failed. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleResendOtp = async () => {\n    setLoading(true)\n    try {\n      await sellerApi.requestSellerOTP({ phone: form.phone })\n    } catch (err) {\n      setError('Failed to resend OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (step === 'pending') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"text-center space-y-2\">\n            <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-yellow-100 mb-4\">\n              <svg className=\"w-8 h-8 text-yellow-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n              </svg>\n            </div>\n            <p className=\"text-xs uppercase tracking-wide text-yellow-600 font-semibold\">Account Pending</p>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Awaiting Admin Approval</h1>\n          </div>\n\n          <div className=\"rounded-3xl border border-yellow-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <div className=\"space-y-6 text-center\">\n              <div className=\"space-y-3\">\n                <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-yellow-50\">\n                  <svg className=\"w-10 h-10 text-yellow-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                  </svg>\n                </div>\n                <div>\n                  <h2 className=\"text-lg font-bold text-gray-900 mb-2\">Your Account is Pending Approval</h2>\n                  {sellerId && (\n                    <p className=\"text-sm text-gray-600 mb-4\">\n                      Your Seller ID: <span className=\"font-bold text-green-600\">{sellerId}</span>\n                    </p>\n                  )}\n                  <p className=\"text-sm text-gray-700 leading-relaxed\">\n                    Your account is currently pending admin approval. You will be able to access your dashboard once the admin approves your request.\n                  </p>\n                  <p className=\"text-sm text-gray-700 leading-relaxed mt-3\">\n                    We'll notify you once your account is activated.\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"pt-4 border-t border-gray-200\">\n                <button\n                  type=\"button\"\n                  onClick={onSwitchToRegister}\n                  className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all\"\n                >\n                  Go Back to Login\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (step === 'otp') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <OtpVerification\n              phone={form.phone}\n              onVerify={handleVerifyOtp}\n              onResend={handleResendOtp}\n              onBack={() => setStep('phone')}\n              loading={loading}\n              error={error}\n              userType=\"seller\"\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4\">\n            <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n            </svg>\n          </div>\n          <p className=\"text-xs uppercase tracking-wide text-green-600 font-semibold\">IRA Partner Access</p>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Sign in to IRA Partner Dashboard</h1>\n          <p className=\"text-sm text-gray-600\">Enter your contact number to continue</p>\n        </div>\n\n        <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\n            {error && (\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\n                <p className=\"text-sm text-red-600\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"seller-login-phone\" className=\"text-xs font-semibold text-gray-700\">\n                Contact Number <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"seller-login-phone\"\n                name=\"phone\"\n                type=\"tel\"\n                required\n                value={form.phone}\n                onChange={handleChange}\n                placeholder=\"+91 90000 00000\"\n                maxLength={15}\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? 'Sending OTP...' : 'Continue'}\n            </button>\n\n            <div className=\"text-center text-sm\">\n              <span className=\"text-gray-600\">Don't have an account? </span>\n              <button\n                type=\"button\"\n                onClick={onSwitchToRegister}\n                className=\"text-green-600 font-semibold hover:underline\"\n              >\n                Sign up\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\SellerRegister.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":166,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":166,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\nimport * as sellerApi from '../services/sellerApi'\nimport { useSellerDispatch } from '../context/SellerContext'\n\nexport function SellerRegister({ onSuccess, onSubmit, onSwitchToLogin }) {\n  const [step, setStep] = useState('register') // 'register' | 'otp' | 'pending'\n  const [form, setForm] = useState({\n    fullName: '',\n    contact: '',\n    address: '',\n    city: '',\n    state: '',\n    pincode: '',\n  })\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n  const [sellerId, setSellerId] = useState(null)\n  const dispatch = useSellerDispatch()\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setForm((prev) => ({ ...prev, [name]: value }))\n    setError(null)\n  }\n\n  const handleRequestOtp = async (e) => {\n    e.preventDefault()\n    setError(null)\n    setLoading(true)\n\n    try {\n      if (!form.fullName.trim()) {\n        setError('Full name is required')\n        setLoading(false)\n        return\n      }\n      if (!form.contact.trim()) {\n        setError('Contact number is required')\n        setLoading(false)\n        return\n      }\n      if (form.contact.length < 10) {\n        setError('Please enter a valid contact number')\n        setLoading(false)\n        return\n      }\n      if (!form.address.trim()) {\n        setError('Address is required')\n        setLoading(false)\n        return\n      }\n      if (!form.city.trim()) {\n        setError('City is required')\n        setLoading(false)\n        return\n      }\n      if (!form.state.trim()) {\n        setError('State is required')\n        setLoading(false)\n        return\n      }\n      if (!form.pincode.trim() || form.pincode.length !== 6) {\n        setError('Please enter a valid 6-digit pincode')\n        setLoading(false)\n        return\n      }\n\n      // Call register endpoint which generates sellerId and sends OTP\n      const result = await sellerApi.registerSeller({\n        fullName: form.fullName,\n        phone: form.contact,\n        area: form.address || '',\n        location: {\n          address: form.address || '',\n          city: form.city || '',\n          state: form.state || '',\n          pincode: form.pincode || '',\n        },\n      })\n      \n      if (result.success || result.data) {\n        setStep('otp')\n        // Show sellerId if generated\n        if (result.data?.sellerId) {\n          console.log('Seller ID generated:', result.data.sellerId)\n        }\n      } else {\n        setError(result.error?.message || 'Failed to register. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Failed to register. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleVerifyOtp = async (otpCode) => {\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Call verifyOTP endpoint to complete registration\n      const result = await sellerApi.loginSellerWithOtp({\n        phone: form.contact,\n        otp: otpCode,\n      })\n\n      if (result.success || result.data) {\n        // Check if seller requires approval\n        if (result.data?.requiresApproval || result.data?.seller?.status === 'pending') {\n          setSellerId(result.data?.seller?.sellerId || result.data?.sellerId)\n          setStep('pending')\n          return\n        }\n\n        // If approved, proceed with login\n        if (result.data?.token) {\n          localStorage.setItem('seller_token', result.data.token)\n        }\n        \n        // Update context with seller data\n        if (result.data?.seller) {\n          dispatch({\n            type: 'AUTH_LOGIN',\n            payload: {\n              id: result.data.seller.id || result.data.seller._id,\n              name: result.data.seller.name,\n              phone: result.data.seller.phone,\n              sellerId: result.data.seller.sellerId,\n              area: result.data.seller.area,\n              status: result.data.seller.status,\n              isActive: result.data.seller.isActive,\n            },\n          })\n        }\n        \n        // Call both onSuccess and onSubmit for backward compatibility\n        onSuccess?.(result.data?.seller || { name: form.fullName, phone: form.contact })\n        onSubmit?.(result.data?.seller || { name: form.fullName, phone: form.contact })\n      } else {\n        setError(result.error?.message || 'Invalid OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Verification failed. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleResendOtp = async () => {\n    setLoading(true)\n    try {\n      // Resend OTP by calling register again (will regenerate OTP for existing seller)\n      await sellerApi.registerSeller({\n        fullName: form.fullName,\n        phone: form.contact,\n        area: form.address || '',\n        location: {\n          address: form.address || '',\n          city: form.city || '',\n          state: form.state || '',\n          pincode: form.pincode || '',\n        },\n      })\n    } catch (err) {\n      setError('Failed to resend OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (step === 'pending') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"text-center space-y-2\">\n            <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-yellow-100 mb-4\">\n              <svg className=\"w-8 h-8 text-yellow-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n              </svg>\n            </div>\n            <p className=\"text-xs uppercase tracking-wide text-yellow-600 font-semibold\">Registration Successful</p>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Awaiting Admin Approval</h1>\n          </div>\n\n          <div className=\"rounded-3xl border border-yellow-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <div className=\"space-y-6 text-center\">\n              <div className=\"space-y-3\">\n                <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-yellow-50\">\n                  <svg className=\"w-10 h-10 text-yellow-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                  </svg>\n                </div>\n                <div>\n                  <h2 className=\"text-lg font-bold text-gray-900 mb-2\">Your Registration is Complete!</h2>\n                  {sellerId && (\n                    <p className=\"text-sm text-gray-600 mb-4\">\n                      Your Seller ID: <span className=\"font-bold text-green-600\">{sellerId}</span>\n                    </p>\n                  )}\n                  <p className=\"text-sm text-gray-700 leading-relaxed\">\n                    Your account has been created successfully. However, your account is currently pending admin approval.\n                  </p>\n                  <p className=\"text-sm text-gray-700 leading-relaxed mt-3\">\n                    You will be able to access your dashboard once the admin approves your request. We'll notify you once your account is activated.\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"pt-4 border-t border-gray-200\">\n                <button\n                  type=\"button\"\n                  onClick={onSwitchToLogin}\n                  className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all\"\n                >\n                  Go Back to Login\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (step === 'otp') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <OtpVerification\n              phone={form.contact}\n              onVerify={handleVerifyOtp}\n              onResend={handleResendOtp}\n              onBack={() => setStep('register')}\n              loading={loading}\n              error={error}\n              userType=\"seller\"\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4\">\n            <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n            </svg>\n          </div>\n          <p className=\"text-xs uppercase tracking-wide text-green-600 font-semibold\">IRA Partner Registration</p>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Join as IRA Partner</h1>\n          <p className=\"text-sm text-gray-600\">Start earning commissions by referring farmers</p>\n        </div>\n\n        <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\n            {error && (\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\n                <p className=\"text-sm text-red-600\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"seller-register-fullName\" className=\"text-xs font-semibold text-gray-700\">\n                Full Name <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"seller-register-fullName\"\n                name=\"fullName\"\n                type=\"text\"\n                required\n                value={form.fullName}\n                onChange={handleChange}\n                placeholder=\"Enter your full name\"\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"seller-register-contact\" className=\"text-xs font-semibold text-gray-700\">\n                Contact Number <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"seller-register-contact\"\n                name=\"contact\"\n                type=\"tel\"\n                required\n                value={form.contact}\n                onChange={handleChange}\n                placeholder=\"+91 90000 00000\"\n                maxLength={15}\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"seller-register-address\" className=\"text-xs font-semibold text-gray-700\">\n                Address <span className=\"text-red-500\">*</span>\n              </label>\n              <textarea\n                id=\"seller-register-address\"\n                name=\"address\"\n                required\n                value={form.address}\n                onChange={handleChange}\n                placeholder=\"Enter your full address\"\n                rows={3}\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all resize-none\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-1.5\">\n                <label htmlFor=\"seller-register-city\" className=\"text-xs font-semibold text-gray-700\">\n                  City <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  id=\"seller-register-city\"\n                  name=\"city\"\n                  type=\"text\"\n                  required\n                  value={form.city}\n                  onChange={handleChange}\n                  placeholder=\"City\"\n                  className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n                />\n              </div>\n\n              <div className=\"space-y-1.5\">\n                <label htmlFor=\"seller-register-state\" className=\"text-xs font-semibold text-gray-700\">\n                  State <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  id=\"seller-register-state\"\n                  name=\"state\"\n                  type=\"text\"\n                  required\n                  value={form.state}\n                  onChange={handleChange}\n                  placeholder=\"State\"\n                  className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"seller-register-pincode\" className=\"text-xs font-semibold text-gray-700\">\n                Pincode <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"seller-register-pincode\"\n                name=\"pincode\"\n                type=\"text\"\n                required\n                value={form.pincode}\n                onChange={handleChange}\n                placeholder=\"Pincode\"\n                maxLength={6}\n                pattern=\"[0-9]*\"\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? 'Sending OTP...' : 'Continue'}\n            </button>\n\n            <div className=\"text-center text-sm\">\n              <span className=\"text-gray-600\">Already have an account? </span>\n              <button\n                type=\"button\"\n                onClick={onSwitchToLogin}\n                className=\"text-green-600 font-semibold hover:underline\"\n              >\n                Sign in\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\views\\AnnouncementsView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\views\\OverviewView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\views\\PerformanceView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[173,212],"text":""},"desc":"Remove unused variable 'cn'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'profile' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":9,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"profile"},"fix":{"range":[428,437],"text":""},"desc":"Remove unused variable 'profile'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'fetchPerformance' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":10,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[590,597],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'overview' logical expression could make the dependencies of useMemo Hook (at line 88) change on every render. Move it inside the useMemo callback. Alternatively, wrap the initialization of 'overview' in its own useMemo() Hook.","line":14,"column":9,"nodeType":"VariableDeclarator","endLine":14,"endColumn":44}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo, useEffect, useState } from 'react'\r\nimport { useSellerState } from '../../context/SellerContext'\r\nimport { useSellerApi } from '../../hooks/useSellerApi'\r\nimport { cn } from '../../../../lib/cn'\r\nimport { TrendingUpIcon, UsersIcon, WalletIcon, CloseIcon } from '../../components/icons'\r\nimport * as sellerApi from '../../services/sellerApi'\r\n\r\nexport function PerformanceView({ onBack }) {\r\n  const { dashboard, profile } = useSellerState()\r\n  const { fetchPerformance } = useSellerApi()\r\n  const [performanceAnalytics, setPerformanceAnalytics] = useState(null)\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  const overview = dashboard.overview || {}\r\n\r\n  // Fetch performance analytics on mount\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setLoading(true)\r\n      try {\r\n        const result = await sellerApi.getPerformanceAnalytics({ period: '30' })\r\n        if (result.success && result.data?.analytics) {\r\n          setPerformanceAnalytics(result.data.analytics)\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to fetch performance analytics:', error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n    fetchData()\r\n  }, [])\r\n\r\n  // Calculate performance metrics from real data\r\n  // Priority: Use backend analytics if available, otherwise calculate from overview\r\n  const performanceData = useMemo(() => {\r\n    // If backend analytics are available, use them\r\n    if (performanceAnalytics) {\r\n      return {\r\n        totalSales: performanceAnalytics.totalSales || overview.currentMonthSales || 0,\r\n        thisMonthSales: performanceAnalytics.currentMonthSales || overview.currentMonthSales || 0,\r\n        totalReferrals: performanceAnalytics.totalReferrals || overview.totalReferrals || 0,\r\n        activeReferrals: performanceAnalytics.activeReferrals || overview.activeReferrals || 0,\r\n        avgCommissionPerSale: performanceAnalytics.avgCommissionPerSale || 0,\r\n        conversionRate: performanceAnalytics.conversionRate || 0,\r\n        orderCount: performanceAnalytics.orderCount || overview.currentMonthOrders || 0,\r\n        averageOrderValue: performanceAnalytics.averageOrderValue || overview.averageOrderValue || 0,\r\n        totalCommission: performanceAnalytics.totalCommission || 0,\r\n        commissionRate2Percent: performanceAnalytics.commissionRate2Percent || 0,\r\n        commissionRate3Percent: performanceAnalytics.commissionRate3Percent || 0,\r\n        topUsers: performanceAnalytics.topUsers || [],\r\n        weeklyTrend: performanceAnalytics.weeklyTrend || [],\r\n      }\r\n    }\r\n\r\n    // Fallback: Calculate from overview data\r\n    const totalSales = overview.currentMonthSales || 0\r\n    const thisMonthSales = overview.currentMonthSales || 0\r\n    const totalReferrals = overview.totalReferrals || 0\r\n    const activeReferrals = overview.activeReferrals || 0\r\n\r\n    // Calculate average commission per sale (assuming 2-3% commission)\r\n    const avgCommissionRate = 0.025 // Average of 2% and 3%\r\n    const avgCommissionPerSale = totalSales > 0 && overview.currentMonthOrders > 0\r\n      ? (totalSales * avgCommissionRate) / overview.currentMonthOrders\r\n      : 0\r\n\r\n    // Calculate conversion rate (active referrals / total referrals)\r\n    const conversionRate = totalReferrals > 0\r\n      ? (activeReferrals / totalReferrals) * 100\r\n      : 0\r\n\r\n    return {\r\n      totalSales,\r\n      thisMonthSales,\r\n      totalReferrals,\r\n      activeReferrals,\r\n      avgCommissionPerSale: Math.round(avgCommissionPerSale * 100) / 100,\r\n      conversionRate: Math.round(conversionRate * 100) / 100,\r\n      orderCount: overview.currentMonthOrders || 0,\r\n      averageOrderValue: overview.averageOrderValue || 0,\r\n      totalCommission: totalSales * avgCommissionRate,\r\n      commissionRate2Percent: 0,\r\n      commissionRate3Percent: 0,\r\n      topUsers: [],\r\n      weeklyTrend: [],\r\n    }\r\n  }, [overview, performanceAnalytics])\r\n\r\n  const formatCurrency = (value) => {\r\n    if (value >= 100000) {\r\n      return `â‚¹${(value / 100000).toFixed(1)}L`\r\n    }\r\n    return `â‚¹${value.toLocaleString('en-IN')}`\r\n  }\r\n\r\n  return (\r\n    <div className=\"seller-performance space-y-6\">\r\n      {/* Hero Section */}\r\n      <section id=\"seller-performance-hero\" className=\"seller-performance-hero\">\r\n        <div className=\"seller-performance-hero__card\">\r\n          <div className=\"seller-performance-hero__header\">\r\n            <div>\r\n              <h2 className=\"seller-performance-hero__title\">Performance Analytics</h2>\r\n              <p className=\"seller-performance-hero__subtitle\">Detailed insights into your sales performance</p>\r\n            </div>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n              {onBack && (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={onBack}\r\n                  className=\"seller-performance-hero__back\"\r\n                  aria-label=\"Back to overview\"\r\n                >\r\n                  <CloseIcon className=\"h-5 w-5 text-white rotate-45\" />\r\n                </button>\r\n              )}\r\n              <div className=\"seller-performance-hero__badge\">\r\n                <TrendingUpIcon className=\"h-6 w-6 text-white\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Key Metrics - Enhanced with better visuals */}\r\n      <section id=\"seller-performance-metrics\" className=\"seller-section\">\r\n        <div className=\"seller-section__header\">\r\n          <div>\r\n            <h3 className=\"seller-section__title\">Key Metrics</h3>\r\n            <p className=\"seller-section__subtitle\">Your performance at a glance</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"seller-performance-grid\">\r\n          <div className=\"seller-performance-card seller-performance-card--highlight\">\r\n            <div className=\"seller-performance-card__icon seller-performance-card__icon--sales\">\r\n              <TrendingUpIcon className=\"h-5 w-5\" />\r\n            </div>\r\n            <div className=\"seller-performance-card__content\">\r\n              <p className=\"seller-performance-card__label\">Total Sales</p>\r\n              <h4 className=\"seller-performance-card__value\">{formatCurrency(performanceData.totalSales)}</h4>\r\n              <div className=\"seller-performance-card__trend-group\">\r\n                <span className=\"seller-performance-card__trend\">{performanceData.orderCount} orders this month</span>\r\n                {performanceData.averageOrderValue > 0 && (\r\n                  <span className=\"seller-performance-card__trend-secondary\">\r\n                    Avg: {formatCurrency(performanceData.averageOrderValue)}\r\n                  </span>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"seller-performance-card seller-performance-card--referrals\">\r\n            <div className=\"seller-performance-card__icon seller-performance-card__icon--referrals\">\r\n              <UsersIcon className=\"h-5 w-5\" />\r\n            </div>\r\n            <div className=\"seller-performance-card__content\">\r\n              <p className=\"seller-performance-card__label\">Total Referrals</p>\r\n              <h4 className=\"seller-performance-card__value\">{performanceData.totalReferrals}</h4>\r\n              <div className=\"seller-performance-card__trend-group\">\r\n                <span className=\"seller-performance-card__trend seller-performance-card__trend--active\">\r\n                  {performanceData.activeReferrals} active\r\n                </span>\r\n                {performanceData.conversionRate > 0 && (\r\n                  <span className=\"seller-performance-card__trend-secondary\">\r\n                    {performanceData.conversionRate.toFixed(1)}% conversion\r\n                  </span>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"seller-performance-card seller-performance-card--commission\">\r\n            <div className=\"seller-performance-card__icon seller-performance-card__icon--commission\">\r\n              <WalletIcon className=\"h-5 w-5\" />\r\n            </div>\r\n            <div className=\"seller-performance-card__content\">\r\n              <p className=\"seller-performance-card__label\">Total Commission</p>\r\n              <h4 className=\"seller-performance-card__value\">\r\n                {formatCurrency(performanceData.totalCommission || (performanceData.totalSales * 0.025))}\r\n              </h4>\r\n              <div className=\"seller-performance-card__trend-group\">\r\n                <span className=\"seller-performance-card__trend\">\r\n                  Avg: â‚¹{performanceData.avgCommissionPerSale.toLocaleString('en-IN')}/order\r\n                </span>\r\n                {(performanceData.commissionRate2Percent > 0 || performanceData.commissionRate3Percent > 0) && (\r\n                  <span className=\"seller-performance-card__trend-secondary\">\r\n                    {performanceData.commissionRate2Percent > 0 && `${performanceData.commissionRate2Percent} @ 2%`}\r\n                    {performanceData.commissionRate2Percent > 0 && performanceData.commissionRate3Percent > 0 && ' â€¢ '}\r\n                    {performanceData.commissionRate3Percent > 0 && `${performanceData.commissionRate3Percent} @ 3%`}\r\n                  </span>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Sales Summary - Enhanced Visual */}\r\n      <section id=\"seller-performance-breakdown\" className=\"seller-section\">\r\n        <div className=\"seller-section__header\">\r\n          <div>\r\n            <h3 className=\"seller-section__title\">Sales Summary</h3>\r\n            <p className=\"seller-section__subtitle\">This month's sales overview</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"seller-performance-breakdown-card\">\r\n          <div className=\"seller-performance-breakdown-card__header\">\r\n            <div className=\"seller-performance-breakdown-card__target\">\r\n              <TrendingUpIcon className=\"h-5 w-5 text-[#1b8f5b]\" />\r\n              <div>\r\n                <p className=\"seller-performance-breakdown-card__target-label\">Total Sales</p>\r\n                <p className=\"seller-performance-breakdown-card__target-value\">{formatCurrency(performanceData.thisMonthSales)}</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"seller-performance-breakdown-card__progress-badge\">\r\n              <span className=\"seller-performance-breakdown-card__progress-percent\">{performanceData.orderCount}</span>\r\n              <span className=\"seller-performance-breakdown-card__progress-label\">Orders</span>\r\n            </div>\r\n          </div>\r\n          <div className=\"seller-performance-breakdown-card__details\">\r\n            <div className=\"seller-performance-breakdown-card__detail-item seller-performance-breakdown-card__detail-item--achieved\">\r\n              <div className=\"seller-performance-breakdown-card__detail-icon\" style={{ background: 'rgba(27,143,91,0.1)' }}>\r\n                <WalletIcon className=\"h-4 w-4 text-[#1b8f5b]\" />\r\n              </div>\r\n              <div className=\"seller-performance-breakdown-card__detail-content\">\r\n                <p className=\"seller-performance-breakdown-card__detail-label\">Total Commission</p>\r\n                <p className=\"seller-performance-breakdown-card__detail-value\">\r\n                  {formatCurrency(performanceData.totalCommission || (performanceData.totalSales * 0.025))}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div className=\"seller-performance-breakdown-card__detail-item seller-performance-breakdown-card__detail-item--remaining\">\r\n              <div className=\"seller-performance-breakdown-card__detail-icon\" style={{ background: 'rgba(59,130,246,0.1)' }}>\r\n                <TrendingUpIcon className=\"h-4 w-4 text-[#3b82f6]\" />\r\n              </div>\r\n              <div className=\"seller-performance-breakdown-card__detail-content\">\r\n                <p className=\"seller-performance-breakdown-card__detail-label\">Avg Order Value</p>\r\n                <p className=\"seller-performance-breakdown-card__detail-value\">\r\n                  {formatCurrency(performanceData.averageOrderValue || 0)}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Commission Breakdown */}\r\n      {(performanceData.commissionRate2Percent > 0 || performanceData.commissionRate3Percent > 0 || performanceData.totalCommission > 0) && (\r\n        <section id=\"seller-performance-commission\" className=\"seller-section\">\r\n          <div className=\"seller-section__header\">\r\n            <div>\r\n              <h3 className=\"seller-section__title\">Commission Breakdown</h3>\r\n              <p className=\"seller-section__subtitle\">Earnings by commission rate</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"seller-performance-commission-grid\">\r\n            <div className=\"seller-performance-commission-card seller-performance-commission-card--standard\">\r\n              <div className=\"seller-performance-commission-card__header\">\r\n                <WalletIcon className=\"h-5 w-5 text-[#1b8f5b]\" />\r\n                <span className=\"seller-performance-commission-card__rate\">2% Rate</span>\r\n              </div>\r\n              <div className=\"seller-performance-commission-card__content\">\r\n                <p className=\"seller-performance-commission-card__label\">Users at 2%</p>\r\n                <p className=\"seller-performance-commission-card__value\">{performanceData.commissionRate2Percent || 0}</p>\r\n                <p className=\"seller-performance-commission-card__note\">Up to â‚¹50,000/month</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"seller-performance-commission-card seller-performance-commission-card--premium\">\r\n              <div className=\"seller-performance-commission-card__header\">\r\n                <WalletIcon className=\"h-5 w-5 text-[#f97316]\" />\r\n                <span className=\"seller-performance-commission-card__rate\">3% Rate</span>\r\n              </div>\r\n              <div className=\"seller-performance-commission-card__content\">\r\n                <p className=\"seller-performance-commission-card__label\">Users at 3%</p>\r\n                <p className=\"seller-performance-commission-card__value\">{performanceData.commissionRate3Percent || 0}</p>\r\n                <p className=\"seller-performance-commission-card__note\">Above â‚¹50,000/month</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n      )}\r\n\r\n      {/* Statistics - Enhanced Grid */}\r\n      <section id=\"seller-performance-stats\" className=\"seller-section\">\r\n        <div className=\"seller-section__header\">\r\n          <div>\r\n            <h3 className=\"seller-section__title\">Performance Statistics</h3>\r\n            <p className=\"seller-section__subtitle\">Key performance indicators</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"seller-performance-stats-grid\">\r\n          <div className=\"seller-stat-card-enhanced\">\r\n            <div className=\"seller-stat-card-enhanced__icon\" style={{ background: 'rgba(27,143,91,0.1)' }}>\r\n              <UsersIcon className=\"h-5 w-5 text-[#1b8f5b]\" />\r\n            </div>\r\n            <div className=\"seller-stat-card-enhanced__content\">\r\n              <p className=\"seller-stat-card-enhanced__label\">Conversion Rate</p>\r\n              <p className=\"seller-stat-card-enhanced__value\">{performanceData.conversionRate.toFixed(1)}%</p>\r\n              <p className=\"seller-stat-card-enhanced__note\">Active vs Total Referrals</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"seller-stat-card-enhanced\">\r\n            <div className=\"seller-stat-card-enhanced__icon\" style={{ background: 'rgba(59,130,246,0.1)' }}>\r\n              <UsersIcon className=\"h-5 w-5 text-[#3b82f6]\" />\r\n            </div>\r\n            <div className=\"seller-stat-card-enhanced__content\">\r\n              <p className=\"seller-stat-card-enhanced__label\">Active Users</p>\r\n              <p className=\"seller-stat-card-enhanced__value\">{performanceData.activeReferrals}</p>\r\n              <p className=\"seller-stat-card-enhanced__note\">Made purchases this month</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"seller-stat-card-enhanced\">\r\n            <div className=\"seller-stat-card-enhanced__icon\" style={{ background: 'rgba(234,179,8,0.1)' }}>\r\n              <TrendingUpIcon className=\"h-5 w-5 text-[#eab308]\" />\r\n            </div>\r\n            <div className=\"seller-stat-card-enhanced__content\">\r\n              <p className=\"seller-stat-card-enhanced__label\">Avg Purchase Value</p>\r\n              <p className=\"seller-stat-card-enhanced__value\">â‚¹{Math.round(performanceData.averageOrderValue).toLocaleString('en-IN')}</p>\r\n              <p className=\"seller-stat-card-enhanced__note\">Per order average</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"seller-stat-card-enhanced\">\r\n            <div className=\"seller-stat-card-enhanced__icon\" style={{ background: 'rgba(139,92,246,0.1)' }}>\r\n              <TrendingUpIcon className=\"h-5 w-5 text-[#8b5cf6]\" />\r\n            </div>\r\n            <div className=\"seller-stat-card-enhanced__content\">\r\n              <p className=\"seller-stat-card-enhanced__label\">Orders This Month</p>\r\n              <p className=\"seller-stat-card-enhanced__value\">{performanceData.orderCount}</p>\r\n              <p className=\"seller-stat-card-enhanced__note\">Total orders processed</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Top Performers (if available from backend) */}\r\n      {performanceData.topUsers && performanceData.topUsers.length > 0 && (\r\n        <section id=\"seller-performance-top-users\" className=\"seller-section\">\r\n          <div className=\"seller-section__header\">\r\n            <div>\r\n              <h3 className=\"seller-section__title\">Top Performing Users</h3>\r\n              <p className=\"seller-section__subtitle\">Your highest value referrals this month</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"seller-performance-top-users\">\r\n            {performanceData.topUsers.slice(0, 5).map((user, index) => (\r\n              <div key={user.id || index} className=\"seller-performance-top-user-card\">\r\n                <div className=\"seller-performance-top-user-card__rank\">\r\n                  <span>#{index + 1}</span>\r\n                </div>\r\n                <div className=\"seller-performance-top-user-card__avatar\">\r\n                  {user.name ? user.name.substring(0, 2).toUpperCase() : 'U'}\r\n                </div>\r\n                <div className=\"seller-performance-top-user-card__content\">\r\n                  <p className=\"seller-performance-top-user-card__name\">{user.name || 'User'}</p>\r\n                  <p className=\"seller-performance-top-user-card__purchase\">{formatCurrency(user.monthlyPurchases || 0)}</p>\r\n                  <p className=\"seller-performance-top-user-card__commission\">\r\n                    Commission: {formatCurrency(user.commission || 0)} @ {user.commissionRate ? `${user.commissionRate * 100}%` : '2-3%'}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </section>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\views\\ProfileView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[17,28],"text":""},"desc":"Remove unused variable 'useEffect'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[387,426],"text":""},"desc":"Remove unused variable 'cn'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'onNavigate' is defined but never used.","line":17,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"onNavigate"},"fix":{"range":[531,543],"text":""},"desc":"Remove unused variable 'onNavigate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'dispatch' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":19,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'fetchDashboardOverview' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":20,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":85,"suggestions":[{"messageId":"removeVar","data":{"varName":"fetchDashboardOverview"},"fix":{"range":[690,714],"text":""},"desc":"Remove unused variable 'fetchDashboardOverview'."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\r\nimport { useSellerState, useSellerDispatch } from '../../context/SellerContext'\r\nimport { useSellerApi } from '../../hooks/useSellerApi'\r\nimport { sellerSnapshot } from '../../services/sellerData'\r\nimport {\r\n  UserIcon,\r\n  HelpCircleIcon,\r\n  EditIcon,\r\n  CheckIcon,\r\n  XIcon,\r\n  BuildingIcon,\r\n  MapPinIcon,\r\n} from '../../components/icons'\r\nimport { cn } from '../../../../lib/cn'\r\nimport { useToast } from '../../components/ToastNotification'\r\n\r\nexport function ProfileView({ onLogout, onNavigate }) {\r\n  const { profile } = useSellerState()\r\n  const dispatch = useSellerDispatch()\r\n  const { requestNameChange, requestPhoneChange, reportIssue, fetchDashboardOverview } = useSellerApi()\r\n  const { success, warning, error: showError } = useToast()\r\n  const [showNameChangePanel, setShowNameChangePanel] = useState(false)\r\n  const [showPhoneChangePanel, setShowPhoneChangePanel] = useState(false)\r\n  const [showSupportPanel, setShowSupportPanel] = useState(false)\r\n  const [showReportPanel, setShowReportPanel] = useState(false)\r\n\r\n  // Name change request form\r\n  const [nameChangeForm, setNameChangeForm] = useState({\r\n    requestedName: '',\r\n    confirmName: '',\r\n  })\r\n\r\n  // Phone change request form\r\n  const [phoneChangeForm, setPhoneChangeForm] = useState({\r\n    requestedPhone: '',\r\n    confirmPhone: '',\r\n  })\r\n\r\n  // Report issue form\r\n  const [reportForm, setReportForm] = useState({\r\n    subject: '',\r\n    description: '',\r\n    category: 'general',\r\n  })\r\n\r\n  const handleRequestNameChange = async () => {\r\n    if (!nameChangeForm.requestedName.trim()) {\r\n      warning('Please enter the new name')\r\n      return\r\n    }\r\n    if (nameChangeForm.requestedName.trim() !== nameChangeForm.confirmName.trim()) {\r\n      warning('Name confirmation does not match. Please enter the same name in both fields.')\r\n      return\r\n    }\r\n    try {\r\n      const result = await requestNameChange({\r\n        requestedName: nameChangeForm.requestedName.trim(),\r\n        description: '',\r\n      })\r\n      // Check for success\r\n      if (result && (result.success || (result.data && !result.error))) {\r\n        setNameChangeForm({ requestedName: '', confirmName: '' })\r\n        setShowNameChangePanel(false)\r\n        // Show success notification after panel closes\r\n        setTimeout(() => {\r\n          success('Name change request sent to Admin. Kindly wait for the Admin approval.')\r\n        }, 100)\r\n      } else if (result && result.error) {\r\n        showError(result.error.message || 'Failed to submit name change request')\r\n      } else {\r\n        showError('Failed to submit name change request. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to submit name change request')\r\n    }\r\n  }\r\n\r\n  const handleRequestPhoneChange = async () => {\r\n    if (!phoneChangeForm.requestedPhone.trim()) {\r\n      warning('Please enter the new phone number')\r\n      return\r\n    }\r\n    // Basic phone validation\r\n    const phoneRegex = /^[+]?[1-9]\\d{9,14}$/\r\n    if (!phoneRegex.test(phoneChangeForm.requestedPhone.trim())) {\r\n      warning('Please enter a valid phone number')\r\n      return\r\n    }\r\n    if (phoneChangeForm.requestedPhone.trim() !== phoneChangeForm.confirmPhone.trim()) {\r\n      warning('Phone confirmation does not match. Please enter the same phone number in both fields.')\r\n      return\r\n    }\r\n    try {\r\n      const result = await requestPhoneChange({\r\n        requestedPhone: phoneChangeForm.requestedPhone.trim(),\r\n        description: '',\r\n      })\r\n      // Check for success\r\n      if (result && result.success) {\r\n        setPhoneChangeForm({ requestedPhone: '', confirmPhone: '' })\r\n        setShowPhoneChangePanel(false)\r\n        // Show success notification after panel closes\r\n        setTimeout(() => {\r\n          success('Phone number change request sent to Admin. Kindly wait for the Admin approval.')\r\n        }, 100)\r\n      } else if (result && result.error) {\r\n        // Show the specific error message from the backend\r\n        const errorMessage = result.error.message || 'Failed to submit phone change request'\r\n        showError(errorMessage)\r\n      } else {\r\n        showError('Failed to submit phone change request. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      showError(err.message || 'Failed to submit phone change request')\r\n    }\r\n  }\r\n\r\n  const handleSubmitReport = async () => {\r\n    if (!reportForm.subject || !reportForm.description) {\r\n      warning('Please fill in all fields')\r\n      return\r\n    }\r\n    const result = await reportIssue({\r\n      subject: reportForm.subject,\r\n      description: reportForm.description,\r\n      category: reportForm.category,\r\n    })\r\n    if (result.data) {\r\n      success('Issue reported successfully! We will get back to you soon.')\r\n      setReportForm({ subject: '', description: '', category: 'general' })\r\n      setShowReportPanel(false)\r\n    } else if (result.error) {\r\n      showError(result.error.message || 'Failed to submit report')\r\n    }\r\n  }\r\n\r\n  const sellerProfile = profile.name ? profile : sellerSnapshot.profile\r\n\r\n  const sections = [\r\n    {\r\n      id: 'seller-info',\r\n      title: 'Seller Information',\r\n      icon: UserIcon,\r\n      items: [\r\n        {\r\n          id: 'name',\r\n          label: 'Full Name',\r\n          value: sellerProfile.name,\r\n          editable: true,\r\n          onEdit: () => setShowNameChangePanel(true),\r\n        },\r\n        {\r\n          id: 'seller-id',\r\n          label: 'Seller ID',\r\n          value: sellerProfile.sellerId || sellerSnapshot.profile.sellerId,\r\n          editable: false,\r\n        },\r\n        {\r\n          id: 'phone',\r\n          label: 'Phone',\r\n          value: sellerProfile.phone || sellerSnapshot.profile.phone || 'Not set',\r\n          editable: true,\r\n          onEdit: () => setShowPhoneChangePanel(true),\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      id: 'business',\r\n      title: 'Business Details',\r\n      icon: BuildingIcon,\r\n      items: [\r\n        {\r\n          id: 'location',\r\n          label: 'Location',\r\n          value: sellerProfile.area || sellerSnapshot.profile.area || sellerProfile.location?.city || sellerProfile.location?.state || 'Not set',\r\n          editable: false,\r\n        },\r\n        {\r\n          id: 'commission',\r\n          label: 'Commission Rate',\r\n          value: sellerProfile.commissionRate || sellerSnapshot.profile.commissionRate || 'Not set',\r\n          editable: false,\r\n        },\r\n        {\r\n          id: 'cashback',\r\n          label: 'Cashback Rate',\r\n          value: sellerProfile.cashbackRate || sellerSnapshot.profile.cashbackRate || 'Not set',\r\n          editable: false,\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      id: 'support',\r\n      title: 'Support & Help',\r\n      icon: HelpCircleIcon,\r\n      items: [\r\n        {\r\n          id: 'help',\r\n          label: 'Help Center',\r\n          value: 'FAQs & Guides',\r\n          action: () => setShowSupportPanel(true),\r\n        },\r\n        {\r\n          id: 'contact',\r\n          label: 'Contact Support',\r\n          value: 'Chat or Call',\r\n          action: () => setShowSupportPanel(true),\r\n        },\r\n        {\r\n          id: 'report',\r\n          label: 'Report Issue',\r\n          value: 'Report a problem',\r\n          action: () => setShowReportPanel(true),\r\n        },\r\n      ],\r\n    },\r\n  ]\r\n\r\n  return (\r\n    <div className=\"seller-profile-view space-y-6\">\r\n      {/* Profile Header */}\r\n      <div className=\"seller-profile-view__header\">\r\n        <div className=\"seller-profile-view__header-avatar\">\r\n          <UserIcon className=\"h-12 w-12\" />\r\n        </div>\r\n        <div className=\"seller-profile-view__header-info\">\r\n          <h2 className=\"seller-profile-view__header-name\">{sellerProfile.name}</h2>\r\n          <p className=\"seller-profile-view__header-id\">Seller ID: {sellerProfile.sellerId || sellerSnapshot.profile.sellerId}</p>\r\n          <p className=\"seller-profile-view__header-location\">\r\n            <MapPinIcon className=\"h-4 w-4 inline mr-1\" />\r\n            {sellerProfile.area || sellerSnapshot.profile.area || sellerProfile.location?.city || sellerProfile.location?.state || 'Location not set'}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Sections */}\r\n      <div className=\"seller-profile-view__sections\">\r\n        {sections.map((section) => (\r\n          <div key={section.id} className=\"seller-profile-view__section\">\r\n            <div className=\"seller-profile-view__section-header\">\r\n              <section.icon className=\"seller-profile-view__section-icon\" />\r\n              <h3 className=\"seller-profile-view__section-title\">{section.title}</h3>\r\n            </div>\r\n            <div className=\"seller-profile-view__section-content\">\r\n              {section.items.length > 0 ? (\r\n                section.items.map((item) => (\r\n                  <div key={item.id} className=\"seller-profile-view__item\">\r\n                    <div className=\"seller-profile-view__item-content\">\r\n                      <span className=\"seller-profile-view__item-label\">{item.label}</span>\r\n                      <span className=\"seller-profile-view__item-value\">{item.value}</span>\r\n                    </div>\r\n                    <div className=\"seller-profile-view__item-actions\">\r\n                      {item.editable && (\r\n                        <button\r\n                          type=\"button\"\r\n                          className=\"seller-profile-view__item-edit\"\r\n                          onClick={item.onEdit}\r\n                        >\r\n                          <EditIcon className=\"h-4 w-4\" />\r\n                        </button>\r\n                      )}\r\n                      {item.action && (\r\n                        <button\r\n                          type=\"button\"\r\n                          className=\"seller-profile-view__item-action\"\r\n                          onClick={item.action}\r\n                        >\r\n                          â†’\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <div className=\"seller-profile-view__empty\">\r\n                  <section.icon className=\"seller-profile-view__empty-icon\" />\r\n                  <p className=\"seller-profile-view__empty-text\">No {section.title.toLowerCase()} yet</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Logout Button */}\r\n      <div className=\"seller-profile-view__logout\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onLogout}\r\n          className=\"seller-profile-view__logout-button\"\r\n        >\r\n          Sign Out\r\n        </button>\r\n      </div>\r\n\r\n      {/* Name Change Request Panel */}\r\n      {showNameChangePanel && (\r\n        <div\r\n          className=\"seller-profile-view__panel\"\r\n          onClick={(e) => {\r\n            if (e.target === e.currentTarget) {\r\n              setShowNameChangePanel(false)\r\n              setNameChangeForm({ requestedName: '', confirmName: '' })\r\n            }\r\n          }}\r\n        >\r\n          <div className=\"seller-profile-view__panel-content\">\r\n            <div className=\"seller-profile-view__panel-header\">\r\n              <h3 className=\"seller-profile-view__panel-title\">Request Name Change</h3>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setShowNameChangePanel(false)\r\n                  setNameChangeForm({ requestedName: '', confirmName: '' })\r\n                }}\r\n                className=\"seller-profile-view__panel-close\"\r\n              >\r\n                <XIcon className=\"h-5 w-5\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"seller-profile-view__panel-body\">\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\r\n                    Current Name\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={sellerProfile.name}\r\n                    disabled\r\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-gray-50 text-sm text-gray-600\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\r\n                    New Name <span className=\"text-red-500\">*</span>\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={nameChangeForm.requestedName}\r\n                    onChange={(e) => setNameChangeForm({ ...nameChangeForm, requestedName: e.target.value })}\r\n                    placeholder=\"Write your suggested name\"\r\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\r\n                    Confirm Name <span className=\"text-red-500\">*</span>\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={nameChangeForm.confirmName}\r\n                    onChange={(e) => setNameChangeForm({ ...nameChangeForm, confirmName: e.target.value })}\r\n                    placeholder=\"Enter the name again to confirm\"\r\n                    className={`w-full px-3 py-2.5 rounded-lg border text-sm focus:outline-none ${nameChangeForm.confirmName && nameChangeForm.requestedName.trim() !== nameChangeForm.confirmName.trim()\r\n                        ? 'border-red-300 bg-red-50 focus:border-red-500'\r\n                        : 'border-[rgba(34,94,65,0.15)] bg-white focus:border-[#1b8f5b]'\r\n                      }`}\r\n                  />\r\n                  {nameChangeForm.confirmName && nameChangeForm.requestedName.trim() !== nameChangeForm.confirmName.trim() && (\r\n                    <p className=\"mt-1 text-xs text-red-600\">Name does not match. Please enter the same name.</p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"mt-6\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleRequestNameChange}\r\n                  className=\"w-full py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors\"\r\n                >\r\n                  Submit Request\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Phone Change Request Panel */}\r\n      {showPhoneChangePanel && (\r\n        <div\r\n          className=\"seller-profile-view__panel\"\r\n          onClick={(e) => {\r\n            if (e.target === e.currentTarget) {\r\n              setShowPhoneChangePanel(false)\r\n              setPhoneChangeForm({ requestedPhone: '', confirmPhone: '' })\r\n            }\r\n          }}\r\n        >\r\n          <div className=\"seller-profile-view__panel-content\">\r\n            <div className=\"seller-profile-view__panel-header\">\r\n              <h3 className=\"seller-profile-view__panel-title\">Request Phone Change</h3>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setShowPhoneChangePanel(false)\r\n                  setPhoneChangeForm({ requestedPhone: '', confirmPhone: '' })\r\n                }}\r\n                className=\"seller-profile-view__panel-close\"\r\n              >\r\n                <XIcon className=\"h-5 w-5\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"seller-profile-view__panel-body\">\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\r\n                    Current Phone\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={sellerProfile.phone || 'Not set'}\r\n                    disabled\r\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-gray-50 text-sm text-gray-600\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\r\n                    New Phone Number <span className=\"text-red-500\">*</span>\r\n                  </label>\r\n                  <input\r\n                    type=\"tel\"\r\n                    value={phoneChangeForm.requestedPhone}\r\n                    onChange={(e) => setPhoneChangeForm({ ...phoneChangeForm, requestedPhone: e.target.value })}\r\n                    placeholder=\"Write your suggested phone number to change\"\r\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\r\n                    Confirm Phone Number <span className=\"text-red-500\">*</span>\r\n                  </label>\r\n                  <input\r\n                    type=\"tel\"\r\n                    value={phoneChangeForm.confirmPhone}\r\n                    onChange={(e) => setPhoneChangeForm({ ...phoneChangeForm, confirmPhone: e.target.value })}\r\n                    placeholder=\"Enter the phone number again to confirm\"\r\n                    className={`w-full px-3 py-2.5 rounded-lg border text-sm focus:outline-none ${phoneChangeForm.confirmPhone && phoneChangeForm.requestedPhone.trim() !== phoneChangeForm.confirmPhone.trim()\r\n                        ? 'border-red-300 bg-red-50 focus:border-red-500'\r\n                        : 'border-[rgba(34,94,65,0.15)] bg-white focus:border-[#1b8f5b]'\r\n                      }`}\r\n                  />\r\n                  {phoneChangeForm.confirmPhone && phoneChangeForm.requestedPhone.trim() !== phoneChangeForm.confirmPhone.trim() && (\r\n                    <p className=\"mt-1 text-xs text-red-600\">Phone number does not match. Please enter the same phone number.</p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"mt-6\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleRequestPhoneChange}\r\n                  className=\"w-full py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors\"\r\n                >\r\n                  Submit Request\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Support Panel */}\r\n      {showSupportPanel && (\r\n        <div\r\n          className=\"seller-profile-view__panel\"\r\n          onClick={(e) => {\r\n            if (e.target === e.currentTarget) {\r\n              setShowSupportPanel(false)\r\n            }\r\n          }}\r\n        >\r\n          <div className=\"seller-profile-view__panel-content\">\r\n            <div className=\"seller-profile-view__panel-header\">\r\n              <h3 className=\"seller-profile-view__panel-title\">Support & Help</h3>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowSupportPanel(false)}\r\n                className=\"seller-profile-view__panel-close\"\r\n              >\r\n                <XIcon className=\"h-5 w-5\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"seller-profile-view__panel-body\">\r\n              <div className=\"space-y-4\">\r\n                <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\r\n                  <h4 className=\"font-semibold text-[#172022] mb-2\">Help Center</h4>\r\n                  <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\r\n                    Browse FAQs and guides to find answers to common questions.\r\n                  </p>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"text-sm text-[#1b8f5b] font-semibold hover:underline\"\r\n                  >\r\n                    Visit Help Center â†’\r\n                  </button>\r\n                </div>\r\n                <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\r\n                  <h4 className=\"font-semibold text-[#172022] mb-2\">Contact Support</h4>\r\n                  <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-2\">\r\n                    <strong>Phone:</strong> +91 1800-XXX-XXXX\r\n                  </p>\r\n                  <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\r\n                    <strong>Email:</strong> support@irasathi.com\r\n                  </p>\r\n                  <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\r\n                    <strong>Hours:</strong> Mon-Sat, 9 AM - 6 PM\r\n                  </p>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"text-sm text-[#1b8f5b] font-semibold hover:underline\"\r\n                  >\r\n                    Start Chat â†’\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Report Issue Panel */}\r\n      {showReportPanel && (\r\n        <div\r\n          className=\"seller-profile-view__panel\"\r\n          onClick={(e) => {\r\n            if (e.target === e.currentTarget) {\r\n              setShowReportPanel(false)\r\n              setReportForm({ subject: '', description: '', category: 'general' })\r\n            }\r\n          }}\r\n        >\r\n          <div className=\"seller-profile-view__panel-content\">\r\n            <div className=\"seller-profile-view__panel-header\">\r\n              <h3 className=\"seller-profile-view__panel-title\">Report Issue</h3>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setShowReportPanel(false)\r\n                  setReportForm({ subject: '', description: '', category: 'general' })\r\n                }}\r\n                className=\"seller-profile-view__panel-close\"\r\n              >\r\n                <XIcon className=\"h-5 w-5\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"seller-profile-view__panel-body\">\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\r\n                    Category <span className=\"text-red-500\">*</span>\r\n                  </label>\r\n                  <select\r\n                    value={reportForm.category}\r\n                    onChange={(e) => setReportForm({ ...reportForm, category: e.target.value })}\r\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\r\n                  >\r\n                    <option value=\"general\">General Issue</option>\r\n                    <option value=\"commission\">Commission Issue</option>\r\n                    <option value=\"vendor\">Vendor Issue</option>\r\n                    <option value=\"account\">Account Issue</option>\r\n                    <option value=\"other\">Other</option>\r\n                  </select>\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\r\n                    Subject <span className=\"text-red-500\">*</span>\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={reportForm.subject}\r\n                    onChange={(e) => setReportForm({ ...reportForm, subject: e.target.value })}\r\n                    placeholder=\"Brief description of the issue\"\r\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\r\n                    Description <span className=\"text-red-500\">*</span>\r\n                  </label>\r\n                  <textarea\r\n                    value={reportForm.description}\r\n                    onChange={(e) => setReportForm({ ...reportForm, description: e.target.value })}\r\n                    placeholder=\"Please provide detailed information about the issue\"\r\n                    rows={5}\r\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b] resize-none\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"mt-6\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSubmitReport}\r\n                  className=\"w-full py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors\"\r\n                >\r\n                  Submit Report\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\views\\ReferralsView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'dashboard' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":15,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"dashboard"},"fix":{"range":[530,568],"text":""},"desc":"Remove unused variable 'dashboard'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect } from 'react'\nimport { useSellerState } from '../../context/SellerContext'\nimport { useSellerApi } from '../../hooks/useSellerApi'\nimport { sellerSnapshot } from '../../services/sellerData'\nimport { cn } from '../../../../lib/cn'\nimport { UsersIcon, WalletIcon, TrendingUpIcon } from '../../components/icons'\n\nconst FILTER_TABS = [\n  { id: 'all', label: 'All' },\n  { id: 'active', label: 'Active' },\n  { id: 'registered', label: 'New' },\n]\n\nexport function ReferralsView({ onNavigate }) {\n  const { dashboard } = useSellerState()\n  const { fetchReferrals } = useSellerApi()\n  const [activeFilter, setActiveFilter] = useState('all')\n  const [expandedId, setExpandedId] = useState(null)\n  const [searchQuery, setSearchQuery] = useState('')\n  const [referrals, setReferrals] = useState([])\n  const [loading, setLoading] = useState(true)\n  const commissionPolicy = sellerSnapshot.commissionPolicy // Keep policies as is\n\n  // Fetch referrals on mount\n  useEffect(() => {\n    const fetchData = async () => {\n      setLoading(true)\n      try {\n        const result = await fetchReferrals({ limit: 100 })\n        if (result.data?.referrals) {\n          // Transform backend response to frontend format\n          const transformedReferrals = result.data.referrals.map((ref) => ({\n            id: ref._id || ref.id,\n            userId: ref._id || ref.id,\n            name: ref.name || 'User',\n            phone: ref.phone || '',\n            email: ref.email || '',\n            monthlyPurchases: ref.monthlyPurchases || 0,\n            orderCount: ref.orderCount || 0,\n            commissionRate: ref.commissionRate || 0.02,\n            estimatedCommission: ref.estimatedCommission || 0,\n            status: ref.monthlyPurchases > 0 ? 'Active' : 'Registered',\n            createdAt: ref.createdAt,\n            registeredDate: ref.createdAt,\n            totalAmount: ref.monthlyPurchases || 0, // For display purposes\n            totalPurchases: ref.orderCount || 0,\n          }))\n          setReferrals(transformedReferrals)\n        }\n      } catch (error) {\n        console.error('Failed to fetch referrals:', error)\n      } finally {\n        setLoading(false)\n      }\n    }\n    fetchData()\n  }, [fetchReferrals])\n\n  const formatCurrency = (value = 0) => {\n    const amount = Number(value) || 0\n    return `â‚¹${amount.toLocaleString('en-IN')}`\n  }\n\n  const getCommissionInfo = (amount) => {\n    const purchaseAmount = Number(amount) || 0\n    // Commission rate: 2% if <= 50000, 3% if > 50000 (based on monthly purchases)\n    const rate = purchaseAmount >= 50000 ? 0.03 : 0.02\n    const commissionAmount = Math.round(purchaseAmount * rate)\n    return {\n      purchaseAmount,\n      rate,\n      commissionAmount,\n    }\n  }\n\n  const currentMonthLabel =\n    commissionPolicy?.currentMonth ||\n    new Date().toLocaleDateString('en-IN', { month: 'long', year: 'numeric' })\n\n  // Calculate summary stats\n  const stats = useMemo(() => {\n    const total = referrals.length\n    const active = referrals.filter((r) => r.status === 'active' || r.status === 'Active').length\n    const aggregates = referrals.reduce(\n      (acc, referral) => {\n        // Handle both string and number formats\n        const lifetimeAmount = typeof referral.totalAmount === 'number' \n          ? referral.totalAmount \n          : parseFloat((referral.totalAmount || '0').toString().replace(/[â‚¹,\\sL]/g, '')) || 0\n        const monthlyPurchases = typeof referral.monthlyPurchases === 'number'\n          ? referral.monthlyPurchases\n          : parseFloat((referral.monthlyPurchases || '0').toString().replace(/[â‚¹,\\sL]/g, '')) || 0\n        const commissionInfo = getCommissionInfo(monthlyPurchases)\n        acc.totalSales += lifetimeAmount\n        acc.monthlyPurchases += commissionInfo.purchaseAmount\n        acc.monthlyCommission += commissionInfo.commissionAmount\n        return acc\n      },\n      { totalSales: 0, monthlyPurchases: 0, monthlyCommission: 0 },\n    )\n\n    return {\n      total,\n      active,\n      monthlyCommission: formatCurrency(aggregates.monthlyCommission),\n      monthlyPurchases: formatCurrency(aggregates.monthlyPurchases),\n    }\n  }, [referrals])\n\n  // Filter referrals\n  const filteredReferrals = useMemo(() => {\n    let filtered = referrals\n\n    // Status filter\n    if (activeFilter === 'active') {\n      filtered = filtered.filter((r) => r.status === 'active' || r.status === 'Active')\n    } else if (activeFilter === 'registered') {\n      filtered = filtered.filter((r) => r.status === 'registered' || r.status === 'Registered' || !r.status)\n    }\n\n    // Search filter\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase()\n      filtered = filtered.filter(\n        (r) => {\n          const name = (r.name || '').toLowerCase()\n          const userId = (r.userId || r.id || '').toString().toLowerCase()\n          const totalAmount = (r.totalAmount || '').toString().toLowerCase()\n          return name.includes(query) || userId.includes(query) || totalAmount.includes(query)\n        }\n      )\n    }\n\n    return filtered\n  }, [referrals, activeFilter, searchQuery])\n\n  const formatDate = (dateString) => {\n    try {\n      const date = new Date(dateString)\n      return date.toLocaleDateString('en-IN', {\n        day: 'numeric',\n        month: 'short',\n        year: 'numeric',\n      })\n    } catch {\n      return dateString\n    }\n  }\n\n  return (\n    <div className=\"seller-referrals space-y-6\">\n      {/* Header Stats */}\n      <section id=\"seller-referrals-hero\" className=\"seller-referrals-hero\">\n        <div className=\"seller-referrals-hero__card\">\n          <div className=\"seller-referrals-hero__header\">\n            <div>\n              <h2 className=\"seller-referrals-hero__title\">Your Referrals</h2>\n              <p className=\"seller-referrals-hero__subtitle\">Track your referral network</p>\n            </div>\n            <div className=\"seller-referrals-hero__badge\">\n              <UsersIcon className=\"h-6 w-6 text-white\" />\n            </div>\n          </div>\n          <div className=\"seller-referrals-hero__stats\">\n            <div className=\"seller-referrals-stat\">\n              <p className=\"seller-referrals-stat__label\">Total Referrals</p>\n              <span className=\"seller-referrals-stat__value\">{stats.total}</span>\n            </div>\n            <div className=\"seller-referrals-stat\">\n              <p className=\"seller-referrals-stat__label\">Active Users</p>\n              <span className=\"seller-referrals-stat__value\">{stats.active}</span>\n            </div>\n            <div className=\"seller-referrals-stat\">\n              <p className=\"seller-referrals-stat__label\">This Month Commission</p>\n              <span className=\"seller-referrals-stat__value\">{stats.monthlyCommission}</span>\n            </div>\n            <div className=\"seller-referrals-stat\">\n              <p className=\"seller-referrals-stat__label\">This Month Purchases</p>\n              <span className=\"seller-referrals-stat__value\">{stats.monthlyPurchases}</span>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Commission Policy Notice */}\n      <section className=\"seller-section\">\n        <div className=\"rounded-2xl border border-[rgba(34,94,65,0.15)] bg-white/80 p-4\">\n          <p className=\"text-sm font-semibold text-[#172022]\">\n            Monthly commission tally resets on day {commissionPolicy?.resetDay || 1} of every month.\n          </p>\n          <p className=\"mt-1 text-xs text-[rgba(26,42,34,0.7)]\">\n            Current cycle: {currentMonthLabel}. Commission rates apply per connected user:\n          </p>\n          <ul className=\"mt-3 space-y-1 text-xs text-[rgba(26,42,34,0.7)]\">\n            <li>â€¢ Up to â‚¹50,000 cumulative purchases: earn 2% commission.</li>\n            <li>â€¢ Above â‚¹50,000: the entire monthâ€™s purchases earn 3%.</li>\n          </ul>\n        </div>\n      </section>\n\n      {/* Filter Tabs */}\n      <section id=\"seller-referrals-filters\" className=\"seller-section\">\n        <div className=\"seller-filter-tabs\">\n          {FILTER_TABS.map((tab) => (\n            <button\n              key={tab.id}\n              type=\"button\"\n              onClick={() => setActiveFilter(tab.id)}\n              className={cn('seller-filter-tab', activeFilter === tab.id && 'is-active')}\n            >\n              {tab.label}\n            </button>\n          ))}\n        </div>\n      </section>\n\n      {/* Search Bar */}\n      <section id=\"seller-referrals-search\" className=\"seller-section\">\n        <div className=\"seller-search-bar\">\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Search by name, user ID, or amount...\"\n            className=\"seller-search-bar__input\"\n            aria-label=\"Search referrals\"\n          />\n        </div>\n      </section>\n\n      {/* Referrals List */}\n      <section id=\"seller-referrals-list\" className=\"seller-section\">\n        {loading ? (\n          <div className=\"seller-referrals-empty\">\n            <UsersIcon className=\"seller-referrals-empty__icon\" />\n            <p className=\"seller-referrals-empty__text\">Loading referrals...</p>\n          </div>\n        ) : filteredReferrals.length === 0 ? (\n          <div className=\"seller-referrals-empty\">\n            <UsersIcon className=\"seller-referrals-empty__icon\" />\n            <p className=\"seller-referrals-empty__text\">No referrals found</p>\n            <p className=\"seller-referrals-empty__subtext\">\n              {searchQuery ? 'Try adjusting your search or filters' : 'Start referring users to see them here'}\n            </p>\n          </div>\n        ) : (\n          <div className=\"seller-referrals-list\">\n            {filteredReferrals.map((referral) => {\n              // Calculate monthly purchases - handle both number and string formats\n              const monthlyPurchases = typeof referral.monthlyPurchases === 'number'\n                ? referral.monthlyPurchases\n                : parseFloat((referral.monthlyPurchases || '0').toString().replace(/[â‚¹,\\sL]/g, '')) || 0\n              \n              // Always calculate commission rate based on monthlyPurchases (not backend commissionRate)\n              const commissionInfo = getCommissionInfo(monthlyPurchases)\n              const monthlyPurchaseDisplay = formatCurrency(commissionInfo.purchaseAmount)\n              const commissionDisplay = formatCurrency(commissionInfo.commissionAmount)\n              const commissionRateLabel = `${Math.round(commissionInfo.rate * 100)}%`\n              const amountToNextSlab = Math.max(50000 - commissionInfo.purchaseAmount, 0)\n              const amountToNextSlabDisplay = formatCurrency(amountToNextSlab)\n              const lifetimeTotal = typeof referral.totalAmount === 'number'\n                ? formatCurrency(referral.totalAmount)\n                : referral.totalAmount || 'â‚¹0'\n              const avatar = referral.name ? referral.name.substring(0, 2).toUpperCase() : 'U'\n              const status = referral.status || 'Registered'\n              const userId = referral.userId || referral.id || 'N/A'\n              const registeredDate = referral.registeredDate || referral.createdAt || new Date().toISOString()\n              const totalPurchases = referral.totalPurchases || referral.orderCount || 0\n              const lastPurchase = referral.lastPurchase || referral.lastOrderDate \n                ? formatDate(referral.lastPurchase || referral.lastOrderDate)\n                : 'Never'\n              \n              // Determine commission rate badge style\n              const isPremiumRate = commissionInfo.rate >= 0.03\n\n              return (\n                <div\n                  key={referral.id || referral._id}\n                  className={cn('seller-referral-card', expandedId === referral.id && 'is-expanded')}\n                >\n                <div\n                  className=\"seller-referral-card__header\"\n                  onClick={() => setExpandedId(expandedId === referral.id ? null : referral.id)}\n                >\n                  <div className=\"seller-referral-card__avatar\">{avatar}</div>\n                  <div className=\"seller-referral-card__info\">\n                    <div className=\"seller-referral-card__row\">\n                      <h3 className=\"seller-referral-card__name\">{referral.name || 'User'}</h3>\n                      <div className=\"seller-referral-card__header-badges\">\n                        <span\n                          className={cn(\n                            'seller-referral-card__commission-badge',\n                            isPremiumRate ? 'seller-referral-card__commission-badge--premium' : 'seller-referral-card__commission-badge--standard'\n                          )}\n                          title={`Commission Rate: ${commissionRateLabel} for this month`}\n                        >\n                          {commissionRateLabel}\n                        </span>\n                        <span\n                          className={cn(\n                            'seller-referral-card__status',\n                            (status === 'Active' || status === 'active') ? 'is-active' : 'is-registered',\n                          )}\n                        >\n                          {status}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"seller-referral-card__meta\">\n                      <span className=\"seller-referral-card__id\">{userId}</span>\n                      <span className=\"seller-referral-card__date\">\n                        Joined {formatDate(registeredDate)}\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"seller-referral-card__toggle\">\n                    <TrendingUpIcon\n                      className={cn('h-4 w-4', expandedId === referral.id && 'rotate-180')}\n                    />\n                  </div>\n                </div>\n\n                {expandedId === referral.id && (\n                  <div className=\"seller-referral-card__details\">\n                    <div className=\"seller-referral-card__stats-grid\">\n                      <div className=\"seller-referral-stat\">\n                        <p className=\"seller-referral-stat__label\">Total Purchases</p>\n                        <span className=\"seller-referral-stat__value\">{totalPurchases}</span>\n                      </div>\n                      <div className=\"seller-referral-stat\">\n                        <p className=\"seller-referral-stat__label\">Lifetime Amount</p>\n                        <span className=\"seller-referral-stat__value\">{lifetimeTotal}</span>\n                      </div>\n                      <div className=\"seller-referral-stat\">\n                        <p className=\"seller-referral-stat__label\">This Month Purchases</p>\n                        <span className=\"seller-referral-stat__value\">{monthlyPurchaseDisplay}</span>\n                        <div className=\"mt-1 flex items-center gap-2\">\n                          <span className={cn(\n                            'inline-flex items-center gap-1 px-2 py-0.5 rounded text-[0.7rem] font-semibold',\n                            isPremiumRate \n                              ? 'bg-orange-100 text-orange-700 border border-orange-200' \n                              : 'bg-blue-100 text-blue-700 border border-blue-200'\n                          )}>\n                            Commission Rate: {commissionRateLabel}\n                          </span>\n                        </div>\n                        {commissionInfo.purchaseAmount < 50000 && (\n                          <p className=\"mt-1 text-[0.7rem] text-[rgba(26,42,34,0.6)]\">\n                            {amountToNextSlabDisplay} more unlocks 3% rate\n                          </p>\n                        )}\n                      </div>\n                      <div className=\"seller-referral-stat\">\n                        <p className=\"seller-referral-stat__label\">Commission (This Month)</p>\n                        <span className=\"seller-referral-stat__value seller-referral-stat__value--commission\">\n                          {commissionDisplay}\n                        </span>\n                        <p className=\"mt-1 text-[0.7rem] text-[rgba(26,42,34,0.6)]\">\n                          Calculated at {commissionRateLabel} rate\n                        </p>\n                      </div>\n                      <div className=\"seller-referral-stat\">\n                        <p className=\"seller-referral-stat__label\">Last Purchase</p>\n                        <span className=\"seller-referral-stat__value\">{lastPurchase}</span>\n                      </div>\n                    </div>\n                    <div className=\"seller-referral-card__actions\">\n                      <button\n                        type=\"button\"\n                        className=\"seller-referral-card__action\"\n                        onClick={() => onNavigate('wallet')}\n                      >\n                        <WalletIcon className=\"h-4 w-4\" />\n                        View Transactions\n                      </button>\n                    </div>\n                  </div>\n                )}\n\n                  {/* Quick Stats (always visible) */}\n                  <div className=\"seller-referral-card__quick-stats\">\n                    <div className=\"seller-referral-quick-stat\">\n                      <span className=\"seller-referral-quick-stat__label\">Purchases</span>\n                      <span className=\"seller-referral-quick-stat__value\">{totalPurchases}</span>\n                    </div>\n                    <div className=\"seller-referral-quick-stat\">\n                      <span className=\"seller-referral-quick-stat__label\">This Month</span>\n                      <span className=\"seller-referral-quick-stat__value\">{monthlyPurchaseDisplay}</span>\n                    </div>\n                    <div className=\"seller-referral-quick-stat seller-referral-quick-stat--commission\">\n                      <span className=\"seller-referral-quick-stat__label\">Commission</span>\n                      <span className=\"seller-referral-quick-stat__value\">{commissionDisplay}</span>\n                    </div>\n                    <div className={cn(\n                      'seller-referral-quick-stat',\n                      isPremiumRate ? 'seller-referral-quick-stat--premium' : 'seller-referral-quick-stat--standard'\n                    )}>\n                      <span className=\"seller-referral-quick-stat__label\">Rate</span>\n                      <span className=\"seller-referral-quick-stat__value\">{commissionRateLabel}</span>\n                    </div>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        )}\n      </section>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\pages\\views\\WalletView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\routes\\SellerDashboardPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\services\\sellerApi.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":22,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'onMessage' is defined but never used.","line":705,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":705,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"onMessage"},"fix":{"range":[19872,19881],"text":""},"desc":"Remove unused variable 'onMessage'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Seller API Service\n * \n * This file contains all API endpoints for the Seller dashboard.\n * All endpoints are backend-ready and will work once the backend is implemented.\n * \n * Base URL should be configured in environment variables:\n * - Development: http://localhost:3000/api\n * - Production: https://api.irasathi.com/api\n */\n\nconst API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000/api'\n\n/**\n * API Response Handler\n */\nasync function handleResponse(response) {\n  let data;\n  try {\n    const text = await response.text()\n    data = text ? JSON.parse(text) : {}\n  } catch (err) {\n    data = { \n      success: false,\n      error: { message: 'An error occurred while parsing response' }\n    }\n  }\n  \n  if (!response.ok) {\n    // Return error in same format as success response for consistent error handling\n    return {\n      success: false,\n      error: {\n        message: data.message || data.error?.message || `HTTP error! status: ${response.status}`,\n        status: response.status,\n      },\n    }\n  }\n  \n  return data\n}\n\n/**\n * API Request Helper\n */\nasync function apiRequest(endpoint, options = {}) {\n  const token = localStorage.getItem('seller_token') // Seller authentication token\n  \n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n      ...(token && { Authorization: `Bearer ${token}` }),\n      ...options.headers,\n    },\n    ...options,\n  }\n\n  const response = await fetch(`${API_BASE_URL}${endpoint}`, config)\n  return handleResponse(response)\n}\n\n// ============================================================================\n// AUTHENTICATION APIs\n// ============================================================================\n\n/**\n * Request OTP for Seller (IRA Partner)\n * POST /sellers/auth/request-otp\n * \n * @param {Object} data - { phone }\n * @returns {Promise<Object>} - { message: 'OTP sent successfully', expiresIn: 300 }\n */\nexport async function requestSellerOTP(data) {\n  return apiRequest('/sellers/auth/request-otp', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Register Seller (IRA Partner)\n * POST /sellers/auth/register\n * Note: This sends OTP. Use verifyOTP to complete registration.\n * \n * @param {Object} data - { name, phone, area }\n * @returns {Promise<Object>} - { message, sellerId, requiresApproval, expiresIn }\n */\nexport async function registerSeller(data) {\n  return apiRequest('/sellers/auth/register', {\n    method: 'POST',\n    body: JSON.stringify({\n      name: data.fullName || data.name,\n      phone: data.phone,\n      area: data.area || '',\n      location: data.location || null,\n    }),\n  })\n}\n\n/**\n * Login Seller (IRA Partner) with OTP\n * POST /sellers/auth/verify-otp\n * \n * @param {Object} data - { phone, otp }\n * @returns {Promise<Object>} - { token, seller: { id, sellerId, name, phone, area, status, isActive } }\n */\nexport async function loginSellerWithOtp(data) {\n  return apiRequest('/sellers/auth/verify-otp', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Seller Login (Legacy - email/password)\n * POST /sellers/login\n * \n * @param {Object} credentials - { email, password }\n * @returns {Promise<Object>} - { token, seller: { id, name, sellerId, email, phone, area, commissionRate, cashbackRate, assignedVendor } }\n */\nexport async function sellerLogin(credentials) {\n  return apiRequest('/sellers/login', {\n    method: 'POST',\n    body: JSON.stringify(credentials),\n  })\n}\n\n/**\n * Seller Logout\n * POST /sellers/auth/logout\n * \n * @returns {Promise<Object>} - { message: 'Logged out successfully' }\n */\nexport async function sellerLogout() {\n  return apiRequest('/sellers/auth/logout', {\n    method: 'POST',\n  })\n}\n\n/**\n * Get Seller Profile\n * GET /sellers/auth/profile\n * \n * @returns {Promise<Object>} - Seller profile data\n */\nexport async function getSellerProfile() {\n  return apiRequest('/sellers/auth/profile')\n}\n\n/**\n * Update Seller Profile\n * PUT /sellers/profile\n * \n * @param {Object} profileData - { name, phone, email }\n * @returns {Promise<Object>} - Updated seller profile\n */\nexport async function updateSellerProfile(profileData) {\n  return apiRequest('/sellers/profile', {\n    method: 'PUT',\n    body: JSON.stringify(profileData),\n  })\n}\n\n/**\n * Change Password\n * PUT /sellers/password\n * \n * @param {Object} passwordData - { currentPassword, newPassword }\n * @returns {Promise<Object>} - { message: 'Password changed successfully' }\n */\nexport async function changePassword(passwordData) {\n  return apiRequest('/sellers/password', {\n    method: 'PUT',\n    body: JSON.stringify(passwordData),\n  })\n}\n\n/**\n * Request Name Change\n * POST /sellers/profile/request-name-change\n * \n * @param {Object} changeData - { requestedName, description }\n * @returns {Promise<Object>} - { changeRequest, message }\n */\nexport async function requestNameChange(changeData) {\n  return apiRequest('/sellers/profile/request-name-change', {\n    method: 'POST',\n    body: JSON.stringify(changeData),\n  })\n}\n\n/**\n * Request Phone Change\n * POST /sellers/profile/request-phone-change\n * \n * @param {Object} changeData - { requestedPhone, description }\n * @returns {Promise<Object>} - { changeRequest, message }\n */\nexport async function requestPhoneChange(changeData) {\n  return apiRequest('/sellers/profile/request-phone-change', {\n    method: 'POST',\n    body: JSON.stringify(changeData),\n  })\n}\n\n/**\n * Get Change Requests\n * GET /sellers/profile/change-requests\n * \n * @param {Object} params - { status, limit, offset }\n * @returns {Promise<Object>} - { changeRequests: Array, total: number }\n */\nexport async function getChangeRequests(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/profile/change-requests?${queryParams}`)\n}\n\n// ============================================================================\n// DASHBOARD & OVERVIEW APIs\n// ============================================================================\n\n/**\n * Get Seller Dashboard Overview\n * GET /sellers/dashboard/overview\n * \n * @returns {Promise<Object>} - {\n *   walletBalance: number,\n *   monthlyTarget: number,\n *   targetProgress: number,\n *   totalReferrals: number,\n *   totalSales: number,\n *   thisMonthSales: number,\n *   thisMonthReferrals: number,\n *   status: string,\n *   recentActivity: Array\n * }\n */\nexport async function getDashboardOverview() {\n  return apiRequest('/sellers/dashboard/overview')\n}\n\n/**\n * Get Seller Highlights/Metrics\n * GET /sellers/dashboard/highlights\n * \n * @returns {Promise<Array>} - Array of highlight metrics\n */\nexport async function getDashboardHighlights() {\n  return apiRequest('/sellers/dashboard/highlights')\n}\n\n/**\n * Get Recent Activity\n * GET /sellers/dashboard/activity\n * \n * @param {Object} params - { limit, offset }\n * @returns {Promise<Object>} - { activities: Array, total: number }\n */\nexport async function getRecentActivity(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/dashboard/activity?${queryParams}`)\n}\n\n// ============================================================================\n// REFERRALS APIs\n// ============================================================================\n\n/**\n * Get All Referrals\n * GET /sellers/referrals\n * \n * @param {Object} params - { status, search, limit, offset }\n * @returns {Promise<Object>} - { referrals: Array, total: number, stats: Object }\n */\nexport async function getReferrals(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/referrals?${queryParams}`)\n}\n\n/**\n * Get Referral Details\n * GET /sellers/referrals/:referralId\n * \n * @param {string} referralId - Referral user ID\n * @returns {Promise<Object>} - Detailed referral information\n */\nexport async function getReferralDetails(referralId) {\n  return apiRequest(`/sellers/referrals/${referralId}`)\n}\n\n/**\n * Get Referral Statistics\n * GET /sellers/referrals/stats\n * \n * @returns {Promise<Object>} - { total, active, totalCommission, totalSales }\n */\nexport async function getReferralStats() {\n  return apiRequest('/sellers/referrals/stats')\n}\n\n// ============================================================================\n// WALLET APIs\n// ============================================================================\n\n/**\n * Get Wallet Balance\n * GET /sellers/wallet\n * \n * @returns {Promise<Object>} - {\n *   balance: number,\n *   pending: number,\n *   totalEarned: number,\n *   transactions: Array\n * }\n */\nexport async function getWalletBalance() {\n  return apiRequest('/sellers/wallet')\n}\n\n/**\n * Get Wallet Transactions\n * GET /sellers/wallet/transactions\n * \n * @param {Object} params - { type, limit, offset, startDate, endDate }\n * @returns {Promise<Object>} - { transactions: Array, total: number }\n */\nexport async function getWalletTransactions(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/wallet/transactions?${queryParams}`)\n}\n\n/**\n * Request Withdrawal\n * POST /sellers/wallet/withdrawals/request\n * \n * @param {Object} withdrawalData - {\n *   amount: number,\n *   bankAccountId: string\n * }\n * @returns {Promise<Object>} - { withdrawal, message }\n */\nexport async function requestWithdrawal(withdrawalData) {\n  return apiRequest('/sellers/wallet/withdrawals/request', {\n    method: 'POST',\n    body: JSON.stringify(withdrawalData),\n  })\n}\n\n/**\n * Get Withdrawal Requests\n * GET /sellers/wallet/withdrawals\n * \n * @param {Object} params - { status, limit, offset }\n * @returns {Promise<Object>} - { withdrawals: Array, total: number }\n */\nexport async function getWithdrawalRequests(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/wallet/withdrawals?${queryParams}`)\n}\n\n/**\n * Get Withdrawal Request Details\n * GET /sellers/wallet/withdrawals/:requestId\n * \n * @param {string} requestId - Withdrawal request ID\n * @returns {Promise<Object>} - Withdrawal request details\n */\nexport async function getWithdrawalRequestDetails(requestId) {\n  return apiRequest(`/sellers/wallet/withdrawals/${requestId}`)\n}\n\n/**\n * Get Commission Summary\n * GET /sellers/wallet/commissions/summary\n * \n * @returns {Promise<Object>} - {\n *   totalCommission: number,\n *   thisMonthCommission: number,\n *   availableBalance: number,\n *   pendingWithdrawal: number,\n *   commissionByRate: { low: number, high: number },\n *   lastCommissionDate: Date\n * }\n */\nexport async function getCommissionSummary() {\n  return apiRequest('/sellers/wallet/commissions/summary')\n}\n\n/**\n * Get Commission History\n * GET /sellers/wallet/commissions/history\n * \n * @param {Object} params - { limit, offset, startDate, endDate, userId }\n * @returns {Promise<Object>} - { commissions: Array, total: number }\n */\nexport async function getCommissionHistory(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/wallet/commissions/history?${queryParams}`)\n}\n\n// ============================================================================\n// BANK ACCOUNT APIs\n// ============================================================================\n\n/**\n * Add Bank Account\n * POST /sellers/bank-accounts\n * \n * @param {Object} accountData - {\n *   accountHolderName: string,\n *   accountNumber: string,\n *   ifscCode: string,\n *   bankName: string,\n *   branchName?: string,\n *   isPrimary?: boolean\n * }\n * @returns {Promise<Object>} - { bankAccount: Object }\n */\nexport async function addBankAccount(accountData) {\n  return apiRequest('/sellers/bank-accounts', {\n    method: 'POST',\n    body: JSON.stringify(accountData),\n  })\n}\n\n/**\n * Get Bank Accounts\n * GET /sellers/bank-accounts\n * \n * @returns {Promise<Object>} - { bankAccounts: Array }\n */\nexport async function getBankAccounts() {\n  return apiRequest('/sellers/bank-accounts')\n}\n\n/**\n * Update Bank Account\n * PUT /sellers/bank-accounts/:accountId\n * \n * @param {string} accountId - Bank account ID\n * @param {Object} accountData - Update data\n * @returns {Promise<Object>} - { bankAccount: Object }\n */\nexport async function updateBankAccount(accountId, accountData) {\n  return apiRequest(`/sellers/bank-accounts/${accountId}`, {\n    method: 'PUT',\n    body: JSON.stringify(accountData),\n  })\n}\n\n/**\n * Delete Bank Account\n * DELETE /sellers/bank-accounts/:accountId\n * \n * @param {string} accountId - Bank account ID\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function deleteBankAccount(accountId) {\n  return apiRequest(`/sellers/bank-accounts/${accountId}`, {\n    method: 'DELETE',\n  })\n}\n\n// ============================================================================\n// TARGET & PERFORMANCE APIs\n// ============================================================================\n\n/**\n * Get Monthly Target\n * GET /sellers/targets/current\n * \n * @returns {Promise<Object>} - {\n *   monthlyTarget: number,\n *   achieved: number,\n *   progress: number,\n *   status: string,\n *   daysRemaining: number\n * }\n */\nexport async function getMonthlyTarget() {\n  return apiRequest('/sellers/targets/current')\n}\n\n/**\n * Get Target History\n * GET /sellers/targets/history\n * \n * @param {Object} params - { year, month, limit, offset }\n * @returns {Promise<Object>} - { targets: Array, total: number }\n */\nexport async function getTargetHistory(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/targets/history?${queryParams}`)\n}\n\n/**\n * Get Performance Analytics\n * GET /sellers/performance\n * \n * @param {Object} params - { period: 'daily'|'weekly'|'monthly', startDate, endDate }\n * @returns {Promise<Object>} - Performance metrics and analytics\n */\nexport async function getPerformanceAnalytics(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/performance?${queryParams}`)\n}\n\n/**\n * Get Target Achievement Incentives\n * GET /sellers/targets/incentives\n * \n * @returns {Promise<Object>} - { incentives: Array, totalEarned: number }\n */\nexport async function getTargetIncentives() {\n  return apiRequest('/sellers/targets/incentives')\n}\n\n// ============================================================================\n// ANNOUNCEMENTS & NOTIFICATIONS APIs\n// ============================================================================\n\n/**\n * Get Announcements\n * GET /sellers/announcements\n * \n * @param {Object} params - { type, read, limit, offset }\n * @returns {Promise<Object>} - { announcements: Array, total: number }\n */\nexport async function getAnnouncements(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/announcements?${queryParams}`)\n}\n\n/**\n * Mark Announcement as Read\n * PUT /sellers/announcements/:announcementId/read\n * \n * @param {string} announcementId - Announcement ID\n * @returns {Promise<Object>} - { message: 'Marked as read' }\n */\nexport async function markAnnouncementRead(announcementId) {\n  return apiRequest(`/sellers/announcements/${announcementId}/read`, {\n    method: 'PUT',\n  })\n}\n\n/**\n * Mark All Announcements as Read\n * PUT /sellers/announcements/read-all\n * \n * @returns {Promise<Object>} - { message: 'All announcements marked as read' }\n */\nexport async function markAllAnnouncementsRead() {\n  return apiRequest('/sellers/announcements/read-all', {\n    method: 'PUT',\n  })\n}\n\n/**\n * Get Notifications\n * GET /sellers/notifications\n * \n * @param {Object} params - { type, read, limit, offset }\n * @returns {Promise<Object>} - { notifications: Array, unreadCount: number }\n */\nexport async function getNotifications(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/notifications?${queryParams}`)\n}\n\n/**\n * Mark Notification as Read\n * PUT /sellers/notifications/:notificationId/read\n * \n * @param {string} notificationId - Notification ID\n * @returns {Promise<Object>} - { message: 'Marked as read' }\n */\nexport async function markNotificationRead(notificationId) {\n  return apiRequest(`/sellers/notifications/${notificationId}/read`, {\n    method: 'PUT',\n  })\n}\n\n/**\n * Mark All Notifications as Read\n * PUT /sellers/notifications/read-all\n * \n * @returns {Promise<Object>} - { message: 'All notifications marked as read' }\n */\nexport async function markAllNotificationsRead() {\n  return apiRequest('/sellers/notifications/read-all', {\n    method: 'PUT',\n  })\n}\n\n// ============================================================================\n// SELLER ID SHARING APIs\n// ============================================================================\n\n/**\n * Get Seller ID Share Link\n * GET /sellers/share-link\n * \n * @returns {Promise<Object>} - { sellerId, shareText, shareUrl, qrCode }\n */\nexport async function getSellerShareLink() {\n  return apiRequest('/sellers/share-link')\n}\n\n/**\n * Track Share Action\n * POST /sellers/share/track\n * \n * @param {Object} shareData - { platform: 'whatsapp'|'sms'|'link', recipient }\n * @returns {Promise<Object>} - { message: 'Share tracked' }\n */\nexport async function trackShareAction(shareData) {\n  return apiRequest('/sellers/share/track', {\n    method: 'POST',\n    body: JSON.stringify(shareData),\n  })\n}\n\n// ============================================================================\n// SUPPORT & HELP APIs\n// ============================================================================\n\n/**\n * Report Issue\n * POST /sellers/support/report\n * \n * @param {Object} reportData - { category, subject, description }\n * @returns {Promise<Object>} - { ticketId, message: 'Issue reported successfully' }\n */\nexport async function reportIssue(reportData) {\n  return apiRequest('/sellers/support/report', {\n    method: 'POST',\n    body: JSON.stringify(reportData),\n  })\n}\n\n/**\n * Get Support Tickets\n * GET /sellers/support/tickets\n * \n * @param {Object} params - { status, limit, offset }\n * @returns {Promise<Object>} - { tickets: Array, total: number }\n */\nexport async function getSupportTickets(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/sellers/support/tickets?${queryParams}`)\n}\n\n/**\n * Get Support Ticket Details\n * GET /sellers/support/tickets/:ticketId\n * \n * @param {string} ticketId - Support ticket ID\n * @returns {Promise<Object>} - Ticket details with messages\n */\nexport async function getSupportTicketDetails(ticketId) {\n  return apiRequest(`/sellers/support/tickets/${ticketId}`)\n}\n\n// ============================================================================\n// NOTIFICATION PREFERENCES APIs\n// ============================================================================\n\n/**\n * Get Notification Preferences\n * GET /sellers/notifications/preferences\n * \n * @returns {Promise<Object>} - Notification preference settings\n */\nexport async function getNotificationPreferences() {\n  return apiRequest('/sellers/notifications/preferences')\n}\n\n/**\n * Update Notification Preferences\n * PUT /sellers/notifications/preferences\n * \n * @param {Object} preferences - { sms, email, push, announcements, commission, target }\n * @returns {Promise<Object>} - Updated preferences\n */\nexport async function updateNotificationPreferences(preferences) {\n  return apiRequest('/sellers/notifications/preferences', {\n    method: 'PUT',\n    body: JSON.stringify(preferences),\n  })\n}\n\n// ============================================================================\n// REAL-TIME UPDATES (WebSocket/SSE)\n// ============================================================================\n\n/**\n * Initialize Real-time Connection\n * This would typically use WebSocket or Server-Sent Events\n * For now, this is a placeholder for the implementation\n * \n * @param {Function} onMessage - Callback for receiving messages\n * @returns {Function} - Cleanup function to close connection\n */\nexport function initializeRealtimeConnection(onMessage) {\n  // This would be implemented with WebSocket or SSE\n  // Example:\n  // const ws = new WebSocket(`${WS_BASE_URL}/sellers/realtime`)\n  // ws.onmessage = (event) => {\n  //   const data = JSON.parse(event.data)\n  //   onMessage(data)\n  // }\n  // return () => ws.close()\n  \n  // For now, return a no-op cleanup function\n  return () => {}\n}\n\n/**\n * Handle Real-time Notification\n * Processes incoming real-time notifications (cashback, target achievement, etc.)\n * \n * @param {Object} notification - Notification data from real-time connection\n */\nexport function handleRealtimeNotification(notification) {\n  // This would process different types of notifications:\n  // - 'cashback_added': When cashback is credited\n  // - 'target_achieved': When monthly target is reached\n  // - 'announcement': When admin posts new announcement\n  // - 'withdrawal_approved': When withdrawal request is approved\n  // - 'withdrawal_rejected': When withdrawal request is rejected\n  \n  return notification\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Seller\\services\\sellerData.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\AuthPromptLaptop.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\AuthPromptMobile.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\AuthPromptModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":152,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":152,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\r\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\r\nimport { useUserDispatch } from '../context/UserContext'\r\nimport { GoogleMapsLocationPicker } from '../../../components/GoogleMapsLocationPicker'\r\nimport * as userApi from '../services/userApi'\r\nimport { Trans } from '../../../components/Trans'\r\n\r\nexport function AuthPromptModal({ isOpen, onClose, actionType, onSuccess }) {\r\n  const dispatch = useUserDispatch()\r\n  const [mode, setMode] = useState('login') // 'login' | 'register'\r\n  const [step, setStep] = useState('phone') // 'phone' | 'otp' | 'register'\r\n  const [form, setForm] = useState({\r\n    phone: '',\r\n    fullName: '',\r\n    contact: '',\r\n    sellerId: '',\r\n    location: null,\r\n  })\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(null)\r\n  const [showSellerId, setShowSellerId] = useState(false)\r\n\r\n  // Reset form when modal opens/closes\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setStep(mode === 'login' ? 'phone' : 'register')\r\n      setForm({\r\n        phone: '',\r\n        fullName: '',\r\n        contact: '',\r\n        sellerId: '',\r\n        location: null,\r\n      })\r\n      setError(null)\r\n    }\r\n  }, [isOpen, mode])\r\n\r\n  if (!isOpen) return null\r\n\r\n  // Get message based on action type\r\n  const getMessage = () => {\r\n    switch (actionType) {\r\n      case 'favourites':\r\n        return \"You can't add to favourites now. First login or create your account.\"\r\n      case 'cart':\r\n        return \"You can't add to cart now. First login or create your account.\"\r\n      case 'orders':\r\n        return \"You can't view your orders now. First login or create your account.\"\r\n      case 'profile':\r\n        return \"You can't update your profile now. First login or create your account.\"\r\n      default:\r\n        return 'Please login or create your account to continue.'\r\n    }\r\n  }\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target\r\n    setForm((prev) => ({ ...prev, [name]: value }))\r\n    setError(null)\r\n  }\r\n\r\n  const handleRequestOtp = async (e) => {\r\n    e?.preventDefault()\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    try {\r\n      const phone = mode === 'login' ? form.phone : form.contact\r\n      if (!phone.trim()) {\r\n        setError('Contact number is required')\r\n        setLoading(false)\r\n        return\r\n      }\r\n      if (phone.length < 10) {\r\n        setError('Please enter a valid contact number')\r\n        setLoading(false)\r\n        return\r\n      }\r\n\r\n      const result = await userApi.requestOTP({ phone })\r\n      \r\n      if (result.success || result.data) {\r\n        setStep('otp')\r\n      } else {\r\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      setError(err.message || 'Failed to send OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleVerifyOtp = async (otpCode) => {\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    try {\r\n      const phone = mode === 'login' ? form.phone : form.contact\r\n      const result = await userApi.verifyOTP({ phone, otp: otpCode })\r\n\r\n      if (result.success && result.data?.token) {\r\n        localStorage.setItem('user_token', result.data.token)\r\n        \r\n        // Fetch user profile\r\n        const profileResult = await userApi.getUserProfile()\r\n        if (profileResult.success && profileResult.data?.user) {\r\n          const userData = profileResult.data.user\r\n          dispatch({\r\n            type: 'AUTH_LOGIN',\r\n            payload: {\r\n              name: userData.name || 'User',\r\n              phone: userData.phone || phone,\r\n              email: userData.email || '',\r\n              sellerId: userData.sellerId || null,\r\n              location: userData.location || null,\r\n            },\r\n          })\r\n        } else {\r\n          // New user - use basic info\r\n          dispatch({\r\n            type: 'AUTH_LOGIN',\r\n            payload: {\r\n              name: form.fullName || 'User',\r\n              phone: phone,\r\n              email: '',\r\n              sellerId: form.sellerId || null,\r\n              location: form.location || null,\r\n            },\r\n          })\r\n        }\r\n\r\n        if (onSuccess) {\r\n          onSuccess()\r\n        }\r\n        onClose()\r\n      } else {\r\n        setError(result.error?.message || 'Invalid OTP. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      setError(err.message || 'Invalid OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleResendOtp = async () => {\r\n    setLoading(true)\r\n    try {\r\n      const phone = mode === 'login' ? form.phone : form.contact\r\n      await userApi.requestOTP({ phone })\r\n    } catch (err) {\r\n      setError('Failed to resend OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  // OTP Step\r\n  if (step === 'otp') {\r\n    return (\r\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4\">\r\n        <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto\">\r\n          <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-3xl\">\r\n            <h2 className=\"text-lg font-bold text-gray-900\"><Trans>Verify OTP</Trans></h2>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n              aria-label=\"Close\"\r\n            >\r\n              <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n          <div className=\"p-6\">\r\n            <OtpVerification\r\n              phone={mode === 'login' ? form.phone : form.contact}\r\n              onVerify={handleVerifyOtp}\r\n              onResend={handleResendOtp}\r\n              onBack={() => setStep(mode === 'login' ? 'phone' : 'register')}\r\n              loading={loading}\r\n              error={error}\r\n              userType=\"user\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Register Step\r\n  if (mode === 'register' && step === 'register') {\r\n    return (\r\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4\">\r\n        <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto\">\r\n          <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-3xl\">\r\n            <h2 className=\"text-lg font-bold text-gray-900\"><Trans>Create Account</Trans></h2>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n              aria-label=\"Close\"\r\n            >\r\n              <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n          {actionType && (\r\n            <div className=\"px-6 py-4 bg-yellow-50 border-b border-yellow-200\">\r\n              <p className=\"text-sm text-yellow-800\">\r\n                <Trans>{getMessage()}</Trans>\r\n              </p>\r\n            </div>\r\n          )}\r\n          <div className=\"p-6\">\r\n            <form onSubmit={handleRequestOtp} className=\"space-y-4\">\r\n              {error && (\r\n                <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\r\n                  <p className=\"text-sm text-red-600\">{error}</p>\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"space-y-1.5\">\r\n                <label htmlFor=\"register-name\" className=\"text-xs font-semibold text-gray-700\">\r\n                  <Trans>Full Name</Trans> <span className=\"text-red-500\">*</span>\r\n                </label>\r\n                <input\r\n                  id=\"register-name\"\r\n                  name=\"fullName\"\r\n                  type=\"text\"\r\n                  required\r\n                  value={form.fullName}\r\n                  onChange={handleChange}\r\n                  placeholder=\"Enter your full name\"\r\n                  className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-1.5\">\r\n                <label htmlFor=\"register-contact\" className=\"text-xs font-semibold text-gray-700\">\r\n                  <Trans>Contact Number</Trans> <span className=\"text-red-500\">*</span>\r\n                </label>\r\n                <input\r\n                  id=\"register-contact\"\r\n                  name=\"contact\"\r\n                  type=\"tel\"\r\n                  required\r\n                  value={form.contact}\r\n                  onChange={handleChange}\r\n                  placeholder=\"+91 90000 00000\"\r\n                  maxLength={15}\r\n                  className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-1.5\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowSellerId(!showSellerId)}\r\n                  className=\"text-xs text-green-600 hover:underline\"\r\n                >\r\n                  {showSellerId ? <Trans>Hide Seller ID</Trans> : <Trans>Have a Seller ID?</Trans>}\r\n                </button>\r\n                {showSellerId && (\r\n                  <input\r\n                    id=\"register-sellerId\"\r\n                    name=\"sellerId\"\r\n                    type=\"text\"\r\n                    value={form.sellerId}\r\n                    onChange={handleChange}\r\n                    placeholder=\"Enter Seller ID (optional)\"\r\n                    className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\r\n                  />\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"space-y-1.5\">\r\n                <label className=\"text-xs font-semibold text-gray-700\">\r\n                  <Trans>Location</Trans> <span className=\"text-red-500\">*</span>\r\n                </label>\r\n                <GoogleMapsLocationPicker\r\n                  value={form.location}\r\n                  onChange={(location) => setForm((prev) => ({ ...prev, location }))}\r\n                />\r\n              </div>\r\n\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading || !form.fullName || !form.contact || !form.location}\r\n                className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {loading ? <Trans>Sending OTP...</Trans> : <Trans>Continue</Trans>}\r\n              </button>\r\n\r\n              <div className=\"text-center text-sm\">\r\n                <span className=\"text-gray-600\"><Trans>Already have an account?</Trans> </span>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setMode('login')\r\n                    setStep('phone')\r\n                  }}\r\n                  className=\"text-green-600 font-semibold hover:underline\"\r\n                >\r\n                  <Trans>Sign in</Trans>\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Login Step\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4\">\r\n      <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto\">\r\n        <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-3xl\">\r\n          <h2 className=\"text-lg font-bold text-gray-900\">\r\n            {actionType ? <Trans>Login Required</Trans> : <Trans>Welcome</Trans>}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n            aria-label=\"Close\"\r\n          >\r\n            <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {actionType && (\r\n          <div className=\"px-6 py-4 bg-yellow-50 border-b border-yellow-200\">\r\n            <p className=\"text-sm text-yellow-800\">\r\n              <Trans>{getMessage()}</Trans>\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"p-6\">\r\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\r\n            {error && (\r\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\r\n                <p className=\"text-sm text-red-600\">{error}</p>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"space-y-1.5\">\r\n              <label htmlFor=\"login-phone\" className=\"text-xs font-semibold text-gray-700\">\r\n                <Trans>Contact Number</Trans> <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              <input\r\n                id=\"login-phone\"\r\n                name=\"phone\"\r\n                type=\"tel\"\r\n                required\r\n                value={form.phone}\r\n                onChange={handleChange}\r\n                placeholder=\"+91 90000 00000\"\r\n                maxLength={15}\r\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\r\n              />\r\n            </div>\r\n\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {loading ? <Trans>Sending OTP...</Trans> : <Trans>Continue</Trans>}\r\n            </button>\r\n\r\n            <div className=\"text-center text-sm\">\r\n              <span className=\"text-gray-600\"><Trans>Don't have an account?</Trans> </span>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setMode('register')\r\n                  setStep('register')\r\n                }}\r\n                className=\"text-green-600 font-semibold hover:underline\"\r\n              >\r\n                <Trans>Sign up</Trans>\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\BottomNavItem.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[0,36],"text":""},"desc":"Remove unused variable 'cn'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { cn } from '../../../lib/cn'\r\n\r\nexport function BottomNavItem({ label, icon, active, onClick, badge }) {\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      onClick={onClick}\r\n      className=\"flex flex-1 items-center justify-center py-1 rounded-2xl transition-colors duration-200\"\r\n      aria-label={label}\r\n    >\r\n      <span className=\"relative flex items-center justify-center w-11 h-11 rounded-2xl transition-all duration-200\"\r\n        style={{\r\n          background: active ? '#1b8f5b' : 'rgba(238, 245, 237, 0.7)',\r\n          color: active ? '#ffffff' : '#1b8f5b',\r\n          boxShadow: active\r\n            ? '0 12px 20px -14px rgba(24, 63, 44, 0.6), inset 0 0 0 1px rgba(43, 118, 79, 0.16)'\r\n            : 'inset 0 0 0 1px rgba(30, 82, 54, 0.06)',\r\n        }}\r\n      >\r\n        {icon}\r\n        {badge !== undefined && badge !== null && badge > 0 && (\r\n          <span className=\"absolute -top-1 -right-1 flex items-center justify-center min-w-[18px] h-[18px] px-1 rounded-full text-[0.65rem] font-bold text-white bg-red-500\">\r\n            {badge > 99 ? '99+' : badge}\r\n          </span>\r\n        )}\r\n      </span>\r\n    </button>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\CategoryCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\MenuList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\MobileShell.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'displayPlaceholder' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":57,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":57,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'onFilterClick' is defined but never used.","line":107,"column":116,"nodeType":"Identifier","messageId":"unusedVar","endLine":107,"endColumn":129,"suggestions":[{"messageId":"removeVar","data":{"varName":"onFilterClick"},"fix":{"range":[3502,3517],"text":""},"desc":"Remove unused variable 'onFilterClick'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'showThreshold' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":119,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":119,"endColumn":24}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react'\nimport { cn } from '../../../lib/cn'\nimport { CloseIcon, MenuIcon, BellIcon, SearchIcon, FilterIcon, UserIcon, ChevronRightIcon } from './icons'\nimport iraSathiLogo from '../../../assets/IRA Sathi.png'\nimport { MapPinIcon } from './icons'\nimport { NotificationsDropdown } from './NotificationsDropdown'\nimport { LanguageToggle } from '../../../components/LanguageToggle'\nimport { Trans } from '../../../components/Trans'\nimport { useTranslation } from '../../../context/TranslationContext'\nimport { TransText } from '../../../components/TransText'\n\n// Component for translated search input placeholder\nfunction TranslatedSearchInput({ onSearchClick }) {\n  const { translate, isEnglish, language } = useTranslation()\n  const [currentSuggestionIndex, setCurrentSuggestionIndex] = useState(0)\n  const [suggestions, setSuggestions] = useState(['Products', 'Seeds', 'Fertilizers'])\n  const [isAnimating, setIsAnimating] = useState(false)\n\n  // Get base text for translation\n  const baseText = isEnglish ? 'Search' : 'Search'\n\n  useEffect(() => {\n    // Cycle through suggestions - each visible for 2 seconds\n    const interval = setInterval(() => {\n      setIsAnimating(true)\n      setTimeout(() => {\n        setCurrentSuggestionIndex((prev) => (prev + 1) % suggestions.length)\n        setIsAnimating(false)\n      }, 300) // Quick transition: 300ms fade out, then change, then fade in\n    }, 2000) // Change every 2 seconds\n\n    return () => clearInterval(interval)\n  }, [suggestions.length])\n\n  // Translate suggestions when language changes\n  useEffect(() => {\n    if (isEnglish) {\n      setSuggestions(['Products', 'Seeds', 'Fertilizers'])\n      return\n    }\n\n    // Translate each suggestion\n    Promise.all([\n      translate('Products'),\n      translate('Seeds'),\n      translate('Fertilizers')\n    ])\n      .then((translated) => {\n        setSuggestions(translated)\n      })\n      .catch(() => {\n        setSuggestions(['Products', 'Seeds', 'Fertilizers'])\n      })\n  }, [isEnglish, translate, language])\n\n  const currentSuggestion = suggestions[currentSuggestionIndex] || 'Products'\n  const displayPlaceholder = `${baseText} ${currentSuggestion}`\n\n  return (\n    <>\n      <input\n        type=\"text\"\n        className=\"home-search-bar__input\"\n        onClick={onSearchClick}\n        readOnly\n      />\n      <div className=\"home-search-bar__placeholder-animated\">\n        <span className=\"home-search-bar__placeholder-static\">{baseText}</span>\n        <span className=\"home-search-bar__placeholder-space\"> </span>\n        <span className={cn('home-search-bar__placeholder-suggestion', isAnimating && 'fade-out')}>\n          {currentSuggestion}\n        </span>\n      </div>\n    </>\n  )\n}\n\n// Component for translated email input placeholder\nfunction TranslatedEmailInput() {\n  const { translate, isEnglish, language } = useTranslation()\n  const [placeholder, setPlaceholder] = useState('Write Email')\n\n  useEffect(() => {\n    if (isEnglish) {\n      setPlaceholder('Write Email')\n      return\n    }\n\n    translate('Write Email')\n      .then((translated) => {\n        setPlaceholder(translated)\n      })\n      .catch(() => {\n        setPlaceholder('Write Email')\n      })\n  }, [isEnglish, translate, language])\n\n  return (\n    <input\n      type=\"email\"\n      placeholder={placeholder}\n      className=\"user-shell-footer__email-input\"\n    />\n  )\n}\n\nexport function MobileShell({ title, subtitle, children, navigation, bottomNavigation, menuContent, onSearchClick, onFilterClick, notificationsCount = 0, isAuthenticated = false, onNavigate, onLogout, onLogin }) {\n  const [open, setOpen] = useState(false)\n  const [compact, setCompact] = useState(false)\n  const [notificationsOpen, setNotificationsOpen] = useState(false)\n  const [hideSecondRow, setHideSecondRow] = useState(false)\n\n  useEffect(() => {\n    let ticking = false\n    let lastScrollY = window.scrollY\n    let scrollDirection = 0 // -1 = up, 1 = down, 0 = neutral\n    const scrollThreshold = 10 // Minimum scroll difference to trigger change\n    const hideThreshold = 50 // Scroll position to hide second row\n    const showThreshold = 20 // Scroll position to show second row\n\n    const handleScroll = () => {\n      if (!ticking) {\n        window.requestAnimationFrame(() => {\n          const currentScrollY = window.scrollY\n          const scrollDelta = currentScrollY - lastScrollY\n          \n          // Determine scroll direction with threshold to prevent jitter\n          if (Math.abs(scrollDelta) > scrollThreshold) {\n            scrollDirection = scrollDelta > 0 ? 1 : -1\n          }\n\n          // Only update state if there's a meaningful scroll change\n          if (Math.abs(scrollDelta) > 2) {\n            if (scrollDirection === 1) {\n              // Scrolling down\n              setCompact(currentScrollY > 30)\n              setHideSecondRow(currentScrollY > hideThreshold)\n            } else if (scrollDirection === -1) {\n              // Scrolling up\n              setCompact(currentScrollY > 20)\n              setHideSecondRow(false)\n            }\n          }\n          \n          lastScrollY = currentScrollY\n          ticking = false\n        })\n        ticking = true\n      }\n    }\n\n    // Initial state\n    handleScroll()\n    \n    window.addEventListener('scroll', handleScroll, { passive: true })\n    return () => window.removeEventListener('scroll', handleScroll)\n  }, [])\n\n  return (\n    <div className=\"user-shell\">\n      <header className={cn('user-shell-header', compact && 'is-compact')}>\n        <div className=\"user-shell-header__glow\" />\n        <div className=\"relative z-10 flex items-center justify-between\">\n          <div className=\"flex items-center gap-2.5\">\n            <img src={iraSathiLogo} alt=\"IRA Sathi\" className=\"h-11 w-auto transition-transform duration-200\" />\n            <span className=\"user-shell-header__logo-text\">IRA SATHI</span>\n          </div>\n          {/* Search Bar - Between Logo and Navigation (Laptop Only) */}\n          <div className=\"user-shell-header__search-bar ml-8\">\n            <div className=\"home-search-bar__input-wrapper\">\n              <SearchIcon className=\"home-search-bar__icon\" />\n              <TranslatedSearchInput onSearchClick={onSearchClick} />\n            </div>\n          </div>\n          {/* Laptop Navigation - Bottom Nav Items in Header */}\n          <nav className=\"user-shell-header__nav\">\n            <LanguageToggle variant=\"compact\" />\n            {navigation}\n            {/* Notifications Button - Adjacent to Navigation Items (Laptop Only) */}\n            <button\n              type=\"button\"\n              onClick={() => setNotificationsOpen(!notificationsOpen)}\n              className=\"user-shell-header__nav-notification\"\n              aria-label=\"Notifications\"\n            >\n              <span className=\"relative flex items-center justify-center w-11 h-11 rounded-2xl transition-all duration-200\"\n                style={{\n                  background: 'rgba(238, 245, 237, 0.7)',\n                  color: 'rgb(27, 143, 91)',\n                  boxShadow: 'rgba(30, 82, 54, 0.06) 0px 0px 0px 1px inset',\n                }}\n              >\n                <BellIcon className=\"h-5 w-5 stroke-[2.5]\" />\n                {notificationsCount > 0 && (\n                  <span className=\"absolute -top-1 -right-1 flex items-center justify-center min-w-[18px] h-[18px] px-1 rounded-full text-[0.65rem] font-bold text-white bg-red-500\">\n                    {notificationsCount > 99 ? '99+' : notificationsCount}\n                  </span>\n                )}\n              </span>\n            </button>\n          </nav>\n          <div className=\"flex items-center gap-2 user-shell-header__right-buttons\">\n            <button\n              type=\"button\"\n              onClick={onSearchClick}\n              className=\"flex items-center justify-center w-10 h-10 rounded-2xl border-none bg-transparent text-white transition-transform duration-200 hover:-translate-y-0.5 hover:opacity-85\"\n              aria-label=\"Search\"\n            >\n              <SearchIcon className=\"h-5 w-5 stroke-[2.5]\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setOpen(true)}\n              className=\"flex items-center justify-center w-10 h-10 rounded-2xl border-none bg-transparent text-white transition-transform duration-200 hover:-translate-y-0.5 hover:opacity-85\"\n              aria-label=\"Open menu\"\n            >\n              <MenuIcon className=\"h-5 w-5 stroke-[2.5]\" />\n            </button>\n          </div>\n        </div>\n        {/* Mobile Title/Subtitle - Original Position */}\n        {title && (\n          <div className={cn('user-shell-header__mobile-info relative z-10 flex flex-col gap-1 opacity-100 transition-all duration-300 pointer-events-auto', compact && 'is-compact')}>\n            <span className=\"relative z-10 text-[0.95rem] font-bold text-white tracking-[0.01em]\"><TransText>{title}</TransText></span>\n            {subtitle && (\n              <p className=\"relative z-10 text-[0.72rem] font-medium text-white/90 tracking-[0.04em] uppercase\">\n                <MapPinIcon className=\"mr-2 inline h-3.5 w-3.5\" />\n                <TransText>{subtitle}</TransText>\n              </p>\n            )}\n          </div>\n        )}\n        {/* Second Row - Title/Subtitle and Navigation Links (Laptop Only) */}\n        <div className={cn('user-shell-header__second-row', hideSecondRow && 'user-shell-header__second-row--hidden')}>\n          {title && (\n            <div className=\"user-shell-header__info\">\n              <span className=\"user-shell-header__title-text\"><TransText>{title}</TransText></span>\n              {subtitle && (\n                <p className=\"user-shell-header__subtitle-text\">\n                  <MapPinIcon className=\"mr-2 inline h-3.5 w-3.5\" />\n                  <TransText>{subtitle}</TransText>\n                </p>\n              )}\n            </div>\n          )}\n          <nav className=\"user-shell-header__links\">\n            <button\n              type=\"button\"\n              onClick={() => onNavigate?.('home')}\n              className=\"user-shell-header__link\"\n            >\n              <Trans>HOME</Trans>\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => onNavigate?.('favourites')}\n              className=\"user-shell-header__link\"\n            >\n              <Trans>FAVOURITES</Trans>\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => {\n                onNavigate?.('home')\n                // Scroll to categories section or trigger category view\n                setTimeout(() => {\n                  const categoriesSection = document.getElementById('home-categories')\n                  if (categoriesSection) {\n                    categoriesSection.scrollIntoView({ behavior: 'smooth' })\n                  }\n                }, 100)\n              }}\n              className=\"user-shell-header__link\"\n            >\n              <Trans>CATEGORIES</Trans>\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => onNavigate?.('orders')}\n              className=\"user-shell-header__link\"\n            >\n              <Trans>ORDERS</Trans>\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => onNavigate?.('account')}\n              className=\"user-shell-header__link\"\n            >\n              <Trans>ACCOUNT</Trans>\n            </button>\n            {isAuthenticated ? (\n              <button\n                type=\"button\"\n                onClick={onLogout}\n                className=\"user-shell-header__link user-shell-header__link--signout\"\n              >\n                <UserIcon className=\"h-4 w-4 mr-1.5\" />\n                <Trans>SIGNOUT</Trans>\n              </button>\n            ) : (\n              <button\n                type=\"button\"\n                onClick={onLogin}\n                className=\"user-shell-header__link user-shell-header__link--signin\"\n              >\n                <UserIcon className=\"h-4 w-4 mr-1.5\" />\n                <Trans>SIGNIN</Trans>\n              </button>\n            )}\n          </nav>\n        </div>\n      </header>\n\n      <main className=\"user-shell-content\">\n        <div className=\"space-y-6\">{children}</div>\n      </main>\n\n      <nav className=\"user-shell-bottom-nav\">\n        <div className=\"flex items-center justify-between ml-3 gap-3\">{bottomNavigation || navigation}</div>\n      </nav>\n\n      {/* Footer - Laptop Only */}\n      <footer className=\"user-shell-footer\">\n        <div className=\"user-shell-footer__top\">\n          <div className=\"user-shell-footer__content\">\n            {/* Brand Column */}\n            <div className=\"user-shell-footer__column\">\n              <h3 className=\"user-shell-footer__brand\"><Trans>IRA SATHI</Trans></h3>\n              <p className=\"user-shell-footer__slogan\"><Trans>Your Trusted Farming Partner</Trans></p>\n              <div className=\"user-shell-footer__about\">\n                <h4 className=\"user-shell-footer__heading\"><Trans>About Us</Trans></h4>\n                <p className=\"user-shell-footer__text\">\n                  <Trans>IRA Sathi is a comprehensive agricultural marketplace connecting farmers with quality seeds, fertilizers, pesticides, and farming equipment. We are committed to empowering farmers with the best agricultural products and services across India.</Trans>\n                </p>\n              </div>\n            </div>\n\n            {/* Services Column */}\n            <div className=\"user-shell-footer__column\">\n              <h4 className=\"user-shell-footer__heading\"><Trans>Services</Trans></h4>\n              <ul className=\"user-shell-footer__list\">\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>Seeds & Planting</Trans></a></li>\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>Fertilizers</Trans></a></li>\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>Pesticides</Trans></a></li>\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>Farming Equipment</Trans></a></li>\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>Expert Consultation</Trans></a></li>\n              </ul>\n            </div>\n\n            {/* Company Column */}\n            <div className=\"user-shell-footer__column\">\n              <h4 className=\"user-shell-footer__heading\"><Trans>Company</Trans></h4>\n              <ul className=\"user-shell-footer__list\">\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>About IRA Sathi</Trans></a></li>\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>Our Mission</Trans></a></li>\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>Become a Seller</Trans></a></li>\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>Careers</Trans></a></li>\n                <li><a href=\"#\" className=\"user-shell-footer__link\"><Trans>Contact Us</Trans></a></li>\n              </ul>\n            </div>\n\n            {/* Contact Column */}\n            <div className=\"user-shell-footer__column\">\n              <h4 className=\"user-shell-footer__heading\"><Trans>Contact us</Trans></h4>\n              <div className=\"user-shell-footer__contact\">\n                <p className=\"user-shell-footer__text\"><Trans>Call</Trans> : <a href=\"tel:+911234567890\" className=\"user-shell-footer__link\">+91 123 456 7890</a></p>\n                <p className=\"user-shell-footer__text\"><Trans>Email</Trans>: <a href=\"mailto:support@irasathi.com\" className=\"user-shell-footer__link\">support@irasathi.com</a></p>\n              </div>\n            </div>\n\n            {/* Newsletter Column */}\n            <div className=\"user-shell-footer__column\">\n              <div className=\"user-shell-footer__newsletter\">\n                <TranslatedEmailInput />\n                <button type=\"button\" className=\"user-shell-footer__subscribe-btn\">\n                  â†’\n                </button>\n              </div>\n              <div className=\"user-shell-footer__social\">\n                <a href=\"#\" className=\"user-shell-footer__social-icon\" aria-label=\"Facebook\">F</a>\n                <a href=\"#\" className=\"user-shell-footer__social-icon\" aria-label=\"Twitter\">T</a>\n                <a href=\"#\" className=\"user-shell-footer__social-icon\" aria-label=\"LinkedIn\">L</a>\n                <a href=\"#\" className=\"user-shell-footer__social-icon\" aria-label=\"WhatsApp\">W</a>\n                <a href=\"#\" className=\"user-shell-footer__social-icon\" aria-label=\"Instagram\">I</a>\n              </div>\n              <h4 className=\"user-shell-footer__heading\"><Trans>Follow Us</Trans></h4>\n            </div>\n          </div>\n        </div>\n        <div className=\"user-shell-footer__bottom\">\n          <div className=\"user-shell-footer__bottom-content\">\n            <div className=\"user-shell-footer__legal\">\n              <a href=\"#\" className=\"user-shell-footer__legal-link\"><Trans>Privacy Policy</Trans></a>\n              <span className=\"user-shell-footer__separator\">|</span>\n              <a href=\"#\" className=\"user-shell-footer__legal-link\"><Trans>Our History</Trans></a>\n              <span className=\"user-shell-footer__separator\">|</span>\n              <a href=\"#\" className=\"user-shell-footer__legal-link\"><Trans>What We Do</Trans></a>\n            </div>\n            <p className=\"user-shell-footer__copyright\">\n              <Trans>Â© 2025 IRA Sathi. All images are for demo purposes only.</Trans>\n            </p>\n          </div>\n        </div>\n      </footer>\n\n      <div\n        className={cn(\n          'fixed inset-0 z-40 bg-black/20 backdrop-blur-sm transition-opacity',\n          open ? 'pointer-events-auto opacity-100' : 'pointer-events-none opacity-0',\n        )}\n        onClick={() => setOpen(false)}\n      />\n\n      <aside\n        className={cn(\n          'fixed bottom-0 right-0 top-0 z-50 flex w-[78%] max-w-xs flex-col bg-white shadow-[-12px_0_36px_-26px_rgba(15,23,42,0.45)] transition-transform duration-300',\n          open ? 'translate-x-0' : 'translate-x-full',\n        )}\n      >\n        <div className=\"flex items-center justify-between px-4 pb-3 pt-6\">\n          <p className=\"text-sm font-semibold text-surface-foreground\">Menu</p>\n          <button\n            type=\"button\"\n            onClick={() => setOpen(false)}\n            className=\"flex h-9 w-9 items-center justify-center rounded-full border border-muted/60 text-muted-foreground\"\n            aria-label=\"Close menu\"\n          >\n            <CloseIcon className=\"h-4 w-4\" />\n          </button>\n        </div>\n        <div className=\"flex-1 overflow-y-auto px-3 pb-10\">\n          <div className=\"mb-4\">\n            <LanguageToggle variant=\"default\" onLanguageChange={() => setOpen(false)} />\n          </div>\n          {typeof menuContent === 'function'\n            ? menuContent({\n                close: () => setOpen(false),\n                onNavigate: () => setOpen(false),\n              })\n            : menuContent}\n        </div>\n      </aside>\n\n      <NotificationsDropdown\n        isOpen={notificationsOpen}\n        onClose={() => setNotificationsOpen(false)}\n      />\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\NotificationsDropdown.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\ProductCard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'stockStatusText' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":13,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { cn } from '../../../lib/cn'\nimport { StarIcon, HeartIcon } from './icons'\nimport { getPrimaryImageUrl } from '../utils/productImages'\nimport { TransText } from '../../../components/TransText'\nimport { Trans } from '../../../components/Trans'\n\nexport function ProductCard({ product, onAddToCart, onWishlist, onNavigate, className }) {\n  const inStock = product.stock > 0\n  const stockStatus = product.stock > 10 ? 'In Stock' : product.stock > 0 ? 'Low Stock' : 'Out of Stock'\n  const productImage = getPrimaryImageUrl(product)\n  \n  // Translate stock status\n  const stockStatusText = stockStatus === 'In Stock' ? 'In Stock' : stockStatus === 'Low Stock' ? 'Low Stock' : 'Out of Stock'\n\n  return (\n    <div\n      className={cn(\n        'product-card-wrapper',\n        !inStock && 'product-card-wrapper--out-of-stock',\n        className\n      )}\n      onClick={() => onNavigate?.(product.id)}\n    >\n      <div className=\"product-card-wrapper__image\">\n        <img src={productImage} alt={product.name} className=\"product-card-wrapper__image-img\" />\n        <button\n          type=\"button\"\n          className=\"product-card-wrapper__wishlist-btn\"\n          onClick={(e) => {\n            e.stopPropagation()\n            onWishlist?.(product.id)\n          }}\n          aria-label=\"Add to wishlist\"\n        >\n          <HeartIcon className=\"h-4 w-4\" filled={product.isWishlisted} />\n        </button>\n      </div>\n      <div className=\"product-card-wrapper__content\">\n        <div className=\"product-card-wrapper__header\">\n          <h3 className=\"product-card-wrapper__title\"><TransText>{product.name}</TransText></h3>\n          {(product.shortDescription || product.description) && (\n            <p className=\"product-card-wrapper__description\">\n              <TransText>{product.shortDescription || product.description}</TransText>\n            </p>\n          )}\n          {product.vendor && (\n            <p className=\"product-card-wrapper__vendor\"><TransText>{product.vendor.name}</TransText></p>\n          )}\n        </div>\n        <div className=\"product-card-wrapper__rating\">\n          <div className=\"product-card-wrapper__stars\">\n              {[1, 2, 3, 4, 5].map((star) => {\n                // Get rating from product.rating or product.averageRating\n                const rating = product.rating ?? product.averageRating ?? 0\n                return (\n                  <StarIcon\n                    key={star}\n                    className=\"h-3 w-3 text-yellow-400\"\n                    filled={star <= Math.round(rating)}\n                  />\n                )\n              })}\n            </div>\n          <span className=\"product-card-wrapper__rating-value\">\n            {(() => {\n              // Get rating from product.rating or product.averageRating\n              const rating = product.rating ?? product.averageRating ?? 0\n              return typeof rating === 'number' \n                ? rating.toFixed(1) \n                : parseFloat(rating || 0).toFixed(1)\n            })()}\n          </span>\n          <span className=\"product-card-wrapper__reviews\">\n            ({(() => {\n              // Get review count from product.reviews or product.reviewCount\n              const reviewCount = product.reviews ?? product.reviewCount ?? 0\n              return `${reviewCount} ${reviewCount === 1 ? 'review' : 'reviews'}`\n            })()})\n          </span>\n          </div>\n        <div className=\"product-card-wrapper__price-section\">\n          <span className=\"product-card-wrapper__price\">â‚¹{(product.priceToUser || product.price || 0).toLocaleString('en-IN')}</span>\n            {product.originalPrice && product.originalPrice > (product.priceToUser || product.price || 0) && (\n            <span className=\"product-card-wrapper__original-price\">â‚¹{product.originalPrice.toLocaleString('en-IN')}</span>\n            )}\n          </div>\n        <div className=\"product-card-wrapper__stock\">\n            <span className={cn(\n            'product-card-wrapper__stock-badge',\n            inStock ? 'product-card-wrapper__stock-badge--in-stock' : 'product-card-wrapper__stock-badge--out-of-stock'\n            )}>\n              <TransText>{stockStatus}</TransText>\n            </span>\n            {inStock && product.stock <= 10 && (\n            <span className=\"product-card-wrapper__stock-warning\"><Trans>Only</Trans> {product.stock} <Trans>left!</Trans></span>\n            )}\n        </div>\n        <button\n          type=\"button\"\n          className={cn(\n            'product-card-wrapper__add-btn',\n            !inStock && 'product-card-wrapper__add-btn--disabled'\n          )}\n          onClick={(e) => {\n            e.stopPropagation()\n            if (inStock) {\n              onAddToCart?.(product.id)\n            }\n          }}\n          disabled={!inStock}\n        >\n          {inStock ? <Trans>Add to Cart</Trans> : <Trans>Out of Stock</Trans>}\n        </button>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\ToastNotification.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[9,19],"text":""},"desc":"Remove unused variable 'useEffect'."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":42,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":42,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react'\nimport { createContext, useContext } from 'react'\nimport { cn } from '../../../lib/cn'\nimport { CheckIcon, XIcon } from './icons'\n\nconst ToastContext = createContext(null)\n\nexport function ToastProvider({ children }) {\n  const [toasts, setToasts] = useState([])\n\n  const addToast = (message, type = 'info', duration = 3000) => {\n    const id = Date.now() + Math.random()\n    const toast = { id, message, type }\n    setToasts((prev) => [...prev, toast])\n\n    if (duration > 0) {\n      setTimeout(() => {\n        dismissToast(id)\n      }, duration)\n    }\n\n    return id\n  }\n\n  const dismissToast = (id) => {\n    setToasts((prev) => prev.filter((toast) => toast.id !== id))\n  }\n\n  const success = (message, duration) => addToast(message, 'success', duration)\n  const error = (message, duration) => addToast(message, 'error', duration)\n  const warning = (message, duration) => addToast(message, 'warning', duration)\n  const info = (message, duration) => addToast(message, 'info', duration)\n\n  return (\n    <ToastContext.Provider value={{ toasts, addToast, dismissToast, success, error, warning, info }}>\n      {children}\n      <ToastContainer toasts={toasts} onDismiss={dismissToast} />\n    </ToastContext.Provider>\n  )\n}\n\nexport function useToast() {\n  const context = useContext(ToastContext)\n  if (!context) {\n    return {\n      toasts: [],\n      addToast: () => {},\n      dismissToast: () => {},\n      success: () => {},\n      error: () => {},\n      warning: () => {},\n      info: () => {},\n    }\n  }\n  return context\n}\n\nexport function ToastContainer({ toasts, onDismiss }) {\n  return (\n    <div className=\"user-toast-container\">\n      {toasts.map((toast) => (\n        <div\n          key={toast.id}\n          className={cn(\n            'user-toast',\n            `is-${toast.type}`,\n            'flex items-center gap-3.5 p-3.5 rounded-2xl cursor-pointer'\n          )}\n          onClick={() => onDismiss(toast.id)}\n        >\n          <div className={cn(\n            'flex items-center justify-center w-8 h-8 rounded-xl flex-shrink-0 text-[1.1rem] font-bold',\n            toast.type === 'success' && 'bg-gradient-to-br from-[rgba(43,118,79,0.18)] to-[rgba(43,118,79,0.08)] text-[#1b8f5b]',\n            toast.type === 'error' && 'bg-gradient-to-br from-[rgba(220,38,38,0.18)] to-[rgba(220,38,38,0.08)] text-[#dc2626]',\n            toast.type === 'warning' && 'bg-gradient-to-br from-[rgba(224,160,73,0.18)] to-[rgba(224,160,73,0.08)] text-[#9b6532]',\n            toast.type === 'info' && 'bg-gradient-to-br from-[rgba(33,150,173,0.18)] to-[rgba(33,150,173,0.08)] text-[rgba(16,102,112,0.9)]'\n          )}>\n            {toast.type === 'success' && <CheckIcon className=\"h-4 w-4\" />}\n            {toast.type === 'error' && <XIcon className=\"h-4 w-4\" />}\n            {toast.type === 'warning' && <span>âš </span>}\n            {toast.type === 'info' && <span>â„¹</span>}\n          </div>\n          <div className=\"flex-1\">\n            <p className={cn(\n              \"text-[0.85rem] font-semibold leading-relaxed m-0\",\n              toast.type === 'success' && \"text-[#1b8f5b]\",\n              toast.type === 'error' && \"text-[#dc2626]\",\n              toast.type === 'warning' && \"text-[#9b6532]\",\n              toast.type === 'info' && \"text-[rgba(16,102,112,0.9)]\",\n              !toast.type || (toast.type !== 'success' && toast.type !== 'error' && toast.type !== 'warning' && toast.type !== 'info') && \"text-[#172022]\"\n            )}>{toast.message}</p>\n          </div>\n          <button\n            type=\"button\"\n            className=\"flex items-center justify-center w-6 h-6 rounded-lg border-none bg-transparent text-[rgba(26,42,34,0.5)] text-[0.9rem] cursor-pointer transition-colors hover:bg-[rgba(26,42,34,0.08)] hover:text-[rgba(26,42,34,0.75)] flex-shrink-0\"\n            onClick={(e) => {\n              e.stopPropagation()\n              onDismiss(toast.id)\n            }}\n            aria-label=\"Dismiss\"\n          >\n            <XIcon className=\"h-3 w-3\" />\n          </button>\n        </div>\n      ))}\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\VendorAvailabilityWarning.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\components\\icons.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":23,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[770,785],"text":""},"desc":"Remove unused variable 'active'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":38,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[1216,1231],"text":""},"desc":"Remove unused variable 'active'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export function HomeIcon({ active = false, className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke={active ? 'currentColor' : 'currentColor'}>\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M3 10.5 11.469 3a1 1 0 0 1 1.333 0L21 10.5M5.5 9.5V20a1 1 0 0 0 1 1H10v-5a2 2 0 0 1 4 0v5h3.5a1 1 0 0 0 1-1V9.5\"\n      />\n    </svg>\n  )\n}\n\nexport function SearchIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n      <circle cx=\"11\" cy=\"11\" r=\"6\" strokeWidth=\"1.5\" />\n      <path d=\"m17 17 3 3\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n    </svg>\n  )\n}\n\nexport function CartIcon({ active = false, className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M3 4h2l1.6 9.6A2 2 0 0 0 8.57 15h7.86a2 2 0 0 0 1.97-1.4L20 7H6\"\n      />\n      <circle cx=\"9\" cy=\"19\" r=\"1\" />\n      <circle cx=\"17\" cy=\"19\" r=\"1\" />\n    </svg>\n  )\n}\n\nexport function UserIcon({ active = false, className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M16 7a4 4 0 1 1-8 0 4 4 0 0 1 8 0ZM12 14a7 7 0 0 0-7 7h14a7 7 0 0 0-7-7Z\"\n      />\n    </svg>\n  )\n}\n\nexport function MenuIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeWidth=\"1.5\" d=\"M4 7h16M4 12h16M4 17h10\" />\n    </svg>\n  )\n}\n\nexport function CloseIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeWidth=\"1.5\" d=\"m6 6 12 12M18 6 6 18\" />\n    </svg>\n  )\n}\n\nexport function MapPinIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M12 21c4.5-4.2 6.75-7.533 6.75-10.05A6.75 6.75 0 1 0 5.25 10.95C5.25 13.467 7.5 16.8 12 21Z\"\n      />\n      <circle cx=\"12\" cy=\"10.5\" r=\"1.8\" fill=\"currentColor\" />\n    </svg>\n  )\n}\n\nexport function FilterIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"2\"\n        d=\"M4 8h16M4 16h16\"\n      />\n      <circle cx=\"18\" cy=\"8\" r=\"2\" fill=\"currentColor\" />\n      <circle cx=\"6\" cy=\"16\" r=\"2\" fill=\"currentColor\" />\n    </svg>\n  )\n}\n\nexport function HeartIcon({ className = 'h-5 w-5', filled = false }) {\n  return (\n    <svg className={className} fill={filled ? 'currentColor' : 'none'} viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z\"\n      />\n    </svg>\n  )\n}\n\nexport function StarIcon({ className = 'h-5 w-5', filled = false }) {\n  return (\n    <svg className={className} fill={filled ? '#fbbf24' : 'none'} viewBox=\"0 0 24 24\" stroke={filled ? '#fbbf24' : '#fbbf24'} strokeWidth=\"1.5\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        d=\"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z\"\n      />\n    </svg>\n  )\n}\n\nexport function ChevronRightIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"m9 18 6-6-6-6\" />\n    </svg>\n  )\n}\n\nexport function ChevronLeftIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"m15 18-6-6 6-6\" />\n    </svg>\n  )\n}\n\nexport function ChevronDownIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"m19 9-7 7-7-7\" />\n    </svg>\n  )\n}\n\nexport function PlusIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"M12 4.5v15m7.5-7.5h-15\" />\n    </svg>\n  )\n}\n\nexport function MinusIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"M5 12h14\" />\n    </svg>\n  )\n}\n\nexport function TrashIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\n      />\n    </svg>\n  )\n}\n\nexport function TruckIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n      <path\n        d=\"M3 7h11v8H3zM14 9h4l3 3v3h-4\"\n        strokeWidth=\"1.5\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n      <circle cx=\"7\" cy=\"17\" r=\"2\" />\n      <circle cx=\"17\" cy=\"17\" r=\"2\" />\n    </svg>\n  )\n}\n\nexport function CreditCardIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <rect x=\"3\" y=\"5\" width=\"18\" height=\"14\" rx=\"3\" ry=\"3\" strokeWidth=\"1.5\" />\n      <path strokeWidth=\"1.5\" strokeLinecap=\"round\" d=\"M3 10h18\" />\n    </svg>\n  )\n}\n\nexport function PackageIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z\"\n      />\n    </svg>\n  )\n}\n\nexport function ClockIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z\"\n      />\n    </svg>\n  )\n}\n\nexport function CheckCircleIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\n      />\n    </svg>\n  )\n}\n\nexport function CheckIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M5 13l4 4L19 7\" />\n    </svg>\n  )\n}\n\nexport function EditIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10\"\n      />\n    </svg>\n  )\n}\n\nexport function XIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n    </svg>\n  )\n}\n\nexport function ShieldCheckIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z\"\n      />\n    </svg>\n  )\n}\n\nexport function HelpCircleIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z\"\n      />\n    </svg>\n  )\n}\n\nexport function BellIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0\"\n      />\n    </svg>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\context\\UserContext.jsx","messages":[{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":82,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":82,"endColumn":98,"suggestions":[{"messageId":"addBrackets","fix":{"range":[2104,2575],"text":"{ const existingItem = state.cart.find((item) => item.productId === action.payload.productId)\n      if (existingItem) {\n        return {\n          ...state,\n          cart: state.cart.map((item) =>\n            item.productId === action.payload.productId\n              ? { ...item, quantity: item.quantity + action.payload.quantity }\n              : item,\n          ),\n        }\n      }\n      return {\n        ...state,\n        cart: [...state.cart, action.payload],\n      } }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'isInitialized' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":211,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":211,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"isInitialized"},"fix":{"range":[5839,5852],"text":""},"desc":"Remove unused variable 'isInitialized'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'state.favourites.length'. Either include it or remove the dependency array.","line":406,"column":6,"nodeType":"ArrayExpression","endLine":406,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [state.favourites.length]","fix":{"range":[12706,12708],"text":"[state.favourites.length]"}}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":423,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":423,"endColumn":29},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":429,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":429,"endColumn":32}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useMemo, useReducer, useEffect, useState } from 'react'\nimport { initializeRealtimeConnection, handleRealtimeNotification, getUserProfile } from '../services/userApi'\n\nconst UserStateContext = createContext(null)\nconst UserDispatchContext = createContext(() => { })\n\nconst initialState = {\n  authenticated: false,\n  profile: {\n    name: 'Guest User',\n    email: '',\n    phone: '',\n    sellerId: null, // Seller ID linked to user\n    location: {\n      address: '',\n      city: '',\n      state: '',\n      pincode: '',\n      coordinates: null,\n    },\n  },\n  cart: [],\n  orders: [],\n  addresses: [],\n  paymentMethods: [],\n  favourites: [],\n  notifications: [],\n  assignedVendor: null, // Vendor assigned based on location (20km radius)\n  vendorAvailability: {\n    vendorAvailable: false,\n    canPlaceOrder: false,\n    isInBufferZone: false, // Within 300m buffer (20km to 20.3km) - no warning shown\n  },\n  realtimeConnected: false,\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'AUTH_LOGIN':\n      return {\n        ...state,\n        authenticated: true,\n        profile: {\n          ...state.profile,\n          ...action.payload,\n          sellerId: action.payload.sellerId || state.profile.sellerId, // Preserve sellerId if not provided\n        },\n      }\n    case 'UPDATE_SELLER_ID':\n      return {\n        ...state,\n        profile: {\n          ...state.profile,\n          sellerId: action.payload,\n        },\n      }\n    case 'SET_ASSIGNED_VENDOR':\n      return {\n        ...state,\n        assignedVendor: action.payload,\n      }\n    case 'SET_VENDOR_AVAILABILITY':\n      return {\n        ...state,\n        vendorAvailability: action.payload,\n      }\n    case 'SET_REALTIME_CONNECTED':\n      return {\n        ...state,\n        realtimeConnected: action.payload,\n      }\n    case 'AUTH_LOGOUT':\n      return {\n        ...state,\n        authenticated: false,\n        profile: initialState.profile,\n        cart: [],\n        vendorAvailability: initialState.vendorAvailability,\n        assignedVendor: null,\n      }\n    case 'ADD_TO_CART':\n      const existingItem = state.cart.find((item) => item.productId === action.payload.productId)\n      if (existingItem) {\n        return {\n          ...state,\n          cart: state.cart.map((item) =>\n            item.productId === action.payload.productId\n              ? { ...item, quantity: item.quantity + action.payload.quantity }\n              : item,\n          ),\n        }\n      }\n      return {\n        ...state,\n        cart: [...state.cart, action.payload],\n      }\n    case 'UPDATE_CART_ITEM':\n      return {\n        ...state,\n        cart: state.cart.map((item) =>\n          item.productId === action.payload.productId\n            ? { ...item, quantity: action.payload.quantity }\n            : item,\n        ),\n      }\n    case 'REMOVE_FROM_CART':\n      return {\n        ...state,\n        cart: state.cart.filter((item) => item.productId !== action.payload.productId),\n      }\n    case 'CLEAR_CART':\n      return {\n        ...state,\n        cart: [],\n      }\n    case 'SET_CART_ITEMS':\n      return {\n        ...state,\n        cart: Array.isArray(action.payload) ? action.payload : [],\n      }\n    case 'ADD_ORDER':\n      // Note: Cart is NOT cleared here. It will be cleared only after successful payment confirmation\n      // This ensures cart items remain available if user cancels payment or payment fails\n      return {\n        ...state,\n        orders: [...state.orders, action.payload],\n        // cart: [] - Removed: Cart should only be cleared after payment is confirmed\n      }\n    case 'UPDATE_ORDER':\n      return {\n        ...state,\n        orders: state.orders.map((order) =>\n          order.id === action.payload.id ? { ...order, ...action.payload } : order,\n        ),\n      }\n    case 'ADD_ADDRESS':\n      return {\n        ...state,\n        addresses: [...state.addresses, action.payload],\n      }\n    case 'UPDATE_ADDRESS':\n      return {\n        ...state,\n        addresses: state.addresses.map((addr) =>\n          addr.id === action.payload.id ? { ...addr, ...action.payload } : addr,\n        ),\n      }\n    case 'SET_DEFAULT_ADDRESS':\n      return {\n        ...state,\n        addresses: state.addresses.map((addr) => ({\n          ...addr,\n          isDefault: addr.id === action.payload.id,\n        })),\n      }\n    case 'DELETE_ADDRESS':\n      return {\n        ...state,\n        addresses: state.addresses.filter((addr) => addr.id !== action.payload.id),\n      }\n    case 'CLEAR_ADDRESSES':\n      return {\n        ...state,\n        addresses: [],\n      }\n    case 'ADD_TO_FAVOURITES':\n      if (state.favourites.includes(action.payload.productId)) {\n        return state\n      }\n      return {\n        ...state,\n        favourites: [...state.favourites, action.payload.productId],\n      }\n    case 'REMOVE_FROM_FAVOURITES':\n      return {\n        ...state,\n        favourites: state.favourites.filter((id) => id !== action.payload.productId),\n      }\n    case 'ADD_NOTIFICATION':\n      return {\n        ...state,\n        notifications: [\n          {\n            id: Date.now().toString(),\n            ...action.payload,\n            read: false,\n            timestamp: new Date().toISOString(),\n          },\n          ...state.notifications,\n        ],\n      }\n    case 'MARK_NOTIFICATION_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) =>\n          notif.id === action.payload.id ? { ...notif, read: true } : notif,\n        ),\n      }\n    case 'MARK_ALL_NOTIFICATIONS_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) => ({ ...notif, read: true })),\n      }\n    default:\n      return state\n  }\n}\n\nexport function UserProvider({ children }) {\n  const [state, dispatch] = useReducer(reducer, initialState)\n  const [isInitialized, setIsInitialized] = useState(false)\n\n  // Initialize user session from stored token on mount\n  useEffect(() => {\n    const initializeUser = async () => {\n      const token = localStorage.getItem('user_token')\n      if (token && !state.authenticated) {\n        try {\n          const profileResult = await getUserProfile()\n\n          if (profileResult.success && profileResult.data?.user) {\n            const userData = profileResult.data.user\n            dispatch({\n              type: 'AUTH_LOGIN',\n              payload: {\n                name: userData.name || 'User',\n                phone: userData.phone || '',\n                email: userData.email || '',\n                sellerId: userData.sellerId || null,\n                location: userData.location || null,\n              },\n            })\n\n            // Set vendor availability status from profile if available\n            if (profileResult.data?.vendorAvailability) {\n              dispatch({\n                type: 'SET_VENDOR_AVAILABILITY',\n                payload: profileResult.data.vendorAvailability,\n              })\n\n              // Set assigned vendor if available\n              if (profileResult.data.vendorAvailability.assignedVendor) {\n                dispatch({\n                  type: 'SET_ASSIGNED_VENDOR',\n                  payload: profileResult.data.vendorAvailability.assignedVendor,\n                })\n              }\n            }\n          } else {\n            // Token is invalid, remove it\n            localStorage.removeItem('user_token')\n          }\n        } catch (error) {\n          console.error('Failed to initialize user session:', error)\n          // Token might be invalid or expired, remove it\n          localStorage.removeItem('user_token')\n        }\n      }\n      setIsInitialized(true)\n    }\n\n    initializeUser()\n  }, [state.authenticated]) // Re-run when authenticated state changes\n\n  // Initialize real-time connection when authenticated\n  useEffect(() => {\n    if (state.authenticated && state.profile.phone) {\n      const cleanup = initializeRealtimeConnection((notification) => {\n        const processedNotification = handleRealtimeNotification(notification)\n\n        // Handle different notification types\n        switch (processedNotification.type) {\n          case 'payment_reminder':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'payment',\n                title: 'Payment Reminder',\n                message: `Please complete the remaining payment of â‚¹${processedNotification.amount} for Order #${processedNotification.orderId}`,\n                orderId: processedNotification.orderId,\n                amount: processedNotification.amount,\n                read: false,\n              },\n            })\n            break\n\n          case 'delivery_update':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'delivery',\n                title: 'Delivery Update',\n                message: processedNotification.message || `Your order #${processedNotification.orderId} status has been updated`,\n                orderId: processedNotification.orderId,\n                status: processedNotification.status,\n                read: false,\n              },\n            })\n            // Update order status if order exists\n            if (processedNotification.orderId) {\n              dispatch({\n                type: 'UPDATE_ORDER',\n                payload: {\n                  id: processedNotification.orderId,\n                  status: processedNotification.status,\n                },\n              })\n            }\n            break\n\n          case 'order_assigned':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'order',\n                title: 'Order Assigned',\n                message: `Your order #${processedNotification.orderId} has been assigned to ${processedNotification.vendorName}`,\n                orderId: processedNotification.orderId,\n                read: false,\n              },\n            })\n            break\n\n          case 'order_delivered':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'delivery',\n                title: 'Order Delivered',\n                message: `Your order #${processedNotification.orderId} has been delivered. Please complete the remaining payment.`,\n                orderId: processedNotification.orderId,\n                read: false,\n              },\n            })\n            // Update order status\n            if (processedNotification.orderId) {\n              dispatch({\n                type: 'UPDATE_ORDER',\n                payload: {\n                  id: processedNotification.orderId,\n                  status: 'delivered',\n                  deliveryDate: processedNotification.deliveryDate || new Date().toISOString(),\n                },\n              })\n            }\n            break\n\n          case 'offer':\n          case 'announcement':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: processedNotification.type,\n                title: processedNotification.title,\n                message: processedNotification.message,\n                read: false,\n              },\n            })\n            break\n\n          default:\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                ...processedNotification,\n                read: false,\n              },\n            })\n        }\n      })\n\n      dispatch({ type: 'SET_REALTIME_CONNECTED', payload: true })\n\n      return () => {\n        cleanup()\n        dispatch({ type: 'SET_REALTIME_CONNECTED', payload: false })\n      }\n    }\n  }, [state.authenticated, state.profile.phone])\n\n  // Persist favourites to localStorage\n  useEffect(() => {\n    // Load favourites from localStorage on mount\n    const savedFavourites = localStorage.getItem('user_favourites')\n    if (savedFavourites) {\n      try {\n        const parsed = JSON.parse(savedFavourites)\n        if (Array.isArray(parsed) && parsed.length > 0) {\n          // Only load if there are no favourites in state yet (initial load)\n          if (state.favourites.length === 0) {\n            parsed.forEach(productId => {\n              dispatch({ type: 'ADD_TO_FAVOURITES', payload: { productId } })\n            })\n          }\n        }\n      } catch (error) {\n        console.error('Error loading favourites from localStorage:', error)\n      }\n    }\n  }, []) // Run only on mount\n\n  // Save favourites to localStorage whenever they change\n  useEffect(() => {\n    if (state.favourites.length >= 0) {\n      localStorage.setItem('user_favourites', JSON.stringify(state.favourites))\n    }\n  }, [state.favourites])\n\n  const value = useMemo(() => state, [state])\n  return (\n    <UserStateContext.Provider value={value}>\n      <UserDispatchContext.Provider value={dispatch}>{children}</UserDispatchContext.Provider>\n    </UserStateContext.Provider>\n  )\n}\n\nexport function useUserState() {\n  const context = useContext(UserStateContext)\n  if (!context) throw new Error('useUserState must be used within UserProvider')\n  return context\n}\n\nexport function useUserDispatch() {\n  const dispatch = useContext(UserDispatchContext)\n  if (!dispatch) throw new Error('useUserDispatch must be used within UserProvider')\n  return dispatch\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\hooks\\useUserApi.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used.","line":281,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":281,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[7091,7095],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used.","line":327,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":327,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[8188,8192],"text":""},"desc":"Remove unused variable 'data'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Custom hook for User API integration\n * Provides easy access to API functions with loading states and error handling\n */\n\nimport { useState, useCallback } from 'react'\nimport { useUserDispatch } from '../context/UserContext'\nimport * as userApi from '../services/userApi'\n\nexport function useUserApi() {\n  const dispatch = useUserDispatch()\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  const handleApiCall = useCallback(\n    async (apiFunction, successAction, errorMessage, ...args) => {\n      setLoading(true)\n      setError(null)\n      try {\n        const result = await apiFunction(...args)\n        if (result.success) {\n          if (successAction) {\n            // Extract the actual data object from result.data before dispatching\n            dispatch(successAction(result.data))\n          }\n          return { data: result.data, error: null }\n        } else {\n          setError(result.error?.message || errorMessage || 'An error occurred')\n          return { data: null, error: result.error }\n        }\n      } catch (err) {\n        const errorMsg = err.error?.message || err.message || errorMessage || 'An unexpected error occurred'\n        setError(errorMsg)\n        return { data: null, error: { message: errorMsg } }\n      } finally {\n        setLoading(false)\n      }\n    },\n    [dispatch],\n  )\n\n  // Authentication APIs\n  const requestOTP = useCallback(\n    async (phone, language = 'en') => {\n      return handleApiCall(\n        () => userApi.requestOTP({ phone, language }),\n        null,\n        'Failed to send OTP',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const verifyOTP = useCallback(\n    async (phone, otp, sellerId = null) => {\n      return handleApiCall(\n        () => userApi.verifyOTP({ phone, otp, sellerId }),\n        (data) => ({\n          type: 'AUTH_LOGIN',\n          payload: {\n            ...data.user,\n            sellerId: data.user?.sellerId || sellerId,\n          },\n        }),\n        'Failed to verify OTP',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const getSellerID = useCallback(\n    async () => {\n      return handleApiCall(\n        () => userApi.getSellerID(),\n        (data) => ({\n          type: 'UPDATE_SELLER_ID',\n          payload: data.sellerId,\n        }),\n        'Failed to get Seller ID',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Product APIs\n  const fetchProducts = useCallback(\n    async (params = {}) => {\n      return handleApiCall(\n        () => userApi.getProducts(params),\n        null,\n        'Failed to load products',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchProductDetails = useCallback(\n    async (productId) => {\n      return handleApiCall(\n        () => userApi.getProductDetails(productId),\n        null,\n        'Failed to load product details',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchCategories = useCallback(async () => {\n    return handleApiCall(\n      userApi.getCategories,\n      null,\n      'Failed to load categories',\n    )\n  }, [handleApiCall])\n\n  // Cart APIs\n  const addToCart = useCallback(\n    async (productId, quantity, variantAttributes = null) => {\n      const payload = { productId, quantity }\n      if (variantAttributes && Object.keys(variantAttributes).length > 0) {\n        payload.variantAttributes = variantAttributes\n      }\n      return handleApiCall(\n        () => userApi.addToCart(payload),\n        () => ({\n          type: 'ADD_TO_CART',\n          payload: { productId, quantity, variantAttributes },\n        }),\n        'Failed to add to cart',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const updateCartItem = useCallback(\n    async (itemId, quantity) => {\n      return handleApiCall(\n        () => userApi.updateCartItem(itemId, { quantity }),\n        () => ({\n          type: 'UPDATE_CART_ITEM',\n          payload: { productId: itemId, quantity },\n        }),\n        'Failed to update cart',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const removeFromCart = useCallback(\n    async (itemId) => {\n      return handleApiCall(\n        () => userApi.removeFromCart(itemId),\n        () => ({\n          type: 'REMOVE_FROM_CART',\n          payload: { productId: itemId },\n        }),\n        'Failed to remove from cart',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchCart = useCallback(async () => {\n    return handleApiCall(\n      userApi.getCart,\n      null, // Don't auto-dispatch, handle manually\n      'Failed to load cart',\n    )\n  }, [handleApiCall])\n\n  const validateCart = useCallback(async () => {\n    return handleApiCall(\n      userApi.validateCart,\n      null,\n      'Failed to validate cart',\n    )\n  }, [handleApiCall])\n\n  // Vendor Assignment APIs\n  const assignVendor = useCallback(\n    async (location) => {\n      return handleApiCall(\n        () => userApi.getAssignedVendor({ location }),\n        (data) => ({\n          type: 'SET_ASSIGNED_VENDOR',\n          payload: data.vendor,\n        }),\n        'Failed to assign vendor',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const checkVendorStock = useCallback(\n    async (vendorId, productIds) => {\n      return handleApiCall(\n        () => userApi.checkVendorStock({ vendorId, productIds }),\n        null,\n        'Failed to check vendor stock',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Order APIs\n  const createOrder = useCallback(\n    async (orderData) => {\n      return handleApiCall(\n        () => userApi.createOrder(orderData),\n        (data) => ({\n          type: 'ADD_ORDER',\n          payload: data.order || data,\n        }),\n        'Failed to create order',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchOrders = useCallback(\n    async (params = {}) => {\n      return handleApiCall(\n        () => userApi.getOrders(params),\n        null,\n        'Failed to load orders',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchOrderDetails = useCallback(\n    async (orderId) => {\n      return handleApiCall(\n        () => userApi.getOrderDetails(orderId),\n        null,\n        'Failed to load order details',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Payment APIs\n  const createPaymentIntent = useCallback(\n    async (data) => {\n      // Accept object parameter: { orderId, amount?, paymentMethod? }\n      return handleApiCall(\n        () => userApi.createPaymentIntent(data),\n        null,\n        'Failed to create payment intent',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const confirmPayment = useCallback(\n    async (paymentData) => {\n      return handleApiCall(\n        () => userApi.confirmPayment(paymentData),\n        null,\n        'Failed to confirm payment',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const createRemainingPaymentIntent = useCallback(\n    async (orderId, paymentMethod) => {\n      return handleApiCall(\n        () => userApi.createRemainingPaymentIntent({ orderId, paymentMethod }),\n        null,\n        'Failed to create remaining payment intent',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const confirmRemainingPayment = useCallback(\n    async (paymentData) => {\n      return handleApiCall(\n        () => userApi.confirmRemainingPayment(paymentData),\n        (data) => ({\n          type: 'UPDATE_ORDER',\n          payload: {\n            id: paymentData.orderId,\n            paymentStatus: 'fully_paid',\n          },\n        }),\n        'Failed to confirm remaining payment',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Address APIs\n  const addAddress = useCallback(\n    async (addressData) => {\n      return handleApiCall(\n        () => userApi.addAddress(addressData),\n        (data) => ({\n          type: 'ADD_ADDRESS',\n          payload: data.address || data,\n        }),\n        'Failed to add address',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const updateAddress = useCallback(\n    async (addressId, addressData) => {\n      return handleApiCall(\n        () => userApi.updateAddress(addressId, addressData),\n        (data) => ({\n          type: 'UPDATE_ADDRESS',\n          payload: { id: addressId, ...data },\n        }),\n        'Failed to update address',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const deleteAddress = useCallback(\n    async (addressId) => {\n      return handleApiCall(\n        () => userApi.deleteAddress(addressId),\n        (data) => ({\n          type: 'DELETE_ADDRESS',\n          payload: { id: addressId },\n        }),\n        'Failed to delete address',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Favourites APIs\n  const addToFavourites = useCallback(\n    async (productId) => {\n      return handleApiCall(\n        () => userApi.addToFavourites({ productId }),\n        () => ({\n          type: 'ADD_TO_FAVOURITES',\n          payload: { productId },\n        }),\n        'Failed to add to favourites',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const removeFromFavourites = useCallback(\n    async (productId) => {\n      return handleApiCall(\n        () => userApi.removeFromFavourites(productId),\n        () => ({\n          type: 'REMOVE_FROM_FAVOURITES',\n          payload: { productId },\n        }),\n        'Failed to remove from favourites',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Profile APIs\n  const updateUserProfile = useCallback(\n    async (profileData) => {\n      return handleApiCall(\n        () => userApi.updateUserProfile(profileData),\n        (data) => ({\n          type: 'AUTH_LOGIN',\n          payload: data.user || data,\n        }),\n        'Failed to update profile',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Support APIs\n  const createSupportTicket = useCallback(\n    async (ticketData) => {\n      return handleApiCall(\n        () => userApi.createSupportTicket(ticketData),\n        null,\n        'Failed to create support ticket',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const initiateSupportCall = useCallback(\n    async (orderId, issue) => {\n      return handleApiCall(\n        () => userApi.initiateSupportCall({ orderId, issue }),\n        null,\n        'Failed to initiate support call',\n      )\n    },\n    [handleApiCall],\n  )\n\n  return {\n    loading,\n    error,\n    requestOTP,\n    verifyOTP,\n    getSellerID,\n    fetchProducts,\n    fetchProductDetails,\n    fetchCategories,\n    fetchCart,\n    addToCart,\n    updateCartItem,\n    removeFromCart,\n    validateCart,\n    assignVendor,\n    checkVendorStock,\n    createOrder,\n    fetchOrders,\n    fetchOrderDetails,\n    createPaymentIntent,\n    confirmPayment,\n    createRemainingPaymentIntent,\n    confirmRemainingPayment,\n    addAddress,\n    updateAddress,\n    deleteAddress,\n    addToFavourites,\n    removeFromFavourites,\n    updateUserProfile,\n    createSupportTicket,\n    initiateSupportCall,\n  }\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\UserAuth.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\UserDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'location' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":71,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'toasts' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":81,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"toasts"},"fix":{"range":[3295,3302],"text":""},"desc":"Remove unused variable 'toasts'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'dismissToast' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":81,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"dismissToast"},"fix":{"range":[3301,3315],"text":""},"desc":"Remove unused variable 'dismissToast'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'info' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":81,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"info"},"fix":{"range":[3340,3346],"text":""},"desc":"Remove unused variable 'info'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setIsLaptopView' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":92,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":92,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"setIsLaptopView"},"fix":{"range":[3996,4013],"text":""},"desc":"Remove unused variable 'setIsLaptopView'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'validTabs'. Either include it or remove the dependency array.","line":123,"column":6,"nodeType":"ArrayExpression","endLine":123,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [urlTab, navigate, searchParams, validTabs]","fix":{"range":[5290,5322],"text":"[urlTab, navigate, searchParams, validTabs]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'validTabs'. Either include it or remove the dependency array.","line":152,"column":6,"nodeType":"ArrayExpression","endLine":152,"endColumn":45,"suggestions":[{"desc":"Update the dependencies array to be: [authenticated, validTabs, isLaptopView, navigate]","fix":{"range":[6367,6406],"text":"[authenticated, validTabs, isLaptopView, navigate]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleFavouritesClick' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":891,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":891,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'productId' is defined but never used.","line":1161,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":1161,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"productId"},"fix":{"range":[40816,40825],"text":""},"desc":"Remove unused variable 'productId'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'actionType' is defined but never used.","line":1287,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":1287,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"actionType"},"fix":{"range":[45618,45628],"text":""},"desc":"Remove unused variable 'actionType'."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport { useNavigate, useLocation, useParams, useSearchParams } from 'react-router-dom'\nimport { useUserDispatch, useUserState } from '../context/UserContext'\nimport { MobileShell } from '../components/MobileShell'\nimport { BottomNavItem } from '../components/BottomNavItem'\nimport { MenuList } from '../components/MenuList'\nimport { HomeIcon, SearchIcon, CartIcon, UserIcon, MenuIcon, HeartIcon, PackageIcon } from '../components/icons'\nimport { Trans } from '../../../components/Trans'\nimport { MIN_ORDER_VALUE } from '../services/userData'\nimport * as userApi from '../services/userApi'\nimport { cn } from '../../../lib/cn'\nimport { useToast, ToastProvider } from '../components/ToastNotification'\nimport { useUserApi } from '../hooks/useUserApi'\nimport { useTranslatedNavItems } from '../../../utils/translateNavItems'\nimport { HomeView } from './views/HomeView'\nimport { SearchView } from './views/SearchView'\nimport { ProductDetailView } from './views/ProductDetailView'\nimport { CartView } from './views/CartView'\nimport { CheckoutView } from './views/CheckoutView'\nimport { OrderConfirmationView } from './views/OrderConfirmationView'\nimport { AccountView } from './views/AccountView'\nimport { FavouritesView } from './views/FavouritesView'\nimport { CategoryProductsView } from './views/CategoryProductsView'\nimport { CarouselProductsView } from './views/CarouselProductsView'\nimport { OrdersView } from './views/OrdersView'\nimport { LoginPageView } from './views/LoginPageView'\nimport { SignupPageView } from './views/SignupPageView'\nimport { VendorAvailabilityWarning } from '../components/VendorAvailabilityWarning'\nimport { AuthPromptModal } from '../components/AuthPromptModal'\nimport { AuthPromptLaptop } from '../components/AuthPromptLaptop'\nimport { AuthPromptMobile } from '../components/AuthPromptMobile'\nimport '../user.css'\n\nconst NAV_ITEMS = [\n  {\n    id: 'home',\n    label: 'Home',\n    description: 'Browse products and categories',\n    icon: HomeIcon,\n  },\n  {\n    id: 'favourites',\n    label: 'Favourites',\n    description: 'Your favourite products',\n    icon: HeartIcon,\n  },\n  {\n    id: 'cart',\n    label: 'Cart',\n    description: 'Your shopping cart',\n    icon: CartIcon,\n  },\n  {\n    id: 'orders',\n    label: 'Orders',\n    description: 'Your orders',\n    icon: PackageIcon,\n  },\n  {\n    id: 'account',\n    label: 'Account',\n    description: 'Orders, profile, settings',\n    icon: UserIcon,\n  },\n]\n\nfunction UserDashboardContent({ onLogout }) {\n  const { profile, cart, favourites, notifications, orders, authenticated } = useUserState()\n  const dispatch = useUserDispatch()\n  const navigate = useNavigate()\n  const location = useLocation()\n  const { tab: urlTab } = useParams()\n  const [searchParams] = useSearchParams()\n  const [activeTab, setActiveTab] = useState('home')\n  const [cartRefreshKey, setCartRefreshKey] = useState(0) // Key to force CartView refresh\n  const [selectedProduct, setSelectedProduct] = useState(null)\n  const [selectedCategory, setSelectedCategory] = useState(null)\n  const [selectedCarousel, setSelectedCarousel] = useState(null)\n  const [showCheckout, setShowCheckout] = useState(false)\n  const [orderConfirmation, setOrderConfirmation] = useState(null)\n  const { toasts, dismissToast, success, error, warning, info } = useToast()\n  const [searchMounted, setSearchMounted] = useState(false)\n  const [searchOpen, setSearchOpen] = useState(false)\n  const [searchQuery, setSearchQuery] = useState('')\n  const searchInputRef = useRef(null)\n  const searchPanelRef = useRef(null)\n  const [keyboardHeight, setKeyboardHeight] = useState(0)\n  const [showAuthModal, setShowAuthModal] = useState(false)\n  const [showAuthPromptLaptop, setShowAuthPromptLaptop] = useState(false)\n  const [authActionType, setAuthActionType] = useState(null) // 'favourites' | 'cart' | 'orders' | null\n  const [hasShownInitialModal, setHasShownInitialModal] = useState(false)\n  const [isLaptopView, setIsLaptopView] = useState(window.innerWidth >= 1024)\n\n  // Valid tabs for navigation\n  const validTabs = ['home', 'favourites', 'cart', 'orders', 'account', 'search', 'product-detail', 'category-products', 'carousel-products', 'checkout', 'login', 'signup', 'signin']\n\n  // Initialize tab from URL parameter on mount or when URL changes\n  useEffect(() => {\n    const tab = urlTab || 'home'\n    if (validTabs.includes(tab)) {\n      setActiveTab(tab)\n\n      // Extract category ID from URL search params for category-products page\n      if (tab === 'category-products') {\n        const categoryIdFromUrl = searchParams.get('category')\n        if (categoryIdFromUrl) {\n          setSelectedCategory(categoryIdFromUrl)\n        } else {\n          // Default to 'all' if no category in URL\n          setSelectedCategory('all')\n        }\n      } else {\n        // Clear selections when navigating to a different tab\n        if (tab !== 'product-detail') setSelectedProduct(null)\n        if (tab !== 'category-products') setSelectedCategory(null)\n        if (tab !== 'carousel-products') setSelectedCarousel(null)\n        if (tab !== 'checkout') setShowCheckout(false)\n      }\n    } else {\n      // Invalid tab, redirect to home\n      navigate('/user/dashboard/home', { replace: true })\n    }\n  }, [urlTab, navigate, searchParams])\n\n  // Navigate function that updates both state and URL\n  const navigateToTab = useCallback((tab) => {\n    // Check authentication for orders tab\n    if (tab === 'orders' && !authenticated) {\n      if (isLaptopView) {\n        // Show prompt on laptop\n        setAuthActionType('orders')\n        setShowAuthPromptLaptop(true)\n      } else {\n        // Show modal on mobile\n        setAuthActionType('orders')\n        setShowAuthModal(true)\n      }\n      return\n    }\n\n    if (validTabs.includes(tab)) {\n      // Handle signin as alias for login\n      const targetTab = tab === 'signin' ? 'login' : tab\n      setActiveTab(targetTab)\n      navigate(`/user/dashboard/${targetTab}`, { replace: false })\n      // Clear selections when navigating to a different tab type\n      if (targetTab !== 'product-detail') setSelectedProduct(null)\n      if (targetTab !== 'category-products') setSelectedCategory(null)\n      if (targetTab !== 'carousel-products') setSelectedCarousel(null)\n      if (targetTab !== 'checkout') setShowCheckout(false)\n    }\n  }, [navigate, authenticated, isLaptopView])\n\n  // Scroll to top when tab changes\n  useEffect(() => {\n    window.scrollTo(0, 0)\n  }, [activeTab])\n\n  // Fetch user profile from API on mount\n  useEffect(() => {\n    const token = localStorage.getItem('user_token')\n    if (token) {\n      // Fetch user profile from backend\n      const fetchProfile = async () => {\n        try {\n          const result = await userApi.getUserProfile()\n          if (result.success && result.data?.user) {\n            const userData = result.data.user\n            dispatch({\n              type: 'AUTH_LOGIN',\n              payload: {\n                name: userData.name || 'User',\n                phone: userData.phone || '',\n                email: userData.email || '',\n                sellerId: userData.sellerId || null,\n                location: userData.location || null,\n              },\n            })\n\n            // Set vendor availability status from profile\n            if (result.data?.vendorAvailability) {\n              dispatch({\n                type: 'SET_VENDOR_AVAILABILITY',\n                payload: result.data.vendorAvailability,\n              })\n\n              // Set assigned vendor if available\n              if (result.data.vendorAvailability.assignedVendor) {\n                dispatch({\n                  type: 'SET_ASSIGNED_VENDOR',\n                  payload: result.data.vendorAvailability.assignedVendor,\n                })\n              }\n            }\n          }\n        } catch (error) {\n          console.error('Error fetching user profile:', error)\n          // If token is invalid, remove it but don't redirect\n          if (error.error?.message?.includes('unauthorized') || error.error?.message?.includes('token')) {\n            localStorage.removeItem('user_token')\n            dispatch({ type: 'AUTH_LOGOUT' })\n          }\n        }\n      }\n      fetchProfile()\n    } else {\n      // No token - redirect to login/signup based on view\n      if (!hasShownInitialModal) {\n        if (isLaptopView) {\n          // Redirect to login page on laptop\n          setActiveTab('login')\n          navigate('/user/dashboard/login', { replace: false })\n        } else {\n          // Show modal on mobile\n          setShowAuthModal(true)\n          setAuthActionType(null)\n        }\n        setHasShownInitialModal(true)\n      }\n    }\n  }, [dispatch, hasShownInitialModal, isLaptopView, navigate])\n\n  // Initialize welcome notification (only first time user enters dashboard)\n  useEffect(() => {\n    const hasSeenWelcome = localStorage.getItem('hasSeenWelcomeNotification')\n    if (!hasSeenWelcome && notifications.length === 0) {\n      dispatch({\n        type: 'ADD_NOTIFICATION',\n        payload: {\n          title: 'Welcome to IRA Sathi!',\n          message: 'Start shopping for your farming needs',\n          type: 'welcome',\n        },\n      })\n      localStorage.setItem('hasSeenWelcomeNotification', 'true')\n    }\n  }, [dispatch, notifications.length])\n\n  // Fetch orders and cart from API\n  const { fetchOrders, fetchCart } = useUserApi()\n\n  const resolveId = useCallback((value) => {\n    if (!value) return ''\n    if (typeof value === 'string' || typeof value === 'number') return value.toString()\n    if (typeof value === 'object') {\n      if (value._id) return value._id.toString()\n      if (value.id) return value.id.toString()\n      if (typeof value.toString === 'function') return value.toString()\n    }\n    return ''\n  }, [])\n\n  const mapCartItemsFromResponse = useCallback((cartData) => {\n    console.log('ðŸ”„ Mapping Cart Items from Response:', cartData)\n\n    if (!cartData?.items) {\n      console.log('âš ï¸ No items in cart data')\n      return []\n    }\n\n    const mappedItems = cartData.items\n      .map((item, index) => {\n        console.log(`\\nðŸ”„ Mapping Item ${index + 1}:`, item)\n\n        const cartItemId = resolveId(item.id || item._id)\n        const product = item.product || item.productId || {}\n        const productId = resolveId(product.id || product._id || item.productId)\n\n        console.log(`ðŸ”„ Item IDs:`, { cartItemId, productId })\n        console.log(`ðŸ”„ Product:`, product)\n        console.log(`ðŸ”„ Variant Attributes (raw):`, item.variantAttributes)\n\n        if (!productId) {\n          console.log(`âš ï¸ Skipping item - no productId`)\n          return null\n        }\n\n        // Use variant-specific price (unitPrice) if available, otherwise fallback\n        const price =\n          typeof item.unitPrice === 'number'\n            ? item.unitPrice\n            : typeof product.priceToUser === 'number'\n              ? product.priceToUser\n              : typeof product.price === 'number'\n                ? product.price\n                : 0\n\n        // Extract variant attributes if present\n        const variantAttributes = item.variantAttributes || null\n\n        console.log(`ðŸ’° Price Calculation:`, {\n          'item.unitPrice': item.unitPrice,\n          'product.priceToUser': product.priceToUser,\n          'product.price': product.price,\n          'final price': price,\n          'final unitPrice': item.unitPrice || price\n        })\n        console.log(`ðŸ”– Variant Attributes (final):`, variantAttributes)\n\n        const mappedItem = {\n          id: cartItemId, // Add id field for compatibility\n          cartItemId,\n          productId,\n          name: product.name || item.productName || 'Unknown Product',\n          price,\n          unitPrice: item.unitPrice || price, // Variant-specific price\n          image: item.image || product.images?.[0]?.url || product.primaryImage || product.image || '',\n          quantity: item.quantity || 1,\n          vendor: product.vendor || null,\n          deliveryTime: product.deliveryTime || null,\n          variantAttributes: variantAttributes, // Include variant attributes\n        }\n\n        console.log(`âœ… Mapped Item:`, mappedItem)\n\n        return mappedItem\n      })\n      .filter(Boolean)\n\n    console.log(`\\nâœ… Final Mapped Cart Items (${mappedItems.length} items):`, mappedItems)\n\n    return mappedItems\n  }, [resolveId])\n\n  const syncCartState = useCallback(\n    (cartData) => {\n      const items = mapCartItemsFromResponse(cartData)\n      dispatch({ type: 'SET_CART_ITEMS', payload: items })\n    },\n    [dispatch, mapCartItemsFromResponse],\n  )\n  useEffect(() => {\n    const token = localStorage.getItem('user_token')\n    if (token) {\n      const loadData = async () => {\n        try {\n          // Fetch orders\n          const ordersResult = await fetchOrders()\n          if (ordersResult.data?.orders) {\n            ordersResult.data.orders.forEach((order) => {\n              dispatch({\n                type: 'ADD_ORDER',\n                payload: {\n                  id: order.id || order._id,\n                  orderNumber: order.orderNumber,\n                  status: order.status,\n                  totalAmount: order.totalAmount,\n                  subtotal: order.subtotal,\n                  deliveryCharge: order.deliveryCharge,\n                  paymentPreference: order.paymentPreference,\n                  upfrontAmount: order.upfrontAmount,\n                  remainingAmount: order.remainingAmount,\n                  paymentStatus: order.paymentStatus,\n                  items: order.items,\n                  statusTimeline: order.statusTimeline,\n                  createdAt: order.createdAt,\n                },\n              })\n            })\n          }\n\n          // Fetch cart\n          const cartResult = await fetchCart()\n          if (cartResult.data?.cart) {\n            syncCartState(cartResult.data.cart)\n          } else {\n            dispatch({ type: 'SET_CART_ITEMS', payload: [] })\n          }\n\n          // Fetch addresses\n          const addressesResult = await userApi.getAddresses()\n          if (addressesResult.success && addressesResult.data?.addresses) {\n            // Clear existing addresses first\n            dispatch({ type: 'CLEAR_ADDRESSES' })\n            // Add addresses from API\n            addressesResult.data.addresses.forEach((address) => {\n              dispatch({\n                type: 'ADD_ADDRESS',\n                payload: {\n                  id: address.id || address._id,\n                  name: address.name || address.label,\n                  label: address.label || address.name,\n                  address: address.address || address.street,\n                  street: address.street || address.address,\n                  city: address.city,\n                  state: address.state,\n                  pincode: address.pincode,\n                  phone: address.phone,\n                  isDefault: address.isDefault || false,\n                },\n              })\n            })\n          }\n        } catch (error) {\n          console.error('Error loading data:', error)\n        }\n      }\n      loadData()\n    }\n  }, [fetchOrders, fetchCart, dispatch, syncCartState])\n\n  // Track order status changes and send notifications\n  useEffect(() => {\n    const token = localStorage.getItem('user_token')\n    if (!token || orders.length === 0) return\n\n    const checkOrderStatusChanges = async () => {\n      try {\n        const ordersResult = await fetchOrders()\n        if (ordersResult.data?.orders) {\n          ordersResult.data.orders.forEach((order) => {\n            const existingOrder = orders.find((o) => o.id === order.id || o.id === order._id)\n            if (existingOrder && existingOrder.status !== order.status) {\n              // Order status changed - send notification\n              const statusMessages = {\n                accepted: 'Your order has been accepted and is being prepared',\n                dispatched: 'Your order has been dispatched and is on the way',\n                delivered: 'Your order has been delivered successfully',\n              }\n\n              const message = statusMessages[order.status] || `Your order status has been updated to ${order.status}`\n\n              dispatch({\n                type: 'ADD_NOTIFICATION',\n                payload: {\n                  type: 'order_status',\n                  title: 'Order Status Update',\n                  message: `${message}. Order #${order.orderNumber?.slice(-8) || order.id?.slice(-8) || 'N/A'}`,\n                  orderId: order.id || order._id,\n                  orderNumber: order.orderNumber,\n                  status: order.status,\n                },\n              })\n\n              // Update order in state\n              dispatch({\n                type: 'UPDATE_ORDER',\n                payload: {\n                  id: order.id || order._id,\n                  status: order.status,\n                  paymentStatus: order.paymentStatus,\n                  statusTimeline: order.statusTimeline,\n                },\n              })\n            }\n          })\n        }\n      } catch (error) {\n        console.error('Error checking order status changes:', error)\n      }\n    }\n\n    // Check immediately\n    checkOrderStatusChanges()\n\n    // Poll every 30 seconds for order status changes\n    const interval = setInterval(checkOrderStatusChanges, 30000)\n\n    return () => clearInterval(interval)\n  }, [orders, fetchOrders, dispatch])\n\n  // Check for new offers and send notifications\n  useEffect(() => {\n    const token = localStorage.getItem('user_token')\n    if (!token) return\n\n    const checkNewOffers = async () => {\n      try {\n        const offersResult = await userApi.getOffers()\n        if (offersResult.success && offersResult.data) {\n          const activeCarousels = (offersResult.data.carousels || [])\n            .filter(c => c.isActive !== false)\n          const specialOffers = offersResult.data.specialOffers || []\n\n          // Check for new offers (created in last 24 hours)\n          const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000)\n          const newCarousels = activeCarousels.filter(c => {\n            const createdAt = new Date(c.createdAt)\n            return createdAt > oneDayAgo\n          })\n          const newSpecialOffers = specialOffers.filter(o => {\n            const createdAt = new Date(o.createdAt)\n            return createdAt > oneDayAgo\n          })\n\n          // Send notification for new offers (only once per day)\n          if (newCarousels.length > 0 || newSpecialOffers.length > 0) {\n            const lastOfferCheck = localStorage.getItem('lastOfferCheckTime')\n            const now = Date.now()\n            const oneDayInMs = 24 * 60 * 60 * 1000\n\n            if (!lastOfferCheck || (now - parseInt(lastOfferCheck)) > oneDayInMs) {\n              const offerCount = newCarousels.length + newSpecialOffers.length\n              dispatch({\n                type: 'ADD_NOTIFICATION',\n                payload: {\n                  type: 'offer',\n                  title: 'New Offers Available!',\n                  message: `${offerCount} new ${offerCount === 1 ? 'offer' : 'offers'} ${offerCount === 1 ? 'is' : 'are'} now available. Check them out!`,\n                },\n              })\n              localStorage.setItem('lastOfferCheckTime', now.toString())\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error checking new offers:', error)\n      }\n    }\n\n    // Check immediately\n    checkNewOffers()\n\n    // Poll every 5 minutes for new offers\n    const interval = setInterval(checkNewOffers, 5 * 60 * 1000)\n\n    return () => clearInterval(interval)\n  }, [dispatch])\n\n  // Reload cart data when cart tab is clicked\n  useEffect(() => {\n    if (activeTab === 'cart') {\n      const reloadCart = async () => {\n        try {\n          const cartResult = await fetchCart()\n          if (cartResult.data?.cart) {\n            syncCartState(cartResult.data.cart)\n            // Force CartView to refresh by updating key\n            setCartRefreshKey(prev => prev + 1)\n          }\n        } catch (error) {\n          console.error('Error reloading cart:', error)\n        }\n      }\n      reloadCart()\n    }\n  }, [activeTab, fetchCart, syncCartState])\n\n  const cartCount = useMemo(() => cart.reduce((sum, item) => sum + item.quantity, 0), [cart])\n  const favouritesCount = useMemo(() => favourites.length, [favourites])\n  const unreadNotificationsCount = useMemo(() => notifications.filter((n) => !n.read).length, [notifications])\n\n  // Translate navigation items\n  const translatedNavItems = useTranslatedNavItems(NAV_ITEMS)\n\n  const tabLabels = useMemo(() => {\n    return translatedNavItems.reduce((acc, item) => {\n      acc[item.id] = item.label\n      return acc\n    }, {})\n  }, [translatedNavItems])\n\n  const searchCatalog = useMemo(\n    () =>\n      [\n        {\n          id: 'search-home-hero',\n          label: 'Special Offers',\n          keywords: ['offers', 'deals', 'promotions', 'discounts', 'banner', 'special'],\n          tab: 'home',\n          targetId: 'home-hero',\n        },\n        {\n          id: 'search-home-search',\n          label: 'Find Products',\n          keywords: ['search', 'find', 'products', 'items', 'look'],\n          tab: 'home',\n          targetId: 'home-search',\n        },\n        {\n          id: 'search-home-categories',\n          label: 'Browse Categories',\n          keywords: ['categories', 'seeds', 'fertilizers', 'pesticides', 'tools', 'browse'],\n          tab: 'home',\n          targetId: 'home-categories',\n        },\n        {\n          id: 'search-home-popular',\n          label: 'Best Sellers',\n          keywords: ['popular', 'best', 'trending', 'top', 'sellers', 'products'],\n          tab: 'home',\n          targetId: 'home-popular-products',\n        },\n        {\n          id: 'search-cart',\n          label: 'My Cart',\n          keywords: ['cart', 'basket', 'items', 'checkout', 'buy'],\n          tab: 'cart',\n          targetId: null,\n        },\n        {\n          id: 'search-favourites',\n          label: 'My Favourites',\n          keywords: ['favourites', 'wishlist', 'saved', 'liked', 'favorite'],\n          tab: 'favourites',\n          targetId: null,\n        },\n        {\n          id: 'search-orders',\n          label: 'My Orders',\n          keywords: ['orders', 'history', 'purchases', 'deliveries', 'past'],\n          tab: 'orders',\n          targetId: null,\n        },\n        {\n          id: 'search-account',\n          label: 'My Account',\n          keywords: ['account', 'profile', 'settings', 'address', 'payment', 'info'],\n          tab: 'account',\n          targetId: null,\n        },\n      ].map((item) => ({\n        ...item,\n        tabLabel: tabLabels[item.tab],\n      })),\n    [tabLabels],\n  )\n\n  const [pendingScroll, setPendingScroll] = useState(null)\n\n  const searchResults = useMemo(() => {\n    const query = searchQuery.trim().toLowerCase()\n    if (!query) {\n      return searchCatalog.slice(0, 7)\n    }\n    const tokens = query.split(/\\s+/).filter(Boolean)\n    const results = searchCatalog\n      .map((item) => {\n        const haystack = `${item.label} ${item.tabLabel} ${item.keywords.join(' ')}`.toLowerCase()\n        const directIndex = haystack.indexOf(query)\n        const directScore = directIndex >= 0 ? 200 - directIndex : 0\n        const tokenScore = tokens.reduce((score, token) => (haystack.includes(token) ? score + 20 : score), 0)\n        const score = directScore + tokenScore\n        return { ...item, score }\n      })\n      .filter((item) => item.score > 0)\n      .sort((a, b) => b.score - a.score)\n    return results.length ? results : searchCatalog.slice(0, 5)\n  }, [searchCatalog, searchQuery])\n\n  const handleSearchNavigate = (item) => {\n    if (!item) return\n    const delay = item.tab === activeTab ? 150 : 420\n    navigateToTab(item.tab)\n    if (item.targetId) {\n      setPendingScroll({ id: item.targetId, delay })\n    }\n    closeSearch()\n  }\n\n  const handleSearchSubmit = () => {\n    if (searchResults.length) {\n      handleSearchNavigate(searchResults[0])\n    } else {\n      navigateToTab('search')\n      closeSearch()\n    }\n  }\n\n  useEffect(() => {\n    if (!pendingScroll) return\n    const { id, delay } = pendingScroll\n    const timer = setTimeout(() => {\n      const element = document.getElementById(id)\n      if (element) {\n        element.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' })\n      }\n      setPendingScroll(null)\n    }, delay)\n    return () => clearTimeout(timer)\n  }, [pendingScroll, activeTab])\n\n  const handleAddToCart = async (productId, quantity = 1, variantAttributes = {}) => {\n    // Check if user is authenticated\n    if (!authenticated) {\n      if (isLaptopView) {\n        // Show prompt on laptop\n        setAuthActionType('cart')\n        setShowAuthPromptLaptop(true)\n      } else {\n        // Show modal on mobile\n        setAuthActionType('cart')\n        setShowAuthModal(true)\n      }\n      return\n    }\n\n    try {\n      console.log('ðŸ›’ handleAddToCart called:', { productId, quantity, variantAttributes })\n\n      // Fetch product details from API\n      const result = await userApi.getProductDetails(productId)\n      if (!result.success || !result.data?.product) {\n        error('Product not found')\n        return\n      }\n\n      const product = result.data.product\n      if (product.stock === 0) {\n        error('Product is out of stock')\n        return\n      }\n\n      // Prepare cart payload with variant attributes if provided\n      const cartPayload = { productId, quantity }\n      if (variantAttributes && Object.keys(variantAttributes).length > 0) {\n        cartPayload.variantAttributes = variantAttributes\n        console.log('ðŸ›’ Adding variant to cart:', cartPayload)\n      } else {\n        console.log('ðŸ›’ Adding product without variants to cart:', cartPayload)\n      }\n\n      // Add to cart via API and sync state\n      const cartResult = await userApi.addToCart(cartPayload)\n      if (cartResult?.data?.cart) {\n        console.log('ðŸ›’ Cart result from API:', cartResult.data.cart)\n        syncCartState(cartResult.data.cart)\n      }\n      success(`${product.name} added to cart`)\n    } catch (err) {\n      error(err?.error?.message || err.message || 'Failed to add product to cart')\n      console.error('Error adding to cart:', err)\n    }\n  }\n\n  const handleRemoveFromCart = async (itemId) => {\n    // itemId can be either cartItemId (string) or productId\n    // First, try to find by cartItemId (for variant-based removal)\n    let cartItemId = itemId\n    let cartItem = cart.find((item) =>\n      (item.id || item._id || item.cartItemId) === itemId\n    )\n\n    // If not found by ID, try to find by productId (for backward compatibility)\n    if (!cartItem) {\n      cartItem = cart.find((item) => item.productId === itemId)\n      if (cartItem) {\n        cartItemId = cartItem.cartItemId || cartItem.id || cartItem._id\n      }\n    } else {\n      cartItemId = cartItem.cartItemId || cartItem.id || cartItem._id\n    }\n\n    if (!cartItemId) {\n      error('Unable to remove item from cart')\n      return\n    }\n\n    try {\n      const result = await userApi.removeFromCart(cartItemId)\n      if (result?.data?.cart) {\n        syncCartState(result.data.cart)\n      } else {\n        // Fallback: remove by productId if available\n        const productId = cartItem?.productId || itemId\n        dispatch({ type: 'REMOVE_FROM_CART', payload: { productId } })\n      }\n      success('Item removed from cart')\n    } catch (err) {\n      error(err?.error?.message || err.message || 'Failed to remove item from cart')\n      console.error('Error removing from cart:', err)\n    }\n  }\n\n  const handleUpdateCartQuantity = async (itemId, quantity) => {\n    // itemId can be either cartItemId (string) or cart item object with id\n    const cartItemId = typeof itemId === 'string' ? itemId : (itemId?.id || itemId?._id || itemId?.cartItemId)\n\n    if (!cartItemId) {\n      error('Unable to update cart item')\n      return\n    }\n\n    if (quantity <= 0) {\n      await handleRemoveFromCart(itemId)\n      return\n    }\n\n    try {\n      const result = await userApi.updateCartItem(cartItemId, { quantity })\n      if (result?.data?.cart) {\n        syncCartState(result.data.cart)\n      } else {\n        // Fallback: find item by ID and update\n        const cartItem = cart.find((item) => (item.id || item._id || item.cartItemId) === cartItemId)\n        if (cartItem) {\n          dispatch({ type: 'UPDATE_CART_ITEM', payload: { itemId: cartItemId, quantity } })\n        }\n      }\n    } catch (err) {\n      error(err?.error?.message || err.message || 'Failed to update quantity')\n      console.error('Error updating cart quantity:', err)\n    }\n  }\n\n  const handleProceedToCheckout = () => {\n    const cartTotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0)\n    if (cartTotal < MIN_ORDER_VALUE) {\n      warning(`Minimum order value is â‚¹${MIN_ORDER_VALUE.toLocaleString('en-IN')}`)\n      return\n    }\n    setShowCheckout(true)\n    navigateToTab('checkout')\n  }\n\n  const handleBuyNow = async (productsData) => {\n    // productsData is an array of { productId, quantity, attributes }\n    // Check if user is authenticated\n    if (!authenticated) {\n      if (isLaptopView) {\n        setAuthActionType('cart')\n        setShowAuthPromptLaptop(true)\n      } else {\n        setAuthActionType('cart')\n        setShowAuthModal(true)\n      }\n      return\n    }\n\n    try {\n      // Add all products to cart first\n      for (const item of productsData) {\n        const { productId, quantity, attributes } = item\n\n        // Fetch product details to validate\n        const result = await userApi.getProductDetails(productId)\n        if (!result.success || !result.data?.product) {\n          error('Product not found')\n          return\n        }\n\n        const product = result.data.product\n        if (product.stock === 0) {\n          error('Product is out of stock')\n          return\n        }\n\n        // Prepare cart payload\n        const cartPayload = { productId, quantity }\n        if (attributes && Object.keys(attributes).length > 0) {\n          cartPayload.variantAttributes = attributes\n        }\n\n        // Add to cart via API\n        const cartResult = await userApi.addToCart(cartPayload)\n        if (cartResult?.data?.cart) {\n          syncCartState(cartResult.data.cart)\n        }\n      }\n\n      // Navigate to checkout after adding all items\n      const cartTotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0)\n      if (cartTotal < MIN_ORDER_VALUE) {\n        warning(`Minimum order value is â‚¹${MIN_ORDER_VALUE.toLocaleString('en-IN')}`)\n        return\n      }\n\n      setShowCheckout(true)\n      navigateToTab('checkout')\n    } catch (err) {\n      error(err?.error?.message || err.message || 'Failed to process Buy Now')\n      console.error('Error in Buy Now:', err)\n    }\n  }\n\n  const handleToggleFavourite = (productId) => {\n    // Check if user is authenticated\n    if (!authenticated) {\n      if (isLaptopView) {\n        // Show prompt on laptop\n        setAuthActionType('favourites')\n        setShowAuthPromptLaptop(true)\n      } else {\n        // Show modal on mobile\n        setAuthActionType('favourites')\n        setShowAuthModal(true)\n      }\n      return\n    }\n\n    const isFavourite = favourites.includes(productId)\n    if (isFavourite) {\n      dispatch({ type: 'REMOVE_FROM_FAVOURITES', payload: { productId } })\n      success('Removed from favourites')\n    } else {\n      dispatch({ type: 'ADD_TO_FAVOURITES', payload: { productId } })\n      success('Added to favourites')\n    }\n  }\n\n  const handleFavouritesClick = () => {\n    navigateToTab('favourites')\n    setShowCheckout(false)\n  }\n\n  const handleSearchClick = () => {\n    openSearch()\n  }\n\n  const handleFilterClick = () => {\n    navigateToTab('search')\n  }\n\n  const openSearch = () => {\n    // Prevent body scroll when search opens\n    document.body.style.overflow = 'hidden'\n    setSearchMounted(true)\n    requestAnimationFrame(() => {\n      setSearchOpen(true)\n      // Delay focus slightly to allow panel to render first, preventing keyboard jump\n      // This prevents the UI hang when keyboard opens\n      setTimeout(() => {\n        if (searchInputRef.current) {\n          // Use requestAnimationFrame for smoother focus\n          requestAnimationFrame(() => {\n            if (searchInputRef.current) {\n              searchInputRef.current.focus()\n              searchInputRef.current.select()\n            }\n          })\n        }\n      }, 150)\n    })\n  }\n\n  const closeSearch = () => {\n    setSearchOpen(false)\n    setKeyboardHeight(0)\n    // Restore body scroll\n    document.body.style.overflow = ''\n    setTimeout(() => {\n      setSearchMounted(false)\n      setSearchQuery('')\n    }, 260)\n  }\n\n  // Handle keyboard visibility on mobile devices - smooth adjustment\n  useEffect(() => {\n    if (!searchOpen) {\n      setKeyboardHeight(0)\n      return\n    }\n\n    let rafId = null\n    let initialViewportHeight = window.innerHeight\n\n    // Use visualViewport API for better keyboard detection (modern browsers)\n    const handleViewportResize = () => {\n      if (rafId) cancelAnimationFrame(rafId)\n\n      rafId = requestAnimationFrame(() => {\n        if (window.visualViewport) {\n          const viewportHeight = window.visualViewport.height\n          const windowHeight = window.innerHeight\n          const keyboardHeight = windowHeight - viewportHeight\n\n          // Only adjust if keyboard is significantly open (more than 150px)\n          if (keyboardHeight > 150) {\n            // Smooth adjustment - only move panel slightly up to prevent hang\n            setKeyboardHeight(Math.min(keyboardHeight * 0.25, 80))\n          } else {\n            setKeyboardHeight(0)\n          }\n        }\n      })\n    }\n\n    // Fallback for browsers without visualViewport\n    const handleResize = () => {\n      if (rafId) cancelAnimationFrame(rafId)\n\n      rafId = requestAnimationFrame(() => {\n        if (!window.visualViewport) {\n          const currentHeight = window.innerHeight\n          const heightDiff = initialViewportHeight - currentHeight\n\n          if (heightDiff > 150) {\n            // Smooth adjustment - only move panel slightly up\n            setKeyboardHeight(Math.min(heightDiff * 0.25, 80))\n          } else {\n            setKeyboardHeight(0)\n          }\n        }\n      })\n    }\n\n    // Store initial height when search opens\n    initialViewportHeight = window.innerHeight\n\n    if (window.visualViewport) {\n      window.visualViewport.addEventListener('resize', handleViewportResize)\n    } else {\n      window.addEventListener('resize', handleResize)\n    }\n\n    return () => {\n      if (rafId) cancelAnimationFrame(rafId)\n      if (window.visualViewport) {\n        window.visualViewport.removeEventListener('resize', handleViewportResize)\n      } else {\n        window.removeEventListener('resize', handleResize)\n      }\n    }\n  }, [searchOpen])\n\n  const buildMenuItems = (close) => [\n    ...translatedNavItems.map((item) => ({\n      id: item.id,\n      label: item.label,\n      description: item.description,\n      icon: <item.icon className=\"h-4 w-4\" />,\n      onSelect: () => {\n        navigateToTab(item.id)\n        close()\n      },\n    })),\n    {\n      id: 'logout',\n      label: <Trans>Sign out</Trans>,\n      icon: <MenuIcon className=\"h-4 w-4\" />,\n      description: <Trans>Log out from your account</Trans>,\n      onSelect: () => {\n        dispatch({ type: 'AUTH_LOGOUT' })\n        onLogout?.()\n        close()\n      },\n    },\n  ]\n\n  // Handle auth success - refresh profile and close modal\n  const handleAuthSuccess = async () => {\n    const token = localStorage.getItem('user_token')\n    if (token) {\n      try {\n        const result = await userApi.getUserProfile()\n        if (result.success && result.data?.user) {\n          const userData = result.data.user\n          dispatch({\n            type: 'AUTH_LOGIN',\n            payload: {\n              name: userData.name || 'User',\n              phone: userData.phone || '',\n              email: userData.email || '',\n              sellerId: userData.sellerId || null,\n              location: userData.location || null,\n            },\n          })\n        }\n      } catch (error) {\n        console.error('Error fetching user profile after login:', error)\n      }\n    }\n\n    // Close modal on mobile, redirect to home on laptop\n    if (isLaptopView) {\n      navigateToTab('home')\n    } else {\n      setShowAuthModal(false)\n      setAuthActionType(null)\n    }\n  }\n\n  return (\n    <>\n      {/* Mobile prompt - redirects to /user/login */}\n      <AuthPromptMobile\n        isOpen={showAuthModal && !isLaptopView}\n        onClose={() => {\n          setShowAuthModal(false)\n          setAuthActionType(null)\n        }}\n        actionType={authActionType}\n      />\n      {/* Laptop prompt - redirects to /user/dashboard/login */}\n      <AuthPromptLaptop\n        isOpen={showAuthPromptLaptop}\n        onClose={() => {\n          setShowAuthPromptLaptop(false)\n          setAuthActionType(null)\n        }}\n        actionType={authActionType}\n        onNavigateToSignin={() => navigateToTab('signin')}\n      />\n      <VendorAvailabilityWarning />\n      <MobileShell\n        title={activeTab === 'home' ? `Hello ${profile.name.split(' ')[0]}` : null}\n        subtitle={profile.location?.city ? `${profile.location.city}, ${profile.location.state}` : null}\n        onSearchClick={handleSearchClick}\n        onFilterClick={handleFilterClick}\n        notificationsCount={unreadNotificationsCount}\n        navigation={translatedNavItems.filter(item => item.id !== 'home' && item.id !== 'orders').map((item) => (\n          <BottomNavItem\n            key={item.id}\n            label={item.label}\n            active={activeTab === item.id}\n            onClick={() => navigateToTab(item.id)}\n            icon={<item.icon active={activeTab === item.id} className=\"h-5 w-5\" filled={item.id === 'favourites' ? favouritesCount > 0 : undefined} />}\n            badge={item.id === 'cart' ? (cartCount > 0 ? cartCount : undefined) : item.id === 'favourites' ? (favouritesCount > 0 ? favouritesCount : undefined) : undefined}\n          />\n        ))}\n        bottomNavigation={translatedNavItems.map((item) => (\n          <BottomNavItem\n            key={item.id}\n            label={item.label}\n            active={activeTab === item.id}\n            onClick={() => navigateToTab(item.id)}\n            icon={<item.icon active={activeTab === item.id} className=\"h-5 w-5\" filled={item.id === 'favourites' ? favouritesCount > 0 : undefined} />}\n            badge={item.id === 'cart' ? (cartCount > 0 ? cartCount : undefined) : item.id === 'favourites' ? (favouritesCount > 0 ? favouritesCount : undefined) : undefined}\n          />\n        ))}\n        menuContent={({ close }) => <MenuList items={buildMenuItems(close)} active={activeTab} />}\n        cartCount={cartCount}\n        isAuthenticated={authenticated}\n        onNavigate={navigateToTab}\n        onLogout={onLogout}\n        onLogin={() => {\n          if (isLaptopView) {\n            navigateToTab('login')\n          } else {\n            window.location.href = '/user/login'\n          }\n        }}\n      >\n        <section className=\"space-y-6\">\n          {activeTab === 'home' && (\n            <HomeView\n              onProductClick={(productId) => {\n                if (productId === 'all') {\n                  // \"View All\" clicked - switch to search view instead of product detail\n                  setSearchQuery('')\n                  navigateToTab('search')\n                } else if (productId && productId.startsWith('carousel:')) {\n                  // Carousel clicked - show carousel products\n                  const carouselId = productId.replace('carousel:', '')\n                  setSelectedCarousel(carouselId)\n                  navigateToTab('carousel-products')\n                } else {\n                  setSelectedProduct(productId)\n                  navigateToTab('product-detail')\n                }\n              }}\n              onCategoryClick={(categoryId) => {\n                setSelectedCategory(categoryId)\n                // Include category ID in URL for refresh persistence\n                navigate(`/user/dashboard/category-products?category=${categoryId}`, { replace: false })\n              }}\n              onAddToCart={handleAddToCart}\n              onSearchClick={handleSearchClick}\n              onFilterClick={handleFilterClick}\n              onToggleFavourite={handleToggleFavourite}\n              favourites={favourites}\n            />\n          )}\n          {activeTab === 'favourites' && (\n            <FavouritesView\n              onProductClick={(productId) => {\n                setSelectedProduct(productId)\n                navigateToTab('product-detail')\n              }}\n              onAddToCart={handleAddToCart}\n              onRemoveFromFavourites={(productId) => {\n                success('Removed from favourites')\n              }}\n            />\n          )}\n          {activeTab === 'category-products' && (\n            <CategoryProductsView\n              categoryId={selectedCategory || 'all'}\n              onProductClick={(productId) => {\n                setSelectedProduct(productId)\n                navigateToTab('product-detail')\n              }}\n              onAddToCart={handleAddToCart}\n              onBack={() => {\n                navigateToTab('home')\n              }}\n              onToggleFavourite={handleToggleFavourite}\n              favourites={favourites}\n            />\n          )}\n          {activeTab === 'carousel-products' && selectedCarousel && (\n            <CarouselProductsView\n              carouselId={selectedCarousel}\n              onProductClick={(productId) => {\n                setSelectedProduct(productId)\n                navigateToTab('product-detail')\n              }}\n              onAddToCart={handleAddToCart}\n              onBack={() => {\n                navigateToTab('home')\n              }}\n              onToggleFavourite={handleToggleFavourite}\n              favourites={favourites}\n            />\n          )}\n          {activeTab === 'search' && (\n            <SearchView\n              query={searchQuery}\n              onProductClick={(productId) => {\n                setSelectedProduct(productId)\n                navigateToTab('product-detail')\n              }}\n              onAddToCart={handleAddToCart}\n              onToggleFavourite={handleToggleFavourite}\n              favourites={favourites}\n            />\n          )}\n          {activeTab === 'product-detail' && selectedProduct && (\n            <ProductDetailView\n              productId={selectedProduct}\n              onAddToCart={handleAddToCart}\n              onBuyNow={handleBuyNow}\n              onToggleFavourite={handleToggleFavourite}\n              favourites={favourites}\n              onBack={() => {\n                navigateToTab('home')\n              }}\n              onProductClick={(productId) => {\n                setSelectedProduct(productId)\n                navigateToTab('product-detail')\n              }}\n            />\n          )}\n          {activeTab === 'cart' && (\n            <CartView\n              key={cartRefreshKey}\n              onUpdateQuantity={handleUpdateCartQuantity}\n              onRemove={handleRemoveFromCart}\n              onCheckout={handleProceedToCheckout}\n              onAddToCart={handleAddToCart}\n              onNavigateToProduct={(productId) => {\n                setSelectedProduct(productId)\n                navigateToTab('product-detail')\n              }}\n            />\n          )}\n          {orderConfirmation ? (\n            <OrderConfirmationView\n              order={orderConfirmation}\n              onBackToHome={() => {\n                setOrderConfirmation(null)\n                navigateToTab('home')\n              }}\n            />\n          ) : (\n            <>\n              {activeTab === 'checkout' && showCheckout && (\n                <CheckoutView\n                  onBack={() => {\n                    setShowCheckout(false)\n                    navigateToTab('cart')\n                  }}\n                  onOrderPlaced={(order) => {\n                    dispatch({ type: 'ADD_ORDER', payload: order })\n                    dispatch({ type: 'CLEAR_CART' })\n                    setOrderConfirmation(order)\n                    setShowCheckout(false)\n                  }}\n                />\n              )}\n            </>\n          )}\n          {activeTab === 'orders' && authenticated && <OrdersView />}\n          {activeTab === 'orders' && !authenticated && isLaptopView && (\n            <div className=\"user-orders-view__auth-prompt\">\n              <div className=\"user-orders-view__auth-prompt-content\">\n                <h2 className=\"user-orders-view__auth-prompt-title\"><Trans>Authentication Required</Trans></h2>\n                <p className=\"user-orders-view__auth-prompt-message\">\n                  <Trans>You can't view your orders now. First login or create your account.</Trans>\n                </p>\n                <button\n                  onClick={() => navigateToTab('signin')}\n                  className=\"user-orders-view__auth-prompt-button\"\n                >\n                  <UserIcon className=\"h-4 w-4 mr-2\" />\n                  <Trans>Sign In</Trans>\n                </button>\n              </div>\n            </div>\n          )}\n          {activeTab === 'orders' && !authenticated && !isLaptopView && <OrdersView />}\n          {activeTab === 'account' && (\n            <AccountView\n              onNavigate={navigateToTab}\n              authenticated={authenticated}\n              isLaptopView={isLaptopView}\n              onShowAuthPrompt={(actionType) => {\n                if (isLaptopView) {\n                  setAuthActionType('profile')\n                  setShowAuthPromptLaptop(true)\n                } else {\n                  setAuthActionType('profile')\n                  setShowAuthModal(true)\n                }\n              }}\n            />\n          )}\n          {activeTab === 'login' && (\n            <LoginPageView\n              onSuccess={handleAuthSuccess}\n              onSwitchToSignup={() => navigateToTab('signup')}\n            />\n          )}\n          {activeTab === 'signup' && (\n            <SignupPageView\n              onSuccess={handleAuthSuccess}\n              onSwitchToLogin={() => navigateToTab('login')}\n            />\n          )}\n        </section>\n      </MobileShell>\n\n      {searchMounted ? (\n        <div className={cn('user-search-sheet', searchOpen && 'is-open')}>\n          <div className={cn('user-search-sheet__overlay', searchOpen && 'is-open')} onClick={closeSearch} />\n          <div\n            ref={searchPanelRef}\n            className={cn('user-search-sheet__panel', searchOpen && 'is-open')}\n            style={{\n              transform: keyboardHeight > 0\n                ? `translateY(0) translateY(-${Math.min(keyboardHeight * 0.15, 60)}px)`\n                : undefined,\n              transition: keyboardHeight > 0\n                ? 'transform 0.25s cubic-bezier(0.4, 0, 0.2, 1)'\n                : undefined,\n            }}\n          >\n            <div className=\"user-search-sheet__header\">\n              <input\n                ref={searchInputRef}\n                value={searchQuery}\n                onChange={(event) => setSearchQuery(event.target.value)}\n                onKeyDown={(event) => {\n                  if (event.key === 'Enter') {\n                    event.preventDefault()\n                    handleSearchSubmit()\n                  }\n                  if (event.key === 'Escape') {\n                    event.preventDefault()\n                    closeSearch()\n                  }\n                }}\n                placeholder=\"Search for products, orders, cart...\"\n                className=\"user-search-input\"\n                aria-label=\"Search user dashboard\"\n              />\n              <button\n                type=\"button\"\n                className=\"user-search-cancel\"\n                onClick={closeSearch}\n              >\n                Cancel\n              </button>\n            </div>\n            <div className=\"user-search-sheet__body\">\n              {searchResults.length ? (\n                searchResults.map((item) => (\n                  <button\n                    key={item.id}\n                    type=\"button\"\n                    onClick={() => handleSearchNavigate(item)}\n                    className=\"user-search-result\"\n                  >\n                    <span className=\"user-search-result__label\">{item.label}</span>\n                    <span className=\"user-search-result__meta\">{item.tabLabel}</span>\n                  </button>\n                ))\n              ) : (\n                <p className=\"user-search-empty\">No matches yet. Try another keyword.</p>\n              )}\n            </div>\n          </div>\n        </div>\n      ) : null}\n    </>\n  )\n}\n\nexport function UserDashboard({ onLogout }) {\n  return (\n    <ToastProvider>\n      <UserDashboardContent onLogout={onLogout} />\n    </ToastProvider>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\UserLogin.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":122,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":122,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\nimport { useUserDispatch } from '../context/UserContext'\nimport * as userApi from '../services/userApi'\n\nexport function UserLogin({ onSuccess, onSwitchToRegister }) {\n  const navigate = useNavigate()\n  const dispatch = useUserDispatch()\n  const [step, setStep] = useState('phone') // 'phone' | 'otp'\n  const [form, setForm] = useState({ phone: '' })\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setForm((prev) => ({ ...prev, [name]: value }))\n    setError(null)\n  }\n\n  const handleRequestOtp = async (e) => {\n    e.preventDefault()\n    setError(null)\n    setLoading(true)\n\n    try {\n      if (!form.phone.trim()) {\n        setError('Contact number is required')\n        setLoading(false)\n        return\n      }\n      if (form.phone.length < 10) {\n        setError('Please enter a valid contact number')\n        setLoading(false)\n        return\n      }\n\n      // Bypass OTP for specific phone number (8878495505)\n      const BYPASS_PHONE = '8878495505'\n      const BYPASS_OTP = '123456'\n      \n      if (form.phone === BYPASS_PHONE) {\n        // Skip OTP request and directly verify with bypass OTP\n        setLoading(false)\n        await handleVerifyOtp(BYPASS_OTP)\n        return\n      }\n\n      // Request OTP (mock for now - accepts any data)\n      const result = await userApi.requestOTP({ phone: form.phone })\n      \n      if (result.success || result.data) {\n        setStep('otp')\n      } else {\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Failed to send OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleVerifyOtp = async (otpCode) => {\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Login with OTP (mock for now - accepts any data)\n      const result = await userApi.loginWithOtp({ phone: form.phone, otp: otpCode })\n\n      if (result.success || result.data) {\n        // Store token if provided\n        if (result.data?.token) {\n          localStorage.setItem('user_token', result.data.token)\n        }\n        \n        // Update context with user data\n        const userData = result.data?.user || { name: 'User', phone: form.phone }\n        dispatch({\n          type: 'AUTH_LOGIN',\n          payload: {\n            name: userData.name || 'User',\n            phone: userData.phone || form.phone,\n            sellerId: userData.sellerId || null,\n            location: userData.location || null,\n          },\n        })\n        \n        onSuccess?.(userData)\n        // Navigation is handled by onSuccess callback from parent component\n      } else {\n        // Check if user needs to register\n        if (result.error?.message?.includes('not found') || result.requiresRegistration) {\n          setError('User not found. Please register first.')\n          setTimeout(() => {\n            navigate('/user/register')\n          }, 2000)\n        } else {\n          setError(result.error?.message || 'Invalid OTP. Please try again.')\n        }\n      }\n    } catch (err) {\n      // Check if error indicates user doesn't exist\n      if (err.error?.message?.includes('not found') || err.requiresRegistration) {\n        setError('User not found. Redirecting to registration...')\n        setTimeout(() => {\n          navigate('/user/register')\n        }, 2000)\n      } else {\n        setError(err.error?.message || err.message || 'Verification failed. Please try again.')\n      }\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleResendOtp = async () => {\n    setLoading(true)\n    try {\n      await userApi.requestOTP({ phone: form.phone })\n    } catch (err) {\n      setError('Failed to resend OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (step === 'otp') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <OtpVerification\n              phone={form.phone}\n              onVerify={handleVerifyOtp}\n              onResend={handleResendOtp}\n              onBack={() => setStep('phone')}\n              loading={loading}\n              error={error}\n              userType=\"user\"\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4\">\n            <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n            </svg>\n          </div>\n          <p className=\"text-xs uppercase tracking-wide text-green-600 font-semibold\">Welcome Back</p>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Sign in to IRA Sathi</h1>\n          <p className=\"text-sm text-gray-600\">Enter your contact number to continue</p>\n        </div>\n\n        <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\n            {error && (\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\n                <p className=\"text-sm text-red-600\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"login-phone\" className=\"text-xs font-semibold text-gray-700\">\n                Contact Number <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"login-phone\"\n                name=\"phone\"\n                type=\"tel\"\n                required\n                value={form.phone}\n                onChange={handleChange}\n                placeholder=\"+91 90000 00000\"\n                maxLength={15}\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? 'Sending OTP...' : 'Continue'}\n            </button>\n\n            <div className=\"text-center text-sm\">\n              <span className=\"text-gray-600\">Don't have an account? </span>\n              <button\n                type=\"button\"\n                onClick={onSwitchToRegister}\n                className=\"text-green-600 font-semibold hover:underline\"\n              >\n                Sign up\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\UserRegister.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'navigate' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":9,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"navigate"},"fix":{"range":[413,443],"text":""},"desc":"Remove unused variable 'navigate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'otp' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"otp"},"fix":{"range":[751,754],"text":""},"desc":"Remove unused variable 'otp'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setOtp' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":18,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"setOtp"},"fix":{"range":[754,762],"text":""},"desc":"Remove unused variable 'setOtp'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":146,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":146,"endColumn":17}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\nimport { useUserDispatch } from '../context/UserContext'\nimport { GoogleMapsLocationPicker } from '../../../components/GoogleMapsLocationPicker'\nimport * as userApi from '../services/userApi'\n\nexport function UserRegister({ onSuccess, onSwitchToLogin }) {\n  const navigate = useNavigate()\n  const dispatch = useUserDispatch()\n  const [step, setStep] = useState('register') // 'register' | 'otp'\n  const [form, setForm] = useState({\n    fullName: '',\n    contact: '',\n    sellerId: '',\n    location: null, // Will contain { address, city, state, pincode, coordinates: { lat, lng } }\n  })\n  const [otp, setOtp] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n  const [showSellerId, setShowSellerId] = useState(false)\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setForm((prev) => ({ ...prev, [name]: value }))\n    setError(null)\n  }\n\n  const handleRequestOtp = async (e) => {\n    e.preventDefault()\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Validate form\n      if (!form.fullName.trim()) {\n        setError('Full name is required')\n        setLoading(false)\n        return\n      }\n      if (!form.contact.trim()) {\n        setError('Contact number is required')\n        setLoading(false)\n        return\n      }\n      if (form.contact.length < 10) {\n        setError('Please enter a valid contact number')\n        setLoading(false)\n        return\n      }\n      // Validate location - coordinates are required (Google Maps provides this)\n      if (!form.location || !form.location.coordinates) {\n        setError('Please select your location using the map or live location button')\n        setLoading(false)\n        return\n      }\n      // Validate coordinates are valid (not 0,0)\n      if (!form.location.coordinates.lat || !form.location.coordinates.lng || \n          form.location.coordinates.lat === 0 || form.location.coordinates.lng === 0) {\n        setError('Please select a valid location. Coordinates are required.')\n        setLoading(false)\n        return\n      }\n      // Address is required (Google Maps provides formatted_address)\n      if (!form.location.address || !form.location.address.trim()) {\n        setError('Please select a valid address from the location picker')\n        setLoading(false)\n        return\n      }\n\n      // Request OTP\n      const result = await userApi.requestOTP({ phone: form.contact })\n      \n      if (result.success || result.data) {\n        setStep('otp')\n      } else {\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Failed to send OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleVerifyOtp = async (otpCode) => {\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Prepare location object\n      const location = {\n        address: form.location.address,\n        city: form.location.city,\n        state: form.location.state,\n        pincode: form.location.pincode,\n        coordinates: {\n          lat: form.location.coordinates.lat,\n          lng: form.location.coordinates.lng,\n        },\n      }\n\n      // Register user with OTP\n      const result = await userApi.register({\n        fullName: form.fullName,\n        phone: form.contact,\n        otp: otpCode,\n        sellerId: form.sellerId || undefined,\n        location: location,\n      })\n\n      if (result.success || result.data) {\n        // Store token if provided\n        if (result.data?.token) {\n          localStorage.setItem('user_token', result.data.token)\n        }\n        \n        // Update context with user data\n        const userData = result.data?.user || { name: form.fullName, phone: form.contact }\n        dispatch({\n          type: 'AUTH_LOGIN',\n          payload: {\n            name: userData.name || form.fullName,\n            phone: userData.phone || form.contact,\n            sellerId: userData.sellerId || null,\n            location: userData.location || location,\n          },\n        })\n        \n        onSuccess?.(userData)\n        // Navigation is handled by onSuccess callback from parent component\n      } else {\n        setError(result.error?.message || 'Invalid OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Verification failed. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleResendOtp = async () => {\n    setLoading(true)\n    try {\n      await userApi.requestOTP({ phone: form.contact })\n    } catch (err) {\n      setError('Failed to resend OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (step === 'otp') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <OtpVerification\n              phone={form.contact}\n              onVerify={handleVerifyOtp}\n              onResend={handleResendOtp}\n              onBack={() => setStep('register')}\n              loading={loading}\n              error={error}\n              userType=\"user\"\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4\">\n            <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n            </svg>\n          </div>\n          <p className=\"text-xs uppercase tracking-wide text-green-600 font-semibold\">Create Account</p>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Join IRA Sathi</h1>\n          <p className=\"text-sm text-gray-600\">Start your journey to better farming</p>\n        </div>\n\n        <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\n            {error && (\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\n                <p className=\"text-sm text-red-600\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"register-fullName\" className=\"text-xs font-semibold text-gray-700\">\n                Full Name <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"register-fullName\"\n                name=\"fullName\"\n                type=\"text\"\n                required\n                value={form.fullName}\n                onChange={handleChange}\n                placeholder=\"Enter your full name\"\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"register-contact\" className=\"text-xs font-semibold text-gray-700\">\n                Contact Number <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"register-contact\"\n                name=\"contact\"\n                type=\"tel\"\n                required\n                value={form.contact}\n                onChange={handleChange}\n                placeholder=\"+91 90000 00000\"\n                maxLength={15}\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <div className=\"space-y-1.5\">\n              <div className=\"flex items-center justify-between\">\n                <label htmlFor=\"register-sellerId\" className=\"text-xs font-semibold text-gray-700\">\n                  IRA Partner ID <span className=\"text-gray-400 text-xs\">(Optional)</span>\n                </label>\n                <button\n                  type=\"button\"\n                  onClick={() => setShowSellerId(!showSellerId)}\n                  className=\"text-xs text-green-600 hover:underline font-medium\"\n                >\n                  {showSellerId ? 'Hide' : 'Have one?'}\n                </button>\n              </div>\n              {showSellerId && (\n                <input\n                  id=\"register-sellerId\"\n                  name=\"sellerId\"\n                  type=\"text\"\n                  value={form.sellerId}\n                  onChange={handleChange}\n                  placeholder=\"Enter IRA Partner ID (e.g., SLR-1001)\"\n                  className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n                />\n              )}\n              {showSellerId && (\n                <p className=\"text-xs text-gray-500\">\n                  Link your purchases to an IRA Partner for cashback benefits\n                </p>\n              )}\n            </div>\n\n            <div className=\"border-t border-gray-200 pt-5 mt-5\">\n              <h3 className=\"text-sm font-semibold text-gray-900 mb-4\">Address & Location</h3>\n              \n              <div className=\"space-y-4\">\n                <GoogleMapsLocationPicker\n                  onLocationSelect={(location) => {\n                    setForm((prev) => ({ ...prev, location }))\n                    setError(null)\n                  }}\n                  initialLocation={form.location}\n                  required={true}\n                  label=\"Select Your Location\"\n                />\n              </div>\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? 'Sending OTP...' : 'Continue'}\n            </button>\n\n            <div className=\"text-center text-sm\">\n              <span className=\"text-gray-600\">Already have an account? </span>\n              <button\n                type=\"button\"\n                onClick={onSwitchToLogin}\n                className=\"text-green-600 font-semibold hover:underline\"\n              >\n                Sign in\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\AccountView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'isLaptopView' is defined but never used.","line":22,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":70,"suggestions":[{"messageId":"removeVar","data":{"varName":"isLaptopView"},"fix":{"range":[749,763],"text":""},"desc":"Remove unused variable 'isLaptopView'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'activeSection' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":27,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"activeSection"},"fix":{"range":[983,996],"text":""},"desc":"Remove unused variable 'activeSection'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setActiveSection' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":27,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"setActiveSection"},"fix":{"range":[996,1014],"text":""},"desc":"Remove unused variable 'setActiveSection'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'deliveryAddressForm' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":35,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"deliveryAddressForm"},"fix":{"range":[1616,1635],"text":""},"desc":"Remove unused variable 'deliveryAddressForm'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\nimport { useUserState, useUserDispatch } from '../../context/UserContext'\nimport { useUserApi } from '../../hooks/useUserApi'\nimport { useToast } from '../../components/ToastNotification'\nimport * as userApi from '../../services/userApi'\nimport { GoogleMapsLocationPicker } from '../../../../components/GoogleMapsLocationPicker'\nimport {\n  UserIcon,\n  PackageIcon,\n  TruckIcon,\n  HelpCircleIcon,\n  EditIcon,\n  ChevronRightIcon,\n  CheckIcon,\n  XIcon,\n  TrashIcon,\n} from '../../components/icons'\nimport { cn } from '../../../../lib/cn'\nimport { Trans } from '../../../../components/Trans'\nimport { TransText } from '../../../../components/TransText'\n\nexport function AccountView({ onNavigate, authenticated, isLaptopView, onShowAuthPrompt }) {\n  const { profile, orders } = useUserState()\n  const dispatch = useUserDispatch()\n  const { updateUserProfile, loading } = useUserApi()\n  const { success, error: showError } = useToast()\n  const [activeSection, setActiveSection] = useState('profile')\n  const [editingName, setEditingName] = useState(false)\n  const [editedName, setEditedName] = useState(profile.name)\n  const [showChangeDeliveryAddressPanel, setShowChangeDeliveryAddressPanel] = useState(false)\n  const [deliveryAddressOTPStep, setDeliveryAddressOTPStep] = useState(1) // 1: request OTP, 2: verify OTP, 3: select address\n  const [deliveryAddressOTP, setDeliveryAddressOTP] = useState('')\n  const [deliveryAddressOTPLoading, setDeliveryAddressOTPLoading] = useState(false)\n  const [selectedDeliveryLocation, setSelectedDeliveryLocation] = useState(null)\n  const [deliveryAddressForm, setDeliveryAddressForm] = useState({\n    address: profile.location?.address || '',\n    city: profile.location?.city || '',\n    state: profile.location?.state || '',\n    pincode: profile.location?.pincode || '',\n  })\n  const [showSupportPanel, setShowSupportPanel] = useState(false)\n  const [showReportPanel, setShowReportPanel] = useState(false)\n  const [showPhoneUpdatePanel, setShowPhoneUpdatePanel] = useState(false)\n  const [phoneUpdateStep, setPhoneUpdateStep] = useState(1) // 1: request current OTP, 2: verify current OTP, 3: enter new phone, 4: request new OTP, 5: verify new OTP\n  const [currentPhoneOTP, setCurrentPhoneOTP] = useState('')\n  const [newPhone, setNewPhone] = useState('')\n  const [newPhoneOTP, setNewPhoneOTP] = useState('')\n  const [phoneUpdateLoading, setPhoneUpdateLoading] = useState(false)\n  const [activeSectionId, setActiveSectionId] = useState('profile') // For laptop view navigation\n  \n  // Report issue form\n  const [reportForm, setReportForm] = useState({\n    subject: '',\n    description: '',\n    category: 'general',\n  })\n\n  // Update edited name when profile changes\n  useEffect(() => {\n    setEditedName(profile.name)\n  }, [profile.name])\n  \n  // Update delivery address form when profile changes\n  useEffect(() => {\n    setDeliveryAddressForm({\n      address: profile.location?.address || '',\n      city: profile.location?.city || '',\n      state: profile.location?.state || '',\n      pincode: profile.location?.pincode || '',\n    })\n  }, [profile.location])\n\n  const handleSaveName = async () => {\n    // Check authentication\n    if (!authenticated) {\n      if (onShowAuthPrompt) {\n        onShowAuthPrompt('profile')\n      }\n      return\n    }\n\n    if (!editedName.trim()) {\n      alert('Name cannot be empty')\n      return\n    }\n    \n    try {\n      const result = await updateUserProfile({ name: editedName.trim() })\n      \n      // Close edit modal immediately\n      setEditingName(false)\n      \n      // useUserApi hook returns { data, error } structure\n      // If error is null/undefined, it means success\n      if (result && !result.error && result.data) {\n    dispatch({\n      type: 'AUTH_LOGIN',\n          payload: { ...profile, name: result.data.user?.name || editedName.trim() },\n    })\n        // Show green success notification with tick icon\n        success(result.data.message || 'Name updated successfully')\n      } else {\n        // Show red error notification\n        showError(result?.error?.message || result?.data?.message || 'Failed to update name')\n      }\n    } catch (error) {\n      console.error('Error updating name:', error)\n      // Close edit modal on error\n    setEditingName(false)\n      // Show red error notification\n      showError(error?.error?.message || error?.message || 'Failed to update name')\n    }\n  }\n  \n  const handleSaveDeliveryAddress = async () => {\n    // Check authentication\n    if (!authenticated) {\n      if (onShowAuthPrompt) {\n        onShowAuthPrompt('profile')\n      }\n      return\n    }\n\n    // Validate that location is selected from Google Maps\n    if (!selectedDeliveryLocation || !selectedDeliveryLocation.coordinates) {\n      showError('Please select a location from Google Maps')\n      return\n    }\n    \n    if (!selectedDeliveryLocation.city || !selectedDeliveryLocation.state || !selectedDeliveryLocation.pincode) {\n      showError('Please select a complete address with city, state, and pincode')\n      return\n    }\n    \n    try {\n      const result = await updateUserProfile({\n        location: {\n          address: selectedDeliveryLocation.address || '',\n          city: selectedDeliveryLocation.city,\n          state: selectedDeliveryLocation.state,\n          pincode: selectedDeliveryLocation.pincode,\n          coordinates: selectedDeliveryLocation.coordinates,\n        },\n      })\n      \n      // useUserApi hook returns { data, error } structure\n      if (result && !result.error && result.data) {\n        dispatch({\n          type: 'AUTH_LOGIN',\n          payload: { ...profile, location: result.data.user?.location || selectedDeliveryLocation },\n        })\n        success('Delivery address updated successfully')\n        setShowChangeDeliveryAddressPanel(false)\n        setDeliveryAddressOTPStep(1)\n        setDeliveryAddressOTP('')\n        setSelectedDeliveryLocation(null)\n    } else {\n        showError(result?.error?.message || result?.data?.message || 'Failed to update delivery address')\n      }\n    } catch (error) {\n      console.error('Error updating delivery address:', error)\n      showError(error?.error?.message || error?.message || 'Failed to update delivery address')\n    }\n  }\n  \n  const handleSubmitReport = () => {\n    // Check authentication\n    if (!authenticated) {\n      if (onShowAuthPrompt) {\n        onShowAuthPrompt('profile')\n      }\n      return\n    }\n\n    if (!reportForm.subject || !reportForm.description) {\n      alert('Please fill in all fields')\n      return\n    }\n    // In a real app, this would submit to backend\n    alert('Issue reported successfully! We will get back to you soon.')\n    setReportForm({ subject: '', description: '', category: 'general' })\n    setShowReportPanel(false)\n  }\n\n  const sections = [\n    {\n      id: 'profile',\n      title: 'Personal Information',\n      icon: UserIcon,\n      items: [\n        {\n          id: 'name',\n          label: 'Full Name',\n          value: profile.name,\n          editable: true,\n          onEdit: () => {\n            if (!authenticated) {\n              if (onShowAuthPrompt) {\n                onShowAuthPrompt('profile')\n              }\n              return\n            }\n            setEditingName(true)\n          },\n        },\n        {\n          id: 'phone',\n          label: 'Phone',\n          value: profile.phone || 'Not set',\n          editable: true,\n          onEdit: () => {\n            if (!authenticated) {\n              if (onShowAuthPrompt) {\n                onShowAuthPrompt('profile')\n              }\n              return\n            }\n            setPhoneUpdateStep(1)\n            setShowPhoneUpdatePanel(true)\n            setCurrentPhoneOTP('')\n            setNewPhone('')\n            setNewPhoneOTP('')\n          },\n        },\n      ],\n    },\n    {\n      id: 'orders',\n      title: 'Orders & Transactions',\n      icon: PackageIcon,\n      items: [\n        {\n          id: 'history',\n          label: 'Order History',\n          value: `${orders.length} orders`,\n          action: () => {\n            if (onNavigate) onNavigate('orders')\n          },\n        },\n      ],\n    },\n    {\n      id: 'delivery',\n      title: 'Delivery Settings',\n      icon: TruckIcon,\n      items: [\n        {\n          id: 'change-delivery-address',\n          label: 'Change Delivery Address',\n          value: profile.location?.city && profile.location?.state && profile.location?.pincode\n            ? `${profile.location.address || ''}, ${profile.location.city}, ${profile.location.state} - ${profile.location.pincode}`.replace(/^,\\s*|,\\s*$/g, '').trim() || 'Not set'\n            : 'Not set',\n          editable: true,\n          action: () => {\n            if (!authenticated) {\n              if (onShowAuthPrompt) {\n                onShowAuthPrompt('profile')\n              }\n              return\n            }\n            setDeliveryAddressOTPStep(1)\n            setDeliveryAddressOTP('')\n            setSelectedDeliveryLocation(null)\n            setShowChangeDeliveryAddressPanel(true)\n          },\n        },\n      ],\n    },\n    {\n      id: 'support',\n      title: 'Support & Help',\n      icon: HelpCircleIcon,\n      items: [\n        {\n          id: 'help',\n          label: 'Help Center',\n          value: 'FAQs & Guides',\n          action: () => setShowSupportPanel(true),\n        },\n        {\n          id: 'contact',\n          label: 'Contact Support',\n          value: 'Chat or Call',\n          action: () => setShowSupportPanel(true),\n        },\n        {\n          id: 'report',\n          label: 'Report Issue',\n          value: 'Report a problem',\n          action: () => setShowReportPanel(true),\n        },\n      ],\n    },\n  ].map(section => ({\n    ...section,\n    title: section.title, // Will be translated in JSX\n    items: section.items.map(item => ({\n      ...item,\n      label: item.label, // Will be translated in JSX\n      value: item.id === 'history' ? item.value : (item.id === 'change-delivery-address' ? item.value : item.value), // Dynamic values stay as is\n    })),\n  }))\n\n  return (\n    <div className=\"user-account-view space-y-6\">\n      {/* Profile Header */}\n      <div className=\"user-account-view__header\">\n        <div className=\"user-account-view__header-avatar\">\n          <UserIcon className=\"h-10 w-10\" />\n        </div>\n        <div className=\"user-account-view__header-info\">\n          <h2 className=\"user-account-view__header-name\">{profile.name}</h2>\n          <p className=\"user-account-view__header-email\">{profile.email || profile.phone}</p>\n        </div>\n      </div>\n\n      {/* Name Edit Modal */}\n      {editingName && (\n        <div className=\"user-account-view__edit-modal\">\n          <div className=\"user-account-view__edit-modal-content\">\n            <h3 className=\"user-account-view__edit-modal-title\"><Trans>Edit Name</Trans></h3>\n            <input\n              type=\"text\"\n              value={editedName}\n              onChange={(e) => setEditedName(e.target.value)}\n              className=\"user-account-view__edit-modal-input\"\n              placeholder=\"Enter your name\" // TODO: Translate placeholder\n              autoFocus\n            />\n            <div className=\"user-account-view__edit-modal-actions\">\n              <button\n                type=\"button\"\n                className=\"user-account-view__edit-modal-cancel\"\n                onClick={() => {\n                  setEditedName(profile.name)\n                  setEditingName(false)\n                }}\n              >\n                <XIcon className=\"h-4 w-4\" />\n                <Trans>Cancel</Trans>\n              </button>\n              <button\n                type=\"button\"\n                className=\"user-account-view__edit-modal-save\"\n                onClick={handleSaveName}\n              >\n                <CheckIcon className=\"h-4 w-4\" />\n                <Trans>Save</Trans>\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Sections */}\n      <div className=\"user-account-view__sections\">\n        {/* Left Navigation - Laptop View */}\n        <div className=\"user-account-view__nav\">\n          {sections.map((section) => (\n            <button\n              key={section.id}\n              type=\"button\"\n              className={cn(\n                'user-account-view__nav-item',\n                activeSectionId === section.id && 'user-account-view__nav-item--active'\n              )}\n              onClick={() => setActiveSectionId(section.id)}\n            >\n              <section.icon className=\"user-account-view__nav-item-icon\" />\n              <span className=\"user-account-view__nav-item-title\"><Trans>{section.title}</Trans></span>\n            </button>\n          ))}\n        </div>\n\n        {/* Right Content - Laptop View */}\n        <div className=\"user-account-view__content\">\n          {sections.map((section) => (\n            <div\n              key={section.id}\n              className={cn(\n                'user-account-view__section',\n                activeSectionId === section.id && 'user-account-view__section--active'\n              )}\n            >\n              <div className=\"user-account-view__section-header\">\n                <section.icon className=\"user-account-view__section-icon\" />\n                <h3 className=\"user-account-view__section-title\"><Trans>{section.title}</Trans></h3>\n              </div>\n              <div className=\"user-account-view__section-content\">\n                {section.items.length > 0 ? (\n                  section.items.map((item) => (\n                    <div key={item.id} className=\"user-account-view__item\">\n                      <div className=\"user-account-view__item-content\">\n                        <div className=\"user-account-view__item-label-wrapper\">\n                          <span className=\"user-account-view__item-label\"><Trans>{item.label}</Trans></span>\n                          {item.isDefault && (\n                            <span className=\"user-account-view__item-badge\">Default</span>\n                          )}\n                        </div>\n                        <span className=\"user-account-view__item-value\">\n                          {item.id === 'history' ? (\n                            <>\n                              {orders.length} <Trans>orders</Trans>\n                            </>\n                          ) : item.id === 'change-delivery-address' ? (\n                            profile.location?.city && profile.location?.state && profile.location?.pincode\n                              ? `${profile.location.address || ''}, ${profile.location.city}, ${profile.location.state} - ${profile.location.pincode}`.replace(/^,\\s*|,\\s*$/g, '').trim() || <Trans>Not set</Trans>\n                              : <Trans>Not set</Trans>\n                          ) : item.value === 'Not set' ? (\n                            <Trans>Not set</Trans>\n                          ) : (\n                            <Trans>{item.value}</Trans>\n                          )}\n                        </span>\n                      </div>\n                      <div className=\"user-account-view__item-actions\">\n                        {item.toggle ? (\n                          <label className=\"user-account-view__toggle\">\n                            <input\n                              type=\"checkbox\"\n                              checked={item.enabled}\n                              onChange={item.onToggle || (() => {})}\n                              className=\"user-account-view__toggle-input\"\n                            />\n                            <span className=\"user-account-view__toggle-slider\" />\n                          </label>\n                        ) : (\n                          <>\n                            {item.editable && (\n                              <button\n                                type=\"button\"\n                                className=\"user-account-view__item-edit\"\n                                onClick={item.onEdit}\n                              >\n                                <EditIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                            {item.onDelete && (\n                              <button\n                                type=\"button\"\n                                className=\"user-account-view__item-delete\"\n                                onClick={item.onDelete}\n                              >\n                                <TrashIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                            {item.action && (\n                              <button\n                                type=\"button\"\n                                className=\"user-account-view__item-action\"\n                                onClick={item.action}\n                              >\n                                <ChevronRightIcon className=\"h-5 w-5\" />\n                              </button>\n                            )}\n                          </>\n                        )}\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <div className=\"user-account-view__empty\">\n                    <section.icon className=\"user-account-view__empty-icon\" />\n                    <p className=\"user-account-view__empty-text\"><Trans>No</Trans> {section.title.toLowerCase()} <Trans>yet</Trans></p>\n                  </div>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {/* Mobile View - All Sections */}\n        <div className=\"user-account-view__sections-mobile\">\n          {sections.map((section) => (\n            <div key={section.id} className=\"user-account-view__section\">\n              <div className=\"user-account-view__section-header\">\n                <section.icon className=\"user-account-view__section-icon\" />\n                <h3 className=\"user-account-view__section-title\"><Trans>{section.title}</Trans></h3>\n              </div>\n              <div className=\"user-account-view__section-content\">\n                {section.items.length > 0 ? (\n                  section.items.map((item) => (\n                    <div key={item.id} className=\"user-account-view__item\">\n                      <div className=\"user-account-view__item-content\">\n                        <div className=\"user-account-view__item-label-wrapper\">\n                          <span className=\"user-account-view__item-label\"><Trans>{item.label}</Trans></span>\n                          {item.isDefault && (\n                            <span className=\"user-account-view__item-badge\">Default</span>\n                          )}\n                        </div>\n                        <span className=\"user-account-view__item-value\">\n                          {item.id === 'history' ? (\n                            <>\n                              {orders.length} <Trans>orders</Trans>\n                            </>\n                          ) : item.id === 'change-delivery-address' ? (\n                            profile.location?.city && profile.location?.state && profile.location?.pincode\n                              ? `${profile.location.address || ''}, ${profile.location.city}, ${profile.location.state} - ${profile.location.pincode}`.replace(/^,\\s*|,\\s*$/g, '').trim() || <Trans>Not set</Trans>\n                              : <Trans>Not set</Trans>\n                          ) : item.value === 'Not set' ? (\n                            <Trans>Not set</Trans>\n                          ) : (\n                            <Trans>{item.value}</Trans>\n                          )}\n                        </span>\n                      </div>\n                      <div className=\"user-account-view__item-actions\">\n                        {item.toggle ? (\n                          <label className=\"user-account-view__toggle\">\n                            <input\n                              type=\"checkbox\"\n                              checked={item.enabled}\n                              onChange={item.onToggle || (() => {})}\n                              className=\"user-account-view__toggle-input\"\n                            />\n                            <span className=\"user-account-view__toggle-slider\" />\n                          </label>\n                        ) : (\n                          <>\n                            {item.editable && (\n                              <button\n                                type=\"button\"\n                                className=\"user-account-view__item-edit\"\n                                onClick={item.onEdit}\n                              >\n                                <EditIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                            {item.onDelete && (\n                              <button\n                                type=\"button\"\n                                className=\"user-account-view__item-delete\"\n                                onClick={item.onDelete}\n                              >\n                                <TrashIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                            {item.action && (\n                              <button\n                                type=\"button\"\n                                className=\"user-account-view__item-action\"\n                                onClick={item.action}\n                              >\n                                <ChevronRightIcon className=\"h-5 w-5\" />\n                              </button>\n                            )}\n                          </>\n                        )}\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <div className=\"user-account-view__empty\">\n                    <section.icon className=\"user-account-view__empty-icon\" />\n                    <p className=\"user-account-view__empty-text\"><Trans>No</Trans> {section.title.toLowerCase()} <Trans>yet</Trans></p>\n                  </div>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Support Panel */}\n      {showSupportPanel && (\n        <div\n          className=\"user-account-view__panel\"\n          onClick={(e) => {\n            if (e.target === e.currentTarget) {\n              setShowSupportPanel(false)\n            }\n          }}\n        >\n          <div className=\"user-account-view__panel-content\">\n            <div className=\"user-account-view__panel-header\">\n              <h3 className=\"user-account-view__panel-title\"><Trans>Support & Help</Trans></h3>\n              <button\n                type=\"button\"\n                onClick={() => setShowSupportPanel(false)}\n                className=\"user-account-view__panel-close\"\n              >\n                <XIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n            <div className=\"user-account-view__panel-body\">\n              <div className=\"space-y-4\">\n                <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                  <h4 className=\"font-semibold text-[#172022] mb-2\"><Trans>Help Center</Trans></h4>\n                  <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                    <Trans>Browse FAQs and guides to find answers to common questions.</Trans>\n                  </p>\n                  <button\n                    type=\"button\"\n                    className=\"text-sm text-[#1b8f5b] font-semibold hover:underline\"\n                  >\n                    <Trans>Visit Help Center</Trans> â†’\n                  </button>\n                </div>\n                <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                  <h4 className=\"font-semibold text-[#172022] mb-2\"><Trans>Contact Support</Trans></h4>\n                  <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-2\">\n                    <strong><Trans>Phone</Trans>:</strong> +91 1800-XXX-XXXX\n                  </p>\n                  <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                    <strong><Trans>Email</Trans>:</strong> support@irasathi.com\n                  </p>\n                  <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                    <strong><Trans>Hours</Trans>:</strong> <Trans>Mon-Sat, 9 AM - 6 PM</Trans>\n                  </p>\n                  <button\n                    type=\"button\"\n                    className=\"text-sm text-[#1b8f5b] font-semibold hover:underline\"\n                  >\n                    <Trans>Start Chat</Trans> â†’\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Report Issue Panel */}\n      {showReportPanel && (\n        <div\n          className=\"user-account-view__panel\"\n          onClick={(e) => {\n            if (e.target === e.currentTarget) {\n              setShowReportPanel(false)\n              setReportForm({ subject: '', description: '', category: 'general' })\n            }\n          }}\n        >\n          <div className=\"user-account-view__panel-content\">\n            <div className=\"user-account-view__panel-header\">\n              <h3 className=\"user-account-view__panel-title\"><Trans>Report Issue</Trans></h3>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setShowReportPanel(false)\n                  setReportForm({ subject: '', description: '', category: 'general' })\n                }}\n                className=\"user-account-view__panel-close\"\n              >\n                <XIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n            <div className=\"user-account-view__panel-body\">\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\n                    <Trans>Category</Trans> <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={reportForm.category}\n                    onChange={(e) => setReportForm({ ...reportForm, category: e.target.value })}\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\n                  >\n                    <option value=\"general\"><Trans>General Issue</Trans></option>\n                    <option value=\"payment\"><Trans>Payment Issue</Trans></option>\n                    <option value=\"delivery\"><Trans>Delivery Issue</Trans></option>\n                    <option value=\"product\"><Trans>Product Issue</Trans></option>\n                    <option value=\"account\"><Trans>Account Issue</Trans></option>\n                    <option value=\"other\"><Trans>Other</Trans></option>\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\n                    <Trans>Subject</Trans> <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={reportForm.subject}\n                    onChange={(e) => setReportForm({ ...reportForm, subject: e.target.value })}\n                    placeholder=\"Brief description of the issue\" // TODO: Translate placeholder\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\n                    <Trans>Description</Trans> <span className=\"text-red-500\">*</span>\n                  </label>\n                  <textarea\n                    value={reportForm.description}\n                    onChange={(e) => setReportForm({ ...reportForm, description: e.target.value })}\n                    placeholder=\"Please provide detailed information about the issue\" // TODO: Translate placeholder\n                    rows={5}\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b] resize-none\"\n                  />\n                </div>\n              </div>\n              <div className=\"mt-6\">\n                <button\n                  type=\"button\"\n                  onClick={handleSubmitReport}\n                  className=\"w-full py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors\"\n                >\n                  <Trans>Submit Report</Trans>\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Phone Update Panel */}\n      {showPhoneUpdatePanel && (\n        <div\n          className=\"user-account-view__panel\"\n          onClick={(e) => {\n            if (e.target === e.currentTarget) {\n              setShowPhoneUpdatePanel(false)\n              setPhoneUpdateStep(1)\n              setCurrentPhoneOTP('')\n              setNewPhone('')\n              setNewPhoneOTP('')\n            }\n          }}\n        >\n          <div className=\"user-account-view__panel-content\">\n            <div className=\"user-account-view__panel-header\">\n              <h3 className=\"user-account-view__panel-title\"><Trans>Update Phone Number</Trans></h3>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setShowPhoneUpdatePanel(false)\n                  setPhoneUpdateStep(1)\n                  setCurrentPhoneOTP('')\n                  setNewPhone('')\n                  setNewPhoneOTP('')\n                }}\n                className=\"user-account-view__panel-close\"\n              >\n                <XIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n            <div className=\"user-account-view__panel-body\">\n              {/* Step 1: Request OTP for current phone */}\n              {phoneUpdateStep === 1 && (\n              <div className=\"space-y-4\">\n                  <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                    <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                      We'll send an OTP to your current phone number <strong>{profile.phone}</strong> to verify your identity.\n                    </p>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={async () => {\n                      // Check authentication\n                      if (!authenticated) {\n                        if (onShowAuthPrompt) {\n                          onShowAuthPrompt('profile')\n                        }\n                        return\n                      }\n\n                      setPhoneUpdateLoading(true)\n                      try {\n                        const result = await userApi.requestOTPForCurrentPhone()\n                        if (result.success) {\n                          success('OTP sent to your current phone number')\n                          setPhoneUpdateStep(2)\n                        } else {\n                          showError(result.message || 'Failed to send OTP')\n                        }\n                      } catch (error) {\n                        console.error('Error requesting OTP:', error)\n                        showError(error.error?.message || 'Failed to send OTP')\n                      } finally {\n                        setPhoneUpdateLoading(false)\n                      }\n                    }}\n                    disabled={phoneUpdateLoading}\n                    className=\"w-full py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    {phoneUpdateLoading ? <Trans>Sending...</Trans> : <Trans>Send OTP to Current Phone</Trans>}\n                  </button>\n                </div>\n              )}\n\n              {/* Step 2: Verify OTP for current phone */}\n              {phoneUpdateStep === 2 && (\n                <div className=\"space-y-4\">\n                  <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                    <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                      Enter the OTP sent to <strong>{profile.phone}</strong>\n                    </p>\n                  </div>\n                <div>\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\n                      OTP <span className=\"text-red-500\">*</span>\n                  </label>\n                    <input\n                      type=\"text\"\n                      value={currentPhoneOTP}\n                      onChange={(e) => setCurrentPhoneOTP(e.target.value.replace(/\\D/g, '').slice(0, 6))}\n                      placeholder=\"Enter 6-digit OTP\" // TODO: Translate placeholder\n                      maxLength={6}\n                      className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\n                  />\n                </div>\n                  <div className=\"flex gap-3\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setPhoneUpdateStep(1)}\n                      className=\"flex-1 py-2.5 px-4 rounded-xl border border-[rgba(34,94,65,0.2)] bg-white text-[#1b8f5b] text-sm font-semibold hover:bg-[rgba(240,245,242,0.5)] transition-colors\"\n                    >\n                      <Trans>Back</Trans>\n                    </button>\n                    <button\n                      type=\"button\"\n                    onClick={async () => {\n                      // Check authentication\n                      if (!authenticated) {\n                        if (onShowAuthPrompt) {\n                          onShowAuthPrompt('profile')\n                        }\n                        return\n                      }\n\n                      if (!currentPhoneOTP || currentPhoneOTP.length !== 6) {\n                        showError('Please enter a valid 6-digit OTP')\n                        return\n                      }\n                      setPhoneUpdateLoading(true)\n                      try {\n                        const result = await userApi.verifyOTPForCurrentPhone({ otp: currentPhoneOTP })\n                          if (result.success) {\n                            success('Current phone verified successfully')\n                            setPhoneUpdateStep(3)\n                          } else {\n                            showError(result.message || 'Invalid OTP')\n                          }\n                        } catch (error) {\n                          console.error('Error verifying OTP:', error)\n                          showError(error.error?.message || 'Invalid OTP')\n                        } finally {\n                          setPhoneUpdateLoading(false)\n                        }\n                      }}\n                      disabled={phoneUpdateLoading || !currentPhoneOTP || currentPhoneOTP.length !== 6}\n                      className=\"flex-1 py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      {phoneUpdateLoading ? <Trans>Verifying...</Trans> : <Trans>Verify OTP</Trans>}\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              {/* Step 3: Enter new phone number */}\n              {phoneUpdateStep === 3 && (\n                <div className=\"space-y-4\">\n                  <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                    <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                      Current phone verified! Now enter your new phone number.\n                    </p>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\n                      <Trans>New Phone Number</Trans> <span className=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"tel\"\n                      value={newPhone}\n                      onChange={(e) => setNewPhone(e.target.value.replace(/\\D/g, ''))}\n                      placeholder=\"Enter new phone number\"\n                      className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\n                    />\n                  </div>\n                  <div className=\"flex gap-3\">\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        setPhoneUpdateStep(2)\n                        setNewPhone('')\n                      }}\n                      className=\"flex-1 py-2.5 px-4 rounded-xl border border-[rgba(34,94,65,0.2)] bg-white text-[#1b8f5b] text-sm font-semibold hover:bg-[rgba(240,245,242,0.5)] transition-colors\"\n                    >\n                      <Trans>Back</Trans>\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={async () => {\n                      // Check authentication\n                      if (!authenticated) {\n                        if (onShowAuthPrompt) {\n                          onShowAuthPrompt('profile')\n                        }\n                        return\n                      }\n\n                      if (!newPhone || newPhone.length < 10) {\n                        showError('Please enter a valid phone number')\n                        return\n                      }\n                      if (newPhone === profile.phone) {\n                        showError('New phone number must be different from current phone number')\n                        return\n                      }\n                      setPhoneUpdateLoading(true)\n                      try {\n                        const result = await userApi.requestOTPForNewPhone({ newPhone })\n                          if (result.success) {\n                            success('OTP sent to your new phone number')\n                            setPhoneUpdateStep(4)\n                          } else {\n                            showError(result.message || 'Failed to send OTP')\n                          }\n                        } catch (error) {\n                          console.error('Error requesting OTP:', error)\n                          showError(error.error?.message || 'Failed to send OTP')\n                        } finally {\n                          setPhoneUpdateLoading(false)\n                        }\n                      }}\n                      disabled={phoneUpdateLoading || !newPhone || newPhone.length < 10}\n                      className=\"flex-1 py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      {phoneUpdateLoading ? <Trans>Sending...</Trans> : <Trans>Send OTP to New Phone</Trans>}\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              {/* Step 4: Verify OTP for new phone */}\n              {phoneUpdateStep === 4 && (\n                <div className=\"space-y-4\">\n                  <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                    <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                      Enter the OTP sent to <strong>{newPhone}</strong>\n                    </p>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\n                      OTP <span className=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={newPhoneOTP}\n                      onChange={(e) => setNewPhoneOTP(e.target.value.replace(/\\D/g, '').slice(0, 6))}\n                      placeholder=\"Enter 6-digit OTP\" // TODO: Translate placeholder\n                      maxLength={6}\n                      className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\n                    />\n                  </div>\n                  <div className=\"flex gap-3\">\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        setPhoneUpdateStep(3)\n                        setNewPhoneOTP('')\n                      }}\n                      className=\"flex-1 py-2.5 px-4 rounded-xl border border-[rgba(34,94,65,0.2)] bg-white text-[#1b8f5b] text-sm font-semibold hover:bg-[rgba(240,245,242,0.5)] transition-colors\"\n                    >\n                      <Trans>Back</Trans>\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={async () => {\n                      // Check authentication\n                      if (!authenticated) {\n                        if (onShowAuthPrompt) {\n                          onShowAuthPrompt('profile')\n                        }\n                        return\n                      }\n\n                      if (!newPhoneOTP || newPhoneOTP.length !== 6) {\n                        showError('Please enter a valid 6-digit OTP')\n                        return\n                      }\n                      setPhoneUpdateLoading(true)\n                      try {\n                        const result = await userApi.verifyOTPForNewPhone({ otp: newPhoneOTP })\n                          if (result.success) {\n                            success('Phone number updated successfully')\n                            dispatch({\n                              type: 'AUTH_LOGIN',\n                              payload: { ...profile, phone: result.data?.user?.phone || newPhone },\n                            })\n                            setShowPhoneUpdatePanel(false)\n                            setPhoneUpdateStep(1)\n                            setCurrentPhoneOTP('')\n                            setNewPhone('')\n                            setNewPhoneOTP('')\n                          } else {\n                            showError(result.message || 'Invalid OTP')\n                          }\n                        } catch (error) {\n                          console.error('Error verifying OTP:', error)\n                          showError(error.error?.message || 'Invalid OTP')\n                        } finally {\n                          setPhoneUpdateLoading(false)\n                        }\n                      }}\n                      disabled={phoneUpdateLoading || !newPhoneOTP || newPhoneOTP.length !== 6}\n                      className=\"flex-1 py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      {phoneUpdateLoading ? <Trans>Updating...</Trans> : <Trans>Update Phone Number</Trans>}\n                    </button>\n                </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Change Delivery Address Panel */}\n      {showChangeDeliveryAddressPanel && (\n        <div\n          className=\"user-account-view__panel\"\n          onClick={(e) => {\n            if (e.target === e.currentTarget) {\n              setShowChangeDeliveryAddressPanel(false)\n              setDeliveryAddressOTPStep(1)\n              setDeliveryAddressOTP('')\n              setSelectedDeliveryLocation(null)\n            }\n          }}\n        >\n          <div className=\"user-account-view__panel-content\">\n            <div className=\"user-account-view__panel-header\">\n              <h3 className=\"user-account-view__panel-title\"><Trans>Change Delivery Address</Trans></h3>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setShowChangeDeliveryAddressPanel(false)\n                  setDeliveryAddressOTPStep(1)\n                  setDeliveryAddressOTP('')\n                  setSelectedDeliveryLocation(null)\n                }}\n                className=\"user-account-view__panel-close\"\n              >\n                <XIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n            <div className=\"user-account-view__panel-body\">\n              {/* Step 1: Request OTP for current phone */}\n              {deliveryAddressOTPStep === 1 && (\n                <div className=\"space-y-4\">\n                  <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                    <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                      We'll send an OTP to your registered phone number <strong>{profile.phone}</strong> to verify your identity before updating the delivery address.\n                    </p>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={async () => {\n                      // Check authentication\n                      if (!authenticated) {\n                        if (onShowAuthPrompt) {\n                          onShowAuthPrompt('profile')\n                        }\n                        return\n                      }\n\n                      setDeliveryAddressOTPLoading(true)\n                      try {\n                        const result = await userApi.requestOTPForCurrentPhone()\n                        if (result.success) {\n                          success('OTP sent to your registered phone number')\n                          setDeliveryAddressOTPStep(2)\n                        } else {\n                          showError(result.message || 'Failed to send OTP')\n                        }\n                      } catch (error) {\n                        console.error('Error requesting OTP:', error)\n                        showError(error.error?.message || 'Failed to send OTP')\n                      } finally {\n                        setDeliveryAddressOTPLoading(false)\n                      }\n                    }}\n                    disabled={deliveryAddressOTPLoading}\n                    className=\"w-full py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    {deliveryAddressOTPLoading ? <Trans>Sending...</Trans> : <Trans>Send OTP</Trans>}\n                  </button>\n                </div>\n              )}\n\n              {/* Step 2: Verify OTP */}\n              {deliveryAddressOTPStep === 2 && (\n                <div className=\"space-y-4\">\n                  <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                    <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                      Enter the OTP sent to <strong>{profile.phone}</strong>\n                    </p>\n                  </div>\n                <div>\n                  <label className=\"block text-sm font-semibold text-[#172022] mb-1.5\">\n                      OTP <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"text\"\n                      value={deliveryAddressOTP}\n                      onChange={(e) => setDeliveryAddressOTP(e.target.value.replace(/\\D/g, '').slice(0, 6))}\n                      placeholder=\"Enter 6-digit OTP\" // TODO: Translate placeholder\n                    maxLength={6}\n                    className=\"w-full px-3 py-2.5 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\n                  />\n                </div>\n                  <div className=\"flex gap-3\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setDeliveryAddressOTPStep(1)}\n                      className=\"flex-1 py-2.5 px-4 rounded-xl border border-[rgba(34,94,65,0.2)] bg-white text-[#1b8f5b] text-sm font-semibold hover:bg-[rgba(240,245,242,0.5)] transition-colors\"\n                    >\n                      <Trans>Back</Trans>\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={async () => {\n                        // Check authentication\n                        if (!authenticated) {\n                          if (onShowAuthPrompt) {\n                            onShowAuthPrompt('profile')\n                          }\n                          return\n                        }\n\n                        if (!deliveryAddressOTP || deliveryAddressOTP.length !== 6) {\n                          showError('Please enter a valid 6-digit OTP')\n                          return\n                        }\n                        setDeliveryAddressOTPLoading(true)\n                        try {\n                          const result = await userApi.verifyOTPForCurrentPhone({ otp: deliveryAddressOTP })\n                          if (result.success) {\n                            success('Phone verified successfully')\n                            setDeliveryAddressOTPStep(3)\n                          } else {\n                            showError(result.message || 'Invalid OTP')\n                          }\n                        } catch (error) {\n                          console.error('Error verifying OTP:', error)\n                          showError(error.error?.message || 'Invalid OTP')\n                        } finally {\n                          setDeliveryAddressOTPLoading(false)\n                        }\n                      }}\n                      disabled={deliveryAddressOTPLoading || !deliveryAddressOTP || deliveryAddressOTP.length !== 6}\n                      className=\"flex-1 py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      {deliveryAddressOTPLoading ? <Trans>Verifying...</Trans> : <Trans>Verify OTP</Trans>}\n                    </button>\n              </div>\n                </div>\n              )}\n\n              {/* Step 3: Select Address from Google Maps */}\n              {deliveryAddressOTPStep === 3 && (\n                <div className=\"space-y-4\">\n                  <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                    <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-3\">\n                      Phone verified! Now select your delivery address using Google Maps. You can search for an address or use your live location.\n                    </p>\n                  </div>\n                  \n                  <GoogleMapsLocationPicker\n                    onLocationSelect={(location) => {\n                      setSelectedDeliveryLocation(location)\n                    }}\n                    initialLocation={profile.location ? {\n                      address: profile.location.address || '',\n                      city: profile.location.city || '',\n                      state: profile.location.state || '',\n                      pincode: profile.location.pincode || '',\n                      coordinates: profile.location.coordinates || null,\n                    } : null}\n                    required={true}\n                    label=\"Delivery Address\"\n                  />\n\n                  {selectedDeliveryLocation && (\n                    <div className=\"p-4 rounded-xl bg-[rgba(240,245,242,0.4)] border border-[rgba(34,94,65,0.1)]\">\n                      <p className=\"text-xs font-semibold text-[#172022] mb-2\">Selected Address:</p>\n                      <p className=\"text-sm text-[rgba(26,42,34,0.7)]\">\n                        {selectedDeliveryLocation.address}\n                      </p>\n                      <p className=\"text-xs text-[rgba(26,42,34,0.6)] mt-1\">\n                        {selectedDeliveryLocation.city}, {selectedDeliveryLocation.state} - {selectedDeliveryLocation.pincode}\n                      </p>\n                    </div>\n                  )}\n\n                  <div className=\"flex gap-3\">\n                <button\n                  type=\"button\"\n                      onClick={() => {\n                        setDeliveryAddressOTPStep(2)\n                        setSelectedDeliveryLocation(null)\n                      }}\n                  className=\"flex-1 py-2.5 px-4 rounded-xl border border-[rgba(34,94,65,0.2)] bg-white text-[#1b8f5b] text-sm font-semibold hover:bg-[rgba(240,245,242,0.5)] transition-colors\"\n                >\n                      <Trans>Back</Trans>\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={handleSaveDeliveryAddress}\n                      disabled={loading || !selectedDeliveryLocation}\n                  className=\"flex-1 py-2.5 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  {loading ? <Trans>Saving...</Trans> : <Trans>Save Address</Trans>}\n                </button>\n              </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\CarouselProductsView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[160,199],"text":""},"desc":"Remove unused variable 'cn'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\nimport { ProductCard } from '../../components/ProductCard'\nimport { ChevronLeftIcon } from '../../components/icons'\nimport { cn } from '../../../../lib/cn'\nimport * as userApi from '../../services/userApi'\n\nexport function CarouselProductsView({ carouselId, onProductClick, onAddToCart, onBack, onToggleFavourite, favourites = [] }) {\n  const [carousel, setCarousel] = useState(null)\n  const [products, setProducts] = useState([])\n  const [loading, setLoading] = useState(true)\n\n  // Fetch carousel data and products\n  useEffect(() => {\n    const loadCarouselProducts = async () => {\n      setLoading(true)\n      try {\n        // First, get all offers to find the carousel\n        const offersResult = await userApi.getOffers()\n        if (offersResult.success && offersResult.data?.carousels) {\n          const foundCarousel = offersResult.data.carousels.find(c => c.id === carouselId)\n          if (foundCarousel) {\n            setCarousel(foundCarousel)\n            \n            // Fetch products for the product IDs\n            if (foundCarousel.productIds && foundCarousel.productIds.length > 0) {\n              const productPromises = foundCarousel.productIds.map(productId => \n                userApi.getProductDetails(productId).catch(err => {\n                  console.error(`Failed to load product ${productId}:`, err)\n                  return null\n                })\n              )\n              \n              const productResults = await Promise.all(productPromises)\n              const validProducts = productResults\n                .filter(result => result && result.success && result.data?.product)\n                .map(result => result.data.product)\n              \n              setProducts(validProducts)\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error loading carousel products:', error)\n      } finally {\n        setLoading(false)\n      }\n    }\n    \n    if (carouselId) {\n      loadCarouselProducts()\n    }\n  }, [carouselId])\n\n  return (\n    <div className=\"user-carousel-products-view space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center gap-4\">\n        <button\n          onClick={onBack}\n          className=\"flex items-center justify-center w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors\"\n          aria-label=\"Go back\"\n        >\n          <ChevronLeftIcon className=\"h-5 w-5 text-gray-700\" />\n        </button>\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">{carousel?.title || 'Carousel Products'}</h1>\n          {carousel?.description && (\n            <p className=\"text-sm text-gray-600 mt-1\">{carousel.description}</p>\n          )}\n        </div>\n      </div>\n\n      {/* Products Grid */}\n      {loading ? (\n        <div className=\"text-center py-12\">\n          <p className=\"text-gray-500\">Loading products...</p>\n        </div>\n      ) : products.length === 0 ? (\n        <div className=\"text-center py-12 bg-gray-50 rounded-lg\">\n          <p className=\"text-gray-600 font-medium\">No products available</p>\n          <p className=\"text-sm text-gray-500 mt-1\">This carousel doesn't have any products linked yet.</p>\n        </div>\n      ) : (\n        <div className=\"home-products-grid\">\n          {products.map((product) => (\n            <ProductCard\n              key={product._id || product.id}\n              product={{\n                id: product._id || product.id,\n                name: product.name,\n                price: product.priceToUser || product.price || 0,\n                image: product.images?.[0]?.url || product.primaryImage || 'https://via.placeholder.com/300',\n                category: product.category,\n                stock: product.stock,\n                description: product.description,\n                isWishlisted: favourites.includes(product._id || product.id),\n                rating: product.rating ?? product.averageRating,\n                reviews: product.reviews ?? product.reviewCount,\n                reviewCount: product.reviewCount ?? product.reviews,\n              }}\n              onNavigate={onProductClick}\n              onAddToCart={onAddToCart}\n              onWishlist={onToggleFavourite}\n              className=\"product-card-wrapper\"\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\CartView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'onAddToCart' is defined but never used.","line":11,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":79,"suggestions":[{"messageId":"removeVar","data":{"varName":"onAddToCart"},"fix":{"range":[610,623],"text":""},"desc":"Remove unused variable 'onAddToCart'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo, useState, useEffect, useRef } from 'react'\nimport { useUserState } from '../../context/UserContext'\nimport { MIN_ORDER_VALUE } from '../../services/userData'\nimport { PlusIcon, MinusIcon, TrashIcon, TruckIcon, ChevronRightIcon } from '../../components/icons'\nimport { cn } from '../../../../lib/cn'\nimport * as userApi from '../../services/userApi'\nimport { getPrimaryImageUrl } from '../../utils/productImages'\nimport { Trans } from '../../../../components/Trans'\nimport { TransText } from '../../../../components/TransText'\n\nexport function CartView({ onUpdateQuantity, onRemove, onCheckout, onAddToCart, onNavigateToProduct }) {\n  const { cart } = useUserState()\n  const [suggestedProducts, setSuggestedProducts] = useState([])\n  const [cartProducts, setCartProducts] = useState({})\n  const [expandedVariants, setExpandedVariants] = useState({}) // Track expanded state: { variantId: true/false }\n  const fetchingProductsRef = useRef(new Set()) // Track which products are currently being fetched\n\n  // Optimistic quantity state for instant UI updates\n  const [optimisticQuantities, setOptimisticQuantities] = useState({})\n\n  // Sync optimistic quantities when cart updates from backend\n  useEffect(() => {\n    // Update optimistic quantities to match actual cart state\n    const newOptimisticQuantities = {}\n    cart.forEach(item => {\n      const id = item.id || item._id || item.cartItemId\n      newOptimisticQuantities[id] = item.quantity\n    })\n    setOptimisticQuantities(newOptimisticQuantities)\n  }, [cart])\n\n  // Fetch suggested products (exclude items already in cart)\n  useEffect(() => {\n    const loadSuggested = async () => {\n      try {\n        const cartProductIds = cart.map((item) => item.productId)\n        const result = await userApi.getProducts({ limit: 20 })\n        if (result.success && result.data?.products) {\n          const available = result.data.products.filter(\n            (p) => !cartProductIds.includes(p._id || p.id)\n          )\n          // Shuffle and take 8\n          const shuffled = [...available].sort(() => Math.random() - 0.5)\n          setSuggestedProducts(shuffled.slice(0, 8))\n        }\n      } catch (error) {\n        console.error('Error loading suggested products:', error)\n      }\n    }\n\n    if (cart.length > 0) {\n      loadSuggested()\n    }\n  }, [cart])\n\n  // Fetch product details for cart items\n  useEffect(() => {\n    const loadCartProducts = async () => {\n      // Use functional update to check current state without adding to dependencies\n      setCartProducts(currentProducts => {\n        // Only fetch products that aren't already loaded and aren't currently being fetched\n        const productsToFetch = cart.filter(item =>\n          !currentProducts[item.productId] && !fetchingProductsRef.current.has(item.productId)\n        )\n\n        if (productsToFetch.length === 0) {\n          return currentProducts // All products already loaded or being fetched\n        }\n\n        // Mark products as being fetched\n        productsToFetch.forEach(item => fetchingProductsRef.current.add(item.productId))\n\n        // Fetch missing products and update incrementally (async, doesn't block return)\n        productsToFetch.forEach(async (item) => {\n          try {\n            const result = await userApi.getProductDetails(item.productId)\n            if (result.success && result.data?.product) {\n              // Update state incrementally for each product as it loads\n              setCartProducts(prev => ({\n                ...prev,\n                [item.productId]: result.data.product\n              }))\n            }\n          } catch (error) {\n            console.error(`Error loading product ${item.productId}:`, error)\n          } finally {\n            // Remove from fetching set\n            fetchingProductsRef.current.delete(item.productId)\n          }\n        })\n\n        // Return current products immediately (new products will be added via setState above)\n        return currentProducts\n      })\n    }\n\n    if (cart.length > 0) {\n      loadCartProducts()\n    } else {\n      // Clear cartProducts when cart is empty\n      setCartProducts({})\n      fetchingProductsRef.current.clear()\n    }\n  }, [cart])\n\n  // Group items by productId, and if variants exist, group variants together\n  const groupedCartItems = useMemo(() => {\n    console.log('ðŸ›’ Cart Data:', cart)\n    console.log('ðŸ›’ Cart Products:', cartProducts)\n\n    const grouped = {}\n\n    cart.forEach((item, index) => {\n      console.log(`\\nðŸ“¦ Cart Item ${index + 1}:`, {\n        id: item.id,\n        cartItemId: item.cartItemId,\n        productId: item.productId,\n        name: item.name,\n        price: item.price,\n        unitPrice: item.unitPrice,\n        variantAttributes: item.variantAttributes,\n        quantity: item.quantity,\n        fullItem: item\n      })\n\n      const product = cartProducts[item.productId]\n      console.log(`ðŸ“¦ Product for ${item.productId}:`, product)\n\n      // Use variant-specific price (unitPrice) if available, otherwise fallback\n      const unitPrice = item.unitPrice || item.price || (product ? (product.priceToUser || product.price || 0) : 0)\n      console.log(`ðŸ’° Unit Price calculated:`, unitPrice, {\n        'item.unitPrice': item.unitPrice,\n        'item.price': item.price,\n        'product.priceToUser': product?.priceToUser,\n        'product.price': product?.price\n      })\n\n      // Check if item has variant attributes\n      const variantAttrs = item.variantAttributes || {}\n      const hasVariants = variantAttrs && typeof variantAttrs === 'object' && Object.keys(variantAttrs).length > 0\n      console.log(`ðŸ”– Variant Attributes:`, variantAttrs, 'Has Variants:', hasVariants)\n      const key = item.productId\n\n      if (!grouped[key]) {\n        grouped[key] = {\n          productId: item.productId,\n          product,\n          name: item.name || product?.name || 'Product',\n          image: product ? getPrimaryImageUrl(product) : (item.image || 'https://via.placeholder.com/400'),\n          variants: [], // Array of variant items\n          hasVariants: false,\n        }\n      }\n\n      // Add this item as a variant - ensure we have proper ID and variant attributes\n      const variantItem = {\n        ...item,\n        id: item.id || item._id || item.cartItemId, // Ensure ID is available\n        cartItemId: item.id || item._id || item.cartItemId, // For API calls\n        product,\n        unitPrice, // Variant-specific price from backend\n        variantAttributes: variantAttrs, // Ensure variant attributes are included\n        hasVariants,\n      }\n\n      console.log(`âœ… Adding variant to group ${key}:`, variantItem)\n\n      grouped[key].variants.push(variantItem)\n\n      // Mark as having variants if any variant exists\n      if (hasVariants) {\n        grouped[key].hasVariants = true\n      }\n    })\n\n    const groupedArray = Object.values(grouped)\n    console.log('\\nðŸ“Š Final Grouped Cart Items:', groupedArray)\n    console.log('ðŸ“Š Grouped Items Summary:', groupedArray.map(g => ({\n      productId: g.productId,\n      name: g.name,\n      variantCount: g.variants.length,\n      hasVariants: g.hasVariants,\n      variants: g.variants.map((v, idx) => ({\n        index: idx,\n        id: v.id,\n        cartItemId: v.cartItemId,\n        unitPrice: v.unitPrice,\n        variantAttributes: v.variantAttributes,\n        quantity: v.quantity,\n        hasVariantAttrs: v.variantAttributes && Object.keys(v.variantAttributes).length > 0\n      }))\n    })))\n\n    // Verify all cart items are included\n    const totalCartItems = cart.length\n    const totalGroupedVariants = groupedArray.reduce((sum, g) => sum + g.variants.length, 0)\n    console.log(`\\nâœ… Cart Items Check: ${totalCartItems} cart items â†’ ${totalGroupedVariants} grouped variants`)\n    if (totalCartItems !== totalGroupedVariants) {\n      console.warn('âš ï¸ WARNING: Cart items count mismatch! Some items may be missing.')\n    }\n\n    return groupedArray\n  }, [cart, cartProducts])\n\n  const totals = useMemo(() => {\n    const subtotal = groupedCartItems.reduce((sum, group) => {\n      return sum + group.variants.reduce((variantSum, variant) => {\n        const variantId = variant.id || variant._id || variant.cartItemId\n        // Use optimistic quantity if available, otherwise use actual quantity\n        const quantity = optimisticQuantities[variantId] !== undefined\n          ? optimisticQuantities[variantId]\n          : variant.quantity\n        return variantSum + (variant.unitPrice * quantity)\n      }, 0)\n    }, 0)\n    const delivery = subtotal >= 5000 ? 0 : 50 // Free delivery above â‚¹5,000\n    const total = subtotal + delivery\n    const meetsMinimum = total >= MIN_ORDER_VALUE\n\n    return {\n      subtotal,\n      delivery,\n      total,\n      meetsMinimum,\n      shortfall: meetsMinimum ? 0 : MIN_ORDER_VALUE - total,\n    }\n  }, [groupedCartItems, optimisticQuantities])\n\n  const totalItemsCount = useMemo(() => {\n    return groupedCartItems.reduce((sum, group) => sum + group.variants.length, 0)\n  }, [groupedCartItems])\n\n  if (groupedCartItems.length === 0) {\n    return (\n      <div className=\"user-cart-view space-y-4\">\n        <div className=\"text-center py-12\">\n          <p className=\"text-lg font-semibold text-[rgba(26,42,34,0.75)] mb-2\"><Trans>Your cart is empty</Trans></p>\n          <p className=\"text-sm text-[rgba(26,42,34,0.55)]\"><Trans>Add some products to get started</Trans></p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"user-cart-view space-y-6\">\n      <div className=\"mb-4\">\n        <h2 className=\"text-xl font-bold text-[#172022] mb-1\"><Trans>Shopping Cart</Trans></h2>\n        <p className=\"text-sm text-[rgba(26,42,34,0.65)]\">{totalItemsCount} {totalItemsCount === 1 ? <Trans>item</Trans> : <Trans>items</Trans>}</p>\n      </div>\n\n      <div className=\"space-y-4\">\n        {groupedCartItems.map((group, groupIndex) => (\n          <div\n            key={group.productId || `cart-group-${groupIndex}`}\n            className=\"rounded-2xl border border-[rgba(34,94,65,0.16)] bg-gradient-to-br from-white to-[rgba(239,246,240,0.92)] shadow-[0_20px_42px_-30px_rgba(16,44,30,0.36)] overflow-hidden\"\n          >\n            {/* Product Header */}\n            <div className=\"flex gap-3 p-4 border-b border-[rgba(34,94,65,0.1)]\">\n              <div className=\"flex-shrink-0 w-20 h-20 rounded-2xl overflow-hidden bg-gray-100\">\n                <img src={group.image} alt={group.name} className=\"w-full h-full object-cover\" />\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <h3 className=\"text-sm font-semibold text-[#172022] mb-1 line-clamp-2\"><TransText>{group.name}</TransText></h3>\n                {group.vendor && (\n                  <p className=\"text-xs text-[rgba(26,42,34,0.6)] mb-1\"><TransText>{group.vendor.name}</TransText></p>\n                )}\n              </div>\n            </div>\n\n            {/* Variants List */}\n            <div className=\"p-4 space-y-3\">\n              {group.variants.map((variant, variantIdx) => {\n                const variantId = variant.id || variant._id || variant.cartItemId\n                const cartItemId = variant.cartItemId || variant.id || variant._id\n                const isExpanded = expandedVariants[variantId] || false\n\n                return (\n                  <div key={variantId || variant.cartItemId || `variant-${groupIndex}-${variantIdx}`} className=\"rounded-xl bg-white border border-[rgba(34,94,65,0.1)] overflow-hidden\">\n                    {/* Variant Header - Collapsible */}\n                    <button\n                      type=\"button\"\n                      onClick={() => setExpandedVariants(prev => ({ ...prev, [variantId]: !prev[variantId] }))}\n                      className=\"w-full flex items-start justify-between gap-3 p-3 hover:bg-[rgba(240,245,242,0.3)] transition-colors\"\n                    >\n                      <div className=\"flex-1 min-w-0 text-left\">\n                        <div className=\"flex items-center gap-2 mb-1\">\n                          <span className=\"text-xs font-bold text-[#172022]\"><Trans>Variant</Trans> {variantIdx + 1}</span>\n                          {variant.variantAttributes && Object.keys(variant.variantAttributes).length > 0 && (\n                            <span className=\"text-[0.65rem] text-[rgba(26,42,34,0.6)]\">\n                              ({Object.keys(variant.variantAttributes).length} <Trans>properties</Trans>)\n                            </span>\n                          )}\n                        </div>\n                        {/* Show first property as preview */}\n                        {(() => {\n                          console.log(`ðŸ” Checking variant attributes for variant ${variantIdx + 1}:`, {\n                            variantAttributes: variant.variantAttributes,\n                            type: typeof variant.variantAttributes,\n                            isObject: variant.variantAttributes && typeof variant.variantAttributes === 'object',\n                            keys: variant.variantAttributes ? Object.keys(variant.variantAttributes) : [],\n                            length: variant.variantAttributes ? Object.keys(variant.variantAttributes).length : 0\n                          })\n                          return null\n                        })()}\n                        {variant.variantAttributes && Object.keys(variant.variantAttributes).length > 0 ? (\n                          <div className=\"text-xs text-[rgba(26,42,34,0.7)]\">\n                            {Object.entries(variant.variantAttributes).slice(0, 1).map(([key, value], attrIndex) => (\n                              <span key={`${variantId || variantIdx}-attr-${key}-${attrIndex}`}>\n                                <span className=\"font-medium\">{key}:</span> {value}\n                                {Object.keys(variant.variantAttributes).length > 1 && ' + more'}\n                              </span>\n                            ))}\n                          </div>\n                        ) : (\n                          <p className=\"text-xs text-[rgba(26,42,34,0.6)]\"><Trans>Standard variant</Trans></p>\n                        )}\n                        {/* Variant Price - Always visible */}\n                        <div className=\"text-sm font-bold text-[#1b8f5b] mt-1\">\n                          â‚¹{(variant.unitPrice || 0).toLocaleString('en-IN')} <Trans>per unit</Trans>\n                          {(() => {\n                            console.log(`ðŸ’° Variant ${variantIdx + 1} Price Display:`, {\n                              unitPrice: variant.unitPrice,\n                              price: variant.price,\n                              calculated: variant.unitPrice || 0\n                            })\n                            return null\n                          })()}\n                        </div>\n                      </div>\n                      <ChevronRightIcon\n                        className={cn(\n                          \"h-4 w-4 text-[rgba(26,42,34,0.5)] transition-transform shrink-0\",\n                          isExpanded && \"rotate-90\"\n                        )}\n                      />\n                    </button>\n\n                    {/* Expanded Variant Details */}\n                    {isExpanded && (\n                      <div className=\"px-3 pb-3 border-t border-[rgba(34,94,65,0.1)] bg-[rgba(240,245,242,0.2)]\">\n                        {variant.variantAttributes && Object.keys(variant.variantAttributes).length > 0 ? (\n                          <div className=\"pt-2 space-y-1\">\n                            <p className=\"text-xs font-bold text-[rgba(26,42,34,0.7)] mb-2\"><Trans>Variant Properties:</Trans></p>\n                            {Object.entries(variant.variantAttributes).map(([key, value], attrIndex) => (\n                              <div key={`${variantId || variantIdx}-expanded-attr-${key}-${attrIndex}`} className=\"flex items-center justify-between text-xs py-1\">\n                                <span className=\"text-[rgba(26,42,34,0.5)] font-medium\">{key}:</span>\n                                <span className=\"text-[rgba(26,42,34,0.7)] font-semibold\">{value}</span>\n                              </div>\n                            ))}\n                          </div>\n                        ) : (\n                          <div className=\"pt-2\">\n                            <p className=\"text-xs text-[rgba(26,42,34,0.6)]\"><Trans>No variant properties available</Trans></p>\n                          </div>\n                        )}\n                      </div>\n                    )}\n\n                    {/* Variant Controls - Always visible */}\n                    <div className=\"flex items-center justify-between gap-3 p-3 border-t border-[rgba(34,94,65,0.1)] bg-[rgba(240,245,242,0.1)]\">\n                      <div className=\"flex items-center gap-2 border border-[rgba(34,94,65,0.2)] rounded-xl bg-white\">\n                        <button\n                          type=\"button\"\n                          className=\"p-1.5 hover:bg-[rgba(240,245,242,0.5)] transition-colors\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            const currentQty = optimisticQuantities[variantId] !== undefined\n                              ? optimisticQuantities[variantId]\n                              : variant.quantity\n                            const newQty = Math.max(1, currentQty - 1)\n                            // Optimistic update\n                            setOptimisticQuantities(prev => ({ ...prev, [variantId]: newQty }))\n                            // Actual backend update\n                            onUpdateQuantity(variantId, newQty)\n                          }}\n                          disabled={(optimisticQuantities[variantId] !== undefined ? optimisticQuantities[variantId] : variant.quantity) <= 1}\n                        >\n                          <MinusIcon className=\"h-4 w-4\" />\n                        </button>\n                        <span className=\"px-2 text-sm font-semibold text-[#172022] min-w-[2rem] text-center\">\n                          {optimisticQuantities[variantId] !== undefined ? optimisticQuantities[variantId] : variant.quantity}\n                        </span>\n                        <button\n                          type=\"button\"\n                          className=\"p-1.5 hover:bg-[rgba(240,245,242,0.5)] transition-colors\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            const currentQty = optimisticQuantities[variantId] !== undefined\n                              ? optimisticQuantities[variantId]\n                              : variant.quantity\n                            const newQty = currentQty + 1\n                            // Optimistic update\n                            setOptimisticQuantities(prev => ({ ...prev, [variantId]: newQty }))\n                            // Actual backend update\n                            onUpdateQuantity(variantId, newQty)\n                          }}\n                        >\n                          <PlusIcon className=\"h-4 w-4\" />\n                        </button>\n                      </div>\n\n                      {/* Variant Total */}\n                      <div className=\"text-right min-w-[80px]\">\n                        <div className=\"text-base font-bold text-[#172022]\">\n                          â‚¹{((variant.unitPrice || 0) * (optimisticQuantities[variantId] !== undefined ? optimisticQuantities[variantId] : variant.quantity)).toLocaleString('en-IN')}\n                        </div>\n                      </div>\n\n                      <button\n                        type=\"button\"\n                        className=\"p-2 text-red-600 hover:bg-red-50 rounded-xl transition-colors\"\n                        onClick={(e) => {\n                          e.stopPropagation()\n                          onRemove(cartItemId)\n                        }}\n                      >\n                        <TrashIcon className=\"h-4 w-4\" />\n                      </button>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"p-4 rounded-2xl border border-[rgba(34,94,65,0.16)] bg-gradient-to-br from-white to-[rgba(241,244,236,0.9)] shadow-[0_18px_38px_-28px_rgba(13,38,24,0.35)] space-y-3 user-cart-summary\">\n        <div className=\"flex items-center justify-between text-sm\">\n          <span className=\"text-[rgba(26,42,34,0.65)]\"><Trans>Subtotal</Trans></span>\n          <span className=\"font-semibold text-[#172022]\">â‚¹{totals.subtotal.toLocaleString('en-IN')}</span>\n        </div>\n        <div className=\"flex items-center justify-between text-sm\">\n          <span className=\"text-[rgba(26,42,34,0.65)]\"><Trans>Delivery</Trans></span>\n          <span className=\"font-semibold text-[#172022]\">{totals.delivery === 0 ? <Trans>Free</Trans> : `â‚¹${totals.delivery}`}</span>\n        </div>\n        <div className=\"flex items-center justify-between pt-3 border-t border-[rgba(34,94,65,0.1)]\">\n          <span className=\"text-base font-bold text-[#172022]\"><Trans>Total</Trans></span>\n          <span className=\"text-xl font-bold text-[#1b8f5b]\">â‚¹{totals.total.toLocaleString('en-IN')}</span>\n        </div>\n        {!totals.meetsMinimum && (\n          <div className=\"p-3 rounded-xl bg-orange-50 border border-orange-200\">\n            <p className=\"text-xs font-semibold text-orange-700 text-center\">\n              <Trans>Add â‚¹{totals.shortfall.toLocaleString('en-IN')} more to reach minimum order value of â‚¹{MIN_ORDER_VALUE.toLocaleString('en-IN')}</Trans>\n            </p>\n          </div>\n        )}\n        <button\n          type=\"button\"\n          className={cn(\n            'w-full py-4 px-6 rounded-2xl text-base font-bold transition-all duration-200 mt-4 user-cart-checkout-btn',\n            totals.meetsMinimum\n              ? 'bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5'\n              : 'bg-gray-200 text-gray-500 cursor-not-allowed'\n          )}\n          onClick={onCheckout}\n          disabled={!totals.meetsMinimum}\n        >\n          {totals.meetsMinimum ? <Trans>Proceed to Checkout</Trans> : <Trans>Add â‚¹{totals.shortfall.toLocaleString('en-IN')} more</Trans>}\n        </button>\n      </div>\n\n      {/* Suggested Items Section */}\n      {suggestedProducts.length > 0 && (\n        <div className=\"user-cart-suggested\">\n          <h3 className=\"text-base font-bold text-[#172022] mb-3\"><Trans>You might also like</Trans></h3>\n          <div className=\"user-cart-suggested__rail\">\n            {suggestedProducts.map((product, index) => {\n              // Check if product has variants\n              const hasVariants = product.variants && Array.isArray(product.variants) && product.variants.length > 0\n\n              return (\n                <div key={product._id || product.id || `suggested-${index}`} className=\"user-cart-suggested__card\">\n                  <div className=\"user-cart-suggested__image-wrapper\">\n                    <img src={getPrimaryImageUrl(product)} alt={product.name} className=\"user-cart-suggested__image\" />\n                  </div>\n                  <div className=\"user-cart-suggested__content\">\n                    <h4 className=\"user-cart-suggested__title\"><TransText>{product.name}</TransText></h4>\n                    {/* Variant indicator */}\n                    {hasVariants && (\n                      <p className=\"text-[0.65rem] text-[rgba(27,143,91,0.75)] font-medium mb-1\">\n                        <Trans>Variants available</Trans>\n                      </p>\n                    )}\n                    <div className=\"user-cart-suggested__price\">â‚¹{(product.priceToUser || product.price || 0).toLocaleString('en-IN')}</div>\n                    <button\n                      type=\"button\"\n                      className=\"user-cart-suggested__add-btn\"\n                      onClick={() => onNavigateToProduct?.(product._id || product.id)}\n                    >\n                      <Trans>View Details</Trans>\n                    </button>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </div>\n      )}\n\n      <div className=\"sticky bottom-0 left-0 right-0 p-4 bg-white border-t border-[rgba(34,94,65,0.1)] -mx-5\">\n        <button\n          type=\"button\"\n          className={cn(\n            'w-full py-4 px-6 rounded-2xl text-base font-bold transition-all duration-200',\n            totals.meetsMinimum\n              ? 'bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5'\n              : 'bg-gray-200 text-gray-500 cursor-not-allowed'\n          )}\n          onClick={onCheckout}\n          disabled={!totals.meetsMinimum}\n        >\n          {totals.meetsMinimum ? <Trans>Proceed to Checkout</Trans> : <Trans>Add â‚¹{totals.shortfall.toLocaleString('en-IN')} more</Trans>}\n        </button>\n      </div>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\CategoryProductsView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\CheckoutView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'setPaymentMethod' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":37,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"setPaymentMethod"},"fix":{"range":[1719,1737],"text":""},"desc":"Remove unused variable 'setPaymentMethod'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'paymentAmount' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":300,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":300,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"paymentAmount"},"fix":{"range":[12013,12087],"text":""},"desc":"Remove unused variable 'paymentAmount'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect } from 'react'\nimport { useUserState, useUserDispatch } from '../../context/UserContext'\nimport { useUserApi } from '../../hooks/useUserApi'\nimport { ADVANCE_PAYMENT_PERCENTAGE, REMAINING_PAYMENT_PERCENTAGE } from '../../services/userData'\nimport { MapPinIcon, CreditCardIcon, TruckIcon, ChevronRightIcon, ChevronDownIcon, CheckIcon, PackageIcon, XIcon } from '../../components/icons'\nimport { cn } from '../../../../lib/cn'\nimport { useToast } from '../../components/ToastNotification'\nimport * as userApi from '../../services/userApi'\nimport { getPrimaryImageUrl } from '../../utils/productImages'\nimport { openRazorpayCheckout } from '../../../../utils/razorpay'\n\nconst STEPS = [\n  { id: 1, label: 'Summary', icon: PackageIcon },\n  { id: 2, label: 'Address & Shipping', icon: MapPinIcon },\n  { id: 3, label: 'Payment', icon: CreditCardIcon },\n]\n\nexport function CheckoutView({ onBack, onOrderPlaced }) {\n  const { cart, profile, assignedVendor, vendorAvailability } = useUserState()\n  const dispatch = useUserDispatch()\n  const { createOrder, createPaymentIntent, confirmPayment, loading } = useUserApi()\n  const { success, error: showError } = useToast()\n  \n  // Debug: Log state values\n  useEffect(() => {\n    console.log('ðŸ” CheckoutView - State Values:', {\n      cartLength: cart?.length || 0,\n      profile: profile,\n      assignedVendor: assignedVendor,\n      vendorAvailability: vendorAvailability,\n    })\n  }, [cart, profile, assignedVendor, vendorAvailability])\n  \n  const [currentStep, setCurrentStep] = useState(1)\n  const [summaryExpanded, setSummaryExpanded] = useState(true)\n  const [shippingMethod, setShippingMethod] = useState('standard')\n  const [paymentMethod, setPaymentMethod] = useState('razorpay')\n  const [promoCode, setPromoCode] = useState('')\n  const [showChangeAddressPanel, setShowChangeAddressPanel] = useState(false)\n  const [showPaymentConfirm, setShowPaymentConfirm] = useState(false)\n  const [pendingOrder, setPendingOrder] = useState(null)\n  const [paymentPreference, setPaymentPreference] = useState('partial') // 'partial' | 'full'\n  const [cartProducts, setCartProducts] = useState({})\n\n  // Get delivery address from user profile\n  const deliveryAddress = useMemo(() => {\n    console.log('ðŸ“ CheckoutView - Profile data:', profile)\n    console.log('ðŸ“ CheckoutView - Profile location:', profile?.location)\n    \n    if (!profile.location || !profile.location.city || !profile.location.state || !profile.location.pincode) {\n      console.log('ðŸ“ CheckoutView - Delivery address is NULL (missing required fields)')\n      return null\n    }\n    const address = {\n      name: profile.name || 'Home',\n      address: profile.location.address || '',\n      city: profile.location.city,\n      state: profile.location.state,\n      pincode: profile.location.pincode,\n      phone: profile.phone || '',\n    }\n    console.log('ðŸ“ CheckoutView - Delivery address created:', address)\n    return address\n  }, [profile])\n\n  // Fetch product details for cart items\n  useEffect(() => {\n    const loadCartProducts = async () => {\n      const productMap = {}\n      for (const item of cart) {\n        try {\n          const result = await userApi.getProductDetails(item.productId)\n          if (result.success && result.data?.product) {\n            productMap[item.productId] = result.data.product\n          }\n        } catch (error) {\n          console.error(`Error loading product ${item.productId}:`, error)\n        }\n      }\n      setCartProducts(productMap)\n    }\n    \n    if (cart.length > 0) {\n      loadCartProducts()\n    }\n  }, [cart])\n\n\n  const cartItems = useMemo(() => {\n    return cart.map((item) => {\n      const product = cartProducts[item.productId]\n      // Use variant-specific price (unitPrice) if available, otherwise fallback\n      const price = item.unitPrice || item.price || (product ? (product.priceToUser || product.price || 0) : 0)\n      return {\n        ...item,\n        product,\n        price: typeof price === 'number' && !isNaN(price) ? price : 0,\n        unitPrice: price, // Ensure unitPrice is set for variant pricing\n        // Ensure image is available using utility function\n        image: item.image || (product ? getPrimaryImageUrl(product) : 'https://via.placeholder.com/300'),\n        // Ensure name is available\n        name: item.name || product?.name || 'Unknown Product',\n      }\n    })\n  }, [cart, cartProducts])\n\n  // Group items by productId, and if variants exist, group variants together\n  const groupedCartItems = useMemo(() => {\n    const grouped = {}\n    \n    cartItems.forEach((item) => {\n      const product = cartProducts[item.productId]\n      \n      // Use variant-specific price (unitPrice) if available, otherwise fallback\n      const unitPrice = item.unitPrice || item.price || (product ? (product.priceToUser || product.price || 0) : 0)\n      \n      // Check if item has variant attributes\n      const variantAttrs = item.variantAttributes || {}\n      const hasVariants = variantAttrs && typeof variantAttrs === 'object' && Object.keys(variantAttrs).length > 0\n      const key = item.productId\n      \n      if (!grouped[key]) {\n        grouped[key] = {\n          productId: item.productId,\n          product,\n          name: item.name || product?.name || 'Product',\n          image: product ? getPrimaryImageUrl(product) : (item.image || 'https://via.placeholder.com/400'),\n          variants: [], // Array of variant items\n          hasVariants: false,\n        }\n      }\n      \n      // Add this item as a variant - ensure we have proper ID and variant attributes\n      const variantItem = {\n        ...item,\n        id: item.id || item._id || item.cartItemId, // Ensure ID is available\n        cartItemId: item.id || item._id || item.cartItemId, // For API calls\n        product,\n        unitPrice, // Variant-specific price from backend\n        variantAttributes: variantAttrs, // Ensure variant attributes are included\n        hasVariants,\n      }\n      \n      grouped[key].variants.push(variantItem)\n      \n      // Mark as having variants if any variant exists\n      if (hasVariants) {\n        grouped[key].hasVariants = true\n      }\n    })\n    \n    return Object.values(grouped)\n  }, [cartItems, cartProducts])\n\n  const isFullPayment = paymentPreference === 'full'\n\n  const paymentOptions = [\n    {\n      id: 'partial',\n      title: 'Pay 30% now, 70% later',\n      description: 'Keep the standard split. Remaining amount is collected after delivery.',\n      badge: 'Standard',\n      helper: 'Best when you prefer COD for the remaining balance.',\n    },\n    {\n      id: 'full',\n      title: 'Pay 100% now',\n      description: 'Settle the entire order upfront and skip delivery charges automatically.',\n      badge: 'Free Delivery',\n      helper: 'Unlocks complimentary delivery and faster dispatch handling.',\n    },\n  ]\n\n  const shippingOptions = [\n    { id: 'standard', label: 'Standard Delivery', cost: 50, time: '24 hours' },\n  ]\n\n  const selectedShipping = shippingOptions.find((s) => s.id === shippingMethod) || shippingOptions[0]\n\n  const totals = useMemo(() => {\n    // Calculate subtotal with proper price handling - use variant-specific price (unitPrice)\n    // Use groupedCartItems to calculate from variants\n    const subtotal = groupedCartItems.reduce((sum, group) => {\n      return sum + group.variants.reduce((variantSum, variant) => {\n        const itemPrice = typeof variant.unitPrice === 'number' && !isNaN(variant.unitPrice) ? variant.unitPrice : 0\n        const itemQuantity = typeof variant.quantity === 'number' && !isNaN(variant.quantity) ? variant.quantity : 0\n        return variantSum + (itemPrice * itemQuantity)\n      }, 0)\n    }, 0)\n    \n    const deliveryBeforeBenefit = subtotal >= (selectedShipping.minOrder || Infinity) ? 0 : selectedShipping.cost\n    const delivery = paymentPreference === 'full' ? 0 : deliveryBeforeBenefit\n    const discount = 0 // Promo code discount would be calculated here\n    const total = subtotal + delivery - discount\n    const advance =\n      paymentPreference === 'full'\n        ? total\n        : Math.round((total * ADVANCE_PAYMENT_PERCENTAGE) / 100)\n    const remaining = total - advance\n\n    return {\n      subtotal: isNaN(subtotal) ? 0 : subtotal,\n      delivery: isNaN(delivery) ? 0 : delivery,\n      deliveryBeforeBenefit: isNaN(deliveryBeforeBenefit) ? 0 : deliveryBeforeBenefit,\n      discount: isNaN(discount) ? 0 : discount,\n      total: isNaN(total) ? 0 : total,\n      advance: isNaN(advance) ? 0 : advance,\n      remaining: isNaN(remaining) ? 0 : remaining,\n    }\n  }, [groupedCartItems, selectedShipping, paymentPreference])\n\n  const amountDueNow = totals.advance\n  const amountDueLater = totals.remaining\n  const paymentDueNowLabel = isFullPayment ? 'Full Payment (100%)' : `Advance (${ADVANCE_PAYMENT_PERCENTAGE}%)`\n  const paymentDueLaterLabel = isFullPayment\n    ? 'After Delivery'\n    : `Remaining (${REMAINING_PAYMENT_PERCENTAGE}%)`\n\n  // Use actual order total if order exists, otherwise use calculated totals (for preview)\n  const modalOrderTotal = pendingOrder?.total ?? (pendingOrder?.preview ? totals.total : totals.total)\n  const pendingPaymentPreference = pendingOrder?.uiPayment?.paymentPreference || paymentPreference\n  const modalAmountDueNow = pendingOrder?.uiPayment?.amountDueNow ?? amountDueNow\n  const modalAmountDueLater = pendingOrder?.uiPayment?.amountDueLater ?? amountDueLater\n  const modalDueNowLabel =\n    pendingPaymentPreference === 'full' ? 'Full Payment (100%)' : `Advance (${ADVANCE_PAYMENT_PERCENTAGE}%)`\n  const modalDueLaterLabel =\n    pendingPaymentPreference === 'full' ? 'After Delivery' : `Remaining (${REMAINING_PAYMENT_PERCENTAGE}%)`\n  const modalDeliveryWaived =\n    pendingOrder?.uiPayment?.deliveryWaived ?? (isFullPayment && totals.deliveryBeforeBenefit > 0)\n\n  // Note: Vendor assignment is now handled by the backend during order creation\n  // No need to call assignVendor separately - it's done automatically when creating the order\n\n  const handleNext = () => {\n    if (currentStep < 3) {\n      setCurrentStep(currentStep + 1)\n    }\n  }\n\n  const handleBack = () => {\n    if (currentStep > 1) {\n      setCurrentStep(currentStep - 1)\n    } else {\n      onBack()\n    }\n  }\n\n  const handlePlaceOrder = () => {\n    // Block order placement if no vendor available (beyond 20.3km)\n    // Allow if in buffer zone (20km to 20.3km)\n    if (!vendorAvailability?.canPlaceOrder && !vendorAvailability?.isInBufferZone) {\n      showError('No vendor available in your region. You cannot place orders at this location.')\n      return\n    }\n    if (!deliveryAddress) {\n      showError('Please update your delivery address in settings before placing an order')\n      return\n    }\n\n    // Show payment confirmation modal WITHOUT creating order\n    // Order will only be created when user confirms payment\n    const uiPayment = {\n      paymentPreference,\n      amountDueNow,\n      amountDueLater,\n      deliveryWaived: isFullPayment && totals.deliveryBeforeBenefit > 0,\n    }\n    \n    // Store preview data (not actual order) - order will be created on confirmation\n    setPendingOrder({\n      preview: true, // Flag to indicate this is preview, not actual order\n      uiPayment,\n      total: totals.total,\n    })\n    setShowPaymentConfirm(true)\n  }\n\n  const handleConfirmPayment = async () => {\n    if (!pendingOrder) {\n      showError('Order information is missing')\n      return\n    }\n\n    // Block order placement if no vendor available (beyond 20.3km)\n    // Allow if in buffer zone (20km to 20.3km)\n    if (!vendorAvailability?.canPlaceOrder && !vendorAvailability?.isInBufferZone) {\n      showError('No vendor available in your region. You cannot place orders at this location.')\n      setShowPaymentConfirm(false)\n      setPendingOrder(null)\n      return\n    }\n    if (!deliveryAddress) {\n      showError('Please update your delivery address in settings before placing an order')\n      setShowPaymentConfirm(false)\n      setPendingOrder(null)\n      return\n    }\n\n    try {\n      const paymentAmount = pendingOrder.uiPayment?.amountDueNow ?? amountDueNow\n      const paymentPlan = pendingOrder.uiPayment?.paymentPreference ?? paymentPreference\n\n      // Create order via API FIRST (only when user confirms payment)\n      // Note: Backend reads from cart, so we only need to send payment preference and notes\n      const orderData = {\n        paymentPreference, // 'partial' or 'full'\n        notes: `Shipping method: ${selectedShipping.label}`,\n        // Backend will calculate amounts from cart items\n      }\n      \n      console.log('ðŸ“¦ Order Data being sent:', orderData)\n\n      const orderResult = await createOrder(orderData)\n      if (orderResult.error) {\n        showError(orderResult.error.message || 'Failed to create order')\n        setShowPaymentConfirm(false)\n        setPendingOrder(null)\n        return\n      }\n\n      const order = orderResult.data.order\n      \n      // Update pendingOrder with actual order data\n      const updatedPendingOrder = {\n        ...order,\n        uiPayment: pendingOrder.uiPayment,\n      }\n      setPendingOrder(updatedPendingOrder)\n\n      // Create payment intent (backend calculates amount from order)\n      const paymentIntentResult = await createPaymentIntent({\n        orderId: order.id,\n        paymentMethod: paymentMethod,\n      })\n\n      if (paymentIntentResult.error) {\n        showError(paymentIntentResult.error.message || 'Failed to initialize payment')\n        return\n      }\n\n      const { paymentIntent } = paymentIntentResult.data\n      const { razorpayOrderId, keyId, amount } = paymentIntent\n\n      console.log('ðŸ’³ Payment Intent Data:', {\n        razorpayOrderId,\n        keyId: keyId ? 'Present' : 'Missing',\n        amount,\n        orderId: pendingOrder.id,\n        orderNumber: pendingOrder.orderNumber,\n      })\n\n      // Validate payment intent data\n      if (!razorpayOrderId) {\n        showError('Invalid payment order. Please try again.')\n        return\n      }\n      if (!keyId) {\n        showError('Payment gateway configuration error. Please contact support.')\n        return\n      }\n      if (!amount || amount <= 0) {\n        showError('Invalid payment amount. Please try again.')\n        return\n      }\n\n      // Open Razorpay Checkout\n      try {\n        const razorpayResponse = await openRazorpayCheckout({\n          key: keyId,\n          amount: amount, // Amount in rupees (will be converted to paise in openRazorpayCheckout)\n          currency: 'INR',\n          order_id: razorpayOrderId,\n          name: 'IRA SATHI',\n          description: `Payment for Order ${pendingOrder.orderNumber || pendingOrder.id}`,\n          prefill: {\n            name: profile.name || '',\n            email: profile.email || '',\n            contact: profile.phone || '',\n          },\n        })\n\n        // Confirm payment with Razorpay response\n        const confirmResult = await confirmPayment({\n          orderId: order.id,\n          paymentIntentId: paymentIntent.id,\n          gatewayPaymentId: razorpayResponse.paymentId,\n          gatewayOrderId: razorpayResponse.orderId,\n          gatewaySignature: razorpayResponse.signature,\n          paymentMethod: paymentMethod,\n        })\n\n        if (confirmResult.error) {\n          showError(confirmResult.error.message || 'Payment failed')\n          setShowPaymentConfirm(false)\n          setPendingOrder(null)\n          return\n        }\n\n        // Clear cart after successful payment (backend also clears cart, but this keeps frontend state in sync)\n        dispatch({ type: 'CLEAR_CART' })\n\n        success(\n          paymentPlan === 'full'\n            ? 'Order fully paid and confirmed!'\n            : 'Order placed successfully! Advance payment confirmed.'\n        )\n        onOrderPlaced?.(updatedPendingOrder)\n        setShowPaymentConfirm(false)\n        setPendingOrder(null)\n      } catch (razorpayError) {\n        // Handle Razorpay errors\n        if (razorpayError.error) {\n          showError(razorpayError.error || 'Payment was cancelled or failed')\n        } else {\n          showError(razorpayError.message || 'Payment processing failed. Please try again.')\n        }\n        setShowPaymentConfirm(false)\n        setPendingOrder(null)\n        return\n      }\n    } catch (err) {\n      console.error('Payment processing error:', err)\n      showError(err.message || 'Payment processing failed. Please try again.')\n      setShowPaymentConfirm(false)\n      setPendingOrder(null)\n    }\n  }\n\n  // Collapsible Summary Component\n  const OrderSummary = ({ compact = false }) => (\n    <div className={cn(\n      \"user-checkout-summary\",\n      compact && \"user-checkout-summary--compact\"\n    )}>\n      <button\n        type=\"button\"\n        onClick={() => setSummaryExpanded(!summaryExpanded)}\n        className=\"user-checkout-summary__header\"\n      >\n        <div className=\"flex items-center gap-2\">\n          <PackageIcon className=\"h-4 w-4 text-[#1b8f5b]\" />\n          <span className=\"text-sm font-semibold text-[#172022]\">\n            {compact ? `â‚¹${totals.total.toLocaleString('en-IN')}` : 'Order Summary'}\n          </span>\n          {compact && (\n            <span className=\"text-xs text-[rgba(26,42,34,0.6)]\">\n              ({cartItems.length} {cartItems.length === 1 ? 'item' : 'items'})\n            </span>\n          )}\n        </div>\n        <ChevronDownIcon className={cn(\n          \"h-4 w-4 text-[rgba(26,42,34,0.6)] transition-transform\",\n          summaryExpanded && \"rotate-180\"\n        )} />\n      </button>\n\n      {summaryExpanded && (\n        <div className=\"user-checkout-summary__content\">\n          <div className=\"space-y-3 mb-3\">\n            {groupedCartItems.map((group, index) => (\n              <div key={group.productId || `checkout-group-${index}`} className=\"space-y-2\">\n                {/* Product Header */}\n                <div className=\"flex items-center gap-2 pb-2 border-b border-[rgba(34,94,65,0.1)]\">\n                  <img src={group.image} alt={group.name} className=\"w-12 h-12 rounded-lg object-cover flex-shrink-0\" />\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-xs font-semibold text-[#172022] line-clamp-1\">{group.name}</p>\n                    <p className=\"text-[0.65rem] text-[rgba(26,42,34,0.6)]\">{group.variants.length} variant{group.variants.length > 1 ? 's' : ''}</p>\n                  </div>\n                </div>\n                \n                {/* Variants */}\n                {group.variants.map((variant, variantIndex) => (\n                  <div key={variant.id || variant._id || variant.cartItemId || `variant-${variantIndex}`} className=\"flex items-start justify-between gap-2 pl-4\">\n                    <div className=\"flex-1 min-w-0\">\n                      {/* Variant Attributes */}\n                      {variant.variantAttributes && Object.keys(variant.variantAttributes).length > 0 ? (\n                        <div className=\"mb-1 space-y-0.5\">\n                          {Object.entries(variant.variantAttributes).map(([key, value], attrIndex) => (\n                            <p key={`${variant.id || variant._id || variantIndex}-attr-${key}-${attrIndex}`} className=\"text-[0.65rem] text-[rgba(26,42,34,0.6)]\">\n                              <span className=\"font-medium\">{key}:</span> {value}\n                            </p>\n                          ))}\n                        </div>\n                      ) : (\n                        <p className=\"text-[0.65rem] text-[rgba(26,42,34,0.6)] mb-1\">Standard variant</p>\n                      )}\n                      <p className=\"text-xs text-[rgba(26,42,34,0.6)]\">\n                        Qty: {variant.quantity} Ã— â‚¹{(variant.unitPrice || variant.price || 0).toLocaleString('en-IN')}\n                      </p>\n                    </div>\n                    <p className=\"text-xs font-bold text-[#1b8f5b] flex-shrink-0\">\n                      â‚¹{((variant.unitPrice || variant.price || 0) * variant.quantity).toLocaleString('en-IN')}\n                    </p>\n                  </div>\n                ))}\n              </div>\n            ))}\n          </div>\n          <div className=\"space-y-1.5 pt-2 border-t border-[rgba(34,94,65,0.1)]\">\n            <div className=\"flex items-center justify-between text-xs\">\n              <span className=\"text-[rgba(26,42,34,0.65)]\">Subtotal</span>\n              <span className=\"font-semibold text-[#172022]\">â‚¹{totals.subtotal.toLocaleString('en-IN')}</span>\n            </div>\n            <div className=\"flex items-center justify-between text-xs\">\n              <span className=\"text-[rgba(26,42,34,0.65)]\">Delivery</span>\n              <div className=\"text-right\">\n                <span className=\"font-semibold text-[#172022]\">\n                  {totals.delivery === 0 ? 'Free' : `â‚¹${totals.delivery}`}\n                </span>\n                {totals.delivery === 0 && totals.deliveryBeforeBenefit > 0 && isFullPayment && (\n                  <p className=\"text-[10px] text-[#1b8f5b] font-semibold leading-tight\">\n                    Waived with 100% payment\n                  </p>\n                )}\n              </div>\n            </div>\n            {totals.discount > 0 && (\n              <div className=\"flex items-center justify-between text-xs\">\n                <span className=\"text-[rgba(26,42,34,0.65)]\">Discount</span>\n                <span className=\"font-semibold text-green-600\">-â‚¹{totals.discount.toLocaleString('en-IN')}</span>\n              </div>\n            )}\n            <div className=\"flex items-center justify-between pt-1.5 border-t border-[rgba(34,94,65,0.1)]\">\n              <span className=\"text-sm font-bold text-[#172022]\">Total</span>\n              <span className=\"text-base font-bold text-[#1b8f5b]\">â‚¹{totals.total.toLocaleString('en-IN')}</span>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n\n  return (\n    <div className=\"user-checkout-view user-checkout-view-container\">\n      {/* Back Button */}\n      <button\n        type=\"button\"\n        className=\"flex items-center gap-2 text-sm font-semibold text-[#1b8f5b] mb-3\"\n        onClick={handleBack}\n      >\n        <ChevronRightIcon className=\"h-5 w-5 rotate-180\" />\n        {currentStep === 1 ? 'Back to Cart' : 'Back'}\n      </button>\n\n      {/* Progress Indicator */}\n      <div className=\"user-checkout-progress mb-6\">\n        <div className=\"user-checkout-progress__steps\">\n          {STEPS.map((step, index) => {\n            const StepIcon = step.icon\n            const isActive = currentStep === step.id\n            const isCompleted = currentStep > step.id\n            const isLast = index === STEPS.length - 1\n            // Connector should be completed if we've passed this step (currentStep > step.id)\n            const connectorCompleted = currentStep > step.id\n\n            return (\n              <div \n                key={step.id} \n                className={cn(\n                  \"user-checkout-progress__step-wrapper\",\n                  !isLast && connectorCompleted && \"user-checkout-progress__step-wrapper--connector-completed\"\n                )}\n              >\n                <div className=\"user-checkout-progress__step\">\n                  <div className={cn(\n                    \"user-checkout-progress__step-circle\",\n                    isActive && \"user-checkout-progress__step-circle--active\",\n                    isCompleted && \"user-checkout-progress__step-circle--completed\"\n                  )}>\n                    {isCompleted ? (\n                      <CheckIcon className=\"h-4 w-4 text-white\" />\n                    ) : (\n                      <StepIcon className=\"h-4 w-4\" />\n                    )}\n                  </div>\n                  <span className={cn(\n                    \"user-checkout-progress__step-label\",\n                    isActive && \"user-checkout-progress__step-label--active\"\n                  )}>\n                    {step.label}\n                  </span>\n                </div>\n              </div>\n            )\n          })}\n        </div>\n      </div>\n\n      {/* Sticky Summary (Compact) */}\n      {currentStep > 1 && (\n        <div className=\"sticky top-0 z-10 bg-white border-b border-[rgba(34,94,65,0.1)] -mx-5 px-5 pb-3 mb-4\">\n          <OrderSummary compact />\n        </div>\n      )}\n\n      {/* Step 1: Summary */}\n      {currentStep === 1 && (\n        <div className=\"space-y-4\">\n          <h2 className=\"text-xl font-bold text-[#172022] mb-2\">Order Summary</h2>\n\n          {/* Expandable Summary */}\n          <OrderSummary />\n\n          {/* Promo Code */}\n          <div className=\"p-4 rounded-xl border border-[rgba(34,94,65,0.12)] bg-[rgba(240,245,242,0.3)]\">\n            <label className=\"block text-sm font-semibold text-[#172022] mb-2\">Promo Code</label>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"text\"\n                value={promoCode}\n                onChange={(e) => setPromoCode(e.target.value)}\n                placeholder=\"Enter promo code\"\n                className=\"flex-1 px-3 py-2 rounded-lg border border-[rgba(34,94,65,0.15)] bg-white text-sm focus:outline-none focus:border-[#1b8f5b]\"\n              />\n              <button\n                type=\"button\"\n                className=\"px-4 py-2 rounded-lg bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors\"\n              >\n                Apply\n              </button>\n            </div>\n          </div>\n\n          {/* Payment Preference */}\n          <div className=\"p-4 rounded-xl border border-[rgba(34,94,65,0.12)] bg-white\">\n            <h3 className=\"text-sm font-semibold text-[#172022] mb-3\">Payment Preference</h3>\n            <div className=\"grid gap-3\">\n              {paymentOptions.map((option) => (\n                <button\n                  type=\"button\"\n                  key={option.id}\n                  onClick={() => setPaymentPreference(option.id)}\n                  className={cn(\n                    'text-left p-4 rounded-xl border-2 transition-all',\n                    paymentPreference === option.id\n                      ? 'border-[#1b8f5b] bg-[rgba(240,245,242,0.6)] shadow-sm'\n                      : 'border-[rgba(34,94,65,0.15)] bg-white hover:border-[rgba(34,94,65,0.25)]',\n                  )}\n                >\n                  <div className=\"flex items-center justify-between gap-2 mb-1\">\n                    <span className=\"text-sm font-semibold text-[#172022]\">{option.title}</span>\n                    {option.badge && (\n                      <span\n                        className={cn(\n                          'text-[10px] font-bold uppercase tracking-wide px-2 py-0.5 rounded-full',\n                          option.id === 'full'\n                            ? 'bg-[#1b8f5b] text-white'\n                            : 'bg-[rgba(34,94,65,0.08)] text-[#1b8f5b]',\n                        )}\n                      >\n                        {option.badge}\n                      </span>\n                    )}\n                  </div>\n                  <p className=\"text-xs text-[rgba(26,42,34,0.7)]\">{option.description}</p>\n                  {option.helper && (\n                    <p className=\"text-xs font-semibold text-[#1b8f5b] mt-2\">{option.helper}</p>\n                  )}\n                </button>\n              ))}\n            </div>\n            {isFullPayment && (\n              <p className=\"text-xs text-[#1b8f5b] font-semibold mt-3 flex items-center gap-2\">\n                <CheckIcon className=\"h-3.5 w-3.5\" />\n                Delivery fee automatically waived for this order.\n              </p>\n            )}\n          </div>\n\n          {/* Payment Breakdown */}\n          <div className=\"p-4 rounded-xl border border-[rgba(34,94,65,0.12)] bg-white user-checkout-payment-breakdown\">\n            <h3 className=\"text-sm font-semibold text-[#172022] mb-3\">Payment Breakdown</h3>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <div className=\"p-3 rounded-lg bg-[rgba(240,245,242,0.5)] border border-[rgba(34,94,65,0.15)]\">\n                <p className=\"text-xs font-semibold text-[rgba(26,42,34,0.65)] uppercase tracking-wide mb-1\">\n                  {paymentDueNowLabel}\n                </p>\n                <p className=\"text-lg font-bold text-[#1b8f5b]\">â‚¹{amountDueNow.toLocaleString('en-IN')}</p>\n                <p className=\"text-xs text-[rgba(26,42,34,0.6)] mt-1\">Pay now</p>\n              </div>\n              <div className=\"p-3 rounded-lg bg-[rgba(240,245,242,0.5)] border border-[rgba(34,94,65,0.15)]\">\n                <p className=\"text-xs font-semibold text-[rgba(26,42,34,0.65)] uppercase tracking-wide mb-1\">\n                  {paymentDueLaterLabel}\n                </p>\n                <p className=\"text-lg font-bold text-[#1b8f5b]\">â‚¹{amountDueLater.toLocaleString('en-IN')}</p>\n                <p className=\"text-xs text-[rgba(26,42,34,0.6)] mt-1\">\n                  {isFullPayment ? 'No pending payment after delivery' : 'Pay after delivery'}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Step 2: Address & Shipping */}\n      {currentStep === 2 && (\n        <div className=\"space-y-4\">\n          <h2 className=\"text-xl font-bold text-[#172022] mb-2\">Delivery Address</h2>\n\n          {/* Delivery Address Display */}\n          {deliveryAddress ? (\n            <div className=\"p-5 rounded-2xl border-2 border-[#1b8f5b] bg-gradient-to-br from-[rgba(240,253,249,0.95)] to-[rgba(255,255,255,0.98)] shadow-[0_4px_12px_-4px_rgba(27,143,91,0.25)]\">\n              <div className=\"flex items-start gap-3 mb-4\">\n                <div className=\"flex-shrink-0 w-10 h-10 rounded-xl bg-[#1b8f5b] flex items-center justify-center\">\n                  <MapPinIcon className=\"h-5 w-5 text-white\" />\n                </div>\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <span className=\"text-base font-bold text-[#172022]\">{deliveryAddress.name}</span>\n                    <span className=\"px-2.5 py-1 rounded-full text-xs font-bold bg-[#1b8f5b] text-white uppercase tracking-wide\">\n                      Delivery Address\n                    </span>\n                  </div>\n                  {deliveryAddress.address && (\n                    <p className=\"text-sm text-[rgba(26,42,34,0.75)] mb-2 leading-relaxed font-medium\">{deliveryAddress.address}</p>\n                  )}\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <p className=\"text-sm text-[rgba(26,42,34,0.75)] font-medium\">\n                    {deliveryAddress.city}, {deliveryAddress.state} - {deliveryAddress.pincode}\n                  </p>\n                  </div>\n                  {deliveryAddress.phone && (\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"text-xs text-[rgba(26,42,34,0.6)] font-medium\">Phone:</span>\n                      <p className=\"text-sm text-[rgba(26,42,34,0.75)] font-semibold\">{deliveryAddress.phone}</p>\n                    </div>\n                  )}\n                </div>\n              </div>\n              <button\n                type=\"button\"\n                onClick={() => setShowChangeAddressPanel(true)}\n                className=\"w-full mt-4 py-2.5 px-4 rounded-xl bg-white border border-[rgba(34,94,65,0.2)] text-sm font-semibold text-[#1b8f5b] hover:bg-[rgba(240,245,242,0.6)] transition-all hover:shadow-sm\"\n              >\n                Want to change Delivery Address?\n              </button>\n            </div>\n          ) : (\n            <div className=\"text-center py-8 p-5 rounded-2xl border-2 border-red-200 bg-gradient-to-br from-red-50 to-white shadow-[0_4px_12px_-4px_rgba(220,38,38,0.2)]\">\n              <MapPinIcon className=\"h-12 w-12 text-red-400 mx-auto mb-3\" />\n              <p className=\"text-sm font-semibold text-red-700 mb-4\">Delivery address is required to place an order.</p>\n              <button\n                type=\"button\"\n                onClick={() => setShowChangeAddressPanel(true)}\n                className=\"px-6 py-3 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors shadow-md hover:shadow-lg\"\n              >\n                Add Delivery Address\n              </button>\n            </div>\n          )}\n\n          {/* Shipping Methods */}\n          <div className=\"mt-6\">\n            <h3 className=\"text-base font-bold text-[#172022] mb-4 flex items-center gap-2\">\n              <div className=\"w-8 h-8 rounded-lg bg-[rgba(27,143,91,0.1)] flex items-center justify-center\">\n              <TruckIcon className=\"h-5 w-5 text-[#1b8f5b]\" />\n              </div>\n              Shipping Method\n            </h3>\n            <div className=\"space-y-3\">\n              {shippingOptions.map((option) => {\n                const isAvailable = !option.minOrder || totals.subtotal >= option.minOrder\n                return (\n                  <label\n                    key={option.id}\n                    className={cn(\n                      'flex items-center gap-4 p-5 rounded-2xl border-2 cursor-pointer transition-all shadow-sm',\n                      !isAvailable && 'opacity-50 cursor-not-allowed',\n                      shippingMethod === option.id && isAvailable\n                        ? 'border-[#1b8f5b] bg-gradient-to-br from-[rgba(240,253,249,0.95)] to-[rgba(255,255,255,0.98)] shadow-[0_4px_12px_-4px_rgba(27,143,91,0.25)]'\n                        : 'border-[rgba(34,94,65,0.15)] bg-white hover:border-[rgba(34,94,65,0.3)] hover:shadow-md'\n                    )}\n                  >\n                    <input\n                      type=\"radio\"\n                      name=\"shipping\"\n                      value={option.id}\n                      checked={shippingMethod === option.id}\n                      onChange={(e) => setShippingMethod(e.target.value)}\n                      disabled={!isAvailable}\n                      className=\"w-5 h-5 accent-[#1b8f5b]\"\n                    />\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <span className=\"text-base font-bold text-[#172022]\">{option.label}</span>\n                        <div className=\"text-right\">\n                          <span className=\"text-base font-bold text-[#1b8f5b]\">\n                            {option.cost === 0 || isFullPayment ? 'Free' : `â‚¹${option.cost}`}\n                          </span>\n                          {isFullPayment && option.cost > 0 && (\n                            <p className=\"text-[10px] text-[#1b8f5b] font-bold leading-tight mt-0.5\">\n                              Savings: â‚¹{option.cost}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                      <p className=\"text-xs text-[rgba(26,42,34,0.65)] font-medium\">\n                        Estimated delivery: {option.time}\n                        {option.minOrder && !isAvailable && ` (Min order: â‚¹${option.minOrder.toLocaleString('en-IN')})`}\n                      </p>\n                    </div>\n                  </label>\n                )\n              })}\n            </div>\n          </div>\n\n          {(assignedVendor || cartItems[0]?.vendor) && (\n            <div className=\"p-4 rounded-2xl bg-gradient-to-br from-[rgba(240,245,242,0.6)] to-[rgba(255,255,255,0.9)] border border-[rgba(34,94,65,0.2)] shadow-sm user-checkout-vendor-container\">\n              <p className=\"text-xs font-bold text-[rgba(26,42,34,0.7)] uppercase tracking-wide mb-2 flex items-center gap-2\">\n                <PackageIcon className=\"h-4 w-4 text-[#1b8f5b]\" />\n                Assigned Vendor\n              </p>\n              <p className=\"text-sm font-bold text-[#172022] mb-1\">\n                {assignedVendor?.name || cartItems[0]?.vendor?.name || 'Assigning...'}\n              </p>\n              <p className=\"text-xs text-[rgba(26,42,34,0.65)] font-medium\">\n                {assignedVendor?.location || cartItems[0]?.vendor?.location || 'Based on your location (20km radius)'}\n              </p>\n              {!assignedVendor && (\n                <p className=\"text-xs text-orange-600 font-semibold mt-2\">Vendor will be assigned automatically based on your address</p>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Step 3: Payment */}\n      {currentStep === 3 && (\n        <div className=\"space-y-4\">\n          <h2 className=\"text-xl font-bold text-[#172022] mb-2\">Payment Method</h2>\n\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center gap-4 p-5 rounded-2xl border-2 border-[#1b8f5b] bg-gradient-to-br from-[rgba(240,253,249,0.95)] to-[rgba(255,255,255,0.98)] shadow-[0_4px_12px_-4px_rgba(27,143,91,0.25)]\">\n              <div className=\"flex-shrink-0 w-12 h-12 rounded-xl bg-[#1b8f5b] flex items-center justify-center\">\n                <CreditCardIcon className=\"h-6 w-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <span className=\"text-base font-bold text-[#172022]\">Razorpay</span>\n                <p className=\"text-xs text-[rgba(26,42,34,0.65)] mt-1 font-medium\">Secure payment gateway</p>\n              </div>\n              <div className=\"flex-shrink-0 w-8 h-8 rounded-full bg-[#1b8f5b] flex items-center justify-center\">\n                <CheckIcon className=\"h-5 w-5 text-white\" />\n              </div>\n            </div>\n          </div>\n\n          {/* Final Summary */}\n          <div className=\"p-5 rounded-2xl border-2 border-[rgba(34,94,65,0.15)] bg-gradient-to-br from-[rgba(240,245,242,0.6)] to-[rgba(255,255,255,0.95)] shadow-[0_4px_12px_-4px_rgba(16,44,30,0.15)] user-checkout-final-summary\">\n            <div className=\"flex items-center gap-2 mb-4\">\n              <div className=\"w-8 h-8 rounded-lg bg-[rgba(27,143,91,0.1)] flex items-center justify-center\">\n                <PackageIcon className=\"h-5 w-5 text-[#1b8f5b]\" />\n              </div>\n              <h3 className=\"text-base font-bold text-[#172022]\">Final Summary</h3>\n            </div>\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between p-3 rounded-xl bg-white border border-[rgba(34,94,65,0.1)]\">\n                <span className=\"text-sm font-medium text-[rgba(26,42,34,0.7)]\">Subtotal</span>\n                <span className=\"text-sm font-bold text-[#172022]\">â‚¹{totals.subtotal.toLocaleString('en-IN')}</span>\n              </div>\n              <div className=\"flex items-center justify-between p-3 rounded-xl bg-white border border-[rgba(34,94,65,0.1)]\">\n                <span className=\"text-sm font-medium text-[rgba(26,42,34,0.7)]\">Delivery</span>\n                <div className=\"text-right\">\n                  <span className=\"text-sm font-bold text-[#172022]\">\n                    {totals.delivery === 0 ? 'Free' : `â‚¹${totals.delivery}`}\n                  </span>\n                  {totals.delivery === 0 && totals.deliveryBeforeBenefit > 0 && isFullPayment && (\n                    <p className=\"text-[10px] text-[#1b8f5b] font-bold leading-tight mt-0.5\">\n                      Waived with 100% payment\n                    </p>\n                  )}\n                </div>\n              </div>\n              <div className=\"flex items-center justify-between p-4 rounded-xl bg-gradient-to-r from-[rgba(27,143,91,0.1)] to-[rgba(27,143,91,0.05)] border-2 border-[#1b8f5b]\">\n                <span className=\"text-base font-bold text-[#172022]\">Total</span>\n                <span className=\"text-xl font-bold text-[#1b8f5b]\">â‚¹{totals.total.toLocaleString('en-IN')}</span>\n              </div>\n              <div className=\"grid grid-cols-2 gap-3 pt-2\">\n                <div className=\"p-4 rounded-xl bg-gradient-to-br from-[rgba(240,253,249,0.8)] to-white border-2 border-[rgba(27,143,91,0.2)] shadow-sm\">\n                  <p className=\"text-[10px] font-bold text-[rgba(26,42,34,0.65)] uppercase tracking-wide mb-2\">\n                    {paymentDueNowLabel}\n                  </p>\n                  <p className=\"text-lg font-bold text-[#1b8f5b]\">â‚¹{amountDueNow.toLocaleString('en-IN')}</p>\n                  <p className=\"text-[10px] text-[rgba(26,42,34,0.6)] font-medium mt-1\">Pay now</p>\n                </div>\n                <div className=\"p-4 rounded-xl bg-gradient-to-br from-[rgba(240,245,242,0.6)] to-white border-2 border-[rgba(34,94,65,0.15)] shadow-sm\">\n                  <p className=\"text-[10px] font-bold text-[rgba(26,42,34,0.65)] uppercase tracking-wide mb-2\">\n                    {paymentDueLaterLabel}\n                  </p>\n                  <p className=\"text-lg font-bold text-[#1b8f5b]\">â‚¹{amountDueLater.toLocaleString('en-IN')}</p>\n                  <p className=\"text-[10px] text-[rgba(26,42,34,0.6)] font-medium mt-1\">\n                    {isFullPayment ? 'No pending payment' : 'Pay after delivery'}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Navigation Buttons */}\n      <div className=\"sticky bottom-0 left-0 right-0 p-4 bg-white border-t border-[rgba(34,94,65,0.1)] -mx-5 mt-6 space-y-2 user-checkout-navigation\">\n        {currentStep < 3 ? (\n          <button\n            type=\"button\"\n            className={cn(\n              'w-full py-3.5 px-6 rounded-xl text-base font-bold transition-all',\n              currentStep === 2 && !deliveryAddress\n                ? 'bg-gray-200 text-gray-500 cursor-not-allowed'\n                : 'bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white shadow-md hover:shadow-lg'\n            )}\n            onClick={handleNext}\n            disabled={currentStep === 2 && !deliveryAddress}\n          >\n            {currentStep === 1 ? 'Continue to Address & Shipping' : 'Continue to Payment'}\n          </button>\n        ) : (\n          <>\n            {(() => {\n              const hasDeliveryAddress = !!deliveryAddress\n              \n              // Only disable if vendorAvailability has been explicitly checked and found unavailable\n              // Logic: If assignedVendor exists, vendor was checked. If not, it's likely default state.\n              // Default state (all false, no assignedVendor) should allow order - backend will handle vendor assignment\n              const vendorWasChecked = assignedVendor !== null || \n                (vendorAvailability && (vendorAvailability.canPlaceOrder === true || vendorAvailability.isInBufferZone === true))\n              \n              // Only block if vendor was explicitly checked AND found unavailable (not in buffer zone)\n              const vendorCheck = vendorWasChecked && \n                vendorAvailability && \n                !vendorAvailability?.canPlaceOrder && \n                !vendorAvailability?.isInBufferZone\n              \n              const isDisabled = !hasDeliveryAddress || vendorCheck\n              \n              console.log('ðŸ”˜ CheckoutView - Button State Check:', {\n                hasDeliveryAddress,\n                deliveryAddress,\n                assignedVendor,\n                vendorAvailability,\n                vendorWasChecked,\n                vendorCheck,\n                canPlaceOrder: vendorAvailability?.canPlaceOrder,\n                isInBufferZone: vendorAvailability?.isInBufferZone,\n                vendorAvailable: vendorAvailability?.vendorAvailable,\n                isDisabled,\n                finalDisabled: isDisabled\n              })\n              \n              return (\n                <button\n                  type=\"button\"\n                  className={cn(\n                    'w-full py-3.5 px-6 rounded-xl text-base font-bold transition-all',\n                    isDisabled\n                      ? 'bg-gray-200 text-gray-500 cursor-not-allowed'\n                      : 'bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white shadow-md hover:shadow-lg'\n                  )}\n                  onClick={handlePlaceOrder}\n                  disabled={isDisabled}\n                >\n                  Pay â‚¹{amountDueNow.toLocaleString('en-IN')} & Place Order\n                </button>\n              )\n            })()}\n            <p className=\"text-xs text-center text-[rgba(26,42,34,0.65)]\">\n              {amountDueLater > 0\n                ? `You will pay the remaining â‚¹${amountDueLater.toLocaleString('en-IN')} after delivery`\n                : 'This order will be fully prepaid and delivery is complimentary.'}\n            </p>\n          </>\n        )}\n      </div>\n\n      {/* Payment Confirmation Modal */}\n      {showPaymentConfirm && pendingOrder && (\n        <div\n          className=\"user-payment-confirm-modal\"\n          onClick={(e) => {\n            if (e.target === e.currentTarget) {\n              setShowPaymentConfirm(false)\n              setPendingOrder(null)\n            }\n          }}\n        >\n          <div className=\"user-payment-confirm-modal__content\">\n            <button\n              type=\"button\"\n              onClick={() => {\n                setShowPaymentConfirm(false)\n                setPendingOrder(null)\n              }}\n              className=\"user-payment-confirm-modal__close\"\n              aria-label=\"Close\"\n            >\n              <XIcon className=\"h-5 w-5\" />\n            </button>\n\n            <div className=\"user-payment-confirm-modal__icon\">\n              <CreditCardIcon className=\"h-12 w-12 text-[#1b8f5b]\" />\n            </div>\n\n            <h3 className=\"user-payment-confirm-modal__title\">Confirm Payment</h3>\n            <p className=\"user-payment-confirm-modal__subtitle\">\n              Please confirm to proceed with your order\n            </p>\n\n            <div className=\"user-payment-confirm-modal__details\">\n              <div className=\"user-payment-confirm-modal__detail-row\">\n                <span className=\"user-payment-confirm-modal__detail-label\">Order Total</span>\n                <span className=\"user-payment-confirm-modal__detail-value\">\n                  â‚¹{modalOrderTotal.toLocaleString('en-IN')}\n                </span>\n              </div>\n              <div className=\"user-payment-confirm-modal__detail-row\">\n                <span className=\"user-payment-confirm-modal__detail-label\">{modalDueNowLabel}</span>\n                <span className=\"user-payment-confirm-modal__detail-value user-payment-confirm-modal__detail-value--highlight\">\n                  â‚¹{modalAmountDueNow.toLocaleString('en-IN')}\n                </span>\n              </div>\n              {modalAmountDueLater > 0 && (\n                <div className=\"user-payment-confirm-modal__detail-row\">\n                  <span className=\"user-payment-confirm-modal__detail-label\">\n                    {modalDueLaterLabel}\n                  </span>\n                  <span className=\"user-payment-confirm-modal__detail-value\">\n                    â‚¹{modalAmountDueLater.toLocaleString('en-IN')}\n                  </span>\n                </div>\n              )}\n            </div>\n\n            <div className=\"user-payment-confirm-modal__info\">\n              <div className=\"user-payment-confirm-modal__info-item\">\n                <CheckIcon className=\"h-5 w-5 text-[#1b8f5b]\" />\n                <span>Secure payment via Razorpay</span>\n              </div>\n              <div className=\"user-payment-confirm-modal__info-item\">\n                <CheckIcon className=\"h-5 w-5 text-[#1b8f5b]\" />\n                <span>\n                  {modalAmountDueLater > 0\n                    ? 'Remaining amount payable on delivery'\n                    : 'Delivery charges waived automatically'}\n                </span>\n              </div>\n              {modalAmountDueLater === 0 && modalDeliveryWaived && (\n                <div className=\"user-payment-confirm-modal__info-item\">\n                  <CheckIcon className=\"h-5 w-5 text-[#1b8f5b]\" />\n                  <span>Get priority processing for prepaid orders</span>\n                </div>\n              )}\n            </div>\n\n            <div className=\"user-payment-confirm-modal__actions\">\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setShowPaymentConfirm(false)\n                  setPendingOrder(null)\n                }}\n                className=\"user-payment-confirm-modal__btn user-payment-confirm-modal__btn--cancel\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleConfirmPayment}\n                disabled={loading}\n                className=\"user-payment-confirm-modal__btn user-payment-confirm-modal__btn--confirm\"\n              >\n                {loading\n                  ? 'Processing...'\n                  : `Pay â‚¹${modalAmountDueNow.toLocaleString('en-IN')} & Place Order`}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Change Address Instructions Panel */}\n      <div\n        className={cn(\n          'fixed inset-0 z-50 flex items-end justify-center bg-black bg-opacity-50 transition-opacity duration-300',\n          showChangeAddressPanel ? 'opacity-100' : 'opacity-0 pointer-events-none'\n        )}\n        onClick={(e) => {\n          if (e.target === e.currentTarget) {\n            setShowChangeAddressPanel(false)\n          }\n        }}\n      >\n        <div\n          className={cn(\n            'w-full max-w-md bg-white rounded-t-3xl shadow-2xl transform transition-transform duration-300 ease-out',\n            showChangeAddressPanel ? 'translate-y-0' : 'translate-y-full'\n          )}\n        >\n          <div className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-6\">\n              <h3 className=\"text-xl font-bold text-[#172022]\">Change Delivery Address</h3>\n              <button\n                type=\"button\"\n                onClick={() => setShowChangeAddressPanel(false)}\n                className=\"p-2 text-gray-400 hover:text-gray-600 transition-colors\"\n                aria-label=\"Close\"\n              >\n                <XIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n\n            <div className=\"space-y-4\">\n              <p className=\"text-sm text-[rgba(26,42,34,0.7)] mb-4\">\n                To change your delivery address, please follow these steps:\n              </p>\n\n              <div className=\"space-y-3\">\n                <div className=\"flex items-start gap-3 p-3 rounded-lg bg-[rgba(240,245,242,0.5)] border border-[rgba(34,94,65,0.15)]\">\n                  <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-[#1b8f5b] text-white flex items-center justify-center text-sm font-bold\">\n                    1\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm font-semibold text-[#172022]\">Go to Settings</p>\n                    <p className=\"text-xs text-[rgba(26,42,34,0.6)] mt-1\">Navigate to your account settings</p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start gap-3 p-3 rounded-lg bg-[rgba(240,245,242,0.5)] border border-[rgba(34,94,65,0.15)]\">\n                  <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-[#1b8f5b] text-white flex items-center justify-center text-sm font-bold\">\n                    2\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm font-semibold text-[#172022]\">Locate Delivery Address</p>\n                    <p className=\"text-xs text-[rgba(26,42,34,0.6)] mt-1\">Find the \"Delivery Address\" section</p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start gap-3 p-3 rounded-lg bg-[rgba(240,245,242,0.5)] border border-[rgba(34,94,65,0.15)]\">\n                  <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-[#1b8f5b] text-white flex items-center justify-center text-sm font-bold\">\n                    3\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm font-semibold text-[#172022]\">Click on Change Delivery Address</p>\n                    <p className=\"text-xs text-[rgba(26,42,34,0.6)] mt-1\">Click the button to update your address</p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start gap-3 p-3 rounded-lg bg-[rgba(240,245,242,0.5)] border border-[rgba(34,94,65,0.15)]\">\n                  <div className=\"flex-shrink-0 w-6 h-6 rounded-full bg-[#1b8f5b] text-white flex items-center justify-center text-sm font-bold\">\n                    4\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm font-semibold text-[#172022]\">Update Your Address</p>\n                    <p className=\"text-xs text-[rgba(26,42,34,0.6)] mt-1\">From there you can change your delivery address</p>\n                  </div>\n                </div>\n              </div>\n\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setShowChangeAddressPanel(false)\n                  // Navigate to settings - you may need to adjust this based on your routing\n                  if (onBack) {\n                    // This will go back, but ideally should navigate to settings\n                    // You might want to add a prop for navigation\n                  }\n                }}\n                className=\"w-full mt-6 py-3 px-4 rounded-xl bg-[#1b8f5b] text-white text-sm font-semibold hover:bg-[#2a9d61] transition-colors\"\n              >\n                Got it\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\FavouritesView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[228,267],"text":""},"desc":"Remove unused variable 'cn'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\nimport { useUserState, useUserDispatch } from '../../context/UserContext'\nimport { ProductCard } from '../../components/ProductCard'\nimport { HeartIcon } from '../../components/icons'\nimport { cn } from '../../../../lib/cn'\nimport * as userApi from '../../services/userApi'\nimport { Trans } from '../../../../components/Trans'\n\nexport function FavouritesView({ onProductClick, onAddToCart, onRemoveFromFavourites }) {\n  const { favourites } = useUserState()\n  const dispatch = useUserDispatch()\n  const [favouriteProducts, setFavouriteProducts] = useState([])\n  const [loading, setLoading] = useState(true)\n\n  // Fetch favourite products from API\n  useEffect(() => {\n    const loadFavourites = async () => {\n      setLoading(true)\n      try {\n        const productPromises = favourites.map(async (id) => {\n          try {\n            const result = await userApi.getProductDetails(id)\n            if (result.success && result.data?.product) {\n              return result.data.product\n            }\n            return null\n          } catch (error) {\n            console.error(`Error loading favourite product ${id}:`, error)\n            return null\n          }\n        })\n        const products = await Promise.all(productPromises)\n        setFavouriteProducts(products.filter(Boolean))\n      } catch (error) {\n        console.error('Error loading favourites:', error)\n      } finally {\n        setLoading(false)\n      }\n    }\n    \n    if (favourites.length > 0) {\n      loadFavourites()\n    } else {\n      setFavouriteProducts([])\n      setLoading(false)\n    }\n  }, [favourites])\n\n  const handleRemoveFromFavourites = (productId) => {\n    dispatch({ type: 'REMOVE_FROM_FAVOURITES', payload: { productId } })\n    onRemoveFromFavourites?.(productId)\n  }\n\n  return (\n    <div className=\"user-favourites-view space-y-6\">\n      <div className=\"user-favourites-view__header\">\n        <h2 className=\"user-favourites-view__title\"><Trans>My Favourites</Trans></h2>\n        <p className=\"user-favourites-view__subtitle\">\n          {favouriteProducts.length} {favouriteProducts.length === 1 ? <Trans>item saved</Trans> : <Trans>items saved</Trans>}\n        </p>\n      </div>\n\n      {loading ? (\n        <div className=\"user-favourites-view__empty\">\n          <div className=\"user-favourites-view__empty-icon\">\n            <HeartIcon className=\"h-16 w-16\" filled={false} />\n          </div>\n          <h3 className=\"user-favourites-view__empty-title\"><Trans>Loading favourites...</Trans></h3>\n        </div>\n      ) : favouriteProducts.length === 0 ? (\n        <div className=\"user-favourites-view__empty\">\n          <div className=\"user-favourites-view__empty-icon\">\n            <HeartIcon className=\"h-16 w-16\" filled={false} />\n          </div>\n          <h3 className=\"user-favourites-view__empty-title\"><Trans>No favourites yet</Trans></h3>\n          <p className=\"user-favourites-view__empty-text\">\n            <Trans>Start adding products to your favourites by tapping the heart icon on any product</Trans>\n          </p>\n        </div>\n      ) : (\n        <div className=\"user-favourites-view__grid\">\n          {favouriteProducts.map((product, index) => (\n            <ProductCard\n              key={product._id || product.id || `favourite-${index}`}\n              product={{ \n                ...product, \n                id: product._id || product.id,\n                price: product.priceToUser || product.price,\n                image: product.images?.[0]?.url || product.primaryImage || product.image,\n                isWishlisted: true,\n                rating: product.rating ?? product.averageRating,\n                reviews: product.reviews ?? product.reviewCount,\n                reviewCount: product.reviewCount ?? product.reviews,\n              }}\n              onNavigate={onProductClick}\n              onAddToCart={onAddToCart}\n              onWishlist={handleRemoveFromFavourites}\n              className=\"user-favourites-view__card\"\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\HomeView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'onSearchClick' is defined but never used.","line":24,"column":74,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":87,"suggestions":[{"messageId":"removeVar","data":{"varName":"onSearchClick"},"fix":{"range":[1182,1197],"text":""},"desc":"Remove unused variable 'onSearchClick'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'onFilterClick' is defined but never used.","line":24,"column":89,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":102,"suggestions":[{"messageId":"removeVar","data":{"varName":"onFilterClick"},"fix":{"range":[1197,1212],"text":""},"desc":"Remove unused variable 'onFilterClick'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'products' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":36,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"products"},"fix":{"range":[1713,1721],"text":""},"desc":"Remove unused variable 'products'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchCategories' and 'fetchProducts'. Either include them or remove the dependency array.","line":123,"column":6,"nodeType":"ArrayExpression","endLine":123,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCategories, fetchProducts]","fix":{"range":[5456,5458],"text":"[fetchCategories, fetchProducts]"}}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useRef, useState, useEffect } from 'react'\nimport { ProductCard } from '../../components/ProductCard'\nimport { CategoryCard } from '../../components/CategoryCard'\nimport { ChevronRightIcon, MapPinIcon, TruckIcon, SearchIcon, FilterIcon } from '../../components/icons'\nimport { cn } from '../../../../lib/cn'\nimport { useUserApi } from '../../hooks/useUserApi'\nimport * as userApi from '../../services/userApi'\nimport { Trans } from '../../../../components/Trans'\nimport { TransText } from '../../../../components/TransText'\n\n// Helper function to format category names - split \"Fertilizer\" word for better display\nconst formatCategoryName = (name) => {\n  if (!name) return name\n  // Check if name contains \"Fertilizer\" as part of a compound word (like \"BioFertilizer\")\n  // Split before \"Fertilizer\" if it's part of a compound word\n  const fertilizerMatch = name.match(/(\\w+)(Fertilizer)/i)\n  if (fertilizerMatch && fertilizerMatch[1] && fertilizerMatch[2]) {\n    // Split compound word: \"BioFertilizer\" -> \"Bio Fertilizer\"\n    return `${fertilizerMatch[1]} ${fertilizerMatch[2]}`\n  }\n  return name\n}\n\nexport function HomeView({ onProductClick, onCategoryClick, onAddToCart, onSearchClick, onFilterClick, onToggleFavourite, favourites = [] }) {\n  const [bannerIndex, setBannerIndex] = useState(0)\n  const categoriesRef = useRef(null)\n  const bannerRef = useRef(null)\n  const [selectedCategory, setSelectedCategory] = useState(null)\n  const [isUserInteracting, setIsUserInteracting] = useState(false)\n  const autoSlideTimeoutRef = useRef(null)\n  const touchStartXRef = useRef(null)\n  const touchEndXRef = useRef(null)\n  \n  // Real data from API\n  const [categories, setCategories] = useState([])\n  const [products, setProducts] = useState([])\n  const [popularProducts, setPopularProducts] = useState([])\n  const [categoryProducts, setCategoryProducts] = useState([]) // Array of 4 random products from different categories\n  const [carousels, setCarousels] = useState([])\n  const [specialOffers, setSpecialOffers] = useState([])\n  const [loading, setLoading] = useState(true)\n  const { fetchCategories, fetchProducts } = useUserApi()\n\n  // Fetch categories and products on mount\n  useEffect(() => {\n    const loadData = async () => {\n      setLoading(true)\n      try {\n        // Fetch categories\n        const categoriesResult = await fetchCategories()\n        if (categoriesResult.data?.categories) {\n          const cats = categoriesResult.data.categories\n          setCategories(cats)\n          if (cats.length > 0) {\n            setSelectedCategory(cats[0].id)\n          }\n        }\n\n        // Fetch popular products - limit to 4 for home screen\n        const popularResult = await userApi.getPopularProducts({ limit: 4 })\n        if (popularResult.success && popularResult.data?.products) {\n          setPopularProducts(popularResult.data.products)\n        }\n\n        // Fetch all products (or products by selected category)\n        const productsResult = await fetchProducts({ limit: 20 })\n        if (productsResult.data?.products) {\n          setProducts(productsResult.data.products)\n        }\n\n        // Fetch products from multiple categories and randomly select 4 products (for laptop category products section)\n        const cats = categoriesResult.data?.categories || []\n        if (cats.length > 0) {\n          // Shuffle categories to get random ones\n          const shuffledCategories = [...cats].sort(() => Math.random() - 0.5)\n          const selectedCategories = shuffledCategories.slice(0, Math.min(4, cats.length))\n          \n          // Fetch products from each selected category\n          const allCategoryProducts = []\n          await Promise.all(\n            selectedCategories.map(async (category) => {\n              try {\n                const catProductsResult = await fetchProducts({ category: category.id, limit: 10 })\n                if (catProductsResult.data?.products && catProductsResult.data.products.length > 0) {\n                  // Add category info to each product\n                  const productsWithCategory = catProductsResult.data.products.map(p => ({\n                    ...p,\n                    categoryName: category.name,\n                    categoryId: category.id\n                  }))\n                  allCategoryProducts.push(...productsWithCategory)\n                }\n              } catch (error) {\n                console.error(`Error loading products for category ${category.id}:`, error)\n              }\n            })\n          )\n          \n          // Shuffle and select 4 random products\n          const shuffledProducts = allCategoryProducts.sort(() => Math.random() - 0.5)\n          const selectedProducts = shuffledProducts.slice(0, 4)\n          \n          setCategoryProducts(selectedProducts)\n        }\n\n        // Fetch offers (carousels and special offers)\n        const offersResult = await userApi.getOffers()\n        if (offersResult.success && offersResult.data) {\n          // Filter active carousels and sort by order\n          const activeCarousels = (offersResult.data.carousels || [])\n            .filter(c => c.isActive !== false)\n            .sort((a, b) => (a.order || 0) - (b.order || 0))\n          setCarousels(activeCarousels)\n          setSpecialOffers(offersResult.data.specialOffers || [])\n        }\n      } catch (error) {\n        console.error('Error loading data:', error)\n      } finally {\n        setLoading(false)\n      }\n    }\n    loadData()\n  }, [])\n\n  // Fetch products when category changes\n  useEffect(() => {\n    if (selectedCategory) {\n      const loadProducts = async () => {\n        try {\n          const result = await fetchProducts({ category: selectedCategory, limit: 20 })\n          if (result.data?.products) {\n            setProducts(result.data.products)\n          }\n        } catch (error) {\n          console.error('Error loading products:', error)\n        }\n      }\n      loadProducts()\n    }\n  }, [selectedCategory, fetchProducts])\n\n  // Use dynamic carousels from API, fallback to empty array\n  // Carousels are already filtered and sorted by order in the fetch\n  const banners = carousels.length > 0 \n    ? carousels.map(carousel => ({\n        id: carousel.id || carousel._id,\n        title: carousel.title || '',\n        subtitle: carousel.description || '',\n        image: carousel.image || '',\n        productIds: carousel.productIds || [],\n      }))\n    : []\n\n  const goToNextSlide = () => {\n    if (banners.length === 0) return\n    setBannerIndex((prev) => (prev + 1) % banners.length)\n  }\n\n  const goToPreviousSlide = () => {\n    if (banners.length === 0) return\n    setBannerIndex((prev) => (prev - 1 + banners.length) % banners.length)\n  }\n\n  const goToSlide = (index) => {\n    if (banners.length === 0 || index < 0 || index >= banners.length) return\n    setBannerIndex(index)\n    setIsUserInteracting(true)\n    resetAutoSlide()\n  }\n\n  const resetAutoSlide = () => {\n    if (autoSlideTimeoutRef.current) {\n      clearTimeout(autoSlideTimeoutRef.current)\n    }\n    autoSlideTimeoutRef.current = setTimeout(() => {\n      setIsUserInteracting(false)\n    }, 3000)\n  }\n\n  // Auto-slide when user is not interacting\n  useEffect(() => {\n    if (isUserInteracting || banners.length === 0) return\n\n    const interval = setInterval(() => {\n      setBannerIndex((prev) => (prev + 1) % banners.length)\n    }, 3000)\n    \n    return () => clearInterval(interval)\n  }, [isUserInteracting, banners.length])\n\n  // Cleanup on unmount and reset banner index when banners change\n  useEffect(() => {\n    if (banners.length > 0 && bannerIndex >= banners.length) {\n      setBannerIndex(0)\n    }\n    return () => {\n      if (autoSlideTimeoutRef.current) {\n        clearTimeout(autoSlideTimeoutRef.current)\n      }\n    }\n  }, [banners.length, bannerIndex])\n\n  // Touch handlers for swipe\n  const handleTouchStart = (e) => {\n    touchStartXRef.current = e.touches[0].clientX\n    setIsUserInteracting(true)\n  }\n\n  const handleTouchMove = (e) => {\n    touchEndXRef.current = e.touches[0].clientX\n  }\n\n  const handleTouchEnd = () => {\n    if (!touchStartXRef.current || !touchEndXRef.current) return\n\n    const distance = touchStartXRef.current - touchEndXRef.current\n    const minSwipeDistance = 50\n\n    if (Math.abs(distance) > minSwipeDistance) {\n      if (distance > 0) {\n        // Swiped left - go to next\n        goToNextSlide()\n      } else {\n        // Swiped right - go to previous\n        goToPreviousSlide()\n      }\n    }\n\n    resetAutoSlide()\n    touchStartXRef.current = null\n    touchEndXRef.current = null\n  }\n\n  // Mouse handlers for desktop drag\n  const handleMouseDown = (e) => {\n    touchStartXRef.current = e.clientX\n    setIsUserInteracting(true)\n  }\n\n  const handleMouseMove = (e) => {\n    if (touchStartXRef.current !== null) {\n      touchEndXRef.current = e.clientX\n    }\n  }\n\n  const handleMouseUp = () => {\n    if (!touchStartXRef.current || !touchEndXRef.current) {\n      touchStartXRef.current = null\n      touchEndXRef.current = null\n      return\n    }\n\n    const distance = touchStartXRef.current - touchEndXRef.current\n    const minSwipeDistance = 50\n\n    if (Math.abs(distance) > minSwipeDistance) {\n      if (distance > 0) {\n        goToNextSlide()\n      } else {\n        goToPreviousSlide()\n      }\n    }\n\n    resetAutoSlide()\n    touchStartXRef.current = null\n    touchEndXRef.current = null\n  }\n\n  const handleCategoryClick = (categoryId) => {\n    setSelectedCategory(categoryId)\n    onCategoryClick?.(categoryId)\n  }\n\n  // Prevent scrolling past the end\n  useEffect(() => {\n    const container = categoriesRef.current\n    if (!container) return\n\n    const handleScroll = () => {\n      const maxScroll = container.scrollWidth - container.clientWidth\n      if (container.scrollLeft > maxScroll) {\n        container.scrollLeft = maxScroll\n      }\n    }\n\n    container.addEventListener('scroll', handleScroll, { passive: true })\n    return () => container.removeEventListener('scroll', handleScroll)\n  }, [])\n\n  return (\n    <div className=\"user-home-view space-y-6\">\n      {/* Hero Banner Section - Only show if carousels exist */}\n      {banners.length > 0 && (\n      <section id=\"home-hero\" className=\"home-hero-section\">\n        <div\n          ref={bannerRef}\n          className=\"home-hero-banner\"\n          onTouchStart={handleTouchStart}\n          onTouchMove={handleTouchMove}\n          onTouchEnd={handleTouchEnd}\n          onMouseDown={handleMouseDown}\n          onMouseMove={handleMouseMove}\n          onMouseUp={handleMouseUp}\n          onMouseLeave={handleMouseUp}\n        >\n          {banners.map((banner, index) => (\n            <div\n              key={banner.id || `banner-${index}`}\n              className={cn(\n                'home-hero-banner__slide',\n                index === bannerIndex ? 'home-hero-banner__slide--active' : 'home-hero-banner__slide--hidden'\n              )}\n              style={{ backgroundImage: `url(${banner.image})` }}\n                onClick={() => {\n                  // Navigate to carousel products view\n                  if (banner.productIds && banner.productIds.length > 0) {\n                    onProductClick(`carousel:${banner.id}`)\n                  }\n                }}\n            >\n              <div className=\"home-hero-banner__overlay\" />\n              <div className=\"home-hero-banner__content\">\n                <h2 className=\"home-hero-banner__title\"><TransText>{banner.title}</TransText></h2>\n                <p className=\"home-hero-banner__subtitle\"><TransText>{banner.subtitle}</TransText></p>\n              </div>\n            </div>\n          ))}\n        </div>\n        <div className=\"home-hero-banner__indicators\">\n          {banners.map((_, index) => (\n            <button\n              key={index}\n              type=\"button\"\n              className={cn(\n                'home-hero-banner__indicator',\n                index === bannerIndex && 'home-hero-banner__indicator--active'\n              )}\n              onClick={() => goToSlide(index)}\n              aria-label={`Go to banner ${index + 1}`}\n            />\n          ))}\n        </div>\n      </section>\n      )}\n\n      {/* Categories Section */}\n      <section id=\"home-categories\" className=\"home-categories-section\">\n        <div className=\"home-section-header\">\n          <div className=\"home-section-header__content\">\n            <h3 className=\"home-section-header__title\"><Trans>Categories</Trans></h3>\n          </div>\n          <button\n            type=\"button\"\n            className=\"home-section-header__cta\"\n            onClick={() => onCategoryClick('all')}\n          >\n            <Trans>See all</Trans>\n          </button>\n        </div>\n        <div ref={categoriesRef} className=\"home-categories-rail\">\n          {loading ? (\n            <div className=\"flex items-center justify-center p-8\">\n              <p className=\"text-sm text-gray-500\"><Trans>Loading categories...</Trans></p>\n            </div>\n          ) : categories.length === 0 ? (\n            <div className=\"flex items-center justify-center p-8\">\n              <p className=\"text-sm text-gray-500\"><Trans>No categories available</Trans></p>\n            </div>\n          ) : (\n            categories.map((category) => (\n              <CategoryCard\n                key={category.id}\n                category={{\n                  id: category.id,\n                  name: formatCategoryName(category.name),\n                  emoji: category.icon,\n                  count: category.count,\n                  description: category.description,\n                }}\n                onClick={handleCategoryClick}\n                isSelected={selectedCategory === category.id}\n                className=\"category-card-wrapper\"\n              />\n            ))\n          )}\n        </div>\n      </section>\n\n      {/* Popular Products Section */}\n      <section id=\"home-popular-products\" className=\"home-products-section\">\n        <div className=\"home-section-header\">\n          <div className=\"home-section-header__content\">\n            <h3 className=\"home-section-header__title\"><Trans>Popular Products</Trans></h3>\n            <p className=\"home-section-header__subtitle\"><Trans>Best sellers this week</Trans></p>\n          </div>\n          <button\n            type=\"button\"\n            className=\"home-section-header__cta\"\n            onClick={() => onProductClick('all')}\n          >\n            <Trans>View All</Trans>\n            <ChevronRightIcon className=\"home-section-header__cta-icon\" />\n          </button>\n        </div>\n        <div className=\"home-products-grid\">\n          {loading ? (\n            <div className=\"flex items-center justify-center p-8 col-span-full\">\n              <p className=\"text-sm text-gray-500\"><Trans>Loading products...</Trans></p>\n            </div>\n          ) : popularProducts.length === 0 ? (\n            <div className=\"flex items-center justify-center p-8 col-span-full\">\n              <p className=\"text-sm text-gray-500\"><Trans>No popular products available</Trans></p>\n            </div>\n          ) : (\n            popularProducts.map((product) => (\n              <ProductCard\n                key={product._id || product.id}\n                product={{\n                  id: product._id || product.id,\n                  name: product.name,\n                  price: product.priceToUser || product.price || 0,\n                  image: product.images?.[0]?.url || product.primaryImage || 'https://via.placeholder.com/300',\n                  category: product.category,\n                  stock: product.stock,\n                  description: product.description,\n                  shortDescription: product.shortDescription || product.description,\n                  isWishlisted: favourites.includes(product._id || product.id),\n                  rating: product.rating ?? product.averageRating,\n                  reviews: product.reviews ?? product.reviewCount,\n                  reviewCount: product.reviewCount ?? product.reviews,\n                }}\n                onNavigate={onProductClick}\n                onAddToCart={onAddToCart}\n                onWishlist={onToggleFavourite}\n                className=\"product-card-wrapper\"\n              />\n            ))\n          )}\n        </div>\n      </section>\n\n      {/* Category Products Section - Laptop Only */}\n      {categoryProducts.length > 0 && (\n        <section id=\"home-category-products\" className=\"home-category-products-section\">\n          <div className=\"home-section-header\">\n            <div className=\"home-section-header__content\">\n              <h3 className=\"home-section-header__title\"><Trans>Featured Products</Trans></h3>\n              <p className=\"home-section-header__subtitle\"><Trans>From different categories</Trans></p>\n            </div>\n            <button\n              type=\"button\"\n              className=\"home-section-header__cta\"\n              onClick={() => onProductClick('all')}\n            >\n              <Trans>View All</Trans>\n              <ChevronRightIcon className=\"home-section-header__cta-icon\" />\n            </button>\n          </div>\n          <div className=\"home-products-grid\">\n            {categoryProducts.map((product) => (\n              <ProductCard\n                key={product._id || product.id}\n                product={{\n                  id: product._id || product.id,\n                  name: product.name,\n                  price: product.priceToUser || product.price || 0,\n                  image: product.images?.[0]?.url || product.primaryImage || 'https://via.placeholder.com/300',\n                  category: product.category,\n                  stock: product.stock,\n                  description: product.description,\n                  shortDescription: product.shortDescription || product.description,\n                  isWishlisted: favourites.includes(product._id || product.id),\n                  rating: product.rating ?? product.averageRating,\n                  reviews: product.reviews ?? product.reviewCount,\n                  reviewCount: product.reviewCount ?? product.reviews,\n                }}\n                onNavigate={onProductClick}\n                onAddToCart={onAddToCart}\n                onWishlist={onToggleFavourite}\n                className=\"product-card-wrapper\"\n              />\n            ))}\n          </div>\n        </section>\n      )}\n\n      {/* Special Deals Section - Only show if special offers exist */}\n      {specialOffers.length > 0 && (\n      <section id=\"home-deals\" className=\"home-deals-section\">\n        <div className=\"home-section-header\">\n          <div className=\"home-section-header__content\">\n            <h3 className=\"home-section-header__title\"><Trans>Special Offers</Trans></h3>\n            <p className=\"home-section-header__subtitle\"><Trans>Limited time deals</Trans></p>\n          </div>\n        </div>\n        <div className=\"home-deals-grid\">\n            {specialOffers.map((offer) => (\n              <div key={offer.id} className=\"home-deal-card\">\n                <div className=\"home-deal-card__badge\"><TransText>{offer.specialTag}</TransText></div>\n            <div className=\"home-deal-card__content\">\n                  <h4 className=\"home-deal-card__title\"><TransText>{offer.title}</TransText></h4>\n                  {offer.description && (\n                    <p className=\"home-deal-card__description\"><TransText>{offer.description}</TransText></p>\n                  )}\n              <div className=\"home-deal-card__price\">\n                    <span className=\"home-deal-card__price-current\"><TransText>{offer.specialValue}</TransText></span>\n            </div>\n          </div>\n              </div>\n            ))}\n        </div>\n      </section>\n      )}\n\n      {/* Quick Stats Section */}\n      <section id=\"home-stats\" className=\"home-stats-section\">\n        <div className=\"home-stats-grid\">\n          <div className=\"home-stat-card\">\n            <div className=\"home-stat-card__icon home-stat-card__icon--delivery\">\n              <TruckIcon className=\"h-5 w-5\" />\n            </div>\n            <div className=\"home-stat-card__content\">\n              <p className=\"home-stat-card__label\"><Trans>Fast Delivery</Trans></p>\n              <span className=\"home-stat-card__value\"><Trans>3-4 Hours</Trans></span>\n            </div>\n          </div>\n          <div className=\"home-stat-card\">\n            <div className=\"home-stat-card__icon home-stat-card__icon--payment\">\n              <MapPinIcon className=\"h-5 w-5\" />\n            </div>\n            <div className=\"home-stat-card__content\">\n              <p className=\"home-stat-card__label\"><Trans>Easy Payment</Trans></p>\n              <span className=\"home-stat-card__value\"><Trans>30% Advance</Trans></span>\n            </div>\n          </div>\n          <div className=\"home-stat-card\">\n            <div className=\"home-stat-card__icon home-stat-card__icon--quality\">\n              <TruckIcon className=\"h-5 w-5\" />\n            </div>\n            <div className=\"home-stat-card__content\">\n              <p className=\"home-stat-card__label\"><Trans>Quality Assured</Trans></p>\n              <span className=\"home-stat-card__value\"><Trans>100% Genuine</Trans></span>\n            </div>\n          </div>\n        </div>\n      </section>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\LoginPageView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":94,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":94,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\r\nimport { OtpVerification } from '../../../../components/auth/OtpVerification'\r\nimport { useUserDispatch } from '../../context/UserContext'\r\nimport * as userApi from '../../services/userApi'\r\nimport { Trans } from '../../../../components/Trans'\r\n\r\nexport function LoginPageView({ onSuccess, onSwitchToSignup }) {\r\n  const dispatch = useUserDispatch()\r\n  const [step, setStep] = useState('phone') // 'phone' | 'otp'\r\n  const [form, setForm] = useState({ phone: '' })\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(null)\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target\r\n    setForm((prev) => ({ ...prev, [name]: value }))\r\n    setError(null)\r\n  }\r\n\r\n  const handleRequestOtp = async (e) => {\r\n    e?.preventDefault()\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    try {\r\n      if (!form.phone.trim()) {\r\n        setError('Contact number is required')\r\n        setLoading(false)\r\n        return\r\n      }\r\n      if (form.phone.length < 10) {\r\n        setError('Please enter a valid contact number')\r\n        setLoading(false)\r\n        return\r\n      }\r\n\r\n      const result = await userApi.requestOTP({ phone: form.phone })\r\n      \r\n      if (result.success || result.data) {\r\n        setStep('otp')\r\n      } else {\r\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      setError(err.message || 'Failed to send OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleVerifyOtp = async (otpCode) => {\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    try {\r\n      const result = await userApi.verifyOTP({ phone: form.phone, otp: otpCode })\r\n\r\n      if (result.success && result.data?.token) {\r\n        localStorage.setItem('user_token', result.data.token)\r\n        \r\n        // Fetch user profile\r\n        const profileResult = await userApi.getUserProfile()\r\n        if (profileResult.success && profileResult.data?.user) {\r\n          const userData = profileResult.data.user\r\n          dispatch({\r\n            type: 'AUTH_LOGIN',\r\n            payload: {\r\n              name: userData.name || 'User',\r\n              phone: userData.phone || form.phone,\r\n              email: userData.email || '',\r\n              sellerId: userData.sellerId || null,\r\n              location: userData.location || null,\r\n            },\r\n          })\r\n        }\r\n\r\n        if (onSuccess) {\r\n          onSuccess()\r\n        }\r\n      } else {\r\n        setError(result.error?.message || 'Invalid OTP. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      setError(err.message || 'Invalid OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleResendOtp = async () => {\r\n    setLoading(true)\r\n    try {\r\n      await userApi.requestOTP({ phone: form.phone })\r\n    } catch (err) {\r\n      setError('Failed to resend OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  // OTP Step\r\n  if (step === 'otp') {\r\n    return (\r\n      <div className=\"user-auth-page-view\">\r\n        <div className=\"user-auth-page-view__container\">\r\n          <div className=\"user-auth-page-view__content\">\r\n            <div className=\"user-auth-page-view__form-section\">\r\n              <div className=\"user-auth-page-view__form-wrapper\">\r\n                <h1 className=\"user-auth-page-view__title\"><Trans>Verify OTP</Trans></h1>\r\n                <OtpVerification\r\n                  phone={form.phone}\r\n                  onVerify={handleVerifyOtp}\r\n                  onResend={handleResendOtp}\r\n                  onBack={() => setStep('phone')}\r\n                  loading={loading}\r\n                  error={error}\r\n                  userType=\"user\"\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"user-auth-page-view__illustration-section\">\r\n              <div className=\"user-auth-page-view__illustration\">\r\n                <div className=\"user-auth-page-view__illustration-content\">\r\n                  <h2 className=\"user-auth-page-view__illustration-title\"><Trans>Welcome Back</Trans></h2>\r\n                  <p className=\"user-auth-page-view__illustration-text\"><Trans>Continue your farming journey with IRA Sathi</Trans></p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Phone Step\r\n  return (\r\n    <div className=\"user-auth-page-view\">\r\n      <div className=\"user-auth-page-view__container\">\r\n        <div className=\"user-auth-page-view__content\">\r\n          <div className=\"user-auth-page-view__form-section\">\r\n            <div className=\"user-auth-page-view__form-wrapper\">\r\n              <h1 className=\"user-auth-page-view__title\"><Trans>Welcome Back</Trans></h1>\r\n              <p className=\"user-auth-page-view__subtitle\"><Trans>Sign in with your contact number</Trans></p>\r\n              \r\n              <form onSubmit={handleRequestOtp} className=\"user-auth-page-view__form\">\r\n                {error && (\r\n                  <div className=\"user-auth-page-view__error\">\r\n                    <p>{error}</p>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"user-auth-page-view__field\">\r\n                  <label htmlFor=\"login-phone\" className=\"user-auth-page-view__label\">\r\n                    <Trans>Contact Number</Trans> <span className=\"user-auth-page-view__required\">*</span>\r\n                  </label>\r\n                  <input\r\n                    id=\"login-phone\"\r\n                    name=\"phone\"\r\n                    type=\"tel\"\r\n                    required\r\n                    value={form.phone}\r\n                    onChange={handleChange}\r\n                    placeholder=\"+91 90000 00000\"\r\n                    maxLength={15}\r\n                    className=\"user-auth-page-view__input\"\r\n                  />\r\n                </div>\r\n\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={loading}\r\n                  className=\"user-auth-page-view__submit-btn\"\r\n                >\r\n                  {loading ? <Trans>Sending OTP...</Trans> : <Trans>Continue</Trans>}\r\n                </button>\r\n\r\n                <div className=\"user-auth-page-view__switch\">\r\n                  <span className=\"user-auth-page-view__switch-text\"><Trans>Don't have an account?</Trans> </span>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={onSwitchToSignup}\r\n                    className=\"user-auth-page-view__switch-link\"\r\n                  >\r\n                    <Trans>Sign up</Trans>\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n          <div className=\"user-auth-page-view__illustration-section\">\r\n            <div className=\"user-auth-page-view__illustration\">\r\n              <div className=\"user-auth-page-view__illustration-content\">\r\n                <h2 className=\"user-auth-page-view__illustration-title\"><Trans>Your Farming Partner</Trans></h2>\r\n                <p className=\"user-auth-page-view__illustration-text\"><Trans>Access quality products, expert advice, and seamless delivery for all your agricultural needs</Trans></p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\OrderConfirmationView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\OrdersView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\ProductDetailView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'translate' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":30,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"translate"},"fix":{"range":[1312,1350],"text":""},"desc":"Remove unused variable 'translate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":321,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":321,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[12372,12373],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'totalVariantPrice' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":534,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":534,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'imageGalleryRect' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":565,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":565,"endColumn":29},{"ruleId":"no-unused-vars","severity":2,"message":"'maxQuantity' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":660,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":660,"endColumn":20}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect, useRef, useCallback } from 'react'\nimport { StarIcon, HeartIcon, TruckIcon, MapPinIcon, ChevronRightIcon, ChevronDownIcon, PlusIcon, MinusIcon, PackageIcon, CheckCircleIcon, TrashIcon } from '../../components/icons'\nimport { cn } from '../../../../lib/cn'\nimport * as userApi from '../../services/userApi'\nimport { getPrimaryImageUrl } from '../../utils/productImages'\nimport { TransText } from '../../../../components/TransText'\nimport { Trans } from '../../../../components/Trans'\nimport { useTranslation } from '../../../../context/TranslationContext'\n\n// Component for dynamic \"Add X Variant(s) to Cart\" text\nfunction AddVariantToCartText({ count, price }) {\n  const { translate, isEnglish, language } = useTranslation()\n  const [text, setText] = useState('')\n\n  useEffect(() => {\n    const template = count === 1 ? 'Add 1 Variant to Cart' : `Add ${count} Variants to Cart`\n    if (isEnglish) {\n      setText(template)\n    } else {\n      translate(template)\n        .then(setText)\n        .catch(() => setText(template))\n    }\n  }, [count, isEnglish, translate, language])\n\n  return <>{text} â€¢ â‚¹{price.toLocaleString('en-IN')}</>\n}\n\nexport function ProductDetailView({ productId, onAddToCart, onBuyNow, onToggleFavourite, favourites = [], onBack, onProductClick }) {\n  const { translate } = useTranslation()\n  const [product, setProduct] = useState(null)\n  const [similarProducts, setSimilarProducts] = useState([])\n  const [suggestedProducts, setSuggestedProducts] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [quantity, setQuantity] = useState(1)\n  const [selectedImage, setSelectedImage] = useState(0)\n  const [isWishlisted, setIsWishlisted] = useState(false)\n  const [selectedAttributes, setSelectedAttributes] = useState({}) // Selected attribute combination\n  const [selectedAttributeStock, setSelectedAttributeStock] = useState(null) // The matching attributeStock entry\n  const [selectedVariants, setSelectedVariants] = useState([]) // Array of selected variant combinations\n  const [variantQuantities, setVariantQuantities] = useState({}) // Track quantity per variant: { variantKey: quantity }\n  const [activeTab, setActiveTab] = useState('description') // Tab state: 'description', 'stock', 'delivery', 'reviews'\n  const [variantError, setVariantError] = useState('') // Error message for variant selection\n  const variantSectionRef = useRef(null) // Ref for variant selection section\n  const containerRef = useRef(null)\n  const imageGalleryRef = useRef(null) // Ref for image gallery\n  const productInfoRef = useRef(null) // Ref for product info section\n  const [stickyTop, setStickyTop] = useState(100) // Dynamic top value for sticky positioning\n\n  // Initialize sticky top on mount\n  useEffect(() => {\n    setStickyTop(100)\n  }, [])\n\n  // Review states\n  const [reviews, setReviews] = useState([])\n  const [reviewStats, setReviewStats] = useState({ averageRating: 0, totalReviews: 0, distribution: { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 } })\n  const [reviewsLoading, setReviewsLoading] = useState(false)\n  const [reviewPage, setReviewPage] = useState(1)\n  const [hasMoreReviews, setHasMoreReviews] = useState(true)\n  const [myReview, setMyReview] = useState(null)\n  const [showReviewForm, setShowReviewForm] = useState(false)\n  const [reviewFormData, setReviewFormData] = useState({ rating: 0, comment: '' })\n  const [submittingReview, setSubmittingReview] = useState(false)\n  const [isAuthenticated, setIsAuthenticated] = useState(false)\n  const [showDeleteConfirmModal, setShowDeleteConfirmModal] = useState(false)\n  const [deletingReview, setDeletingReview] = useState(false)\n\n  // Check authentication status\n  useEffect(() => {\n    const token = localStorage.getItem('user_token')\n    setIsAuthenticated(!!token)\n  }, [])\n\n  // Fetch product details and related products\n  useEffect(() => {\n    const loadProduct = async () => {\n      // Don't fetch if productId is 'all' or invalid\n      if (!productId || productId === 'all') {\n        setLoading(false)\n        return\n      }\n\n      setLoading(true)\n      try {\n        // Fetch product details\n        const result = await userApi.getProductDetails(productId)\n        if (result.success && result.data?.product) {\n          const productData = result.data.product\n          setProduct(productData)\n\n          // Fetch similar products (same category)\n          if (productData.category) {\n            const similarResult = await userApi.getProducts({\n              category: productData.category,\n              limit: 10\n            })\n            if (similarResult.success && similarResult.data?.products) {\n              const similar = similarResult.data.products\n                .filter((p) => (p._id || p.id) !== productId)\n                .slice(0, 10)\n              setSimilarProducts(similar)\n\n              // Fetch suggested products (different category)\n              const suggestedResult = await userApi.getProducts({ limit: 20 })\n              if (suggestedResult.success && suggestedResult.data?.products) {\n                const excludeIds = [productId, ...similar.map((p) => p._id || p.id)]\n                const suggested = suggestedResult.data.products\n                  .filter((p) => !excludeIds.includes(p._id || p.id))\n                  .slice(0, 10)\n                setSuggestedProducts(suggested)\n              }\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error loading product:', error)\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    if (productId) {\n      loadProduct()\n    }\n  }, [productId])\n\n  // Fetch reviews when product loads\n  useEffect(() => {\n    const loadReviews = async () => {\n      if (!productId || productId === 'all') return\n\n      setReviewsLoading(true)\n      try {\n        const result = await userApi.getProductReviews(productId, { page: 1, limit: 10 })\n        if (result.success && result.data) {\n          setReviews(result.data.reviews || [])\n          setReviewStats(result.data.stats || { averageRating: 0, totalReviews: 0, distribution: { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 } })\n          setHasMoreReviews(result.data.pagination?.pages > 1)\n          setReviewPage(1)\n        }\n      } catch (error) {\n        console.error('Error loading reviews:', error)\n      } finally {\n        setReviewsLoading(false)\n      }\n    }\n\n    // Fetch my review if authenticated\n    const loadMyReview = async () => {\n      if (!isAuthenticated || !productId || productId === 'all') return\n\n      try {\n        const result = await userApi.getMyReview(productId)\n        if (result.success && result.data?.review) {\n          setMyReview(result.data.review)\n          setReviewFormData({\n            rating: result.data.review.rating,\n            comment: result.data.review.comment || ''\n          })\n        }\n      } catch (error) {\n        // User hasn't reviewed yet - that's fine\n        if (error.error?.message !== 'Review not found') {\n          console.error('Error loading my review:', error)\n        }\n      }\n    }\n\n    if (productId) {\n      loadReviews()\n      if (isAuthenticated) {\n        loadMyReview()\n      }\n    }\n  }, [productId, isAuthenticated])\n\n  // Handle review submission\n  const handleSubmitReview = async () => {\n    if (!isAuthenticated) {\n      // Redirect to login or show message\n      return\n    }\n\n    if (reviewFormData.rating === 0) {\n      alert('Please select a rating') // TODO: Translate alert message\n      return\n    }\n\n    setSubmittingReview(true)\n    try {\n      if (myReview) {\n        // Update existing review\n        const result = await userApi.updateReview(productId, myReview._id, reviewFormData)\n        if (result.success) {\n          setMyReview(result.data.review)\n          setShowReviewForm(false)\n          // Reload reviews\n          const reviewsResult = await userApi.getProductReviews(productId, { page: 1, limit: 10 })\n          if (reviewsResult.success && reviewsResult.data) {\n            setReviews(reviewsResult.data.reviews || [])\n            setReviewStats(reviewsResult.data.stats || reviewStats)\n          }\n        }\n      } else {\n        // Create new review\n        const result = await userApi.createReview(productId, reviewFormData)\n        if (result.success) {\n          setMyReview(result.data.review)\n          setShowReviewForm(false)\n          // Reload reviews\n          const reviewsResult = await userApi.getProductReviews(productId, { page: 1, limit: 10 })\n          if (reviewsResult.success && reviewsResult.data) {\n            setReviews(reviewsResult.data.reviews || [])\n            setReviewStats(reviewsResult.data.stats || reviewStats)\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error submitting review:', error)\n      alert(error.error?.message || 'Failed to submit review')\n    } finally {\n      setSubmittingReview(false)\n    }\n  }\n\n  // Handle delete review confirmation\n  const handleDeleteReviewClick = () => {\n    if (!myReview) return\n    setShowDeleteConfirmModal(true)\n  }\n\n  // Handle delete review\n  const handleDeleteReview = async () => {\n    if (!myReview) return\n\n    setDeletingReview(true)\n    try {\n      const result = await userApi.deleteReview(productId, myReview._id)\n      if (result.success) {\n        setMyReview(null)\n        setReviewFormData({ rating: 0, comment: '' })\n        setShowReviewForm(false)\n        setShowDeleteConfirmModal(false)\n        // Reload reviews\n        const reviewsResult = await userApi.getProductReviews(productId, { page: 1, limit: 10 })\n        if (reviewsResult.success && reviewsResult.data) {\n          setReviews(reviewsResult.data.reviews || [])\n          setReviewStats(reviewsResult.data.stats || reviewStats)\n        }\n      } else {\n        alert(result.error?.message || 'Failed to delete review')\n      }\n    } catch (error) {\n      console.error('Error deleting review:', error)\n      alert(error.error?.message || 'Failed to delete review')\n    } finally {\n      setDeletingReview(false)\n    }\n  }\n\n  // Load more reviews\n  const loadMoreReviews = async () => {\n    if (!hasMoreReviews || reviewsLoading) return\n\n    setReviewsLoading(true)\n    try {\n      const result = await userApi.getProductReviews(productId, { page: reviewPage + 1, limit: 10 })\n      if (result.success && result.data) {\n        setReviews(prev => [...prev, ...(result.data.reviews || [])])\n        setReviewPage(prev => prev + 1)\n        setHasMoreReviews(result.data.pagination?.pages > reviewPage + 1)\n      }\n    } catch (error) {\n      console.error('Error loading more reviews:', error)\n    } finally {\n      setReviewsLoading(false)\n    }\n  }\n\n  // Smart attribute mapping: Group by attribute name, then show properties\n  const attributeStructure = useMemo(() => {\n    if (!product?.attributeStocks || product.attributeStocks.length === 0) {\n      return { attributeNames: [], attributeProperties: {} }\n    }\n\n    // First, identify the \"Attribute Name\" field (usually the first key or a key containing \"name\" or \"attribute\")\n    const allKeys = new Set()\n    product.attributeStocks.forEach(stock => {\n      if (stock.attributes) {\n        Object.keys(stock.attributes).forEach(key => allKeys.add(key))\n      }\n    })\n\n    // Try to find attribute name field (case-insensitive check)\n    let attributeNameKey = null\n    const possibleNameKeys = Array.from(allKeys).filter(key =>\n      key.toLowerCase().includes('name') ||\n      key.toLowerCase().includes('attribute') ||\n      key.toLowerCase() === 'type' && Array.from(allKeys).length > 2\n    )\n\n    // If we find a likely attribute name field, use it; otherwise use first key\n    if (possibleNameKeys.length > 0) {\n      attributeNameKey = possibleNameKeys[0]\n    } else {\n      // Use the key that has the most unique values (likely the main attribute)\n      const keyValueCounts = {}\n      Array.from(allKeys).forEach(key => {\n        const uniqueValues = new Set()\n        product.attributeStocks.forEach(stock => {\n          if (stock.attributes && stock.attributes[key]) {\n            uniqueValues.add(stock.attributes[key])\n          }\n        })\n        keyValueCounts[key] = uniqueValues.size\n      })\n      // Find key with most unique values (but not all unique, that would be properties)\n      const sortedKeys = Object.entries(keyValueCounts)\n        .sort((a, b) => b[1] - a[1])\n        .filter(([_, count]) => count < product.attributeStocks.length) // Exclude keys where every entry is unique\n\n      attributeNameKey = sortedKeys.length > 0 ? sortedKeys[0][0] : Array.from(allKeys)[0]\n    }\n\n    // Extract unique attribute names\n    const attributeNames = new Set()\n    product.attributeStocks.forEach(stock => {\n      if (stock.attributes && stock.attributes[attributeNameKey]) {\n        attributeNames.add(stock.attributes[attributeNameKey])\n      }\n    })\n\n    // For each attribute name, extract its properties and values\n    const attributeProperties = {}\n    Array.from(attributeNames).forEach(attrName => {\n      attributeProperties[attrName] = {}\n\n      // Get all stocks for this attribute name\n      const relevantStocks = product.attributeStocks.filter(stock =>\n        stock.attributes && stock.attributes[attributeNameKey] === attrName\n      )\n\n      // Extract properties (all keys except attribute name key)\n      relevantStocks.forEach(stock => {\n        Object.keys(stock.attributes).forEach(key => {\n          if (key !== attributeNameKey) {\n            if (!attributeProperties[attrName][key]) {\n              attributeProperties[attrName][key] = new Set()\n            }\n            const value = stock.attributes[key]\n            if (value) {\n              // Handle array values (multiple subvalues)\n              if (Array.isArray(value)) {\n                value.forEach(v => attributeProperties[attrName][key].add(v))\n              } else {\n                attributeProperties[attrName][key].add(value)\n              }\n            }\n          }\n        })\n      })\n\n      // Convert Sets to Arrays\n      Object.keys(attributeProperties[attrName]).forEach(propKey => {\n        attributeProperties[attrName][propKey] = Array.from(attributeProperties[attrName][propKey]).sort()\n      })\n    })\n\n    return {\n      attributeNameKey,\n      attributeNames: Array.from(attributeNames).sort(),\n      attributeProperties\n    }\n  }, [product])\n\n  // Get available properties for currently selected attribute name\n  const availableProperties = useMemo(() => {\n    if (!selectedAttributes[attributeStructure.attributeNameKey]) {\n      return {}\n    }\n    const selectedAttrName = selectedAttributes[attributeStructure.attributeNameKey]\n    return attributeStructure.attributeProperties[selectedAttrName] || {}\n  }, [selectedAttributes, attributeStructure])\n\n  // Find matching attributeStock entry based on selected attributes\n  const findMatchingAttributeStock = useMemo(() => {\n    if (!product?.attributeStocks || product.attributeStocks.length === 0) {\n      return null\n    }\n\n    if (Object.keys(selectedAttributes).length === 0) {\n      return null\n    }\n\n    // Find the attributeStock entry that matches all selected attributes\n    // Handle array values in attributes (multiple subvalues)\n    return product.attributeStocks.find(stock => {\n      if (!stock.attributes) return false\n      return Object.keys(selectedAttributes).every(key => {\n        const stockValue = stock.attributes[key]\n        const selectedValue = selectedAttributes[key]\n\n        // If stock has array value, check if selected value is in array\n        if (Array.isArray(stockValue)) {\n          return stockValue.includes(selectedValue)\n        }\n        // If selected is array, check if stock value is in selected array\n        if (Array.isArray(selectedValue)) {\n          return selectedValue.includes(stockValue)\n        }\n        // Direct comparison\n        return stockValue === selectedValue\n      })\n    }) || null\n  }, [product, selectedAttributes])\n\n  // Update selectedAttributeStock when match changes\n  useEffect(() => {\n    setSelectedAttributeStock(findMatchingAttributeStock)\n    // Reset quantity when attribute selection changes\n    if (findMatchingAttributeStock) {\n      setQuantity(1)\n    }\n  }, [findMatchingAttributeStock])\n\n  // Reset quantity and image when product changes\n  useEffect(() => {\n    if (product) {\n      setQuantity(1)\n      setSelectedImage(0)\n      setSelectedAttributes({})\n      setSelectedAttributeStock(null)\n      setSelectedVariants([])\n      setVariantError('')\n      setIsWishlisted(product.isWishlisted || false)\n      // Scroll to top when product changes\n      if (containerRef.current) {\n        containerRef.current.scrollIntoView({ behavior: 'smooth', block: 'start' })\n      }\n    }\n  }, [productId, product])\n\n  // Sync isWishlisted with favourites array\n  useEffect(() => {\n    if (productId) {\n      setIsWishlisted(favourites.includes(productId))\n    }\n  }, [productId, favourites])\n\n  // Get images array - handle both new format (images array) and legacy formats\n  // This hook must be called before any conditional returns\n  const images = useMemo(() => {\n    if (!product) {\n      return ['https://via.placeholder.com/400']\n    }\n    if (product.images && Array.isArray(product.images) && product.images.length > 0) {\n      return product.images\n        .map(img => typeof img === 'string' ? img : (img.url || ''))\n        .filter(url => url && url !== '')\n        .sort((a, b) => {\n          // Sort by order if available\n          const aIndex = product.images.findIndex(i =>\n            (typeof i === 'string' ? i === a : i.url === a)\n          )\n          const bIndex = product.images.findIndex(i =>\n            (typeof i === 'string' ? i === b : i.url === b)\n          )\n          const aOrder = typeof product.images[aIndex] === 'object' ? (product.images[aIndex].order ?? aIndex) : aIndex\n          const bOrder = typeof product.images[bIndex] === 'object' ? (product.images[bIndex].order ?? bIndex) : bIndex\n          return aOrder - bOrder\n        })\n    }\n    if (product.primaryImage) {\n      return [product.primaryImage]\n    }\n    if (product.image) {\n      return [product.image]\n    }\n    return ['https://via.placeholder.com/400']\n  }, [product])\n\n  // Determine current stock, price, and status based on selected attribute or default\n  // These hooks MUST be called before any conditional returns\n  const currentStock = useMemo(() => {\n    if (!product) return 0\n    if (selectedAttributeStock) {\n      return selectedAttributeStock.displayStock || 0\n    }\n    return product.displayStock || product.stock || 0\n  }, [product, selectedAttributeStock])\n\n  const currentPrice = useMemo(() => {\n    if (!product) return 0\n    if (selectedAttributeStock) {\n      return selectedAttributeStock.userPrice || 0\n    }\n    return product.priceToUser || product.price || 0\n  }, [product, selectedAttributeStock])\n\n  const currentStockUnit = useMemo(() => {\n    if (!product) return 'kg'\n    if (selectedAttributeStock) {\n      return selectedAttributeStock.stockUnit || 'kg'\n    }\n    return product.stockUnit || 'kg'\n  }, [product, selectedAttributeStock])\n\n  // Check if product has attributes (flexible check)\n  const hasAttributes = useMemo(() => {\n    if (!product) return false\n    // Check if attributeStocks exists and has valid entries with attributes\n    if (product.attributeStocks && Array.isArray(product.attributeStocks) && product.attributeStocks.length > 0) {\n      // Check if at least one entry has valid attributes\n      return product.attributeStocks.some(stock =>\n        stock &&\n        stock.attributes &&\n        typeof stock.attributes === 'object' &&\n        Object.keys(stock.attributes).length > 0\n      )\n    }\n    return false\n  }, [product])\n\n  // Get variant key for quantity tracking - MUST be before conditional returns\n  const getVariantKey = useCallback((variantStock) => {\n    const stockAttrs = variantStock.attributes instanceof Map\n      ? Object.fromEntries(variantStock.attributes)\n      : variantStock.attributes || {}\n    return JSON.stringify(stockAttrs)\n  }, [])\n\n  // Calculate total price for all selected variants - MUST be before conditional returns\n  const totalVariantPrice = useMemo(() => {\n    return selectedVariants.reduce((total, variant) => {\n      const variantKey = getVariantKey(variant)\n      const variantQty = variantQuantities[variantKey] || 1\n      return total + ((variant.userPrice || 0) * variantQty)\n    }, 0)\n  }, [selectedVariants, variantQuantities, getVariantKey])\n\n  // Update selectedAttributeStock when a single variant is selected - MUST be before conditional returns\n  useEffect(() => {\n    if (selectedVariants.length === 1) {\n      setSelectedAttributeStock(selectedVariants[0])\n    } else {\n      setSelectedAttributeStock(null)\n    }\n  }, [selectedVariants])\n\n  // Handle sticky image gallery - stop when bottom aligns with product info bottom\n  useEffect(() => {\n    if (!product) return\n\n    const handleScroll = () => {\n      if (!imageGalleryRef.current || !productInfoRef.current) {\n        setStickyTop(100)\n        return\n      }\n\n      const imageGallery = imageGalleryRef.current\n      const productInfo = productInfoRef.current\n\n      // Get bounding rectangles (viewport coordinates)\n      const imageGalleryRect = imageGallery.getBoundingClientRect()\n      const productInfoRect = productInfo.getBoundingClientRect()\n\n      // Get heights\n      const imageGalleryHeight = imageGallery.offsetHeight\n      const productInfoHeight = productInfo.offsetHeight\n\n      // Base sticky top value\n      const baseStickyTop = 100\n\n      // If product info is shorter or equal to image gallery, use base sticky top\n      if (productInfoHeight <= imageGalleryHeight) {\n        setStickyTop(baseStickyTop)\n        return\n      }\n\n      // Calculate the adjusted top value to keep bottoms aligned\n      // We want: imageGalleryRect.bottom = productInfoRect.bottom\n      // Since imageGalleryRect.top = stickyTop (when sticky)\n      // We need: stickyTop + imageGalleryHeight = productInfoRect.bottom\n      // So: stickyTop = productInfoRect.bottom - imageGalleryHeight\n      const adjustedTop = productInfoRect.bottom - imageGalleryHeight\n\n      // Only adjust if we've scrolled enough that bottoms would align\n      // This happens when adjustedTop becomes less than baseStickyTop\n      if (adjustedTop < baseStickyTop && adjustedTop >= 0) {\n        setStickyTop(adjustedTop)\n      } else {\n        // Normal sticky behavior - stick at baseStickyTop\n        setStickyTop(baseStickyTop)\n      }\n    }\n\n    // Only run on laptop/bigger screens\n    const mediaQuery = window.matchMedia('(min-width: 1024px)')\n\n    if (mediaQuery.matches) {\n      // Use requestAnimationFrame for smooth updates\n      let ticking = false\n      const optimizedHandleScroll = () => {\n        if (!ticking) {\n          window.requestAnimationFrame(() => {\n            handleScroll()\n            ticking = false\n          })\n          ticking = true\n        }\n      }\n\n      // Initial calculation with a small delay to ensure DOM is ready\n      setTimeout(() => {\n        handleScroll()\n      }, 200)\n\n      window.addEventListener('scroll', optimizedHandleScroll, { passive: true })\n\n      // Also recalculate on resize and when content changes\n      window.addEventListener('resize', handleScroll, { passive: true })\n\n      // Use MutationObserver to detect content changes\n      const observer = new MutationObserver(() => {\n        setTimeout(handleScroll, 100)\n      })\n\n      if (productInfoRef.current) {\n        observer.observe(productInfoRef.current, {\n          childList: true,\n          subtree: true,\n          attributes: true,\n          attributeFilter: ['style', 'class']\n        })\n      }\n\n      if (imageGalleryRef.current) {\n        observer.observe(imageGalleryRef.current, {\n          childList: true,\n          subtree: true,\n          attributes: true,\n          attributeFilter: ['style', 'class']\n        })\n      }\n\n      return () => {\n        window.removeEventListener('scroll', optimizedHandleScroll)\n        window.removeEventListener('resize', handleScroll)\n        observer.disconnect()\n      }\n    } else {\n      // On mobile, don't use sticky\n      setStickyTop(100)\n    }\n  }, [product]) // Re-run when product loads\n\n  const inStock = currentStock > 0\n  const stockStatus = currentStock > 10 ? 'In Stock' : currentStock > 0 ? 'Low Stock' : 'Out of Stock'\n  const maxQuantity = currentStock\n\n  const handleProductClick = (clickedProductId) => {\n    if (onProductClick) {\n      onProductClick(clickedProductId)\n      // Scroll to top when navigating to a new product\n      if (containerRef.current) {\n        containerRef.current.scrollIntoView({ behavior: 'smooth', block: 'start' })\n      }\n    }\n  }\n\n  // Conditional returns must come after all hooks\n  if (loading) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"text-center py-12\">\n          <p className=\"text-base font-semibold text-[rgba(26,42,34,0.75)] mb-4\">Loading product...</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (!product) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"text-center py-12\">\n          <p className=\"text-base font-semibold text-[rgba(26,42,34,0.75)] mb-4\">Product not found</p>\n          <button\n            type=\"button\"\n            className=\"flex items-center gap-2 px-4 py-2 rounded-2xl bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white text-sm font-semibold\"\n            onClick={onBack}\n          >\n            Go Back\n          </button>\n        </div>\n      </div>\n    )\n  }\n\n  // Handle attribute selection - allow multiple selections\n  const handleAttributeChange = (attributeKey, value) => {\n    setSelectedAttributes(prev => {\n      const newSelection = { ...prev, [attributeKey]: value }\n\n      // If attribute name is changed, clear all property selections\n      if (attributeKey === attributeStructure.attributeNameKey) {\n        // Keep only the attribute name selection\n        return { [attributeKey]: value }\n      }\n\n      return newSelection\n    })\n    // Clear error when user makes a selection\n    setVariantError('')\n  }\n\n  // Handle variant selection - toggle variant in/out of selection\n  const handleVariantToggle = (variantStock) => {\n    const variantKey = getVariantKey(variantStock)\n\n    setSelectedVariants(prev => {\n      // Normalize attributes for comparison\n      const stockAttrs = variantStock.attributes instanceof Map\n        ? Object.fromEntries(variantStock.attributes)\n        : variantStock.attributes || {}\n\n      const exists = prev.find(v => {\n        const vAttrs = v.attributes instanceof Map\n          ? Object.fromEntries(v.attributes)\n          : v.attributes || {}\n        return JSON.stringify(vAttrs) === JSON.stringify(stockAttrs)\n      })\n\n      if (exists) {\n        // Remove variant and its quantity\n        setVariantQuantities(prevQty => {\n          const newQty = { ...prevQty }\n          delete newQty[variantKey]\n          return newQty\n        })\n        return prev.filter(v => {\n          const vAttrs = v.attributes instanceof Map\n            ? Object.fromEntries(v.attributes)\n            : v.attributes || {}\n          return JSON.stringify(vAttrs) !== JSON.stringify(stockAttrs)\n        })\n      } else {\n        // Add variant with initial quantity of 1\n        setVariantQuantities(prevQty => ({\n          ...prevQty,\n          [variantKey]: 1\n        }))\n        return [...prev, variantStock]\n      }\n    })\n    setVariantError('')\n  }\n\n  // Handle variant quantity change\n  const handleVariantQuantityChange = (variantStock, delta) => {\n    const variantKey = getVariantKey(variantStock)\n    const currentQty = variantQuantities[variantKey] || 1\n    const maxQty = variantStock.displayStock || variantStock.actualStock || 999\n\n    const newQty = Math.max(1, Math.min(maxQty, currentQty + delta))\n    setVariantQuantities(prev => ({\n      ...prev,\n      [variantKey]: newQty\n    }))\n  }\n\n  // Format attribute key to readable label\n  const formatAttributeLabel = (key) => {\n    const formatted = key\n      .replace(/([A-Z])/g, ' $1')\n      .replace(/^./, str => str.toUpperCase())\n      .trim()\n    // Return formatted key - will be translated in JSX using Trans component\n    return formatted\n  }\n\n  const handleAddToCart = () => {\n    if (!inStock) {\n      return\n    }\n\n    // Validate variant selection if product has attributes\n    if (hasAttributes && attributeStructure.attributeNames.length > 0) {\n      if (selectedVariants.length === 0) {\n        setVariantError('Please select at least one variant to proceed')\n        // Scroll to variant section\n        setTimeout(() => {\n          if (variantSectionRef.current) {\n            variantSectionRef.current.scrollIntoView({ behavior: 'smooth', block: 'center' })\n          }\n        }, 100)\n        return\n      }\n    }\n\n    // Clear error if validation passes\n    setVariantError('')\n\n    // Add each selected variant to cart separately with variant-specific quantities\n    if (selectedVariants.length > 0) {\n      // Handle multiple variants - add each variant separately with its own quantity\n      selectedVariants.forEach(variant => {\n        // Convert variant attributes to plain object\n        const variantAttrs = variant.attributes instanceof Map\n          ? Object.fromEntries(variant.attributes)\n          : variant.attributes || {}\n        const variantKey = getVariantKey(variant)\n        const variantQty = variantQuantities[variantKey] || 1\n        onAddToCart(productId, variantQty, variantAttrs)\n      })\n    } else {\n      onAddToCart(productId, quantity)\n    }\n  }\n\n  const handleBuyNow = () => {\n    if (!inStock) {\n      return\n    }\n\n    // Validate variant selection if product has attributes\n    if (hasAttributes && attributeStructure.attributeNames.length > 0) {\n      if (selectedVariants.length === 0) {\n        setVariantError('Please select at least one variant to proceed')\n        // Scroll to variant section\n        setTimeout(() => {\n          if (variantSectionRef.current) {\n            variantSectionRef.current.scrollIntoView({ behavior: 'smooth', block: 'center' })\n          }\n        }, 100)\n        return\n      }\n    }\n\n    // Clear error if validation passes\n    setVariantError('')\n\n    // Prepare product data for buy now\n    if (onBuyNow) {\n      if (selectedVariants.length > 0) {\n        // Handle multiple variants\n        const variantsData = selectedVariants.map(variant => {\n          const variantAttrs = variant.attributes instanceof Map\n            ? Object.fromEntries(variant.attributes)\n            : variant.attributes || {}\n          const variantKey = getVariantKey(variant)\n          const variantQty = variantQuantities[variantKey] || 1\n          return {\n            productId,\n            quantity: variantQty,\n            attributes: variantAttrs\n          }\n        })\n        onBuyNow(variantsData)\n      } else {\n        // No variants, just quantity\n        onBuyNow([{ productId, quantity }])\n      }\n    }\n  }\n\n  return (\n    <div ref={containerRef} className=\"user-product-detail-view space-y-6\">\n      <button\n        type=\"button\"\n        className=\"flex items-center gap-2 text-sm font-semibold text-[#1b8f5b] mb-2 user-product-detail-view__back-button\"\n        onClick={onBack}\n      >\n        <ChevronRightIcon className=\"h-5 w-5 rotate-180 transition-transform duration-300\" />\n        <Trans>Back</Trans>\n      </button>\n\n      {/* Product Content Group - Image Gallery and Product Info */}\n      <div className=\"user-product-detail-view__content-group\">\n        {/* Image Gallery */}\n        <div ref={imageGalleryRef} className=\"space-y-3\" style={{ '--sticky-top': `${stickyTop}px` }}>\n          <div className=\"relative w-full aspect-square rounded-3xl overflow-hidden bg-gray-100\">\n            <img src={images[selectedImage]} alt={product.name} className=\"w-full h-full object-cover\" />\n          </div>\n          {images.length > 1 && (\n            <div className=\"flex gap-2 overflow-x-auto pb-2 user-product-detail-view__thumbnail-container\">\n              {images.map((img, index) => (\n                <button\n                  key={index}\n                  type=\"button\"\n                  className={cn(\n                    'flex-shrink-0 w-20 h-20 rounded-2xl overflow-hidden border-2 transition-all',\n                    selectedImage === index\n                      ? 'border-[#1b8f5b] scale-105'\n                      : 'border-transparent opacity-60 hover:opacity-100'\n                  )}\n                  onClick={() => setSelectedImage(index)}\n                >\n                  <img src={img} alt={`${product.name} view ${index + 1}`} className=\"w-full h-full object-cover\" />\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Product Info - Redesigned Layout */}\n        <div ref={productInfoRef} className=\"user-product-info space-y-5\">\n          {/* Title and Wishlist */}\n          <div className=\"flex items-start justify-between gap-3\">\n            <div className=\"flex-1\">\n              <h1 className=\"text-xl font-bold text-[#172022] leading-tight mb-1.5\"><TransText>{product.name}</TransText></h1>\n              {/* Rating */}\n              <div className=\"flex items-center gap-2\">\n                <div className=\"flex items-center gap-0.5\">\n                  {[1, 2, 3, 4, 5].map((star) => (\n                    <StarIcon\n                      key={star}\n                      className=\"h-3.5 w-3.5 text-yellow-400\"\n                      filled={star <= Math.round(product.rating || 0)}\n                    />\n                  ))}\n                </div>\n                <span className=\"text-xs text-[rgba(26,42,34,0.65)]\">\n                  {product.rating || 0} ({product.reviews || 0} <Trans>reviews</Trans>)\n                </span>\n              </div>\n            </div>\n            <button\n              type=\"button\"\n              className={cn(\n                \"flex items-center justify-center w-10 h-10 rounded-xl border-2 transition-all shadow-sm\",\n                isWishlisted\n                  ? \"border-red-300 bg-red-50 text-red-600\"\n                  : \"border-[rgba(34,94,65,0.15)] bg-white text-gray-600 hover:border-red-200 hover:bg-red-50\"\n              )}\n              onClick={() => {\n                if (onToggleFavourite) {\n                  onToggleFavourite(productId)\n                }\n                setIsWishlisted(!isWishlisted)\n              }}\n            >\n              <HeartIcon className=\"h-4 w-4\" filled={isWishlisted} />\n            </button>\n          </div>\n\n          {/* Price - Prominent Display */}\n          <div className=\"bg-gradient-to-br from-[#1b8f5b]/10 to-[#2a9d61]/5 rounded-xl p-3 border border-[#1b8f5b]/20\">\n            <div className=\"flex items-baseline gap-2.5\">\n              <span className=\"text-2xl font-bold text-[#1b8f5b]\">â‚¹{currentPrice.toLocaleString('en-IN')}</span>\n              {product.originalPrice && product.originalPrice > currentPrice && (\n                <>\n                  <span className=\"text-base text-[rgba(26,42,34,0.5)] line-through\">â‚¹{product.originalPrice.toLocaleString('en-IN')}</span>\n                  {product.discount && (\n                    <span className=\"px-2 py-0.5 rounded-lg text-[0.65rem] font-bold text-white bg-red-500 shadow-sm\">\n                      -{product.discount}% OFF\n                    </span>\n                  )}\n                </>\n              )}\n            </div>\n            {selectedAttributeStock && (\n              <p className=\"text-[0.65rem] text-[rgba(26,42,34,0.6)] mt-1.5 font-medium\">\n                Price for selected variant\n              </p>\n            )}\n          </div>\n\n          {/* Dynamic Attribute Selection - Smart hierarchical display */}\n          {hasAttributes && attributeStructure.attributeNames.length > 0 && (\n            <div\n              ref={variantSectionRef}\n              className=\"space-y-3 p-3 rounded-xl border-2 border-blue-200/50 bg-gradient-to-br from-blue-50/50 to-purple-50/30\"\n            >\n              <div className=\"flex items-center justify-between mb-2\">\n                <div className=\"flex items-center gap-2\">\n                  <PackageIcon className=\"h-4 w-4 text-blue-600\" />\n                  <h3 className=\"text-sm font-bold text-[#172022]\"><Trans>Select Variant</Trans></h3>\n                </div>\n                {selectedVariants.length === 0 && (\n                  <span className=\"text-xs font-bold text-red-500 animate-pulse\" style={{ animationDuration: '2s' }}>\n                    <Trans>Required</Trans>\n                  </span>\n                )}\n              </div>\n              {variantError && (\n                <div className=\"p-2.5 rounded-lg bg-red-50 border-2 border-red-300\">\n                  <p className=\"text-xs font-semibold text-red-600 flex items-center gap-1.5\">\n                    <span>âš ï¸</span>\n                    {variantError}\n                  </p>\n                </div>\n              )}\n              <div className=\"space-y-3\">\n                {/* Step 1: Select Attribute Name */}\n                <div>\n                  <label className=\"block text-xs font-semibold text-[#172022] mb-1.5\">\n                    <Trans>{formatAttributeLabel(attributeStructure.attributeNameKey || 'Attribute Name')}</Trans>\n                  </label>\n                  <div className=\"flex flex-wrap gap-1.5\">\n                    {attributeStructure.attributeNames.map((attrName) => {\n                      const isSelected = selectedAttributes[attributeStructure.attributeNameKey] === attrName\n                      return (\n                        <button\n                          key={attrName}\n                          type=\"button\"\n                          onClick={() => handleAttributeChange(attributeStructure.attributeNameKey, attrName)}\n                          className={cn(\n                            'px-3 py-2 rounded-lg text-xs font-semibold transition-all border-2',\n                            isSelected\n                              ? 'bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white border-[#1b8f5b] shadow-md scale-105'\n                              : 'bg-white text-[#172022] border-gray-200 hover:border-[#1b8f5b]/50 hover:bg-[rgba(27,143,91,0.05)]'\n                          )}\n                        >\n                          {isSelected && <CheckCircleIcon className=\"inline h-3 w-3 mr-1\" />}\n                          {attrName}\n                        </button>\n                      )\n                    })}\n                  </div>\n                </div>\n\n                {/* Step 2: Show Properties only for selected Attribute Name */}\n                {selectedAttributes[attributeStructure.attributeNameKey] && Object.keys(availableProperties).length > 0 && (\n                  <div className=\"space-y-3 pt-2 border-t border-blue-200\">\n                    {Object.keys(availableProperties).map((propKey) => (\n                      <div key={propKey}>\n                        <label className=\"block text-xs font-semibold text-[#172022] mb-1.5\">\n                          <Trans>{formatAttributeLabel(propKey)}</Trans>\n                        </label>\n                        <div className=\"flex flex-wrap gap-1.5\">\n                          {availableProperties[propKey].map((value) => {\n                            const isSelected = selectedAttributes[propKey] === value\n                            return (\n                              <button\n                                key={value}\n                                type=\"button\"\n                                onClick={() => handleAttributeChange(propKey, value)}\n                                className={cn(\n                                  'px-3 py-2 rounded-lg text-xs font-semibold transition-all border-2',\n                                  isSelected\n                                    ? 'bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white border-[#1b8f5b] shadow-md scale-105'\n                                    : 'bg-white text-[#172022] border-gray-200 hover:border-[#1b8f5b]/50 hover:bg-[rgba(27,143,91,0.05)]'\n                                )}\n                              >\n                                {isSelected && <CheckCircleIcon className=\"inline h-3 w-3 mr-1\" />}\n                                {value}\n                              </button>\n                            )\n                          })}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              {/* Show all available variants for selection */}\n              {selectedAttributes[attributeStructure.attributeNameKey] && (\n                <div className=\"mt-3 space-y-2\">\n                  <p className=\"text-xs font-semibold text-[#172022] mb-2\">\n                    <Trans>Available Variants (Select one or more):</Trans>\n                  </p>\n                  {product.attributeStocks\n                    .filter(stock => {\n                      // Filter stocks that match the selected attribute name\n                      if (!stock.attributes || !stock.attributes[attributeStructure.attributeNameKey]) return false\n                      const stockAttrs = stock.attributes instanceof Map\n                        ? Object.fromEntries(stock.attributes)\n                        : stock.attributes\n                      return stockAttrs[attributeStructure.attributeNameKey] === selectedAttributes[attributeStructure.attributeNameKey]\n                    })\n                    .map((variantStock, idx) => {\n                      const stockAttrs = variantStock.attributes instanceof Map\n                        ? Object.fromEntries(variantStock.attributes)\n                        : variantStock.attributes || {}\n\n                      const isSelected = selectedVariants.some(v => {\n                        const vAttrs = v.attributes instanceof Map\n                          ? Object.fromEntries(v.attributes)\n                          : v.attributes || {}\n                        return JSON.stringify(vAttrs) === JSON.stringify(stockAttrs)\n                      })\n\n                      const variantAttributes = Object.entries(stockAttrs)\n                        .filter(([key]) => key !== attributeStructure.attributeNameKey)\n                        .map(([key, value]) => ({ key, value, formattedKey: formatAttributeLabel(key) }))\n\n                      const variantKey = getVariantKey(variantStock)\n                      const variantQty = variantQuantities[variantKey] || 1\n                      const maxQty = variantStock.displayStock || variantStock.actualStock || 999\n\n                      return (\n                        <div\n                          key={idx}\n                          className={cn(\n                            \"w-full p-3 rounded-lg border-2 transition-all\",\n                            isSelected\n                              ? \"bg-gradient-to-r from-[#1b8f5b]/10 to-[#2a9d61]/10 border-[#1b8f5b] shadow-md\"\n                              : \"bg-white border-gray-200\"\n                          )}\n                        >\n                          <div className=\"flex items-start justify-between gap-2 mb-3\">\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center gap-2 mb-1\">\n                                {isSelected && <CheckCircleIcon className=\"h-4 w-4 text-[#1b8f5b]\" />}\n                                <span className=\"text-xs font-bold text-[#172022]\">\n                                  {stockAttrs[attributeStructure.attributeNameKey] || `Variant ${idx + 1}`}\n                                </span>\n                              </div>\n                              <p className=\"text-xs text-[rgba(26,42,34,0.7)] mb-2\">\n                                {variantAttributes && variantAttributes.length > 0 ? (\n                                  variantAttributes.map((attr, attrIdx) => (\n                                    <span key={attrIdx}>\n                                      <Trans>{attr.formattedKey}</Trans>: {attr.value}\n                                      {attrIdx < variantAttributes.length - 1 && ', '}\n                                    </span>\n                                  ))\n                                ) : (\n                                  <Trans>No additional attributes</Trans>\n                                )}\n                              </p>\n                              <div className=\"grid grid-cols-2 gap-2 text-xs\">\n                                <div>\n                                  <span className=\"text-[rgba(26,42,34,0.6)]\"><Trans>Stock:</Trans></span>\n                                  <span className=\"ml-1 font-semibold text-[#172022]\">\n                                    {variantStock.displayStock || 0} {variantStock.stockUnit || 'kg'}\n                                  </span>\n                                </div>\n                                <div>\n                                  <span className=\"text-[rgba(26,42,34,0.6)]\"><Trans>Price:</Trans></span>\n                                  <span className=\"ml-1 font-bold text-[#1b8f5b]\">\n                                    â‚¹{(variantStock.userPrice || 0).toLocaleString('en-IN')}\n                                  </span>\n                                </div>\n                              </div>\n                            </div>\n                            <button\n                              type=\"button\"\n                              onClick={() => handleVariantToggle(variantStock)}\n                              className={cn(\n                                \"w-5 h-5 rounded border-2 flex items-center justify-center shrink-0 transition-all\",\n                                isSelected\n                                  ? \"bg-[#1b8f5b] border-[#1b8f5b]\"\n                                  : \"bg-white border-gray-300 hover:border-[#1b8f5b]\"\n                              )}\n                            >\n                              {isSelected && <CheckCircleIcon className=\"h-3 w-3 text-white\" />}\n                            </button>\n                          </div>\n\n                          {/* Variant-specific Quantity Control - Only show if selected */}\n                          {isSelected && (\n                            <div className=\"mt-3 pt-3 border-t border-[rgba(34,94,65,0.2)]\">\n                              <label className=\"block text-xs font-semibold text-[#172022] mb-2\"><Trans>Quantity</Trans></label>\n                              <div className=\"flex items-center justify-between gap-3\">\n                                <div className=\"flex items-center gap-2 border border-[rgba(34,94,65,0.2)] rounded-lg bg-white p-1.5\">\n                                  <button\n                                    type=\"button\"\n                                    className=\"flex items-center justify-center w-7 h-7 rounded-md border border-[rgba(34,94,65,0.2)] bg-white hover:bg-[rgba(240,245,242,0.8)] transition-all\"\n                                    onClick={(e) => {\n                                      e.stopPropagation()\n                                      handleVariantQuantityChange(variantStock, -1)\n                                    }}\n                                    disabled={variantQty <= 1}\n                                  >\n                                    <MinusIcon className=\"h-3.5 w-3.5\" />\n                                  </button>\n                                  <span className=\"px-2 text-sm font-semibold text-[#172022] min-w-[2rem] text-center\">{variantQty}</span>\n                                  <button\n                                    type=\"button\"\n                                    className=\"flex items-center justify-center w-7 h-7 rounded-md border border-[rgba(34,94,65,0.2)] bg-white hover:bg-[rgba(240,245,242,0.8)] transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n                                    onClick={(e) => {\n                                      e.stopPropagation()\n                                      handleVariantQuantityChange(variantStock, 1)\n                                    }}\n                                    disabled={variantQty >= maxQty}\n                                  >\n                                    <PlusIcon className=\"h-3.5 w-3.5\" />\n                                  </button>\n                                </div>\n                                <div className=\"text-right\">\n                                  <p className=\"text-[0.65rem] text-[rgba(26,42,34,0.6)]\">Available: {maxQty}</p>\n                                  <p className=\"text-xs font-bold text-[#1b8f5b]\">\n                                    Total: â‚¹{((variantStock.userPrice || 0) * variantQty).toLocaleString('en-IN')}\n                                  </p>\n                                </div>\n                              </div>\n                            </div>\n                          )}\n                        </div>\n                      )\n                    })}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Vendor Info - Keep separate */}\n          {product.vendor && (\n            <div className=\"flex items-start gap-2.5 p-2.5 rounded-lg border-l-4 border-[#1b8f5b] bg-gradient-to-r from-[rgba(240,245,242,0.6)] to-[rgba(240,245,242,0.3)]\">\n              <MapPinIcon className=\"h-4 w-4 text-[#1b8f5b] shrink-0 mt-0.5\" />\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-[0.65rem] font-semibold text-[rgba(26,42,34,0.5)] uppercase tracking-wide mb-0.5\"><Trans>Vendor</Trans></p>\n                <p className=\"text-xs font-bold text-[#172022] mb-0.5\"><TransText>{product.vendor.name}</TransText></p>\n                <p className=\"text-[0.65rem] text-[rgba(26,42,34,0.65)]\"><TransText>{product.vendor.location}</TransText></p>\n              </div>\n            </div>\n          )}\n\n          {/* Action Buttons - Add to Cart and Buy Now */}\n          <div className=\"sticky bottom-0 left-0 right-0 p-4 bg-white border-t-2 border-[rgba(34,94,65,0.15)] -mx-5 mt-6 shadow-lg backdrop-blur-sm bg-white/95 user-product-info__add-to-cart-container\">\n            <div className=\"flex gap-3\">\n              {/* Add to Cart Button */}\n              <button\n                type=\"button\"\n                className={cn(\n                  'flex-1 py-4 px-4 rounded-2xl text-base font-bold transition-all shadow-lg',\n                  inStock\n                    ? 'bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white hover:shadow-xl hover:scale-[1.02] active:scale-[0.98]'\n                    : 'bg-gray-200 text-gray-500 cursor-not-allowed'\n                )}\n                onClick={handleAddToCart}\n                disabled={!inStock || (hasAttributes && selectedVariants.length === 0)}\n              >\n                {!inStock ? (\n                  <Trans>Out of Stock</Trans>\n                ) : hasAttributes && selectedVariants.length === 0 ? (\n                  <Trans>Select Variant</Trans>\n                ) : (\n                  <Trans>Add to Cart</Trans>\n                )}\n              </button>\n\n              {/* Buy Now Button */}\n              <button\n                type=\"button\"\n                className={cn(\n                  'flex-1 py-4 px-4 rounded-2xl text-base font-bold transition-all shadow-lg',\n                  inStock\n                    ? 'bg-gradient-to-r from-[#f59e0b] to-[#d97706] text-white hover:shadow-xl hover:scale-[1.02] active:scale-[0.98]'\n                    : 'bg-gray-200 text-gray-500 cursor-not-allowed'\n                )}\n                onClick={handleBuyNow}\n                disabled={!inStock || (hasAttributes && selectedVariants.length === 0)}\n              >\n                {!inStock ? (\n                  <Trans>Out of Stock</Trans>\n                ) : hasAttributes && selectedVariants.length === 0 ? (\n                  <Trans>Select Variant</Trans>\n                ) : (\n                  <Trans>Buy Now</Trans>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Tabbed Content: Description, Stock, Delivery Time - Full Width Below 2-Column Layout */}\n      <div className=\"user-product-detail-view__tabs-section space-y-4\">\n        {/* Horizontal Scrollable Tab Menu */}\n        <div>\n          <style>{`\n              .tab-scroll-container::-webkit-scrollbar {\n                display: none;\n              }\n            `}</style>\n          <div\n            className=\"overflow-x-auto pb-2 tab-scroll-container\"\n            style={{\n              scrollbarWidth: 'none',\n              msOverflowStyle: 'none'\n            }}\n          >\n            <div className=\"flex gap-2 min-w-max user-product-detail-view__tabs-container\">\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('description')}\n                className={cn(\n                  \"px-5 py-2.5 rounded-xl text-xs font-bold transition-all whitespace-nowrap border-2 min-w-[120px] flex items-center justify-center gap-2\",\n                  activeTab === 'description'\n                    ? \"bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white border-[#1b8f5b] shadow-lg scale-105\"\n                    : \"bg-white text-[#172022] border-gray-200 hover:border-[#1b8f5b]/50 hover:bg-[rgba(27,143,91,0.05)]\"\n                )}\n              >\n                <PackageIcon className=\"h-3.5 w-3.5\" />\n                <Trans>Description</Trans>\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('stock')}\n                className={cn(\n                  \"px-5 py-2.5 rounded-xl text-xs font-bold transition-all whitespace-nowrap border-2 min-w-[120px] flex items-center justify-center gap-2\",\n                  activeTab === 'stock'\n                    ? \"bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white border-[#1b8f5b] shadow-lg scale-105\"\n                    : \"bg-white text-[#172022] border-gray-200 hover:border-[#1b8f5b]/50 hover:bg-[rgba(27,143,91,0.05)]\"\n                )}\n              >\n                <div className={cn(\n                  \"w-2.5 h-2.5 rounded-full\",\n                  inStock ? \"bg-[#1b8f5b]\" : \"bg-red-500\"\n                )} />\n                <Trans>Stock</Trans>\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('delivery')}\n                className={cn(\n                  \"px-5 py-2.5 rounded-xl text-xs font-bold transition-all whitespace-nowrap border-2 min-w-[120px] flex items-center justify-center gap-2\",\n                  activeTab === 'delivery'\n                    ? \"bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white border-[#1b8f5b] shadow-lg scale-105\"\n                    : \"bg-white text-[#172022] border-gray-200 hover:border-[#1b8f5b]/50 hover:bg-[rgba(27,143,91,0.05)]\"\n                )}\n              >\n                <TruckIcon className=\"h-3.5 w-3.5\" />\n                <Trans>Delivery Time</Trans>\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('reviews')}\n                className={cn(\n                  \"px-5 py-2.5 rounded-xl text-xs font-bold transition-all whitespace-nowrap border-2 min-w-[120px] flex items-center justify-center gap-2\",\n                  activeTab === 'reviews'\n                    ? \"bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white border-[#1b8f5b] shadow-lg scale-105\"\n                    : \"bg-white text-[#172022] border-gray-200 hover:border-[#1b8f5b]/50 hover:bg-[rgba(27,143,91,0.05)]\"\n                )}\n              >\n                <StarIcon className=\"h-3.5 w-3.5\" />\n                <Trans>Reviews & Ratings</Trans>\n              </button>\n            </div>\n          </div>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"min-h-[200px]\">\n          {/* Description Tab */}\n          {activeTab === 'description' && (\n            <div className=\"relative p-6 rounded-2xl bg-gradient-to-br from-[#f0f9f4] via-[#e8f5ed] to-[#d4ede0] border-2 border-[#1b8f5b]/30 shadow-xl overflow-hidden\">\n              {/* Decorative background elements */}\n              <div className=\"absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-[#1b8f5b]/10 to-transparent rounded-full blur-3xl\"></div>\n              <div className=\"absolute bottom-0 left-0 w-48 h-48 bg-gradient-to-tr from-[#2a9d61]/10 to-transparent rounded-full blur-3xl\"></div>\n\n              <div className=\"relative z-10\">\n                <div className=\"flex items-center gap-3 mb-5\">\n                  <div className=\"w-1.5 h-8 bg-gradient-to-b from-[#1b8f5b] to-[#2a9d61] rounded-full shadow-md\"></div>\n                  <div>\n                    <h3 className=\"text-lg font-bold text-[#172022] mb-1\"><Trans>About this Product</Trans></h3>\n                    <div className=\"h-0.5 w-16 bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] rounded-full\"></div>\n                  </div>\n                </div>\n\n                <div className=\"pl-4 space-y-4\">\n                  {(product.longDescription || product.description) ? (\n                    <div className=\"prose prose-sm max-w-none\">\n                      {(() => {\n                        const description = product.longDescription || product.description\n                        // Split by double line breaks first, then by single line breaks\n                        const paragraphs = description\n                          .split(/\\n\\n+/)\n                          .flatMap(p => p.split(/\\n/))\n                          .map(p => p.trim())\n                          .filter(p => p.length > 0)\n\n                        return paragraphs.map((paragraph, idx) => {\n                          // Check if paragraph looks like a heading (short and bold)\n                          const isHeading = paragraph.length < 80 && !paragraph.includes('.') && paragraph.split(' ').length < 10\n\n                          // Check if paragraph contains usage instructions\n                          const isUsage = paragraph.toLowerCase().includes('usage:') || paragraph.toLowerCase().includes('how to use') || paragraph.toLowerCase().startsWith('usage')\n\n                          // Check if paragraph contains benefits/features\n                          const isFeature = paragraph.toLowerCase().includes('suitable') || paragraph.toLowerCase().includes('contains') || paragraph.toLowerCase().includes('enhance') || paragraph.toLowerCase().includes('designed')\n\n                          return (\n                            <div\n                              key={idx}\n                              className={cn(\n                                \"mb-4 p-4 rounded-xl border-l-4 transition-all hover:shadow-md\",\n                                isHeading\n                                  ? \"bg-white border-[#1b8f5b] shadow-sm\"\n                                  : isUsage\n                                    ? \"bg-gradient-to-r from-blue-50/90 to-indigo-50/90 border-blue-500 shadow-sm\"\n                                    : isFeature\n                                      ? \"bg-white border-[#1b8f5b] shadow-sm\"\n                                      : \"bg-white border-[#1b8f5b]/40 shadow-sm\"\n                              )}\n                            >\n                              {isHeading ? (\n                                <h4 className=\"text-base font-bold text-[#1b8f5b] mb-2 flex items-center gap-2\">\n                                  <div className=\"w-2 h-2 rounded-full bg-[#1b8f5b]\"></div>\n                                  <TransText>{paragraph}</TransText>\n                                </h4>\n                              ) : isUsage ? (\n                                <div>\n                                  <div className=\"flex items-center gap-2 mb-2\">\n                                    <div className=\"w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center\">\n                                      <span className=\"text-white text-xs font-bold\">!</span>\n                                    </div>\n                                    <span className=\"text-sm font-bold text-blue-700 uppercase tracking-wide\"><Trans>Usage Instructions</Trans></span>\n                                  </div>\n                                  <p className=\"text-sm text-[rgba(26,42,34,0.85)] leading-relaxed ml-8\">\n                                    <TransText>{paragraph.replace(/^(usage|how to use):\\s*/i, '').trim()}</TransText>\n                                  </p>\n                                </div>\n                              ) : (\n                                <p className=\"text-sm text-[rgba(26,42,34,0.85)] leading-relaxed\">\n                                  <TransText>{paragraph}</TransText>\n                                </p>\n                              )}\n                            </div>\n                          )\n                        })\n                      })()}\n                    </div>\n                  ) : (\n                    <div className=\"p-6 bg-white/60 rounded-xl border-2 border-dashed border-[#1b8f5b]/30 text-center\">\n                      <p className=\"text-sm text-[rgba(26,42,34,0.6)]\">No description available for this product.</p>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Stock Tab */}\n          {activeTab === 'stock' && (\n            <div className={cn(\n              \"p-5 rounded-2xl border-2 shadow-lg\",\n              inStock\n                ? \"bg-gradient-to-br from-[rgba(240,245,242,0.6)] to-[rgba(240,245,242,0.3)] border-[#1b8f5b]\"\n                : \"bg-gradient-to-br from-[rgba(254,242,242,0.6)] to-[rgba(254,242,242,0.3)] border-red-500\"\n            )}>\n              <div className=\"flex items-center gap-2.5 mb-3\">\n                <div className={cn(\n                  \"w-4 h-4 rounded-full shadow-md\",\n                  inStock ? \"bg-[#1b8f5b]\" : \"bg-red-500\"\n                )} />\n                <h3 className=\"text-base font-bold text-[#172022]\">Stock Availability</h3>\n              </div>\n              <div className=\"pl-3 space-y-3\">\n                <div className=\"flex items-center justify-between p-3 bg-white rounded-xl border-2 border-[rgba(34,94,65,0.1)]\">\n                  <div>\n                    <p className=\"text-[0.65rem] font-semibold text-[rgba(26,42,34,0.6)] uppercase tracking-wide mb-0.5\">Status</p>\n                    <p className={cn(\n                      \"text-base font-bold\",\n                      inStock ? \"text-[#1b8f5b]\" : \"text-red-600\"\n                    )}>\n                      {stockStatus}\n                    </p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-[0.65rem] font-semibold text-[rgba(26,42,34,0.6)] uppercase tracking-wide mb-0.5\">Available Quantity</p>\n                    <p className=\"text-base font-bold text-[#172022]\">\n                      {currentStock.toLocaleString('en-IN')} {currentStockUnit}\n                    </p>\n                  </div>\n                </div>\n                {inStock && (\n                  <div className=\"p-3 bg-white rounded-xl border-2 border-[rgba(34,94,65,0.1)]\">\n                    {currentStock > 10 ? (\n                      <div className=\"flex items-center gap-2\">\n                        <CheckCircleIcon className=\"h-4 w-4 text-[#1b8f5b]\" />\n                        <p className=\"text-xs font-semibold text-[#172022]\">\n                          Product is in stock and ready for delivery\n                        </p>\n                      </div>\n                    ) : (\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-4 h-4 rounded-full bg-orange-500\"></div>\n                        <p className=\"text-xs font-semibold text-orange-600\">\n                          Limited stock available â€¢ Only {currentStock} {currentStockUnit} left!\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                )}\n                {!inStock && (\n                  <div className=\"p-3 bg-white rounded-xl border-2 border-red-200\">\n                    <p className=\"text-xs font-semibold text-red-600\">\n                      This product is currently out of stock. Please check back later.\n                    </p>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Delivery Time Tab */}\n          {activeTab === 'delivery' && (\n            <div className=\"p-5 rounded-2xl bg-gradient-to-br from-[rgba(239,246,255,0.6)] to-[rgba(239,246,255,0.3)] border-2 border-blue-500 shadow-lg\">\n              <div className=\"flex items-center gap-2.5 mb-3\">\n                <TruckIcon className=\"h-5 w-5 text-blue-500\" />\n                <h3 className=\"text-base font-bold text-[#172022]\">Delivery Information</h3>\n              </div>\n              <div className=\"pl-3 space-y-3\">\n                <div className=\"p-4 bg-white rounded-xl border-2 border-blue-200 shadow-sm\">\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center shrink-0\">\n                      <TruckIcon className=\"h-5 w-5 text-blue-600\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"text-[0.65rem] font-semibold text-[rgba(26,42,34,0.6)] uppercase tracking-wide mb-1.5\">Estimated Delivery Time</p>\n                      <p className=\"text-xl font-bold text-[#172022] mb-1.5\">\n                        {product.deliveryTime || 'Within 24 hours'}\n                      </p>\n                      <p className=\"text-xs text-[rgba(26,42,34,0.7)]\">\n                        Fast and reliable delivery to your doorstep\n                      </p>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-2 gap-2.5\">\n                  <div className=\"p-3 bg-white rounded-xl border border-blue-200\">\n                    <p className=\"text-[0.65rem] font-semibold text-[rgba(26,42,34,0.6)] mb-0.5\">Delivery Type</p>\n                    <p className=\"text-xs font-bold text-[#172022]\">Standard</p>\n                  </div>\n                  <div className=\"p-3 bg-white rounded-xl border border-blue-200\">\n                    <p className=\"text-[0.65rem] font-semibold text-[rgba(26,42,34,0.6)] mb-0.5\">Tracking</p>\n                    <p className=\"text-xs font-bold text-[#172022]\">Available</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Reviews Tab */}\n          {activeTab === 'reviews' && (\n            <div className=\"space-y-6 p-6 rounded-2xl bg-gradient-to-br from-[rgba(240,245,242,0.4)] via-[rgba(248,250,249,0.3)] to-white border-2 border-[#1b8f5b]/20 shadow-sm\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <h3 className=\"text-lg font-bold text-[#172022] mb-1\"><Trans>Reviews & Ratings</Trans></h3>\n                  <p className=\"text-sm text-[rgba(26,42,34,0.65)]\">\n                    {reviewStats.totalReviews} {reviewStats.totalReviews === 1 ? <Trans>review</Trans> : <Trans>reviews</Trans>}\n                  </p>\n                </div>\n                {reviewStats.averageRating > 0 && (\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"flex items-center gap-0.5\">\n                      {[1, 2, 3, 4, 5].map((star) => (\n                        <StarIcon\n                          key={star}\n                          className=\"h-4 w-4 text-yellow-400\"\n                          filled={star <= Math.round(reviewStats.averageRating)}\n                        />\n                      ))}\n                    </div>\n                    <span className=\"text-base font-bold text-[#172022]\">\n                      {reviewStats.averageRating.toFixed(1)}\n                    </span>\n                  </div>\n                )}\n              </div>\n\n              {/* Rating Distribution */}\n              {reviewStats.totalReviews > 0 && (\n                <div className=\"p-4 rounded-xl bg-gradient-to-br from-[rgba(240,245,242,0.6)] to-[rgba(240,245,242,0.3)] border border-[#1b8f5b]/20\">\n                  <div className=\"space-y-2\">\n                    {[5, 4, 3, 2, 1].map((rating) => {\n                      const count = reviewStats.distribution[rating] || 0\n                      const percentage = reviewStats.totalReviews > 0 ? (count / reviewStats.totalReviews) * 100 : 0\n                      return (\n                        <div key={rating} className=\"flex items-center gap-3\">\n                          <div className=\"flex items-center gap-1 w-16\">\n                            <span className=\"text-xs font-semibold text-[#172022]\">{rating}</span>\n                            <StarIcon className=\"h-3 w-3 text-yellow-400\" filled={true} />\n                          </div>\n                          <div className=\"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden\">\n                            <div\n                              className=\"h-full bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] transition-all duration-300\"\n                              style={{ width: `${percentage}%` }}\n                            />\n                          </div>\n                          <span className=\"text-xs font-semibold text-[rgba(26,42,34,0.7)] w-8 text-right\">\n                            {count}\n                          </span>\n                        </div>\n                      )\n                    })}\n                  </div>\n                </div>\n              )}\n\n              {/* Review Form (if authenticated) */}\n              {isAuthenticated && (\n                <div className=\"p-4 rounded-xl border-2 border-[#1b8f5b]/30 bg-gradient-to-br from-[rgba(240,245,242,0.4)] to-white\">\n                  {!showReviewForm && !myReview ? (\n                    <button\n                      type=\"button\"\n                      onClick={() => setShowReviewForm(true)}\n                      className=\"w-full py-3 px-4 rounded-lg bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white text-sm font-semibold hover:shadow-md transition-all\"\n                    >\n                      <Trans>Write a Review</Trans>\n                    </button>\n                  ) : myReview && !showReviewForm ? (\n                    // Collapsed state - show dropdown button\n                    <div className=\"space-y-3\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setShowReviewForm(true)}\n                        className=\"w-full flex items-center justify-between py-3 px-4 rounded-lg bg-white border-2 border-[rgba(34,94,65,0.2)] hover:bg-[rgba(240,245,242,0.5)] transition-all\"\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"flex items-center gap-1\">\n                            {[1, 2, 3, 4, 5].map((star) => (\n                              <StarIcon\n                                key={star}\n                                className=\"h-4 w-4\"\n                                filled={star <= myReview.rating}\n                              />\n                            ))}\n                          </div>\n                          <span className=\"text-sm font-semibold text-[#172022]\"><Trans>Edit Your Review</Trans></span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <button\n                            type=\"button\"\n                            onClick={(e) => {\n                              e.stopPropagation()\n                              handleDeleteReviewClick()\n                            }}\n                            className=\"text-xs text-red-600 font-semibold hover:underline px-2 py-1\"\n                          >\n                            <Trans>Delete Review</Trans>\n                          </button>\n                          <ChevronDownIcon className=\"h-5 w-5 text-[#172022]\" />\n                        </div>\n                      </button>\n                    </div>\n                  ) : showReviewForm ? (\n                    // Expanded state - show full form\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <h4 className=\"text-base font-bold text-[#172022]\">\n                          {myReview ? <Trans>Edit Your Review</Trans> : <Trans>Write a Review</Trans>}\n                        </h4>\n                        <div className=\"flex items-center gap-2\">\n                          {myReview && (\n                            <button\n                              type=\"button\"\n                              onClick={handleDeleteReviewClick}\n                              className=\"text-xs text-red-600 font-semibold hover:underline px-2 py-1\"\n                            >\n                              Delete Review\n                            </button>\n                          )}\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              setShowReviewForm(false)\n                              if (myReview) {\n                                setReviewFormData({ rating: myReview.rating, comment: myReview.comment || '' })\n                              }\n                            }}\n                            className=\"text-[#172022] hover:text-[#1b8f5b] transition-colors\"\n                          >\n                            <ChevronDownIcon className=\"h-5 w-5 rotate-180\" />\n                          </button>\n                        </div>\n                      </div>\n\n                      {/* Star Rating Input */}\n                      <div>\n                        <label className=\"block text-sm font-semibold text-[#172022] mb-2\">\n                          <Trans>Rating</Trans> <span className=\"text-red-500\">*</span>\n                        </label>\n                        <div className=\"flex items-center gap-2\">\n                          {[1, 2, 3, 4, 5].map((star) => (\n                            <button\n                              key={star}\n                              type=\"button\"\n                              onClick={() => setReviewFormData(prev => ({ ...prev, rating: star }))}\n                              className=\"focus:outline-none\"\n                            >\n                              <StarIcon\n                                className=\"h-6 w-6 transition-all hover:scale-110\"\n                                filled={star <= reviewFormData.rating}\n                                style={{ color: star <= reviewFormData.rating ? '#fbbf24' : '#d1d5db' }}\n                              />\n                            </button>\n                          ))}\n                          {reviewFormData.rating > 0 && (\n                            <span className=\"text-sm font-semibold text-[#172022] ml-2\">\n                              {reviewFormData.rating} {reviewFormData.rating === 1 ? <Trans>star</Trans> : <Trans>stars</Trans>}\n                            </span>\n                          )}\n                        </div>\n                      </div>\n\n                      {/* Comment Input */}\n                      <div>\n                        <label className=\"block text-sm font-semibold text-[#172022] mb-2\">\n                          <Trans>Your Review</Trans>\n                        </label>\n                        <textarea\n                          value={reviewFormData.comment}\n                          onChange={(e) => setReviewFormData(prev => ({ ...prev, comment: e.target.value }))}\n                          placeholder=\"Share your experience with this product...\"\n                          className=\"w-full px-4 py-3 rounded-lg border-2 border-[rgba(34,94,65,0.2)] focus:border-[#1b8f5b] focus:outline-none resize-none\"\n                          rows={4}\n                          maxLength={1000}\n                        />\n                        <p className=\"text-xs text-[rgba(26,42,34,0.6)] mt-1\">\n                          {reviewFormData.comment.length}/1000 <Trans>characters</Trans>\n                        </p>\n                      </div>\n\n                      {/* Submit Buttons */}\n                      <div className=\"flex items-center gap-3\">\n                        <button\n                          type=\"button\"\n                          onClick={handleSubmitReview}\n                          disabled={submittingReview || reviewFormData.rating === 0}\n                          className={cn(\n                            'flex-1 py-3 px-4 rounded-lg text-sm font-semibold transition-all',\n                            submittingReview || reviewFormData.rating === 0\n                              ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\n                              : 'bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white hover:shadow-md'\n                          )}\n                        >\n                          {submittingReview ? <Trans>Submitting...</Trans> : myReview ? <Trans>Update Review</Trans> : <Trans>Submit Review</Trans>}\n                        </button>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setShowReviewForm(false)\n                            if (myReview) {\n                              // Reset to original review data when canceling edit\n                              setReviewFormData({ rating: myReview.rating, comment: myReview.comment || '' })\n                            } else {\n                              // Clear form when canceling new review\n                              setReviewFormData({ rating: 0, comment: '' })\n                            }\n                          }}\n                          className=\"py-3 px-4 rounded-lg border-2 border-[rgba(34,94,65,0.2)] text-sm font-semibold text-[#172022] hover:bg-[rgba(240,245,242,0.5)] transition-all\"\n                        >\n                          {myReview ? <Trans>Collapse</Trans> : <Trans>Cancel</Trans>}\n                        </button>\n                      </div>\n                    </div>\n                  ) : null}\n                </div>\n              )}\n\n              {/* Reviews List */}\n              {reviewsLoading && reviews.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <p className=\"text-sm text-[rgba(26,42,34,0.65)]\"><Trans>Loading reviews...</Trans></p>\n                </div>\n              ) : reviews.length === 0 ? (\n                <div className=\"text-center py-8 p-4 rounded-xl bg-gray-50 border border-gray-200\">\n                  <p className=\"text-sm text-[rgba(26,42,34,0.65)]\"><Trans>No reviews yet. Be the first to review this product!</Trans></p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {reviews.map((review) => (\n                    <div\n                      key={review._id || review.id}\n                      className=\"p-4 rounded-xl border-2 border-[rgba(34,94,65,0.15)] bg-white hover:shadow-md transition-all\"\n                    >\n                      <div className=\"flex items-start justify-between mb-3\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <span className=\"text-sm font-bold text-[#172022]\">\n                              {review.userId?.name || 'Anonymous User'}\n                            </span>\n                            <div className=\"flex items-center gap-0.5\">\n                              {[1, 2, 3, 4, 5].map((star) => (\n                                <StarIcon\n                                  key={star}\n                                  className=\"h-3.5 w-3.5 text-yellow-400\"\n                                  filled={star <= review.rating}\n                                />\n                              ))}\n                            </div>\n                          </div>\n                          <p className=\"text-xs text-[rgba(26,42,34,0.6)]\">\n                            {new Date(review.createdAt).toLocaleDateString('en-IN', {\n                              year: 'numeric',\n                              month: 'long',\n                              day: 'numeric'\n                            })}\n                          </p>\n                        </div>\n                      </div>\n\n                      {review.comment && (\n                        <p className=\"text-sm text-[rgba(26,42,34,0.85)] leading-relaxed mb-3\">\n                          <TransText>{review.comment}</TransText>\n                        </p>\n                      )}\n\n                      {/* Admin Response */}\n                      {review.adminResponse?.response && (\n                        <div className=\"mt-3 pt-3 border-t border-[rgba(34,94,65,0.15)]\">\n                          <div className=\"flex items-start gap-2\">\n                            <div className=\"w-1 h-full bg-gradient-to-b from-[#1b8f5b] to-[#2a9d61] rounded-full mt-1\" />\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center gap-2 mb-1\">\n                                <span className=\"text-xs font-bold text-[#1b8f5b]\"><Trans>Admin Response</Trans></span>\n                                {review.adminResponse.respondedBy?.name && (\n                                  <span className=\"text-xs text-[rgba(26,42,34,0.6)]\">\n                                    <Trans>by</Trans> {review.adminResponse.respondedBy.name}\n                                  </span>\n                                )}\n                              </div>\n                              <p className=\"text-sm text-[rgba(26,42,34,0.85)] leading-relaxed\">\n                                <TransText>{review.adminResponse.response}</TransText>\n                              </p>\n                              {review.adminResponse.respondedAt && (\n                                <p className=\"text-xs text-[rgba(26,42,34,0.6)] mt-1\">\n                                  {new Date(review.adminResponse.respondedAt).toLocaleDateString('en-IN', {\n                                    year: 'numeric',\n                                    month: 'long',\n                                    day: 'numeric'\n                                  })}\n                                </p>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {/* Load More Reviews Button */}\n              {hasMoreReviews && reviews.length > 0 && (\n                <div className=\"text-center\">\n                  <button\n                    type=\"button\"\n                    onClick={loadMoreReviews}\n                    disabled={reviewsLoading}\n                    className={cn(\n                      'px-6 py-3 rounded-lg text-sm font-semibold transition-all',\n                      reviewsLoading\n                        ? 'bg-gray-200 text-gray-500 cursor-not-allowed'\n                        : 'bg-gradient-to-r from-[#1b8f5b] to-[#2a9d61] text-white hover:shadow-md'\n                    )}\n                  >\n                    {reviewsLoading ? <Trans>Loading...</Trans> : <Trans>Load More Reviews</Trans>}\n                  </button>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Similar Products Section */}\n      {similarProducts.length > 0 && (\n        <section className=\"user-product-detail-view__similar-section\">\n          <div className=\"user-product-detail-view__similar-header\">\n            <h3 className=\"user-product-detail-view__similar-title\"><Trans>Similar Products</Trans></h3>\n            <p className=\"user-product-detail-view__similar-subtitle\"><Trans>Products you might like</Trans></p>\n          </div>\n          <div className=\"user-product-detail-view__similar-rail\">\n            {similarProducts.map((similarProduct) => (\n              <div key={similarProduct.id} className=\"user-product-detail-view__similar-card-wrapper\">\n                <div\n                  className=\"user-product-detail-view__similar-card\"\n                  onClick={() => handleProductClick(similarProduct._id || similarProduct.id)}\n                >\n                  <div className=\"user-product-detail-view__similar-card-image\">\n                    <img src={getPrimaryImageUrl(similarProduct)} alt={similarProduct.name} />\n                  </div>\n                  <div className=\"user-product-detail-view__similar-card-content\">\n                    <h4 className=\"user-product-detail-view__similar-card-title\"><TransText>{similarProduct.name}</TransText></h4>\n                    <div className=\"user-product-detail-view__similar-card-price\">\n                      <span className=\"user-product-detail-view__similar-card-price-main\">\n                        â‚¹{(similarProduct.priceToUser || similarProduct.price || 0).toLocaleString('en-IN')}\n                      </span>\n                      {similarProduct.originalPrice && similarProduct.originalPrice > (similarProduct.priceToUser || similarProduct.price) && (\n                        <span className=\"user-product-detail-view__similar-card-price-original\">\n                          â‚¹{similarProduct.originalPrice.toLocaleString('en-IN')}\n                        </span>\n                      )}\n                    </div>\n                    <button\n                      type=\"button\"\n                      className=\"user-product-detail-view__similar-card-button\"\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        handleProductClick(similarProduct._id || similarProduct.id)\n                      }}\n                    >\n                      <Trans>View Details</Trans>\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </section>\n      )}\n\n      {/* Suggested Products Section */}\n      {suggestedProducts.length > 0 && (\n        <section className=\"user-product-detail-view__suggested-section\">\n          <div className=\"user-product-detail-view__suggested-header\">\n            <h3 className=\"user-product-detail-view__suggested-title\"><Trans>Suggested for You</Trans></h3>\n            <p className=\"user-product-detail-view__suggested-subtitle\"><Trans>Discover more products</Trans></p>\n          </div>\n          <div className=\"user-product-detail-view__suggested-rail\">\n            {suggestedProducts.map((suggestedProduct) => (\n              <div key={suggestedProduct.id} className=\"user-product-detail-view__suggested-card-wrapper\">\n                <div\n                  className=\"user-product-detail-view__suggested-card\"\n                  onClick={() => handleProductClick(suggestedProduct._id || suggestedProduct.id)}\n                >\n                  <div className=\"user-product-detail-view__suggested-card-image\">\n                    <img src={getPrimaryImageUrl(suggestedProduct)} alt={suggestedProduct.name} />\n                  </div>\n                  <div className=\"user-product-detail-view__suggested-card-content\">\n                    <h4 className=\"user-product-detail-view__suggested-card-title\"><TransText>{suggestedProduct.name}</TransText></h4>\n                    <div className=\"user-product-detail-view__suggested-card-price\">\n                      <span className=\"user-product-detail-view__suggested-card-price-main\">\n                        â‚¹{(suggestedProduct.priceToUser || suggestedProduct.price || 0).toLocaleString('en-IN')}\n                      </span>\n                      {suggestedProduct.originalPrice && suggestedProduct.originalPrice > (suggestedProduct.priceToUser || suggestedProduct.price) && (\n                        <span className=\"user-product-detail-view__suggested-card-price-original\">\n                          â‚¹{suggestedProduct.originalPrice.toLocaleString('en-IN')}\n                        </span>\n                      )}\n                    </div>\n                    <button\n                      type=\"button\"\n                      className=\"user-product-detail-view__suggested-card-button\"\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        handleProductClick(suggestedProduct._id || suggestedProduct.id)\n                      }}\n                    >\n                      <Trans>View Details</Trans>\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </section>\n      )}\n\n      {/* Delete Review Confirmation Modal */}\n      {showDeleteConfirmModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl shadow-xl max-w-md w-full p-6 border-2 border-[#1b8f5b]/20\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0\">\n                <TrashIcon className=\"h-6 w-6 text-red-600\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-bold text-[#172022]\"><Trans>Delete Review</Trans></h3>\n                <p className=\"text-sm text-[rgba(26,42,34,0.7)]\"><Trans>This action cannot be undone</Trans></p>\n              </div>\n            </div>\n\n            <p className=\"text-sm text-[rgba(26,42,34,0.85)] mb-6 pl-15\">\n              <Trans>Are you sure you want to delete your review? This will permanently remove your rating and comment for this product.</Trans>\n            </p>\n\n            <div className=\"flex items-center gap-3\">\n              <button\n                type=\"button\"\n                onClick={handleDeleteReview}\n                disabled={deletingReview}\n                className={cn(\n                  'flex-1 py-3 px-4 rounded-lg text-sm font-semibold transition-all',\n                  deletingReview\n                    ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\n                    : 'bg-red-600 text-white hover:bg-red-700 hover:shadow-md'\n                )}\n              >\n                {deletingReview ? <Trans>Deleting...</Trans> : <Trans>Delete Review</Trans>}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setShowDeleteConfirmModal(false)}\n                disabled={deletingReview}\n                className={cn(\n                  'py-3 px-4 rounded-lg border-2 border-[rgba(34,94,65,0.2)] text-sm font-semibold text-[#172022] transition-all',\n                  deletingReview\n                    ? 'opacity-50 cursor-not-allowed'\n                    : 'hover:bg-[rgba(240,245,242,0.5)]'\n                )}\n              >\n                Cancel\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\SearchView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\pages\\views\\SignupPageView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'otpCode' is defined but never used.","line":68,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":68,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"otpCode"},"fix":{"range":[2074,2081],"text":""},"desc":"Remove unused variable 'otpCode'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":118,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":118,"endColumn":17}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\r\nimport { OtpVerification } from '../../../../components/auth/OtpVerification'\r\nimport { useUserDispatch } from '../../context/UserContext'\r\nimport { GoogleMapsLocationPicker } from '../../../../components/GoogleMapsLocationPicker'\r\nimport * as userApi from '../../services/userApi'\r\nimport { Trans } from '../../../../components/Trans'\r\n\r\nexport function SignupPageView({ onSuccess, onSwitchToLogin }) {\r\n  const dispatch = useUserDispatch()\r\n  const [step, setStep] = useState('register') // 'register' | 'otp'\r\n  const [form, setForm] = useState({\r\n    fullName: '',\r\n    contact: '',\r\n    sellerId: '',\r\n    location: null,\r\n  })\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(null)\r\n  const [showSellerId, setShowSellerId] = useState(false)\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target\r\n    setForm((prev) => ({ ...prev, [name]: value }))\r\n    setError(null)\r\n  }\r\n\r\n  const handleRequestOtp = async (e) => {\r\n    e?.preventDefault()\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    try {\r\n      if (!form.fullName.trim()) {\r\n        setError('Full name is required')\r\n        setLoading(false)\r\n        return\r\n      }\r\n      if (!form.contact.trim()) {\r\n        setError('Contact number is required')\r\n        setLoading(false)\r\n        return\r\n      }\r\n      if (form.contact.length < 10) {\r\n        setError('Please enter a valid contact number')\r\n        setLoading(false)\r\n        return\r\n      }\r\n      if (!form.location) {\r\n        setError('Location is required')\r\n        setLoading(false)\r\n        return\r\n      }\r\n\r\n      const result = await userApi.requestOTP({ phone: form.contact })\r\n      \r\n      if (result.success || result.data) {\r\n        setStep('otp')\r\n      } else {\r\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      setError(err.message || 'Failed to send OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleVerifyOtp = async (otpCode) => {\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    try {\r\n      const registerData = {\r\n        phone: form.contact,\r\n        name: form.fullName,\r\n        sellerId: form.sellerId || undefined,\r\n        location: form.location,\r\n      }\r\n\r\n      const result = await userApi.register(registerData)\r\n\r\n      if (result.success && result.data?.token) {\r\n        localStorage.setItem('user_token', result.data.token)\r\n        \r\n        // Fetch user profile\r\n        const profileResult = await userApi.getUserProfile()\r\n        if (profileResult.success && profileResult.data?.user) {\r\n          const userData = profileResult.data.user\r\n          dispatch({\r\n            type: 'AUTH_LOGIN',\r\n            payload: {\r\n              name: userData.name || form.fullName,\r\n              phone: userData.phone || form.contact,\r\n              email: userData.email || '',\r\n              sellerId: userData.sellerId || form.sellerId || null,\r\n              location: userData.location || form.location,\r\n            },\r\n          })\r\n        }\r\n\r\n        if (onSuccess) {\r\n          onSuccess()\r\n        }\r\n      } else {\r\n        setError(result.error?.message || 'Registration failed. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      setError(err.message || 'Registration failed. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleResendOtp = async () => {\r\n    setLoading(true)\r\n    try {\r\n      await userApi.requestOTP({ phone: form.contact })\r\n    } catch (err) {\r\n      setError('Failed to resend OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  // OTP Step\r\n  if (step === 'otp') {\r\n    return (\r\n      <div className=\"user-auth-page-view\">\r\n        <div className=\"user-auth-page-view__container\">\r\n          <div className=\"user-auth-page-view__content\">\r\n            <div className=\"user-auth-page-view__form-section\">\r\n              <div className=\"user-auth-page-view__form-wrapper\">\r\n                <h1 className=\"user-auth-page-view__title\"><Trans>Verify OTP</Trans></h1>\r\n                <OtpVerification\r\n                  phone={form.contact}\r\n                  onVerify={handleVerifyOtp}\r\n                  onResend={handleResendOtp}\r\n                  onBack={() => setStep('register')}\r\n                  loading={loading}\r\n                  error={error}\r\n                  userType=\"user\"\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"user-auth-page-view__illustration-section\">\r\n              <div className=\"user-auth-page-view__illustration\">\r\n                <div className=\"user-auth-page-view__illustration-content\">\r\n                  <h2 className=\"user-auth-page-view__illustration-title\"><Trans>Join IRA Sathi</Trans></h2>\r\n                  <p className=\"user-auth-page-view__illustration-text\"><Trans>Start your journey towards better farming</Trans></p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Register Step\r\n  return (\r\n    <div className=\"user-auth-page-view\">\r\n      <div className=\"user-auth-page-view__container\">\r\n        <div className=\"user-auth-page-view__content\">\r\n          <div className=\"user-auth-page-view__form-section\">\r\n            <div className=\"user-auth-page-view__form-wrapper\">\r\n              <h1 className=\"user-auth-page-view__title\"><Trans>Create Account</Trans></h1>\r\n              <p className=\"user-auth-page-view__subtitle\"><Trans>Sign up to get started with IRA Sathi</Trans></p>\r\n              \r\n              <form onSubmit={handleRequestOtp} className=\"user-auth-page-view__form\">\r\n                {error && (\r\n                  <div className=\"user-auth-page-view__error\">\r\n                    <p>{error}</p>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"user-auth-page-view__field\">\r\n                  <label htmlFor=\"register-name\" className=\"user-auth-page-view__label\">\r\n                    <Trans>Full Name</Trans> <span className=\"user-auth-page-view__required\">*</span>\r\n                  </label>\r\n                  <input\r\n                    id=\"register-name\"\r\n                    name=\"fullName\"\r\n                    type=\"text\"\r\n                    required\r\n                    value={form.fullName}\r\n                    onChange={handleChange}\r\n                    placeholder=\"Enter your full name\"\r\n                    className=\"user-auth-page-view__input\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"user-auth-page-view__field\">\r\n                  <label htmlFor=\"register-contact\" className=\"user-auth-page-view__label\">\r\n                    <Trans>Contact Number</Trans> <span className=\"user-auth-page-view__required\">*</span>\r\n                  </label>\r\n                  <input\r\n                    id=\"register-contact\"\r\n                    name=\"contact\"\r\n                    type=\"tel\"\r\n                    required\r\n                    value={form.contact}\r\n                    onChange={handleChange}\r\n                    placeholder=\"+91 90000 00000\"\r\n                    maxLength={15}\r\n                    className=\"user-auth-page-view__input\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"user-auth-page-view__field\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setShowSellerId(!showSellerId)}\r\n                    className=\"user-auth-page-view__toggle-link\"\r\n                  >\r\n                    {showSellerId ? <Trans>Hide Seller ID</Trans> : <Trans>Have a Seller ID?</Trans>}\r\n                  </button>\r\n                  {showSellerId && (\r\n                    <input\r\n                      id=\"register-sellerId\"\r\n                      name=\"sellerId\"\r\n                      type=\"text\"\r\n                      value={form.sellerId}\r\n                      onChange={handleChange}\r\n                      placeholder=\"Enter Seller ID (optional)\"\r\n                      className=\"user-auth-page-view__input\"\r\n                    />\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"user-auth-page-view__field\">\r\n                  <label className=\"user-auth-page-view__label\">\r\n                    <Trans>Location</Trans> <span className=\"user-auth-page-view__required\">*</span>\r\n                  </label>\r\n                  <GoogleMapsLocationPicker\r\n                    value={form.location}\r\n                    onChange={(location) => setForm((prev) => ({ ...prev, location }))}\r\n                  />\r\n                </div>\r\n\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={loading || !form.fullName || !form.contact || !form.location}\r\n                  className=\"user-auth-page-view__submit-btn\"\r\n                >\r\n                  {loading ? <Trans>Sending OTP...</Trans> : <Trans>Continue</Trans>}\r\n                </button>\r\n\r\n                <div className=\"user-auth-page-view__switch\">\r\n                  <span className=\"user-auth-page-view__switch-text\"><Trans>Already have an account?</Trans> </span>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={onSwitchToLogin}\r\n                    className=\"user-auth-page-view__switch-link\"\r\n                  >\r\n                    <Trans>Sign in</Trans>\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n          <div className=\"user-auth-page-view__illustration-section\">\r\n            <div className=\"user-auth-page-view__illustration\">\r\n              <div className=\"user-auth-page-view__illustration-content\">\r\n                <h2 className=\"user-auth-page-view__illustration-title\"><Trans>Start Your Journey</Trans></h2>\r\n                <p className=\"user-auth-page-view__illustration-text\"><Trans>Join thousands of farmers who trust IRA Sathi for quality agricultural products and expert guidance</Trans></p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\routes\\UserDashboardPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\services\\userApi.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'onMessage' is defined but never used.","line":876,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":876,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"onMessage"},"fix":{"range":[24182,24191],"text":""},"desc":"Remove unused variable 'onMessage'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * User API Service\n * \n * This file contains all API endpoints for the User application.\n * All endpoints are backend-ready and will work once the backend is implemented.\n * \n * Base URL should be configured in environment variables:\n * - Development: http://localhost:3000/api\n * - Production: https://api.irasathi.com/api\n */\n\nconst API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000/api'\n\n/**\n * API Response Handler\n */\nasync function handleResponse(response) {\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ message: 'An error occurred' }))\n    // Ensure error response always has a 'success: false' and 'error' object\n    throw { success: false, error: { message: error.message || `HTTP error! status: ${response.status}` } }\n  }\n  return response.json()\n}\n\n/**\n * API Request Helper\n */\nasync function apiRequest(endpoint, options = {}) {\n  const token = localStorage.getItem('user_token') // User authentication token\n  \n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n      ...(token && { Authorization: `Bearer ${token}` }),\n      ...options.headers,\n    },\n    ...options,\n  }\n\n  const response = await fetch(`${API_BASE_URL}${endpoint}`, config)\n  return handleResponse(response)\n}\n\n// ============================================================================\n// AUTHENTICATION & ONBOARDING APIs\n// ============================================================================\n\n/**\n * Request OTP\n * POST /users/auth/request-otp\n * \n * @param {Object} data - { phone, language }\n * @returns {Promise<Object>} - { message: 'OTP sent successfully', expiresIn: 300 }\n */\nexport async function requestOTP(data) {\n  return apiRequest('/users/auth/request-otp', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Register User with OTP\n * POST /users/auth/register\n * \n * @param {Object} data - { fullName, phone, otp, sellerId? }\n * @returns {Promise<Object>} - { token, user: { id, name, phone, sellerId } }\n */\nexport async function register(data) {\n  return apiRequest('/users/auth/register', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Login with OTP\n * POST /users/auth/login\n * \n * @param {Object} data - { phone, otp }\n * @returns {Promise<Object>} - { token, user: { id, name, phone, sellerId, location } }\n */\nexport async function loginWithOtp(data) {\n  return apiRequest('/users/auth/login', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Verify OTP and Login (Legacy - use loginWithOtp)\n * POST /users/auth/verify-otp\n * \n * @param {Object} data - { phone, otp, sellerId? }\n * @returns {Promise<Object>} - { token, user: { id, name, phone, email, sellerId, location } }\n */\nexport async function verifyOTP(data) {\n  return apiRequest('/users/auth/verify-otp', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Get Seller ID (Read-only - Seller ID is locked for lifetime after first registration)\n * GET /users/profile/seller-id\n * \n * @returns {Promise<Object>} - Seller ID information\n * @note Seller ID can only be set during first-time registration and cannot be changed afterwards\n */\nexport async function getSellerID() {\n  return apiRequest('/users/profile/seller-id')\n}\n\n/**\n * Get User Profile\n * GET /users/profile\n * \n * @returns {Promise<Object>} - User profile data\n */\nexport async function getUserProfile() {\n  return apiRequest('/users/profile')\n}\n\n/**\n * Update User Profile\n * PUT /users/profile\n * \n * @param {Object} profileData - { name, email, phone, location }\n * @returns {Promise<Object>} - Updated user profile\n */\nexport async function updateUserProfile(profileData) {\n  return apiRequest('/users/profile', {\n    method: 'PUT',\n    body: JSON.stringify(profileData),\n  })\n}\n\n/**\n * Request OTP for current phone (for phone update)\n * POST /users/profile/phone/request-otp-current\n * \n * @returns {Promise<Object>} - { message, expiresIn, testOTP? }\n */\nexport async function requestOTPForCurrentPhone() {\n  return apiRequest('/users/profile/phone/request-otp-current', {\n    method: 'POST',\n  })\n}\n\n/**\n * Verify OTP for current phone (for phone update)\n * POST /users/profile/phone/verify-otp-current\n * \n * @param {Object} data - { otp }\n * @returns {Promise<Object>} - { message, verified }\n */\nexport async function verifyOTPForCurrentPhone(data) {\n  return apiRequest('/users/profile/phone/verify-otp-current', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Request OTP for new phone (for phone update)\n * POST /users/profile/phone/request-otp-new\n * \n * @param {Object} data - { newPhone }\n * @returns {Promise<Object>} - { message, expiresIn, testOTP? }\n */\nexport async function requestOTPForNewPhone(data) {\n  return apiRequest('/users/profile/phone/request-otp-new', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Verify OTP for new phone and update phone number\n * POST /users/profile/phone/verify-otp-new\n * \n * @param {Object} data - { otp }\n * @returns {Promise<Object>} - Updated user profile\n */\nexport async function verifyOTPForNewPhone(data) {\n  return apiRequest('/users/profile/phone/verify-otp-new', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Logout\n * POST /users/auth/logout\n * \n * @returns {Promise<Object>} - { message: 'Logged out successfully' }\n */\nexport async function userLogout() {\n  return apiRequest('/users/auth/logout', {\n    method: 'POST',\n  })\n}\n\n// ============================================================================\n// PRODUCT & CATALOG APIs\n// ============================================================================\n\n/**\n * Get Categories\n * GET /users/products/categories\n * \n * @returns {Promise<Array>} - Array of categories\n */\nexport async function getCategories() {\n  return apiRequest('/users/products/categories')\n}\n\n/**\n * Get Products\n * GET /users/products\n * \n * @param {Object} params - { category, search, minPrice, maxPrice, sort, limit, offset }\n * @returns {Promise<Object>} - { products: Array, total: number }\n */\nexport async function getProducts(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/products?${queryParams}`)\n}\n\n/**\n * Get Product Details\n * GET /users/products/:productId\n * \n * @param {string} productId - Product ID\n * @returns {Promise<Object>} - Product details with stock, delivery timeline, vendor info\n */\nexport async function getProductDetails(productId) {\n  return apiRequest(`/users/products/${productId}`)\n}\n\n/**\n * Get Popular Products\n * GET /users/products/popular\n * \n * @param {Object} params - { limit }\n * @returns {Promise<Array>} - Array of popular products\n */\nexport async function getPopularProducts(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/products/popular?${queryParams}`)\n}\n\n/**\n * Get Offers/Banners\n * GET /users/offers\n * \n * @returns {Promise<Object>} - { carousels: Array, specialOffers: Array }\n */\nexport async function getOffers() {\n  return apiRequest('/users/offers')\n}\n\n/**\n * Search Products\n * GET /users/products/search\n * \n * @param {Object} params - { query, category, limit, offset }\n * @returns {Promise<Object>} - { products: Array, total: number }\n */\nexport async function searchProducts(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/products/search?${queryParams}`)\n}\n\n// ============================================================================\n// REVIEW & RATING APIs\n// ============================================================================\n\n/**\n * Get Product Reviews\n * GET /users/products/:productId/reviews\n * \n * @param {string} productId - Product ID\n * @param {Object} params - { page, limit, sort }\n * @returns {Promise<Object>} - { reviews: Array, stats: Object, pagination: Object }\n */\nexport async function getProductReviews(productId, params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/products/${productId}/reviews?${queryParams}`)\n}\n\n/**\n * Get My Review for a Product\n * GET /users/products/:productId/reviews/my-review\n * \n * @param {string} productId - Product ID\n * @returns {Promise<Object>} - { review: Object }\n */\nexport async function getMyReview(productId) {\n  return apiRequest(`/users/products/${productId}/reviews/my-review`)\n}\n\n/**\n * Create or Update Review\n * POST /users/products/:productId/reviews\n * \n * @param {string} productId - Product ID\n * @param {Object} data - { rating, comment, orderId }\n * @returns {Promise<Object>} - { review: Object }\n */\nexport async function createReview(productId, data) {\n  return apiRequest(`/users/products/${productId}/reviews`, {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Update Review\n * PUT /users/products/:productId/reviews/:reviewId\n * \n * @param {string} productId - Product ID\n * @param {string} reviewId - Review ID\n * @param {Object} data - { rating, comment }\n * @returns {Promise<Object>} - { review: Object }\n */\nexport async function updateReview(productId, reviewId, data) {\n  return apiRequest(`/users/products/${productId}/reviews/${reviewId}`, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Delete Review\n * DELETE /users/products/:productId/reviews/:reviewId\n * \n * @param {string} productId - Product ID\n * @param {string} reviewId - Review ID\n * @returns {Promise<Object>} - { message: string }\n */\nexport async function deleteReview(productId, reviewId) {\n  return apiRequest(`/users/products/${productId}/reviews/${reviewId}`, {\n    method: 'DELETE',\n  })\n}\n\n// ============================================================================\n// CART APIs\n// ============================================================================\n\n/**\n * Get Cart\n * GET /users/cart\n * \n * @returns {Promise<Object>} - { items: Array, total: number }\n */\nexport async function getCart() {\n  return apiRequest('/users/cart')\n}\n\n/**\n * Add to Cart\n * POST /users/cart\n * \n * @param {Object} data - { productId, quantity }\n * @returns {Promise<Object>} - Updated cart\n */\nexport async function addToCart(data) {\n  return apiRequest('/users/cart', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Update Cart Item\n * PUT /users/cart/:itemId\n * \n * @param {string} itemId - Cart item ID\n * @param {Object} data - { quantity }\n * @returns {Promise<Object>} - Updated cart\n */\nexport async function updateCartItem(itemId, data) {\n  return apiRequest(`/users/cart/${itemId}`, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Remove from Cart\n * DELETE /users/cart/:itemId\n * \n * @param {string} itemId - Cart item ID\n * @returns {Promise<Object>} - Updated cart\n */\nexport async function removeFromCart(itemId) {\n  return apiRequest(`/users/cart/${itemId}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Clear Cart\n * DELETE /users/cart\n * \n * @returns {Promise<Object>} - { message: 'Cart cleared' }\n */\nexport async function clearCart() {\n  return apiRequest('/users/cart', {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Validate Cart (Check minimum order value)\n * POST /users/cart/validate\n * \n * @returns {Promise<Object>} - { valid: boolean, total: number, meetsMinimum: boolean, shortfall: number }\n */\nexport async function validateCart() {\n  return apiRequest('/users/cart/validate', {\n    method: 'POST',\n  })\n}\n\n// ============================================================================\n// VENDOR ASSIGNMENT APIs\n// ============================================================================\n\n/**\n * Get Assigned Vendor\n * POST /users/vendors/assign\n * \n * @param {Object} data - { location: { lat, lng, address, city, state, pincode } }\n * @returns {Promise<Object>} - { vendor: Object, distance: number, hasStock: boolean }\n */\nexport async function getAssignedVendor(data) {\n  return apiRequest('/users/vendors/assign', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Check Vendor Stock\n * POST /users/vendors/check-stock\n * \n * @param {Object} data - { vendorId, productIds: Array }\n * @returns {Promise<Object>} - { available: Array, unavailable: Array }\n */\nexport async function checkVendorStock(data) {\n  return apiRequest('/users/vendors/check-stock', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n// ============================================================================\n// CHECKOUT & ORDER APIs\n// ============================================================================\n\n/**\n * Create Order\n * POST /users/orders\n * \n * IMPORTANT: The backend should handle partial fulfillment scenarios:\n * - When vendor has some items but not all, the order should be split:\n *   - Items in stock â†’ Vendor fulfills\n *   - Items out of stock/insufficient â†’ Escalated to Admin\n * - The response should indicate if order is split and provide details\n * \n * @param {Object} orderData - {\n *   items: Array<{ productId: string, quantity: number }>,\n *   addressId: string,\n *   shippingMethod: string,\n *   vendorId: string,\n *   paymentMethod: string,\n *   paymentPreference: 'partial' | 'full',\n *   payInFull: boolean,\n *   upfrontAmount: number,\n *   deliveryChargeWaived?: boolean\n * }\n * @returns {Promise<Object>} - { \n *   order: Object,\n *   paymentIntent: Object,\n *   splitOrder?: { vendorOrder: Object, adminOrder: Object } // If partial fulfillment\n * }\n */\nexport async function createOrder(orderData) {\n  return apiRequest('/users/orders', {\n    method: 'POST',\n    body: JSON.stringify(orderData),\n  })\n}\n\n/**\n * Get Orders\n * GET /users/orders\n * \n * IMPORTANT: Orders returned should include the latest status updates from vendors.\n * Each order should have:\n * - status: 'awaiting' | 'dispatched' | 'delivered'\n * - statusTimeline: Array of { status: string, timestamp: ISO string }\n * \n * @param {Object} params - { status, limit, offset }\n * @returns {Promise<Object>} - { orders: Array with status and statusTimeline, total: number }\n */\nexport async function getOrders(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/orders?${queryParams}`)\n}\n\n/**\n * Get Order Details\n * GET /users/orders/:orderId\n * \n * @param {string} orderId - Order ID\n * @returns {Promise<Object>} - Order details with items, payment, delivery status\n */\nexport async function getOrderDetails(orderId) {\n  return apiRequest(`/users/orders/${orderId}`)\n}\n\n/**\n * Track Order\n * GET /users/orders/:orderId/track\n * \n * @param {string} orderId - Order ID\n * @returns {Promise<Object>} - Order tracking information\n */\nexport async function trackOrder(orderId) {\n  return apiRequest(`/users/orders/${orderId}/track`)\n}\n\n/**\n * Cancel Order\n * PUT /users/orders/:orderId/cancel\n * \n * @param {string} orderId - Order ID\n * @param {Object} data - { reason }\n * @returns {Promise<Object>} - Updated order\n */\nexport async function cancelOrder(orderId, data = {}) {\n  return apiRequest(`/users/orders/${orderId}/cancel`, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n  })\n}\n\n// ============================================================================\n// PAYMENT APIs\n// ============================================================================\n\n/**\n * Create Payment Intent (Advance Payment)\n * POST /users/payments/create-intent\n * \n * @param {Object} data - { orderId, amount, paymentMethod }\n * @returns {Promise<Object>} - { paymentIntentId, clientSecret, paymentGateway: 'razorpay'|'paytm'|'stripe' }\n */\nexport async function createPaymentIntent(data) {\n  return apiRequest('/users/payments/create-intent', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Confirm Payment (Advance Payment)\n * POST /users/payments/confirm\n * \n * @param {Object} data - { \n *   orderId: string (required),\n *   paymentIntentId?: string,\n *   gatewayPaymentId: string (required - dummy for now),\n *   gatewayOrderId?: string (dummy for now),\n *   gatewaySignature?: string (dummy for now),\n *   paymentMethod: string\n * }\n * @returns {Promise<Object>} - { success: boolean, transactionId, orderId }\n */\nexport async function confirmPayment(data) {\n  return apiRequest('/users/payments/confirm', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Create Remaining Payment Intent\n * POST /users/payments/create-remaining\n * \n * @param {Object} data - { orderId, paymentMethod }\n * @returns {Promise<Object>} - { paymentIntentId, clientSecret, amount }\n */\nexport async function createRemainingPaymentIntent(data) {\n  return apiRequest('/users/payments/create-remaining', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Confirm Remaining Payment\n * POST /users/payments/confirm-remaining\n * \n * @param {Object} data - { orderId, paymentIntentId, paymentMethod, paymentDetails }\n * @returns {Promise<Object>} - { success: boolean, transactionId }\n */\nexport async function confirmRemainingPayment(data) {\n  return apiRequest('/users/payments/confirm-remaining', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Get Payment Status\n * GET /users/payments/:paymentId\n * \n * @param {string} paymentId - Payment ID\n * @returns {Promise<Object>} - Payment status and details\n */\nexport async function getPaymentStatus(paymentId) {\n  return apiRequest(`/users/payments/${paymentId}`)\n}\n\n/**\n * Get Order Payments\n * GET /users/orders/:orderId/payments\n * \n * @param {string} orderId - Order ID\n * @returns {Promise<Object>} - { advance: Object, remaining: Object }\n */\nexport async function getOrderPayments(orderId) {\n  return apiRequest(`/users/orders/${orderId}/payments`)\n}\n\n// ============================================================================\n// ADDRESS APIs\n// ============================================================================\n\n/**\n * Get Addresses\n * GET /users/addresses\n * \n * @returns {Promise<Array>} - Array of addresses\n */\nexport async function getAddresses() {\n  return apiRequest('/users/addresses')\n}\n\n/**\n * Add Address\n * POST /users/addresses\n * \n * @param {Object} addressData - { name, address, city, state, pincode, phone, isDefault }\n * @returns {Promise<Object>} - Created address\n */\nexport async function addAddress(addressData) {\n  return apiRequest('/users/addresses', {\n    method: 'POST',\n    body: JSON.stringify(addressData),\n  })\n}\n\n/**\n * Update Address\n * PUT /users/addresses/:addressId\n * \n * @param {string} addressId - Address ID\n * @param {Object} addressData - Address fields to update\n * @returns {Promise<Object>} - Updated address\n */\nexport async function updateAddress(addressId, addressData) {\n  return apiRequest(`/users/addresses/${addressId}`, {\n    method: 'PUT',\n    body: JSON.stringify(addressData),\n  })\n}\n\n/**\n * Delete Address\n * DELETE /users/addresses/:addressId\n * \n * @param {string} addressId - Address ID\n * @returns {Promise<Object>} - { message: 'Address deleted' }\n */\nexport async function deleteAddress(addressId) {\n  return apiRequest(`/users/addresses/${addressId}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Set Default Address\n * PUT /users/addresses/:addressId/default\n * \n * @param {string} addressId - Address ID\n * @returns {Promise<Object>} - Updated address\n */\nexport async function setDefaultAddress(addressId) {\n  return apiRequest(`/users/addresses/${addressId}/default`, {\n    method: 'PUT',\n  })\n}\n\n// ============================================================================\n// FAVOURITES/WISHLIST APIs\n// ============================================================================\n\n/**\n * Get Favourites\n * GET /users/favourites\n * \n * @returns {Promise<Array>} - Array of favourite product IDs\n */\nexport async function getFavourites() {\n  return apiRequest('/users/favourites')\n}\n\n/**\n * Add to Favourites\n * POST /users/favourites\n * \n * @param {Object} data - { productId }\n * @returns {Promise<Object>} - { message: 'Added to favourites' }\n */\nexport async function addToFavourites(data) {\n  return apiRequest('/users/favourites', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Remove from Favourites\n * DELETE /users/favourites/:productId\n * \n * @param {string} productId - Product ID\n * @returns {Promise<Object>} - { message: 'Removed from favourites' }\n */\nexport async function removeFromFavourites(productId) {\n  return apiRequest(`/users/favourites/${productId}`, {\n    method: 'DELETE',\n  })\n}\n\n// ============================================================================\n// NOTIFICATIONS APIs\n// ============================================================================\n\n/**\n * Get Notifications\n * GET /users/notifications\n * \n * @param {Object} params - { read, type, limit, offset }\n * @returns {Promise<Object>} - { notifications: Array, unreadCount: number }\n */\nexport async function getNotifications(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/notifications?${queryParams}`)\n}\n\n/**\n * Mark Notification as Read\n * PUT /users/notifications/:notificationId/read\n * \n * @param {string} notificationId - Notification ID\n * @returns {Promise<Object>} - { message: 'Marked as read' }\n */\nexport async function markNotificationRead(notificationId) {\n  return apiRequest(`/users/notifications/${notificationId}/read`, {\n    method: 'PUT',\n  })\n}\n\n/**\n * Mark All Notifications as Read\n * PUT /users/notifications/read-all\n * \n * @returns {Promise<Object>} - { message: 'All notifications marked as read' }\n */\nexport async function markAllNotificationsRead() {\n  return apiRequest('/users/notifications/read-all', {\n    method: 'PUT',\n  })\n}\n\n// ============================================================================\n// SUPPORT APIs\n// ============================================================================\n\n/**\n * Create Support Ticket\n * POST /users/support/tickets\n * \n * @param {Object} data - { subject, description, category, orderId? }\n * @returns {Promise<Object>} - { ticketId, message: 'Ticket created successfully' }\n */\nexport async function createSupportTicket(data) {\n  return apiRequest('/users/support/tickets', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Get Support Tickets\n * GET /users/support/tickets\n * \n * @param {Object} params - { status, limit, offset }\n * @returns {Promise<Object>} - { tickets: Array, total: number }\n */\nexport async function getSupportTickets(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/support/tickets?${queryParams}`)\n}\n\n/**\n * Get Support Ticket Details\n * GET /users/support/tickets/:ticketId\n * \n * @param {string} ticketId - Support ticket ID\n * @returns {Promise<Object>} - Ticket details with messages\n */\nexport async function getSupportTicketDetails(ticketId) {\n  return apiRequest(`/users/support/tickets/${ticketId}`)\n}\n\n/**\n * Send Support Message\n * POST /users/support/tickets/:ticketId/messages\n * \n * @param {string} ticketId - Support ticket ID\n * @param {Object} data - { message }\n * @returns {Promise<Object>} - { messageId, message: 'Message sent' }\n */\nexport async function sendSupportMessage(ticketId, data) {\n  return apiRequest(`/users/support/tickets/${ticketId}/messages`, {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Initiate Support Call\n * POST /users/support/call\n * \n * @param {Object} data - { orderId?, issue }\n * @returns {Promise<Object>} - { callId, phoneNumber, message: 'Call initiated' }\n */\nexport async function initiateSupportCall(data) {\n  return apiRequest('/users/support/call', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n// ============================================================================\n// REAL-TIME UPDATES (WebSocket/SSE)\n// ============================================================================\n\n/**\n * Initialize Real-time Connection\n * This would typically use WebSocket or Server-Sent Events\n * For now, this is a placeholder for the implementation\n * \n * @param {Function} onMessage - Callback for receiving messages\n * @returns {Function} - Cleanup function to close connection\n */\nexport function initializeRealtimeConnection(onMessage) {\n  // This would be implemented with WebSocket or SSE\n  // Example:\n  // const ws = new WebSocket(`${WS_BASE_URL}/users/realtime`)\n  // ws.onmessage = (event) => {\n  //   const data = JSON.parse(event.data)\n  //   onMessage(data)\n  // }\n  // return () => ws.close()\n  \n  // For now, return a no-op cleanup function\n  return () => {}\n}\n\n/**\n * Handle Real-time Notification\n * Processes incoming real-time notifications (payment reminders, delivery updates, etc.)\n * \n * @param {Object} notification - Notification data from real-time connection\n */\nexport function handleRealtimeNotification(notification) {\n  // This would process different types of notifications:\n  // - 'payment_reminder': When remaining payment is due\n  // - 'delivery_update': When order status changes\n  // - 'order_assigned': When order is assigned to vendor\n  // - 'order_delivered': When order is delivered\n  // - 'offer': When new offers are available\n  // - 'announcement': When admin posts announcements\n  \n  return notification\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\services\\userData.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\User\\utils\\productImages.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\BankAccountForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\BottomNavItem.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\ButtonActionPanel.jsx","messages":[{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":315,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":315,"endColumn":85,"suggestions":[{"messageId":"addBrackets","fix":{"range":[11026,27312],"text":"{ const isRevert = data?.revert === true && buttonId === 'update-order-status'\n        const previousStatus = isRevert ? (orderInfo?.statusUpdateGracePeriod?.previousStatus || data?.status || '') : null\n\n        // If it's a revert, show special revert confirmation UI\n        if (isRevert && previousStatus) {\n          const formatStatusLabel = (status) => {\n            if (!status) return ''\n            const normalized = status.toLowerCase()\n            if (normalized === 'fully_paid') return 'Fully Paid'\n            if (normalized === 'delivered') return 'Delivered'\n            if (normalized === 'dispatched' || normalized === 'out_for_delivery') return 'Dispatched'\n            if (normalized === 'accepted' || normalized === 'processing') return 'Accepted'\n            if (normalized === 'awaiting' || normalized === 'pending') return 'Awaiting'\n            return status.charAt(0).toUpperCase() + status.slice(1).replace(/_/g, ' ')\n          }\n\n          return (\n            <div className=\"vendor-action-panel__form\">\n              {renderOrderInfo()}\n\n              {/* Previous Status Display */}\n              <div className=\"vendor-action-panel__field\">\n                <label className=\"vendor-action-panel__label\">\n                  Previous Status\n                  <span className=\"vendor-action-panel__required\">*</span>\n                </label>\n                <div style={{\n                  padding: '12px',\n                  backgroundColor: '#F3F4F6',\n                  border: '1px solid #D1D5DB',\n                  borderRadius: '8px',\n                  fontSize: '14px',\n                  fontWeight: '500',\n                  color: '#1F2937'\n                }}>\n                  {formatStatusLabel(previousStatus)}\n                </div>\n              </div>\n\n              {/* Warning Message */}\n              <div style={{\n                padding: '12px',\n                backgroundColor: '#FEF3C7',\n                border: '1px solid #FCD34D',\n                borderRadius: '8px',\n                marginBottom: '16px'\n              }}>\n                <p style={{ fontSize: '14px', color: '#92400E', margin: 0, fontWeight: '500' }}>\n                  âš ï¸ Do you confirm to shift the order status to <strong>{formatStatusLabel(previousStatus)}</strong>?\n                </p>\n              </div>\n\n              {/* Notes field (optional) */}\n              {data.fields?.find(f => f.name === 'notes') && (\n                <div className=\"vendor-action-panel__field\">\n                  <label className=\"vendor-action-panel__label\">\n                    {data.fields.find(f => f.name === 'notes').label}\n                  </label>\n                  <textarea\n                    className={cn(\n                      'vendor-action-panel__input',\n                      formErrors.notes && 'is-error',\n                    )}\n                    value={formData.notes || ''}\n                    onChange={(e) => handleFormChange('notes', e.target.value)}\n                    placeholder=\"Enter notes (optional)\"\n                    rows={4}\n                  />\n                </div>\n              )}\n\n              <div className=\"vendor-action-panel__actions\">\n                <button type=\"button\" onClick={onClose} className=\"vendor-action-panel__button is-secondary\">\n                  Cancel\n                </button>\n                <button type=\"button\" onClick={handleSubmit} className=\"vendor-action-panel__button is-primary\">\n                  Confirm\n                </button>\n              </div>\n            </div>\n          )\n        }\n\n        // Normal update UI (existing logic)\n        return (\n          <div className=\"vendor-action-panel__form\">\n            {renderOrderInfo()}\n            {data.fields?.map((field) => (\n              <div key={field.name} className=\"vendor-action-panel__field\">\n                <label className=\"vendor-action-panel__label\">\n                  {field.label}\n                  {field.required && <span className=\"vendor-action-panel__required\">*</span>}\n                </label>\n                {field.type === 'textarea' ? (\n                  <textarea\n                    className={cn(\n                      'vendor-action-panel__input',\n                      formErrors[field.name] && 'is-error',\n                    )}\n                    value={formData[field.name] || field.value || ''}\n                    onChange={(e) => handleFormChange(field.name, e.target.value)}\n                    placeholder={`Enter ${field.label.toLowerCase()}`}\n                    rows={4}\n                  />\n                ) : field.type === 'select' ? (\n                  (() => {\n                    // Get options from field or from additionalData (for dynamic options like bank accounts)\n                    let filteredOptions = []\n                    if (field.name === 'bankAccountId' && data.bankAccountOptions) {\n                      filteredOptions = data.bankAccountOptions\n                    } else if (field.options) {\n                      filteredOptions = field.options\n                    }\n\n                    // For status field, filter to only show current and next status\n                    if (field.name === 'status' && orderInfo) {\n                      const normalizeStatus = (status) => {\n                        if (!status) return 'awaiting'\n                        const normalized = status.toLowerCase()\n                        if (normalized === 'fully_paid') return 'fully_paid'\n                        if (normalized === 'delivered') return 'delivered'\n                        if (normalized === 'dispatched' || normalized === 'out_for_delivery') return 'dispatched'\n                        if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n                        if (normalized === 'awaiting' || normalized === 'pending') return 'awaiting'\n                        return 'awaiting'\n                      }\n\n                      const currentStatus = normalizeStatus(orderInfo.status)\n                      const paymentPreference = orderInfo.paymentPreference || 'partial'\n                      const isInGracePeriod = orderInfo.statusUpdateGracePeriod?.isActive\n\n                      // Define status flow based on payment preference\n                      const statusFlow = paymentPreference === 'partial'\n                        ? ['awaiting', 'accepted', 'dispatched', 'delivered', 'fully_paid']\n                        : ['awaiting', 'accepted', 'dispatched', 'delivered']\n\n                      const currentIndex = statusFlow.indexOf(currentStatus)\n\n                      if (currentIndex >= 0 && !isInGracePeriod) {\n                        // Only show current status and next status\n                        const nextIndex = currentIndex + 1\n                        const allowedStatuses = [\n                          statusFlow[currentIndex], // Current status\n                          ...(nextIndex < statusFlow.length ? [statusFlow[nextIndex]] : []) // Next status if exists\n                        ]\n\n                        filteredOptions = field.options.filter((option) => {\n                          const optionValue = typeof option === 'object' ? option.value : option\n                          return allowedStatuses.includes(optionValue)\n                        })\n                      } else if (isInGracePeriod) {\n                        // During grace period, only show current status (for reverting)\n                        filteredOptions = field.options.filter((option) => {\n                          const optionValue = typeof option === 'object' ? option.value : option\n                          return optionValue === currentStatus\n                        })\n                      }\n                    }\n\n                    return (\n                      <select\n                        className={cn(\n                          'vendor-action-panel__input',\n                          formErrors[field.name] && 'is-error',\n                        )}\n                        value={formData[field.name] || field.value || ''}\n                        onChange={(e) => handleFormChange(field.name, e.target.value)}\n                        required={field.required}\n                      >\n                        {filteredOptions.length === 0 ? (\n                          <option value=\"\">{field.placeholder || 'No options available'}</option>\n                        ) : (\n                          <>\n                            {!formData[field.name] && !field.value && (\n                              <option value=\"\">{field.placeholder || 'Select an option'}</option>\n                            )}\n                            {filteredOptions.map((option) => {\n                              // Handle both string and object options\n                              const optionValue = typeof option === 'object' ? option.value : option\n                              const optionLabel = typeof option === 'object' ? option.label : option.charAt(0).toUpperCase() + option.slice(1)\n\n                              return (\n                                <option key={optionValue} value={optionValue}>\n                                  {optionLabel}\n                                </option>\n                              )\n                            })}\n                          </>\n                        )}\n                      </select>\n                    )\n                  })()\n                ) : field.type === 'file' ? (\n                  <div className=\"vendor-action-panel__file-field\">\n                    <input\n                      ref={field.name === 'attachment' ? fileInputRef : null}\n                      type=\"file\"\n                      accept={field.accept || '.pdf,.jpg,.jpeg,.png,.doc,.docx'}\n                      onChange={(e) => {\n                        const file = e.target.files?.[0]\n                        if (file) {\n                          handleFormChange(field.name, file.name)\n                          handleFormChange(`${field.name}_file`, file)\n                        }\n                      }}\n                      className=\"vendor-action-panel__file-input\"\n                      style={{ display: 'none' }}\n                    />\n                    {formData[`${field.name}_file`] ? (\n                      <div className=\"vendor-action-panel__file-preview\">\n                        <div className=\"vendor-action-panel__file-info\">\n                          <span className=\"vendor-action-panel__file-icon\">ðŸ“„</span>\n                          <div className=\"vendor-action-panel__file-details\">\n                            <p className=\"vendor-action-panel__file-name\">{formData[field.name]}</p>\n                            <p className=\"vendor-action-panel__file-size\">\n                              {(formData[`${field.name}_file`].size / 1024).toFixed(2)} KB\n                            </p>\n                          </div>\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              handleFormChange(field.name, '')\n                              handleFormChange(`${field.name}_file`, null)\n                            }}\n                            className=\"vendor-action-panel__file-remove\"\n                          >\n                            âœ•\n                          </button>\n                        </div>\n                      </div>\n                    ) : (\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          const input = field.name === 'attachment' ? fileInputRef.current : document.createElement('input')\n                          input.type = 'file'\n                          input.accept = field.accept || '.pdf,.jpg,.jpeg,.png,.doc,.docx'\n                          input.onchange = (e) => {\n                            const file = e.target.files?.[0]\n                            if (file) {\n                              handleFormChange(field.name, file.name)\n                              handleFormChange(`${field.name}_file`, file)\n                            }\n                          }\n                          input.click()\n                        }}\n                        className=\"vendor-action-panel__file-select-button\"\n                      >\n                        Choose File\n                      </button>\n                    )}\n                  </div>\n                ) : (\n                  <>\n                    <input\n                      type={field.type}\n                      className={cn(\n                        'vendor-action-panel__input',\n                        formErrors[field.name] && 'is-error',\n                        field.type === 'number' && 'vendor-action-panel__input--no-spinner',\n                      )}\n                      value={formData[field.name] || field.value || ''}\n                      onChange={(e) => {\n                        const value = e.target.value\n                        // For withdrawal amount, prevent entering more than available balance\n                        if (field.name === 'amount' && data?.availableBalance) {\n                          const numValue = parseFloat(value)\n                          if (!isNaN(numValue) && numValue > data.availableBalance) {\n                            // Don't update if exceeds available balance\n                            return\n                          }\n                        }\n                        // For repayment amount, automatically cap to creditUsed (keep decimal values)\n                        if (field.name === 'amount' && buttonId === 'repay-credit' && data?.creditUsed) {\n                          const numValue = parseFloat(value)\n                          if (!isNaN(numValue) && numValue > data.creditUsed) {\n                            // If value exceeds max, set to exact max value (can be decimal)\n                            handleFormChange(field.name, data.creditUsed.toString())\n                            return\n                          }\n                        }\n                        handleFormChange(field.name, value)\n                      }}\n                      placeholder={field.placeholder || `Enter ${field.label.toLowerCase()}`}\n                      min={field.min}\n                      max={field.max !== undefined ? field.max : (\n                        data?.availableBalance && field.name === 'amount' ? data.availableBalance :\n                          buttonId === 'repay-credit' && data?.creditUsed && field.name === 'amount' ? data.creditUsed :\n                            undefined\n                      )}\n                      required={field.required}\n                    />\n                    {field.name === 'amount' && data?.availableBalance && (\n                      <p style={{ fontSize: '0.75rem', color: '#666', marginTop: '0.25rem' }}>\n                        Available balance: â‚¹{Math.round(data.availableBalance).toLocaleString('en-IN')}\n                      </p>\n                    )}\n                    {field.name === 'amount' && buttonId === 'repay-credit' && data?.creditUsed && (\n                      <p style={{ fontSize: '0.75rem', color: '#666', marginTop: '0.25rem' }}>\n                        Maximum: â‚¹{data.creditUsed.toLocaleString('en-IN', { maximumFractionDigits: 2 })} (Outstanding credit)\n                      </p>\n                    )}\n                  </>\n                )}\n                {formErrors[field.name] && (\n                  <span className=\"vendor-action-panel__error\">{formErrors[field.name]}</span>\n                )}\n              </div>\n            ))}\n            <div className=\"vendor-action-panel__actions\">\n              <button type=\"button\" onClick={onClose} className=\"vendor-action-panel__button is-secondary\">\n                Cancel\n              </button>\n              <button type=\"button\" onClick={handleSubmit} className=\"vendor-action-panel__button is-primary\">\n                {data.type === 'admin_request' ? 'Send Request' :\n                  buttonId === 'repay-credit' ? 'Repay' :\n                    'Update'}\n              </button>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":316,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":316,"endColumn":124,"suggestions":[{"messageId":"addBrackets","fix":{"range":[11026,27312],"text":"{ const isRevert = data?.revert === true && buttonId === 'update-order-status'\n        const previousStatus = isRevert ? (orderInfo?.statusUpdateGracePeriod?.previousStatus || data?.status || '') : null\n\n        // If it's a revert, show special revert confirmation UI\n        if (isRevert && previousStatus) {\n          const formatStatusLabel = (status) => {\n            if (!status) return ''\n            const normalized = status.toLowerCase()\n            if (normalized === 'fully_paid') return 'Fully Paid'\n            if (normalized === 'delivered') return 'Delivered'\n            if (normalized === 'dispatched' || normalized === 'out_for_delivery') return 'Dispatched'\n            if (normalized === 'accepted' || normalized === 'processing') return 'Accepted'\n            if (normalized === 'awaiting' || normalized === 'pending') return 'Awaiting'\n            return status.charAt(0).toUpperCase() + status.slice(1).replace(/_/g, ' ')\n          }\n\n          return (\n            <div className=\"vendor-action-panel__form\">\n              {renderOrderInfo()}\n\n              {/* Previous Status Display */}\n              <div className=\"vendor-action-panel__field\">\n                <label className=\"vendor-action-panel__label\">\n                  Previous Status\n                  <span className=\"vendor-action-panel__required\">*</span>\n                </label>\n                <div style={{\n                  padding: '12px',\n                  backgroundColor: '#F3F4F6',\n                  border: '1px solid #D1D5DB',\n                  borderRadius: '8px',\n                  fontSize: '14px',\n                  fontWeight: '500',\n                  color: '#1F2937'\n                }}>\n                  {formatStatusLabel(previousStatus)}\n                </div>\n              </div>\n\n              {/* Warning Message */}\n              <div style={{\n                padding: '12px',\n                backgroundColor: '#FEF3C7',\n                border: '1px solid #FCD34D',\n                borderRadius: '8px',\n                marginBottom: '16px'\n              }}>\n                <p style={{ fontSize: '14px', color: '#92400E', margin: 0, fontWeight: '500' }}>\n                  âš ï¸ Do you confirm to shift the order status to <strong>{formatStatusLabel(previousStatus)}</strong>?\n                </p>\n              </div>\n\n              {/* Notes field (optional) */}\n              {data.fields?.find(f => f.name === 'notes') && (\n                <div className=\"vendor-action-panel__field\">\n                  <label className=\"vendor-action-panel__label\">\n                    {data.fields.find(f => f.name === 'notes').label}\n                  </label>\n                  <textarea\n                    className={cn(\n                      'vendor-action-panel__input',\n                      formErrors.notes && 'is-error',\n                    )}\n                    value={formData.notes || ''}\n                    onChange={(e) => handleFormChange('notes', e.target.value)}\n                    placeholder=\"Enter notes (optional)\"\n                    rows={4}\n                  />\n                </div>\n              )}\n\n              <div className=\"vendor-action-panel__actions\">\n                <button type=\"button\" onClick={onClose} className=\"vendor-action-panel__button is-secondary\">\n                  Cancel\n                </button>\n                <button type=\"button\" onClick={handleSubmit} className=\"vendor-action-panel__button is-primary\">\n                  Confirm\n                </button>\n              </div>\n            </div>\n          )\n        }\n\n        // Normal update UI (existing logic)\n        return (\n          <div className=\"vendor-action-panel__form\">\n            {renderOrderInfo()}\n            {data.fields?.map((field) => (\n              <div key={field.name} className=\"vendor-action-panel__field\">\n                <label className=\"vendor-action-panel__label\">\n                  {field.label}\n                  {field.required && <span className=\"vendor-action-panel__required\">*</span>}\n                </label>\n                {field.type === 'textarea' ? (\n                  <textarea\n                    className={cn(\n                      'vendor-action-panel__input',\n                      formErrors[field.name] && 'is-error',\n                    )}\n                    value={formData[field.name] || field.value || ''}\n                    onChange={(e) => handleFormChange(field.name, e.target.value)}\n                    placeholder={`Enter ${field.label.toLowerCase()}`}\n                    rows={4}\n                  />\n                ) : field.type === 'select' ? (\n                  (() => {\n                    // Get options from field or from additionalData (for dynamic options like bank accounts)\n                    let filteredOptions = []\n                    if (field.name === 'bankAccountId' && data.bankAccountOptions) {\n                      filteredOptions = data.bankAccountOptions\n                    } else if (field.options) {\n                      filteredOptions = field.options\n                    }\n\n                    // For status field, filter to only show current and next status\n                    if (field.name === 'status' && orderInfo) {\n                      const normalizeStatus = (status) => {\n                        if (!status) return 'awaiting'\n                        const normalized = status.toLowerCase()\n                        if (normalized === 'fully_paid') return 'fully_paid'\n                        if (normalized === 'delivered') return 'delivered'\n                        if (normalized === 'dispatched' || normalized === 'out_for_delivery') return 'dispatched'\n                        if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n                        if (normalized === 'awaiting' || normalized === 'pending') return 'awaiting'\n                        return 'awaiting'\n                      }\n\n                      const currentStatus = normalizeStatus(orderInfo.status)\n                      const paymentPreference = orderInfo.paymentPreference || 'partial'\n                      const isInGracePeriod = orderInfo.statusUpdateGracePeriod?.isActive\n\n                      // Define status flow based on payment preference\n                      const statusFlow = paymentPreference === 'partial'\n                        ? ['awaiting', 'accepted', 'dispatched', 'delivered', 'fully_paid']\n                        : ['awaiting', 'accepted', 'dispatched', 'delivered']\n\n                      const currentIndex = statusFlow.indexOf(currentStatus)\n\n                      if (currentIndex >= 0 && !isInGracePeriod) {\n                        // Only show current status and next status\n                        const nextIndex = currentIndex + 1\n                        const allowedStatuses = [\n                          statusFlow[currentIndex], // Current status\n                          ...(nextIndex < statusFlow.length ? [statusFlow[nextIndex]] : []) // Next status if exists\n                        ]\n\n                        filteredOptions = field.options.filter((option) => {\n                          const optionValue = typeof option === 'object' ? option.value : option\n                          return allowedStatuses.includes(optionValue)\n                        })\n                      } else if (isInGracePeriod) {\n                        // During grace period, only show current status (for reverting)\n                        filteredOptions = field.options.filter((option) => {\n                          const optionValue = typeof option === 'object' ? option.value : option\n                          return optionValue === currentStatus\n                        })\n                      }\n                    }\n\n                    return (\n                      <select\n                        className={cn(\n                          'vendor-action-panel__input',\n                          formErrors[field.name] && 'is-error',\n                        )}\n                        value={formData[field.name] || field.value || ''}\n                        onChange={(e) => handleFormChange(field.name, e.target.value)}\n                        required={field.required}\n                      >\n                        {filteredOptions.length === 0 ? (\n                          <option value=\"\">{field.placeholder || 'No options available'}</option>\n                        ) : (\n                          <>\n                            {!formData[field.name] && !field.value && (\n                              <option value=\"\">{field.placeholder || 'Select an option'}</option>\n                            )}\n                            {filteredOptions.map((option) => {\n                              // Handle both string and object options\n                              const optionValue = typeof option === 'object' ? option.value : option\n                              const optionLabel = typeof option === 'object' ? option.label : option.charAt(0).toUpperCase() + option.slice(1)\n\n                              return (\n                                <option key={optionValue} value={optionValue}>\n                                  {optionLabel}\n                                </option>\n                              )\n                            })}\n                          </>\n                        )}\n                      </select>\n                    )\n                  })()\n                ) : field.type === 'file' ? (\n                  <div className=\"vendor-action-panel__file-field\">\n                    <input\n                      ref={field.name === 'attachment' ? fileInputRef : null}\n                      type=\"file\"\n                      accept={field.accept || '.pdf,.jpg,.jpeg,.png,.doc,.docx'}\n                      onChange={(e) => {\n                        const file = e.target.files?.[0]\n                        if (file) {\n                          handleFormChange(field.name, file.name)\n                          handleFormChange(`${field.name}_file`, file)\n                        }\n                      }}\n                      className=\"vendor-action-panel__file-input\"\n                      style={{ display: 'none' }}\n                    />\n                    {formData[`${field.name}_file`] ? (\n                      <div className=\"vendor-action-panel__file-preview\">\n                        <div className=\"vendor-action-panel__file-info\">\n                          <span className=\"vendor-action-panel__file-icon\">ðŸ“„</span>\n                          <div className=\"vendor-action-panel__file-details\">\n                            <p className=\"vendor-action-panel__file-name\">{formData[field.name]}</p>\n                            <p className=\"vendor-action-panel__file-size\">\n                              {(formData[`${field.name}_file`].size / 1024).toFixed(2)} KB\n                            </p>\n                          </div>\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              handleFormChange(field.name, '')\n                              handleFormChange(`${field.name}_file`, null)\n                            }}\n                            className=\"vendor-action-panel__file-remove\"\n                          >\n                            âœ•\n                          </button>\n                        </div>\n                      </div>\n                    ) : (\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          const input = field.name === 'attachment' ? fileInputRef.current : document.createElement('input')\n                          input.type = 'file'\n                          input.accept = field.accept || '.pdf,.jpg,.jpeg,.png,.doc,.docx'\n                          input.onchange = (e) => {\n                            const file = e.target.files?.[0]\n                            if (file) {\n                              handleFormChange(field.name, file.name)\n                              handleFormChange(`${field.name}_file`, file)\n                            }\n                          }\n                          input.click()\n                        }}\n                        className=\"vendor-action-panel__file-select-button\"\n                      >\n                        Choose File\n                      </button>\n                    )}\n                  </div>\n                ) : (\n                  <>\n                    <input\n                      type={field.type}\n                      className={cn(\n                        'vendor-action-panel__input',\n                        formErrors[field.name] && 'is-error',\n                        field.type === 'number' && 'vendor-action-panel__input--no-spinner',\n                      )}\n                      value={formData[field.name] || field.value || ''}\n                      onChange={(e) => {\n                        const value = e.target.value\n                        // For withdrawal amount, prevent entering more than available balance\n                        if (field.name === 'amount' && data?.availableBalance) {\n                          const numValue = parseFloat(value)\n                          if (!isNaN(numValue) && numValue > data.availableBalance) {\n                            // Don't update if exceeds available balance\n                            return\n                          }\n                        }\n                        // For repayment amount, automatically cap to creditUsed (keep decimal values)\n                        if (field.name === 'amount' && buttonId === 'repay-credit' && data?.creditUsed) {\n                          const numValue = parseFloat(value)\n                          if (!isNaN(numValue) && numValue > data.creditUsed) {\n                            // If value exceeds max, set to exact max value (can be decimal)\n                            handleFormChange(field.name, data.creditUsed.toString())\n                            return\n                          }\n                        }\n                        handleFormChange(field.name, value)\n                      }}\n                      placeholder={field.placeholder || `Enter ${field.label.toLowerCase()}`}\n                      min={field.min}\n                      max={field.max !== undefined ? field.max : (\n                        data?.availableBalance && field.name === 'amount' ? data.availableBalance :\n                          buttonId === 'repay-credit' && data?.creditUsed && field.name === 'amount' ? data.creditUsed :\n                            undefined\n                      )}\n                      required={field.required}\n                    />\n                    {field.name === 'amount' && data?.availableBalance && (\n                      <p style={{ fontSize: '0.75rem', color: '#666', marginTop: '0.25rem' }}>\n                        Available balance: â‚¹{Math.round(data.availableBalance).toLocaleString('en-IN')}\n                      </p>\n                    )}\n                    {field.name === 'amount' && buttonId === 'repay-credit' && data?.creditUsed && (\n                      <p style={{ fontSize: '0.75rem', color: '#666', marginTop: '0.25rem' }}>\n                        Maximum: â‚¹{data.creditUsed.toLocaleString('en-IN', { maximumFractionDigits: 2 })} (Outstanding credit)\n                      </p>\n                    )}\n                  </>\n                )}\n                {formErrors[field.name] && (\n                  <span className=\"vendor-action-panel__error\">{formErrors[field.name]}</span>\n                )}\n              </div>\n            ))}\n            <div className=\"vendor-action-panel__actions\">\n              <button type=\"button\" onClick={onClose} className=\"vendor-action-panel__button is-secondary\">\n                Cancel\n              </button>\n              <button type=\"button\" onClick={handleSubmit} className=\"vendor-action-panel__button is-primary\">\n                {data.type === 'admin_request' ? 'Send Request' :\n                  buttonId === 'repay-credit' ? 'Repay' :\n                    'Update'}\n              </button>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'buttonId' is defined but never used.","line":754,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":754,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"buttonId"},"fix":{"range":[31963,31973],"text":""},"desc":"Remove unused variable 'buttonId'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'getRepaymentHistory'. Either include it or remove the dependency array.","line":796,"column":6,"nodeType":"ArrayExpression","endLine":796,"endColumn":67,"suggestions":[{"desc":"Update the dependencies array to be: [data.type, getCreditInfo, getWithdrawals, getInventoryStats, getRepaymentHistory]","fix":{"range":[33614,33675],"text":"[data.type, getCreditInfo, getWithdrawals, getInventoryStats, getRepaymentHistory]"}}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":803,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":803,"endColumn":81,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":804,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":804,"endColumn":83,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":805,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":805,"endColumn":85,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":806,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":806,"endColumn":90,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":807,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":807,"endColumn":83,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":809,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":812,"endColumn":10,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":814,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":817,"endColumn":10,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":824,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":824,"endColumn":90,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":825,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":825,"endColumn":93,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":828,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":834,"endColumn":16,"suggestions":[{"messageId":"addBrackets","fix":{"range":[33862,39593],"text":"{ const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":905,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":908,"endColumn":10,"suggestions":[{"messageId":"addBrackets","fix":{"range":[39625,42107],"text":"{ const formatCurrency = (amount) => {\n          if (!amount) return 'â‚¹0'\n          return `â‚¹${Math.round(amount).toLocaleString('en-IN')}`\n        }\n\n        const formatPayoutDate = (date) => {\n          if (!date) return 'N/A'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading payouts...</p></div>\n        }\n\n        const withdrawals = withdrawalsData || []\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Recent Payouts</h5>\n              <div className=\"vendor-info-display__list\">\n                {withdrawals.length > 0 ? withdrawals.map((withdrawal, index) => {\n                  const status = withdrawal.status === 'approved' ? 'Completed' : withdrawal.status === 'pending' ? 'Pending' : withdrawal.status === 'rejected' ? 'Rejected' : withdrawal.status\n                  return (\n                    <div key={withdrawal._id || withdrawal.id || index} className=\"vendor-info-display__item\">\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Date</p>\n                        <p className=\"vendor-info-display__item-value\">{formatPayoutDate(withdrawal.requestedAt || withdrawal.createdAt)}</p>\n                      </div>\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Amount</p>\n                        <p className=\"vendor-info-display__item-value\">{formatCurrency(withdrawal.amount)}</p>\n                      </div>\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Status</p>\n                        <span className={cn('vendor-info-display__item-badge', status === 'Completed' || status === 'approved' ? 'is-success' : status === 'Pending' || status === 'pending' ? 'is-pending' : 'is-error')}>\n                          {status}\n                        </span>\n                      </div>\n                    </div>\n                  )\n                }) : (\n                  <div className=\"vendor-info-display__item\">\n                    <p className=\"text-sm text-gray-500\">No withdrawals yet</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":910,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":913,"endColumn":10,"suggestions":[{"messageId":"addBrackets","fix":{"range":[39625,42107],"text":"{ const formatCurrency = (amount) => {\n          if (!amount) return 'â‚¹0'\n          return `â‚¹${Math.round(amount).toLocaleString('en-IN')}`\n        }\n\n        const formatPayoutDate = (date) => {\n          if (!date) return 'N/A'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading payouts...</p></div>\n        }\n\n        const withdrawals = withdrawalsData || []\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Recent Payouts</h5>\n              <div className=\"vendor-info-display__list\">\n                {withdrawals.length > 0 ? withdrawals.map((withdrawal, index) => {\n                  const status = withdrawal.status === 'approved' ? 'Completed' : withdrawal.status === 'pending' ? 'Pending' : withdrawal.status === 'rejected' ? 'Rejected' : withdrawal.status\n                  return (\n                    <div key={withdrawal._id || withdrawal.id || index} className=\"vendor-info-display__item\">\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Date</p>\n                        <p className=\"vendor-info-display__item-value\">{formatPayoutDate(withdrawal.requestedAt || withdrawal.createdAt)}</p>\n                      </div>\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Amount</p>\n                        <p className=\"vendor-info-display__item-value\">{formatCurrency(withdrawal.amount)}</p>\n                      </div>\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Status</p>\n                        <span className={cn('vendor-info-display__item-badge', status === 'Completed' || status === 'approved' ? 'is-success' : status === 'Pending' || status === 'pending' ? 'is-pending' : 'is-error')}>\n                          {status}\n                        </span>\n                      </div>\n                    </div>\n                  )\n                }) : (\n                  <div className=\"vendor-info-display__item\">\n                    <p className=\"text-sm text-gray-500\">No withdrawals yet</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":919,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":919,"endColumn":50,"suggestions":[{"messageId":"addBrackets","fix":{"range":[39625,42107],"text":"{ const formatCurrency = (amount) => {\n          if (!amount) return 'â‚¹0'\n          return `â‚¹${Math.round(amount).toLocaleString('en-IN')}`\n        }\n\n        const formatPayoutDate = (date) => {\n          if (!date) return 'N/A'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading payouts...</p></div>\n        }\n\n        const withdrawals = withdrawalsData || []\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Recent Payouts</h5>\n              <div className=\"vendor-info-display__list\">\n                {withdrawals.length > 0 ? withdrawals.map((withdrawal, index) => {\n                  const status = withdrawal.status === 'approved' ? 'Completed' : withdrawal.status === 'pending' ? 'Pending' : withdrawal.status === 'rejected' ? 'Rejected' : withdrawal.status\n                  return (\n                    <div key={withdrawal._id || withdrawal.id || index} className=\"vendor-info-display__item\">\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Date</p>\n                        <p className=\"vendor-info-display__item-value\">{formatPayoutDate(withdrawal.requestedAt || withdrawal.createdAt)}</p>\n                      </div>\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Amount</p>\n                        <p className=\"vendor-info-display__item-value\">{formatCurrency(withdrawal.amount)}</p>\n                      </div>\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Status</p>\n                        <span className={cn('vendor-info-display__item-badge', status === 'Completed' || status === 'approved' ? 'is-success' : status === 'Pending' || status === 'pending' ? 'is-pending' : 'is-error')}>\n                          {status}\n                        </span>\n                      </div>\n                    </div>\n                  )\n                }) : (\n                  <div className=\"vendor-info-display__item\">\n                    <p className=\"text-sm text-gray-500\">No withdrawals yet</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":962,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":962,"endColumn":118,"suggestions":[{"messageId":"addBrackets","fix":{"range":[42139,43663],"text":"{ if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading reorder information...</p></div>\n        }\n\n        // Use real inventory stats from backend or dashboard\n        const lowStockCount = inventoryStatsData?.lowStockCount || dashboard?.overview?.inventory?.lowStockCount || 0\n        const criticalStockCount = inventoryStatsData?.criticalStockCount || dashboard?.overview?.inventory?.criticalStockCount || 0\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Reorder Information</h5>\n              <div className=\"vendor-info-display__content\">\n                <p>Items requiring reorder based on current stock levels and safety buffers.</p>\n                <div className=\"vendor-info-display__metrics\">\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Critical Items</span>\n                    <span className=\"vendor-info-display__metric-value\">{criticalStockCount}</span>\n                  </div>\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Low Stock Items</span>\n                    <span className=\"vendor-info-display__metric-value\">{lowStockCount}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":963,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":963,"endColumn":133,"suggestions":[{"messageId":"addBrackets","fix":{"range":[42139,43663],"text":"{ if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading reorder information...</p></div>\n        }\n\n        // Use real inventory stats from backend or dashboard\n        const lowStockCount = inventoryStatsData?.lowStockCount || dashboard?.overview?.inventory?.lowStockCount || 0\n        const criticalStockCount = inventoryStatsData?.criticalStockCount || dashboard?.overview?.inventory?.criticalStockCount || 0\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Reorder Information</h5>\n              <div className=\"vendor-info-display__content\">\n                <p>Items requiring reorder based on current stock levels and safety buffers.</p>\n                <div className=\"vendor-info-display__metrics\">\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Critical Items</span>\n                    <span className=\"vendor-info-display__metric-value\">{criticalStockCount}</span>\n                  </div>\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Low Stock Items</span>\n                    <span className=\"vendor-info-display__metric-value\">{lowStockCount}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":992,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":992,"endColumn":118,"suggestions":[{"messageId":"addBrackets","fix":{"range":[43700,45499],"text":"{ if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading stock report...</p></div>\n        }\n\n        // Use real inventory stats from backend or dashboard\n        const totalProducts = inventoryStatsData?.totalProducts || dashboard?.overview?.inventory?.totalProducts || 0\n        const inStockCount = inventoryStatsData?.inStockCount || dashboard?.overview?.inventory?.inStockCount || 0\n        const averageStockHealth = totalProducts > 0 ? Math.round((inStockCount / totalProducts) * 100) : 0\n        const reorderPoints = inventoryStatsData?.reorderPoints || dashboard?.overview?.inventory?.lowStockCount || 0\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Stock Report Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Total SKUs</span>\n                  <span className=\"vendor-info-display__metric-value\">{totalProducts}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Average Stock Health</span>\n                  <span className=\"vendor-info-display__metric-value\">{averageStockHealth}%</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Reorder Points</span>\n                  <span className=\"vendor-info-display__metric-value\">{reorderPoints}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":993,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":993,"endColumn":115,"suggestions":[{"messageId":"addBrackets","fix":{"range":[43700,45499],"text":"{ if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading stock report...</p></div>\n        }\n\n        // Use real inventory stats from backend or dashboard\n        const totalProducts = inventoryStatsData?.totalProducts || dashboard?.overview?.inventory?.totalProducts || 0\n        const inStockCount = inventoryStatsData?.inStockCount || dashboard?.overview?.inventory?.inStockCount || 0\n        const averageStockHealth = totalProducts > 0 ? Math.round((inStockCount / totalProducts) * 100) : 0\n        const reorderPoints = inventoryStatsData?.reorderPoints || dashboard?.overview?.inventory?.lowStockCount || 0\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Stock Report Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Total SKUs</span>\n                  <span className=\"vendor-info-display__metric-value\">{totalProducts}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Average Stock Health</span>\n                  <span className=\"vendor-info-display__metric-value\">{averageStockHealth}%</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Reorder Points</span>\n                  <span className=\"vendor-info-display__metric-value\">{reorderPoints}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":994,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":994,"endColumn":108,"suggestions":[{"messageId":"addBrackets","fix":{"range":[43700,45499],"text":"{ if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading stock report...</p></div>\n        }\n\n        // Use real inventory stats from backend or dashboard\n        const totalProducts = inventoryStatsData?.totalProducts || dashboard?.overview?.inventory?.totalProducts || 0\n        const inStockCount = inventoryStatsData?.inStockCount || dashboard?.overview?.inventory?.inStockCount || 0\n        const averageStockHealth = totalProducts > 0 ? Math.round((inStockCount / totalProducts) * 100) : 0\n        const reorderPoints = inventoryStatsData?.reorderPoints || dashboard?.overview?.inventory?.lowStockCount || 0\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Stock Report Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Total SKUs</span>\n                  <span className=\"vendor-info-display__metric-value\">{totalProducts}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Average Stock Health</span>\n                  <span className=\"vendor-info-display__metric-value\">{averageStockHealth}%</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Reorder Points</span>\n                  <span className=\"vendor-info-display__metric-value\">{reorderPoints}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":995,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":995,"endColumn":118,"suggestions":[{"messageId":"addBrackets","fix":{"range":[43700,45499],"text":"{ if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading stock report...</p></div>\n        }\n\n        // Use real inventory stats from backend or dashboard\n        const totalProducts = inventoryStatsData?.totalProducts || dashboard?.overview?.inventory?.totalProducts || 0\n        const inStockCount = inventoryStatsData?.inStockCount || dashboard?.overview?.inventory?.inStockCount || 0\n        const averageStockHealth = totalProducts > 0 ? Math.round((inStockCount / totalProducts) * 100) : 0\n        const reorderPoints = inventoryStatsData?.reorderPoints || dashboard?.overview?.inventory?.lowStockCount || 0\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Stock Report Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Total SKUs</span>\n                  <span className=\"vendor-info-display__metric-value\">{totalProducts}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Average Stock Health</span>\n                  <span className=\"vendor-info-display__metric-value\">{averageStockHealth}%</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Reorder Points</span>\n                  <span className=\"vendor-info-display__metric-value\">{reorderPoints}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        ) }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'buttonId' is defined but never used.","line":1028,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":1028,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"buttonId"},"fix":{"range":[45717,45727],"text":""},"desc":"Remove unused variable 'buttonId'."}]}],"suppressedMessages":[],"errorCount":23,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect, useCallback } from 'react'\nimport { Package } from 'lucide-react'\nimport { cn } from '../../../lib/cn'\nimport { BUTTON_INTENT } from '../hooks/useButtonAction'\nimport { useVendorApi } from '../hooks/useVendorApi'\nimport { useVendorState } from '../context/VendorContext'\n\nexport function ButtonActionPanel({ action, isOpen, onClose, onAction, onShowNotification }) {\n  const [uploadedFile, setUploadedFile] = useState(null)\n  const [isDragging, setIsDragging] = useState(false)\n  const [formErrors, setFormErrors] = useState({})\n  const [orderInfo, setOrderInfo] = useState(null)\n  const fileInputRef = useRef(null)\n  const { getOrderDetails } = useVendorApi()\n  const { intent, title, data, buttonId } = action || {}\n\n  // Initialize formData from fields if they exist\n  const initializeFormData = useCallback(() => {\n    if (intent === BUTTON_INTENT.UPDATION && data?.fields) {\n      return data.fields.reduce((acc, field) => {\n        acc[field.name] = field.value || ''\n        return acc\n      }, {})\n    }\n    return {}\n  }, [intent, data])\n\n  const [formData, setFormData] = useState(initializeFormData)\n\n\n\n  // Fetch order details if orderId is present\n  useEffect(() => {\n    if (isOpen && data?.orderId && (buttonId === 'update-order-status' || buttonId === 'order-available' || buttonId === 'order-not-available')) {\n      getOrderDetails(data.orderId).then((result) => {\n        if (result.data?.order) {\n          setOrderInfo(result.data.order)\n        }\n      }).catch(() => {\n        setOrderInfo(null)\n      })\n    } else {\n      setOrderInfo(null)\n    }\n  }, [isOpen, data?.orderId, buttonId, getOrderDetails])\n\n  // Reset formData when action changes\n  useEffect(() => {\n    if (action && intent === BUTTON_INTENT.UPDATION) {\n      const newFormData = initializeFormData()\n      // Pre-fill bankAccountId if provided in data\n      if (data.bankAccountId && !newFormData.bankAccountId) {\n        newFormData.bankAccountId = data.bankAccountId\n      }\n      setFormData(newFormData)\n    }\n    setUploadedFile(null)\n  }, [buttonId, action, intent, initializeFormData, data])\n\n  const handleFormChange = (fieldName, value) => {\n    setFormData((prev) => ({\n      ...prev,\n      [fieldName]: value,\n    }))\n    // Clear error for this field when user starts typing\n    if (formErrors[fieldName]) {\n      setFormErrors((prev) => {\n        const newErrors = { ...prev }\n        delete newErrors[fieldName]\n        return newErrors\n      })\n    }\n  }\n\n  const validateField = (field, value) => {\n    if (field.required && !value) {\n      return `${field.label} is required`\n    }\n    if (field.type === 'number' && value) {\n      const numValue = parseFloat(value)\n      if (isNaN(numValue)) {\n        return `${field.label} must be a valid number`\n      }\n      if (field.min !== undefined && numValue < field.min) {\n        return `${field.label} must be at least ${field.min}`\n      }\n      // Check max from field or from data (for dynamic max like availableBalance or creditUsed)\n      const maxValue = field.max !== undefined ? field.max : (\n        data?.availableBalance && field.name === 'amount' ? data.availableBalance :\n          buttonId === 'repay-credit' && data?.creditUsed && field.name === 'amount' ? data.creditUsed :\n            undefined\n      )\n      if (maxValue !== undefined && numValue > maxValue) {\n        // For repay-credit, show exact max value (can be decimal)\n        if (buttonId === 'repay-credit' && field.name === 'amount') {\n          return `${field.label} must be at most â‚¹${maxValue.toLocaleString('en-IN', { maximumFractionDigits: 2 })}`\n        }\n        return `${field.label} must be at most â‚¹${Math.round(maxValue).toLocaleString('en-IN')}`\n      }\n    }\n    if (field.type === 'email' && value && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value)) {\n      return `${field.label} must be a valid email address`\n    }\n    return null\n  }\n\n  const handleFileUpload = (file) => {\n    if (!file) return\n\n    // Validate file type\n    if (data.accept) {\n      const acceptedTypes = data.accept.split(',').map((type) => type.trim())\n      const fileExtension = '.' + file.name.split('.').pop().toLowerCase()\n      const fileType = file.type\n\n      const isAccepted = acceptedTypes.some(\n        (acceptType) =>\n          fileExtension === acceptType ||\n          fileType === acceptType ||\n          (acceptType.startsWith('.') && fileExtension === acceptType.toLowerCase()),\n      )\n\n      if (!isAccepted) {\n        onShowNotification?.(\n          `File type not supported. Accepted types: ${data.accept}`,\n          'error',\n        )\n        return\n      }\n    }\n\n    // Validate file size\n    if (data.maxSize && file.size > data.maxSize) {\n      onShowNotification?.(\n        `File size exceeds ${data.maxSize / (1024 * 1024)}MB limit`,\n        'error',\n      )\n      return\n    }\n\n    setUploadedFile(file)\n    onShowNotification?.('File selected successfully', 'success')\n  }\n\n  const handleFileInputChange = (event) => {\n    const file = event.target.files?.[0]\n    handleFileUpload(file)\n  }\n\n  const handleDragOver = (event) => {\n    event.preventDefault()\n    event.stopPropagation()\n    setIsDragging(true)\n  }\n\n  const handleDragLeave = (event) => {\n    event.preventDefault()\n    event.stopPropagation()\n    setIsDragging(false)\n  }\n\n  const handleDrop = (event) => {\n    event.preventDefault()\n    event.stopPropagation()\n    setIsDragging(false)\n\n    const file = event.dataTransfer.files?.[0]\n    handleFileUpload(file)\n  }\n\n  const handleSubmit = () => {\n    if (intent === BUTTON_INTENT.UPDATION) {\n      // For repay-credit, cap amount to creditUsed if exceeds (keep decimal values)\n      let adjustedFormData = { ...formData }\n      if (buttonId === 'repay-credit' && formData.amount) {\n        const numAmount = parseFloat(formData.amount)\n\n        // If exceeds max, set to exact max value (can be decimal)\n        if (data?.creditUsed && numAmount > data.creditUsed) {\n          adjustedFormData.amount = data.creditUsed.toString()\n          // Update state immediately\n          setFormData(adjustedFormData)\n        }\n      }\n\n      // Validate all fields using adjusted form data\n      const errors = {}\n      let hasErrors = false\n\n      data.fields?.forEach((field) => {\n        const value = adjustedFormData[field.name] || field.value || ''\n        const error = validateField(field, value)\n        if (error) {\n          errors[field.name] = error\n          hasErrors = true\n        }\n      })\n\n      if (hasErrors) {\n        setFormErrors(errors)\n        onShowNotification?.('Please fix the errors in the form', 'error')\n        return\n      }\n\n      const submissionData = { ...adjustedFormData }\n      // Preserve orderId and other metadata from action.data (passed via openPanel)\n      // Always include these if they exist in action.data, even if they're in formData\n      if (data?.orderId) {\n        submissionData.orderId = data.orderId\n      }\n      if (data?.itemId) {\n        submissionData.itemId = data.itemId\n      }\n      if (data?.currentStock !== undefined) {\n        submissionData.currentStock = data.currentStock\n      }\n      // For revert action, ensure status is set to previous status\n      if (data?.revert === true && buttonId === 'update-order-status' && data?.status) {\n        submissionData.status = data.status\n        submissionData.isRevert = true\n      }\n      // For withdrawal requests, include bankAccounts and availableBalance\n      if (buttonId === 'request-withdrawal') {\n        submissionData.availableBalance = data.availableBalance\n        submissionData.bankAccounts = data.bankAccounts || []\n        // Ensure bankAccountId is included\n        if (!submissionData.bankAccountId && data.bankAccountId) {\n          submissionData.bankAccountId = data.bankAccountId\n        }\n      }\n      // For repayment requests, include credit information\n      // Bank account will be filled in Razorpay interface\n      if (buttonId === 'repay-credit') {\n        submissionData.creditUsed = data.creditUsed\n        submissionData.creditLimit = data.creditLimit\n        // Keep amount as-is (can be decimal), but ensure it doesn't exceed creditUsed\n        if (submissionData.amount && data?.creditUsed) {\n          const amount = parseFloat(submissionData.amount)\n          if (amount > data.creditUsed) {\n            submissionData.amount = data.creditUsed\n          }\n        }\n        // For repayment, let the handler manage the flow (payment intent, Razorpay, etc.)\n        // Don't close panel or show success message here - handler will do that\n        onAction?.({ type: 'update', data: submissionData, buttonId })\n        return // Don't close panel or show default success for repayment\n      }\n      // Simulate API call\n      onAction?.({ type: 'update', data: submissionData, buttonId })\n      onShowNotification?.('Changes saved successfully', 'success')\n      onClose()\n    } else if (intent === BUTTON_INTENT.FILE_UPLOAD) {\n      if (!uploadedFile) {\n        onShowNotification?.('Please select a file to upload', 'error')\n        return\n      }\n      // Simulate upload\n      onAction?.({ type: 'upload', file: uploadedFile, buttonId })\n      onShowNotification?.('File uploaded successfully', 'success')\n      onClose()\n    } else if (intent === BUTTON_INTENT.INSTANT_ACTION) {\n      // Include data (like orderId) when confirming instant actions\n      onAction?.({ type: 'confirm', buttonId, data: data || {} })\n      onShowNotification?.('Action completed successfully', 'success')\n      onClose()\n    }\n  }\n\n  const handleCancel = () => {\n    if (intent === BUTTON_INTENT.INSTANT_ACTION) {\n      onAction?.({ type: 'cancel', buttonId })\n      onShowNotification?.('Action cancelled', 'info')\n    }\n    onClose()\n  }\n\n  // Reset errors when panel closes\n  useEffect(() => {\n    if (!isOpen) {\n      setFormErrors({})\n      setUploadedFile(null)\n      setIsDragging(false)\n    }\n  }, [isOpen])\n\n  if (!action) return null\n\n  const renderContent = () => {\n    // Helper to render order customer info\n    const renderOrderInfo = () => {\n      if (!orderInfo && !data?.orderId) return null\n      const order = orderInfo || {}\n      const customerName = order.userId?.name || order.farmer || 'Unknown'\n      const customerPhone = order.userId?.phone || order.customerPhone || 'N/A'\n\n      return (\n        <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-3 mb-4\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <Package className=\"h-4 w-4 text-gray-600\" />\n            <p className=\"text-sm font-semibold text-gray-900\">\n              Order #{order.orderNumber || order.id || data.orderId}\n            </p>\n          </div>\n          <div className=\"text-xs text-gray-600 space-y-1\">\n            <p>Customer: {customerName}</p>\n            <p>Contact: {customerPhone}</p>\n          </div>\n        </div>\n      )\n    }\n\n    switch (intent) {\n      case BUTTON_INTENT.UPDATION:\n        // Check if this is a revert action\n        const isRevert = data?.revert === true && buttonId === 'update-order-status'\n        const previousStatus = isRevert ? (orderInfo?.statusUpdateGracePeriod?.previousStatus || data?.status || '') : null\n\n        // If it's a revert, show special revert confirmation UI\n        if (isRevert && previousStatus) {\n          const formatStatusLabel = (status) => {\n            if (!status) return ''\n            const normalized = status.toLowerCase()\n            if (normalized === 'fully_paid') return 'Fully Paid'\n            if (normalized === 'delivered') return 'Delivered'\n            if (normalized === 'dispatched' || normalized === 'out_for_delivery') return 'Dispatched'\n            if (normalized === 'accepted' || normalized === 'processing') return 'Accepted'\n            if (normalized === 'awaiting' || normalized === 'pending') return 'Awaiting'\n            return status.charAt(0).toUpperCase() + status.slice(1).replace(/_/g, ' ')\n          }\n\n          return (\n            <div className=\"vendor-action-panel__form\">\n              {renderOrderInfo()}\n\n              {/* Previous Status Display */}\n              <div className=\"vendor-action-panel__field\">\n                <label className=\"vendor-action-panel__label\">\n                  Previous Status\n                  <span className=\"vendor-action-panel__required\">*</span>\n                </label>\n                <div style={{\n                  padding: '12px',\n                  backgroundColor: '#F3F4F6',\n                  border: '1px solid #D1D5DB',\n                  borderRadius: '8px',\n                  fontSize: '14px',\n                  fontWeight: '500',\n                  color: '#1F2937'\n                }}>\n                  {formatStatusLabel(previousStatus)}\n                </div>\n              </div>\n\n              {/* Warning Message */}\n              <div style={{\n                padding: '12px',\n                backgroundColor: '#FEF3C7',\n                border: '1px solid #FCD34D',\n                borderRadius: '8px',\n                marginBottom: '16px'\n              }}>\n                <p style={{ fontSize: '14px', color: '#92400E', margin: 0, fontWeight: '500' }}>\n                  âš ï¸ Do you confirm to shift the order status to <strong>{formatStatusLabel(previousStatus)}</strong>?\n                </p>\n              </div>\n\n              {/* Notes field (optional) */}\n              {data.fields?.find(f => f.name === 'notes') && (\n                <div className=\"vendor-action-panel__field\">\n                  <label className=\"vendor-action-panel__label\">\n                    {data.fields.find(f => f.name === 'notes').label}\n                  </label>\n                  <textarea\n                    className={cn(\n                      'vendor-action-panel__input',\n                      formErrors.notes && 'is-error',\n                    )}\n                    value={formData.notes || ''}\n                    onChange={(e) => handleFormChange('notes', e.target.value)}\n                    placeholder=\"Enter notes (optional)\"\n                    rows={4}\n                  />\n                </div>\n              )}\n\n              <div className=\"vendor-action-panel__actions\">\n                <button type=\"button\" onClick={onClose} className=\"vendor-action-panel__button is-secondary\">\n                  Cancel\n                </button>\n                <button type=\"button\" onClick={handleSubmit} className=\"vendor-action-panel__button is-primary\">\n                  Confirm\n                </button>\n              </div>\n            </div>\n          )\n        }\n\n        // Normal update UI (existing logic)\n        return (\n          <div className=\"vendor-action-panel__form\">\n            {renderOrderInfo()}\n            {data.fields?.map((field) => (\n              <div key={field.name} className=\"vendor-action-panel__field\">\n                <label className=\"vendor-action-panel__label\">\n                  {field.label}\n                  {field.required && <span className=\"vendor-action-panel__required\">*</span>}\n                </label>\n                {field.type === 'textarea' ? (\n                  <textarea\n                    className={cn(\n                      'vendor-action-panel__input',\n                      formErrors[field.name] && 'is-error',\n                    )}\n                    value={formData[field.name] || field.value || ''}\n                    onChange={(e) => handleFormChange(field.name, e.target.value)}\n                    placeholder={`Enter ${field.label.toLowerCase()}`}\n                    rows={4}\n                  />\n                ) : field.type === 'select' ? (\n                  (() => {\n                    // Get options from field or from additionalData (for dynamic options like bank accounts)\n                    let filteredOptions = []\n                    if (field.name === 'bankAccountId' && data.bankAccountOptions) {\n                      filteredOptions = data.bankAccountOptions\n                    } else if (field.options) {\n                      filteredOptions = field.options\n                    }\n\n                    // For status field, filter to only show current and next status\n                    if (field.name === 'status' && orderInfo) {\n                      const normalizeStatus = (status) => {\n                        if (!status) return 'awaiting'\n                        const normalized = status.toLowerCase()\n                        if (normalized === 'fully_paid') return 'fully_paid'\n                        if (normalized === 'delivered') return 'delivered'\n                        if (normalized === 'dispatched' || normalized === 'out_for_delivery') return 'dispatched'\n                        if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n                        if (normalized === 'awaiting' || normalized === 'pending') return 'awaiting'\n                        return 'awaiting'\n                      }\n\n                      const currentStatus = normalizeStatus(orderInfo.status)\n                      const paymentPreference = orderInfo.paymentPreference || 'partial'\n                      const isInGracePeriod = orderInfo.statusUpdateGracePeriod?.isActive\n\n                      // Define status flow based on payment preference\n                      const statusFlow = paymentPreference === 'partial'\n                        ? ['awaiting', 'accepted', 'dispatched', 'delivered', 'fully_paid']\n                        : ['awaiting', 'accepted', 'dispatched', 'delivered']\n\n                      const currentIndex = statusFlow.indexOf(currentStatus)\n\n                      if (currentIndex >= 0 && !isInGracePeriod) {\n                        // Only show current status and next status\n                        const nextIndex = currentIndex + 1\n                        const allowedStatuses = [\n                          statusFlow[currentIndex], // Current status\n                          ...(nextIndex < statusFlow.length ? [statusFlow[nextIndex]] : []) // Next status if exists\n                        ]\n\n                        filteredOptions = field.options.filter((option) => {\n                          const optionValue = typeof option === 'object' ? option.value : option\n                          return allowedStatuses.includes(optionValue)\n                        })\n                      } else if (isInGracePeriod) {\n                        // During grace period, only show current status (for reverting)\n                        filteredOptions = field.options.filter((option) => {\n                          const optionValue = typeof option === 'object' ? option.value : option\n                          return optionValue === currentStatus\n                        })\n                      }\n                    }\n\n                    return (\n                      <select\n                        className={cn(\n                          'vendor-action-panel__input',\n                          formErrors[field.name] && 'is-error',\n                        )}\n                        value={formData[field.name] || field.value || ''}\n                        onChange={(e) => handleFormChange(field.name, e.target.value)}\n                        required={field.required}\n                      >\n                        {filteredOptions.length === 0 ? (\n                          <option value=\"\">{field.placeholder || 'No options available'}</option>\n                        ) : (\n                          <>\n                            {!formData[field.name] && !field.value && (\n                              <option value=\"\">{field.placeholder || 'Select an option'}</option>\n                            )}\n                            {filteredOptions.map((option) => {\n                              // Handle both string and object options\n                              const optionValue = typeof option === 'object' ? option.value : option\n                              const optionLabel = typeof option === 'object' ? option.label : option.charAt(0).toUpperCase() + option.slice(1)\n\n                              return (\n                                <option key={optionValue} value={optionValue}>\n                                  {optionLabel}\n                                </option>\n                              )\n                            })}\n                          </>\n                        )}\n                      </select>\n                    )\n                  })()\n                ) : field.type === 'file' ? (\n                  <div className=\"vendor-action-panel__file-field\">\n                    <input\n                      ref={field.name === 'attachment' ? fileInputRef : null}\n                      type=\"file\"\n                      accept={field.accept || '.pdf,.jpg,.jpeg,.png,.doc,.docx'}\n                      onChange={(e) => {\n                        const file = e.target.files?.[0]\n                        if (file) {\n                          handleFormChange(field.name, file.name)\n                          handleFormChange(`${field.name}_file`, file)\n                        }\n                      }}\n                      className=\"vendor-action-panel__file-input\"\n                      style={{ display: 'none' }}\n                    />\n                    {formData[`${field.name}_file`] ? (\n                      <div className=\"vendor-action-panel__file-preview\">\n                        <div className=\"vendor-action-panel__file-info\">\n                          <span className=\"vendor-action-panel__file-icon\">ðŸ“„</span>\n                          <div className=\"vendor-action-panel__file-details\">\n                            <p className=\"vendor-action-panel__file-name\">{formData[field.name]}</p>\n                            <p className=\"vendor-action-panel__file-size\">\n                              {(formData[`${field.name}_file`].size / 1024).toFixed(2)} KB\n                            </p>\n                          </div>\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              handleFormChange(field.name, '')\n                              handleFormChange(`${field.name}_file`, null)\n                            }}\n                            className=\"vendor-action-panel__file-remove\"\n                          >\n                            âœ•\n                          </button>\n                        </div>\n                      </div>\n                    ) : (\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          const input = field.name === 'attachment' ? fileInputRef.current : document.createElement('input')\n                          input.type = 'file'\n                          input.accept = field.accept || '.pdf,.jpg,.jpeg,.png,.doc,.docx'\n                          input.onchange = (e) => {\n                            const file = e.target.files?.[0]\n                            if (file) {\n                              handleFormChange(field.name, file.name)\n                              handleFormChange(`${field.name}_file`, file)\n                            }\n                          }\n                          input.click()\n                        }}\n                        className=\"vendor-action-panel__file-select-button\"\n                      >\n                        Choose File\n                      </button>\n                    )}\n                  </div>\n                ) : (\n                  <>\n                    <input\n                      type={field.type}\n                      className={cn(\n                        'vendor-action-panel__input',\n                        formErrors[field.name] && 'is-error',\n                        field.type === 'number' && 'vendor-action-panel__input--no-spinner',\n                      )}\n                      value={formData[field.name] || field.value || ''}\n                      onChange={(e) => {\n                        const value = e.target.value\n                        // For withdrawal amount, prevent entering more than available balance\n                        if (field.name === 'amount' && data?.availableBalance) {\n                          const numValue = parseFloat(value)\n                          if (!isNaN(numValue) && numValue > data.availableBalance) {\n                            // Don't update if exceeds available balance\n                            return\n                          }\n                        }\n                        // For repayment amount, automatically cap to creditUsed (keep decimal values)\n                        if (field.name === 'amount' && buttonId === 'repay-credit' && data?.creditUsed) {\n                          const numValue = parseFloat(value)\n                          if (!isNaN(numValue) && numValue > data.creditUsed) {\n                            // If value exceeds max, set to exact max value (can be decimal)\n                            handleFormChange(field.name, data.creditUsed.toString())\n                            return\n                          }\n                        }\n                        handleFormChange(field.name, value)\n                      }}\n                      placeholder={field.placeholder || `Enter ${field.label.toLowerCase()}`}\n                      min={field.min}\n                      max={field.max !== undefined ? field.max : (\n                        data?.availableBalance && field.name === 'amount' ? data.availableBalance :\n                          buttonId === 'repay-credit' && data?.creditUsed && field.name === 'amount' ? data.creditUsed :\n                            undefined\n                      )}\n                      required={field.required}\n                    />\n                    {field.name === 'amount' && data?.availableBalance && (\n                      <p style={{ fontSize: '0.75rem', color: '#666', marginTop: '0.25rem' }}>\n                        Available balance: â‚¹{Math.round(data.availableBalance).toLocaleString('en-IN')}\n                      </p>\n                    )}\n                    {field.name === 'amount' && buttonId === 'repay-credit' && data?.creditUsed && (\n                      <p style={{ fontSize: '0.75rem', color: '#666', marginTop: '0.25rem' }}>\n                        Maximum: â‚¹{data.creditUsed.toLocaleString('en-IN', { maximumFractionDigits: 2 })} (Outstanding credit)\n                      </p>\n                    )}\n                  </>\n                )}\n                {formErrors[field.name] && (\n                  <span className=\"vendor-action-panel__error\">{formErrors[field.name]}</span>\n                )}\n              </div>\n            ))}\n            <div className=\"vendor-action-panel__actions\">\n              <button type=\"button\" onClick={onClose} className=\"vendor-action-panel__button is-secondary\">\n                Cancel\n              </button>\n              <button type=\"button\" onClick={handleSubmit} className=\"vendor-action-panel__button is-primary\">\n                {data.type === 'admin_request' ? 'Send Request' :\n                  buttonId === 'repay-credit' ? 'Repay' :\n                    'Update'}\n              </button>\n            </div>\n          </div>\n        )\n\n      case BUTTON_INTENT.INFORMATION_DISPLAY:\n        return <InformationDisplayContent data={data} buttonId={buttonId} />\n\n      case BUTTON_INTENT.VIEW_ONLY:\n        return <ViewOnlyContent data={data} buttonId={buttonId} />\n\n      case BUTTON_INTENT.FILE_UPLOAD:\n        return (\n          <div className=\"vendor-action-panel__upload\">\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept={data.accept}\n              onChange={handleFileInputChange}\n              className=\"vendor-action-panel__file-input\"\n              style={{ display: 'none' }}\n            />\n            {!uploadedFile ? (\n              <div\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                onDrop={handleDrop}\n                className={cn(\n                  'vendor-action-panel__upload-zone',\n                  isDragging && 'is-dragging',\n                )}\n              >\n                <button\n                  type=\"button\"\n                  onClick={() => fileInputRef.current?.click()}\n                  className=\"vendor-action-panel__upload-button\"\n                >\n                  <span className=\"vendor-action-panel__upload-icon\">ðŸ“</span>\n                  <span>Choose File or Drag & Drop</span>\n                  <span className=\"vendor-action-panel__upload-hint\">\n                    {data.accept ? `Accepted: ${data.accept}` : 'Select file'}\n                    {data.maxSize ? ` (Max: ${data.maxSize / (1024 * 1024)}MB)` : ''}\n                  </span>\n                </button>\n              </div>\n            ) : (\n              <div className=\"vendor-action-panel__file-preview\">\n                <div className=\"vendor-action-panel__file-info\">\n                  <span className=\"vendor-action-panel__file-icon\">ðŸ“„</span>\n                  <div className=\"vendor-action-panel__file-details\">\n                    <p className=\"vendor-action-panel__file-name\">{uploadedFile.name}</p>\n                    <p className=\"vendor-action-panel__file-size\">\n                      {(uploadedFile.size / 1024).toFixed(2)} KB\n                    </p>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setUploadedFile(null)\n                      if (fileInputRef.current) fileInputRef.current.value = ''\n                    }}\n                    className=\"vendor-action-panel__file-remove\"\n                  >\n                    âœ•\n                  </button>\n                </div>\n              </div>\n            )}\n            <div className=\"vendor-action-panel__actions\">\n              <button type=\"button\" onClick={onClose} className=\"vendor-action-panel__button is-secondary\">\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleSubmit}\n                disabled={!uploadedFile}\n                className=\"vendor-action-panel__button is-primary\"\n              >\n                Upload\n              </button>\n            </div>\n          </div>\n        )\n\n      case BUTTON_INTENT.INSTANT_ACTION:\n        return (\n          <div className=\"vendor-action-panel__confirmation\">\n            {renderOrderInfo()}\n            <p className=\"vendor-action-panel__confirmation-message\">{data.message}</p>\n            <div className=\"vendor-action-panel__actions\">\n              <button type=\"button\" onClick={handleCancel} className=\"vendor-action-panel__button is-secondary\">\n                {data.cancelLabel || 'Cancel'}\n              </button>\n              <button type=\"button\" onClick={handleSubmit} className=\"vendor-action-panel__button is-primary\">\n                {data.confirmLabel || 'Confirm'}\n              </button>\n            </div>\n          </div>\n        )\n\n      default:\n        return <div>Unknown action type</div>\n    }\n  }\n\n  return (\n    <div className={cn('vendor-activity-sheet', isOpen && 'is-open')}>\n      <div className={cn('vendor-activity-sheet__overlay', isOpen && 'is-open')} onClick={onClose} />\n      <div className={cn('vendor-activity-sheet__panel', isOpen && 'is-open')}>\n        <div className=\"vendor-activity-sheet__header\">\n          <h4>{data?.revert === true && buttonId === 'update-order-status' ? 'Revert Current Status' : title}</h4>\n          <button type=\"button\" onClick={onClose}>\n            Close\n          </button>\n        </div>\n        <div className=\"vendor-activity-sheet__body\">{renderContent()}</div>\n      </div>\n    </div>\n  )\n}\n\n// Information Display Content Component\nfunction InformationDisplayContent({ data, buttonId }) {\n  const { dashboard } = useVendorState()\n  const { getCreditInfo, getWithdrawals, getInventoryStats, getRepaymentHistory } = useVendorApi()\n  const [creditData, setCreditData] = useState(null)\n  const [withdrawalsData, setWithdrawalsData] = useState(null)\n  const [inventoryStatsData, setInventoryStatsData] = useState(null)\n  const [repaymentHistory, setRepaymentHistory] = useState([])\n  const [loading, setLoading] = useState(false)\n\n  // Fetch real data when modal opens\n  useEffect(() => {\n    if (data.type === 'credit_info' || data.type === 'credit_details') {\n      setLoading(true)\n      Promise.all([\n        getCreditInfo(),\n        getRepaymentHistory({ page: 1, limit: 10, status: 'completed' })\n      ]).then(([creditResult, repaymentResult]) => {\n        if (creditResult.data) {\n          setCreditData(creditResult.data)\n        }\n        if (repaymentResult.data?.repayments) {\n          setRepaymentHistory(repaymentResult.data.repayments)\n        }\n        setLoading(false)\n      }).catch(() => setLoading(false))\n    } else if (data.type === 'payouts') {\n      setLoading(true)\n      getWithdrawals({ page: 1, limit: 10 }).then((result) => {\n        if (result.data?.withdrawals) {\n          setWithdrawalsData(result.data.withdrawals)\n        }\n        setLoading(false)\n      }).catch(() => setLoading(false))\n    } else if (data.type === 'reorder' || data.type === 'stock_report') {\n      setLoading(true)\n      getInventoryStats().then((result) => {\n        if (result.data) {\n          setInventoryStatsData(result.data)\n        }\n        setLoading(false)\n      }).catch(() => setLoading(false))\n    }\n  }, [data.type, getCreditInfo, getWithdrawals, getInventoryStats])\n\n  const renderContentByType = () => {\n    switch (data.type) {\n      case 'credit_info':\n      case 'credit_details':\n        // Use real credit data from backend or dashboard\n        const creditInfo = creditData?.credit || dashboard?.credit?.credit || {}\n        const creditStatus = creditData?.status || dashboard?.credit?.status || {}\n        const creditUsed = creditInfo.used || dashboard?.overview?.credit?.used || 0\n        const penalty = creditStatus.penalty || dashboard?.overview?.credit?.penalty || 0\n        const dueDate = creditInfo.dueDate || dashboard?.overview?.credit?.dueDate\n\n        const formatCredit = (value) => {\n          if (!value || value === 0) return 'â‚¹0'\n          return value >= 100000 ? `â‚¹${(value / 100000).toFixed(1)}L` : `â‚¹${Math.round(value).toLocaleString('en-IN')}`\n        }\n\n        const formatDate = (date) => {\n          if (!date) return 'Not set'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading credit information...</p></div>\n        }\n\n        // Calculate total repaid and repayment count\n        const totalRepaid = repaymentHistory.reduce((sum, r) => sum + (r.amount || 0), 0)\n        const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n        // Get last repayment date\n        const lastRepayment = repaymentHistory\n          .filter(r => r.status === 'completed')\n          .sort((a, b) => {\n            const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n            const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n            return dateB - dateA\n          })[0]\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Credit Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Outstanding Credit</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">To Repay</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatCredit(creditUsed)}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Total Repaid</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatCredit(totalRepaid)}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Repayment Count</span>\n                    <span className=\"vendor-info-display__metric-value\">{repaymentCount}</span>\n                  </div>\n                )}\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Due Date</span>\n                  <span className=\"vendor-info-display__metric-value\">{formatDate(dueDate)}</span>\n                </div>\n                {lastRepayment && (\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Last Repayment</span>\n                    <span className=\"vendor-info-display__metric-value\">{formatDate(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt)}</span>\n                  </div>\n                )}\n              </div>\n              <div className=\"vendor-info-display__status\">\n                <span className=\"vendor-info-display__status-badge\">{penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`}</span>\n              </div>\n            </div>\n\n            {repaymentHistory.length > 0 && (\n              <div className=\"vendor-info-display__section\">\n                <h5 className=\"vendor-info-display__section-title\">Recent Repayments</h5>\n                <div className=\"vendor-info-display__list\">\n                  {repaymentHistory.slice(0, 5).map((repayment, index) => {\n                    const repaymentDate = repayment.paidAt || repayment.transactionDate || repayment.createdAt\n                    const repaymentId = repayment.repaymentId || `REP-${(repayment._id || repayment.id).toString().slice(-4)}`\n                    return (\n                      <div key={repayment._id || repayment.id || index} className=\"vendor-info-display__item vendor-info-display__item--repayment\">\n                        <span className=\"vendor-info-display__item-id\">{repaymentId}</span>\n                        <span className=\"vendor-info-display__item-amount\">-â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}</span>\n                        <span className=\"vendor-info-display__item-status\">{repayment.status === 'completed' ? 'Completed' : repayment.status}</span>\n                        <span className=\"vendor-info-display__item-date\">{formatDate(repaymentDate)}</span>\n                        {repayment.penaltyAmount > 0 && (\n                          <span className=\"vendor-info-display__item-penalty\">\n                            (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                          </span>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        )\n\n      case 'payouts':\n        const formatCurrency = (amount) => {\n          if (!amount) return 'â‚¹0'\n          return `â‚¹${Math.round(amount).toLocaleString('en-IN')}`\n        }\n\n        const formatPayoutDate = (date) => {\n          if (!date) return 'N/A'\n          return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n        }\n\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading payouts...</p></div>\n        }\n\n        const withdrawals = withdrawalsData || []\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Recent Payouts</h5>\n              <div className=\"vendor-info-display__list\">\n                {withdrawals.length > 0 ? withdrawals.map((withdrawal, index) => {\n                  const status = withdrawal.status === 'approved' ? 'Completed' : withdrawal.status === 'pending' ? 'Pending' : withdrawal.status === 'rejected' ? 'Rejected' : withdrawal.status\n                  return (\n                    <div key={withdrawal._id || withdrawal.id || index} className=\"vendor-info-display__item\">\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Date</p>\n                        <p className=\"vendor-info-display__item-value\">{formatPayoutDate(withdrawal.requestedAt || withdrawal.createdAt)}</p>\n                      </div>\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Amount</p>\n                        <p className=\"vendor-info-display__item-value\">{formatCurrency(withdrawal.amount)}</p>\n                      </div>\n                      <div>\n                        <p className=\"vendor-info-display__item-label\">Status</p>\n                        <span className={cn('vendor-info-display__item-badge', status === 'Completed' || status === 'approved' ? 'is-success' : status === 'Pending' || status === 'pending' ? 'is-pending' : 'is-error')}>\n                          {status}\n                        </span>\n                      </div>\n                    </div>\n                  )\n                }) : (\n                  <div className=\"vendor-info-display__item\">\n                    <p className=\"text-sm text-gray-500\">No withdrawals yet</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        )\n\n      case 'reorder':\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading reorder information...</p></div>\n        }\n\n        // Use real inventory stats from backend or dashboard\n        const lowStockCount = inventoryStatsData?.lowStockCount || dashboard?.overview?.inventory?.lowStockCount || 0\n        const criticalStockCount = inventoryStatsData?.criticalStockCount || dashboard?.overview?.inventory?.criticalStockCount || 0\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Reorder Information</h5>\n              <div className=\"vendor-info-display__content\">\n                <p>Items requiring reorder based on current stock levels and safety buffers.</p>\n                <div className=\"vendor-info-display__metrics\">\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Critical Items</span>\n                    <span className=\"vendor-info-display__metric-value\">{criticalStockCount}</span>\n                  </div>\n                  <div className=\"vendor-info-display__metric\">\n                    <span className=\"vendor-info-display__metric-label\">Low Stock Items</span>\n                    <span className=\"vendor-info-display__metric-value\">{lowStockCount}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )\n\n      case 'stock_report':\n        if (loading) {\n          return <div className=\"vendor-info-display\"><p>Loading stock report...</p></div>\n        }\n\n        // Use real inventory stats from backend or dashboard\n        const totalProducts = inventoryStatsData?.totalProducts || dashboard?.overview?.inventory?.totalProducts || 0\n        const inStockCount = inventoryStatsData?.inStockCount || dashboard?.overview?.inventory?.inStockCount || 0\n        const averageStockHealth = totalProducts > 0 ? Math.round((inStockCount / totalProducts) * 100) : 0\n        const reorderPoints = inventoryStatsData?.reorderPoints || dashboard?.overview?.inventory?.lowStockCount || 0\n\n        return (\n          <div className=\"vendor-info-display\">\n            <div className=\"vendor-info-display__section\">\n              <h5 className=\"vendor-info-display__section-title\">Stock Report Summary</h5>\n              <div className=\"vendor-info-display__metrics\">\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Total SKUs</span>\n                  <span className=\"vendor-info-display__metric-value\">{totalProducts}</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Average Stock Health</span>\n                  <span className=\"vendor-info-display__metric-value\">{averageStockHealth}%</span>\n                </div>\n                <div className=\"vendor-info-display__metric\">\n                  <span className=\"vendor-info-display__metric-label\">Reorder Points</span>\n                  <span className=\"vendor-info-display__metric-value\">{reorderPoints}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        )\n\n      default:\n        return <div className=\"vendor-info-display\">Information will be displayed here.</div>\n    }\n  }\n\n  return renderContentByType()\n}\n\n// View Only Content Component\nfunction ViewOnlyContent({ data, buttonId }) {\n  const renderContentByType = () => {\n    switch (data.type) {\n      case 'sla_policy':\n        return (\n          <div className=\"vendor-view-only\">\n            <div className=\"vendor-view-only__section\">\n              <h5 className=\"vendor-view-only__section-title\">SLA Policy</h5>\n              <div className=\"vendor-view-only__content\">\n                <div className=\"vendor-view-only__policy-item\">\n                  <h6>Order Confirmation</h6>\n                  <p>Vendors must confirm order availability within 2 hours of order placement.</p>\n                </div>\n                <div className=\"vendor-view-only__policy-item\">\n                  <h6>Processing Time</h6>\n                  <p>Orders should be processed and ready for dispatch within 24 hours of confirmation.</p>\n                </div>\n                <div className=\"vendor-view-only__policy-item\">\n                  <h6>Delivery Commitment</h6>\n                  <p>On-time delivery rate should maintain above 90% for optimal performance rating.</p>\n                </div>\n                <div className=\"vendor-view-only__policy-item\">\n                  <h6>Penalties</h6>\n                  <p>Late confirmations or deliveries may result in performance penalties and credit limit adjustments.</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        )\n\n      case 'suppliers':\n        return (\n          <div className=\"vendor-view-only\">\n            <div className=\"vendor-view-only__section\">\n              <h5 className=\"vendor-view-only__section-title\">Supplier List</h5>\n              <div className=\"vendor-view-only__list\">\n                {['Admin Hub', 'Central Warehouse', 'Regional Distributor'].map((supplier, index) => (\n                  <div key={index} className=\"vendor-view-only__item\">\n                    <div>\n                      <p className=\"vendor-view-only__item-name\">{supplier}</p>\n                      <p className=\"vendor-view-only__item-meta\">Primary supplier â€¢ Fast delivery</p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        )\n\n      case 'profile':\n        return (\n          <div className=\"vendor-view-only\">\n            <div className=\"vendor-view-only__section\">\n              <h5 className=\"vendor-view-only__section-title\">Profile & Settings</h5>\n              <div className=\"vendor-view-only__content\">\n                <div className=\"vendor-view-only__profile-item\">\n                  <span className=\"vendor-view-only__profile-label\">Account Status</span>\n                  <span className=\"vendor-view-only__profile-value is-success\">Active</span>\n                </div>\n                <div className=\"vendor-view-only__profile-item\">\n                  <span className=\"vendor-view-only__profile-label\">KYC Status</span>\n                  <span className=\"vendor-view-only__profile-value is-success\">Verified</span>\n                </div>\n                <div className=\"vendor-view-only__profile-item\">\n                  <span className=\"vendor-view-only__profile-label\">Documentation</span>\n                  <span className=\"vendor-view-only__profile-value\">Up to date</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        )\n\n      default:\n        return <div className=\"vendor-view-only\">View-only content will be displayed here.</div>\n    }\n  }\n\n  return renderContentByType()\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\ConfirmationModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\DocumentUpload.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\MenuList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\MobileShell.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\NotificationPanel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\OrderEscalationModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\OrderPartialEscalationModal.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadOrderDetails'. Either include it or remove the dependency array.","line":26,"column":6,"nodeType":"ArrayExpression","endLine":26,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, loadOrderDetails, order?.id]","fix":{"range":[1084,1103],"text":"[isOpen, loadOrderDetails, order?.id]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":63,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\nimport { Package, X, AlertCircle, CheckCircle } from 'lucide-react'\nimport { cn } from '../../../lib/cn'\nimport { useVendorApi } from '../hooks/useVendorApi'\nimport { useToast } from '../components/ToastNotification'\n\n/**\n * Order Partial Escalation Modal\n * Handles partial item escalation (Scenario 2) and partial quantity escalation (Scenario 3)\n */\nexport function OrderPartialEscalationModal({ isOpen, onClose, order, escalationType = 'items', onSuccess }) {\n  const { acceptOrderPartially, escalateOrderPartial, getOrderDetails, loading } = useVendorApi()\n  const { success, error: showError } = useToast()\n  const [orderDetails, setOrderDetails] = useState(null)\n  const [selectedItems, setSelectedItems] = useState({})\n  const [escalatedQuantities, setEscalatedQuantities] = useState({})\n  const [notes, setNotes] = useState('')\n  const [reason, setReason] = useState('')\n\n  // escalationType: 'items' (Scenario 2) or 'quantities' (Scenario 3)\n\n  useEffect(() => {\n    if (isOpen && order?.id) {\n      loadOrderDetails()\n    }\n  }, [isOpen, order?.id])\n\n  useEffect(() => {\n    if (!isOpen) {\n      setSelectedItems({})\n      setEscalatedQuantities({})\n      setNotes('')\n      setReason('')\n      setOrderDetails(null)\n    }\n  }, [isOpen])\n\n  const loadOrderDetails = async () => {\n    try {\n      const orderId = order._id || order.id\n      if (!orderId) {\n        showError('Invalid order ID')\n        return\n      }\n      \n      const result = await getOrderDetails(orderId)\n      if (result.data?.order) {\n        setOrderDetails(result.data.order)\n        // Initialize selected items\n        const items = result.data.order.items || []\n        const initialSelected = {}\n        items.forEach((item) => {\n          const itemId = (item._id || item.id)?.toString()\n          if (itemId) {\n            initialSelected[itemId] = {\n              accept: true,\n              quantity: item.quantity,\n            }\n          }\n        })\n        setSelectedItems(initialSelected)\n      }\n    } catch (err) {\n      showError('Failed to load order details')\n    }\n  }\n\n  const handleItemToggle = (itemId, action) => {\n    setSelectedItems((prev) => ({\n      ...prev,\n      [itemId]: {\n        ...prev[itemId],\n        accept: action === 'accept',\n      },\n    }))\n  }\n\n  const handleQuantityChange = (itemId, escalatedQty) => {\n    const item = orderDetails?.items?.find((i) => (i._id || i.id) === itemId)\n    const requestedQty = item?.quantity || 0\n    const escalated = Math.max(0, Math.min(escalatedQty, requestedQty))\n    \n    setEscalatedQuantities((prev) => ({\n      ...prev,\n      [itemId]: escalated,\n    }))\n  }\n\n  const handleSubmit = async () => {\n    if (escalationType === 'items') {\n      // Scenario 2: Partial item escalation\n      const acceptedItems = []\n      const rejectedItems = []\n\n      orderDetails?.items?.forEach((item) => {\n        const itemId = (item._id || item.id)?.toString()\n        if (!itemId) return\n        \n        const selection = selectedItems[itemId]\n        \n        if (selection?.accept) {\n          acceptedItems.push({\n            itemId: itemId,\n            quantity: item.quantity,\n            variantAttributes: item.variantAttributes || undefined,\n          })\n        } else {\n          rejectedItems.push({\n            itemId: itemId,\n            quantity: item.quantity,\n            reason: reason || 'Item not available',\n            variantAttributes: item.variantAttributes || undefined,\n          })\n        }\n      })\n\n      if (acceptedItems.length === 0) {\n        showError('Please accept at least one item')\n        return\n      }\n\n      if (rejectedItems.length === 0) {\n        showError('Please reject at least one item to escalate')\n        return\n      }\n\n      try {\n        const orderId = order._id || order.id\n        if (!orderId) {\n          showError('Invalid order ID')\n          return\n        }\n        \n        const result = await acceptOrderPartially(orderId, {\n          acceptedItems,\n          rejectedItems,\n          notes: notes.trim() || undefined,\n        })\n\n        if (result.data) {\n          success('Order partially accepted. Rejected items escalated to admin.')\n          onClose() // Close modal first\n          onSuccess?.(result.data) // Then trigger refresh\n        } else if (result.error) {\n          showError(result.error.message || 'Failed to process partial acceptance')\n        }\n      } catch (err) {\n        showError(err.message || 'Failed to process partial acceptance')\n      }\n    } else {\n      // Scenario 3: Partial quantity escalation\n      const escalatedItems = []\n\n      orderDetails?.items?.forEach((item) => {\n        const itemId = (item._id || item.id)?.toString()\n        if (!itemId) return\n        \n        const escalatedQty = escalatedQuantities[itemId] || 0\n        \n        if (escalatedQty > 0 && escalatedQty < item.quantity) {\n          escalatedItems.push({\n            itemId: itemId,\n            escalatedQuantity: escalatedQty,\n            reason: reason || 'Partial quantity not available',\n            variantAttributes: item.variantAttributes || undefined,\n          })\n        }\n      })\n\n      if (escalatedItems.length === 0) {\n        showError('Please specify quantities to escalate for at least one item')\n        return\n      }\n\n      if (!reason.trim()) {\n        showError('Please provide an escalation reason')\n        return\n      }\n\n      try {\n        const orderId = order._id || order.id\n        if (!orderId) {\n          showError('Invalid order ID')\n          return\n        }\n        \n        const result = await escalateOrderPartial(orderId, {\n          escalatedItems,\n          reason: reason.trim(),\n          notes: notes.trim() || undefined,\n        })\n\n        if (result.data) {\n          success('Order partially escalated. Remaining quantities will be fulfilled by you.')\n          onClose() // Close modal first\n          onSuccess?.(result.data) // Then trigger refresh\n        } else if (result.error) {\n          showError(result.error.message || 'Failed to escalate order')\n        }\n      } catch (err) {\n        showError(err.message || 'Failed to escalate order')\n      }\n    }\n  }\n\n  if (!isOpen || !order) return null\n\n  const items = orderDetails?.items || order.items || []\n\n  return (\n    <div className={cn('vendor-activity-sheet', isOpen && 'is-open')}>\n      <div className={cn('vendor-activity-sheet__overlay', isOpen && 'is-open')} onClick={onClose} />\n      <div className={cn('vendor-activity-sheet__panel', isOpen && 'is-open')}>\n        <div className=\"vendor-activity-sheet__header\">\n          <div className=\"flex items-center gap-2\">\n            <Package className=\"h-5 w-5 text-purple-600\" />\n            <h4>\n              {escalationType === 'items' ? 'Partial Item Escalation' : 'Partial Quantity Escalation'}\n            </h4>\n          </div>\n          <button type=\"button\" onClick={onClose}>\n            Close\n          </button>\n        </div>\n\n        <div className=\"vendor-activity-sheet__body\">\n          {/* Order Info */}\n          <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-3\">\n            <p className=\"text-sm font-semibold text-gray-900\">Order #{order.orderNumber || order.id}</p>\n            <div className=\"text-xs text-gray-600 space-y-1 mt-1\">\n              <p>Customer: {order.userId?.name || order.farmer || 'Unknown'}</p>\n              <p>Contact: {order.userId?.phone || order.customerPhone || 'N/A'}</p>\n            </div>\n          </div>\n\n          {/* Items List */}\n          <div className=\"space-y-3\">\n            <h4 className=\"text-sm font-semibold text-gray-900\">Order Items</h4>\n            {items.map((item) => {\n              const itemId = (item._id || item.id)?.toString()\n              if (!itemId) return null\n              \n              const product = item.productId || {}\n              const selection = selectedItems[itemId] || { accept: true, quantity: item.quantity }\n              const escalatedQty = escalatedQuantities[itemId] || 0\n              const requestedQty = item.quantity || 0\n              const vendorStock = item.vendorStock ?? 0\n              const unit = item.unit || 'units'\n              \n              // Check if product has attributes\n              const hasAttributes = product.attributeStocks && \n                                   Array.isArray(product.attributeStocks) && \n                                   product.attributeStocks.length > 0\n              const itemAttributes = item.variantAttributes || item.attributeCombination || item.attributes || {}\n\n              return (\n                <div key={itemId} className=\"rounded-lg border border-gray-200 p-3 space-y-3\">\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <p className=\"text-sm font-semibold text-gray-900\">\n                        {product.name || item.productName || 'Unknown Product'}\n                      </p>\n                      <div className=\"text-xs text-gray-600 flex flex-col gap-0.5\">\n                        <span>Requested: {requestedQty} {unit}</span>\n                        <span\n                          className={cn(\n                            'font-semibold',\n                            vendorStock > 0 ? 'text-green-600' : 'text-red-600'\n                          )}\n                        >\n                          Your stock: {vendorStock} {unit}\n                        </span>\n                      </div>\n                      \n                      {/* Show attributes if product has them */}\n                      {hasAttributes && Object.keys(itemAttributes).length > 0 && (\n                        <div className=\"mt-2 rounded-lg border border-blue-200 bg-blue-50/50 p-2\">\n                          <p className=\"text-xs font-semibold text-gray-700 mb-1\">Selected Variant:</p>\n                          <div className=\"flex flex-wrap gap-1\">\n                            {Object.entries(itemAttributes).map(([key, value]) => (\n                              <span key={key} className=\"px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-700\">\n                                {key}: {value}\n                              </span>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  {escalationType === 'items' ? (\n                    // Scenario 2: Accept/Reject items\n                    <div className=\"flex gap-2\">\n                      <button\n                        type=\"button\"\n                        onClick={() => handleItemToggle(itemId, 'accept')}\n                        className={cn(\n                          'flex-1 rounded-lg border-2 px-3 py-2 text-sm font-semibold transition-all',\n                          selection.accept\n                            ? 'border-green-500 bg-green-50 text-green-700'\n                            : 'border-gray-300 bg-white text-gray-700 hover:border-gray-400'\n                        )}\n                      >\n                        <CheckCircle className=\"h-4 w-4 inline mr-1\" />\n                        Accept\n                      </button>\n                      <button\n                        type=\"button\"\n                        onClick={() => handleItemToggle(itemId, 'reject')}\n                        className={cn(\n                          'flex-1 rounded-lg border-2 px-3 py-2 text-sm font-semibold transition-all',\n                          !selection.accept\n                            ? 'border-orange-500 bg-orange-50 text-orange-700'\n                            : 'border-gray-300 bg-white text-gray-700 hover:border-gray-400'\n                        )}\n                      >\n                        <AlertCircle className=\"h-4 w-4 inline mr-1\" />\n                        Escalate\n                      </button>\n                    </div>\n                  ) : (\n                    // Scenario 3: Partial quantity escalation\n                    <div className=\"space-y-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <label className=\"text-xs font-semibold text-gray-700\">Quantity to Escalate:</label>\n                        <input\n                          type=\"number\"\n                          min=\"0\"\n                          max={requestedQty}\n                          value={escalatedQty}\n                          onChange={(e) => handleQuantityChange(itemId, parseInt(e.target.value) || 0)}\n                          className=\"w-20 rounded-lg border border-gray-300 px-2 py-1 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n                        />\n                        <span className=\"text-xs text-gray-600\">of {requestedQty} {unit}</span>\n                      </div>\n                      {escalatedQty > 0 && escalatedQty < requestedQty && (\n                        <p className=\"text-xs text-green-600\">\n                          You will fulfill: {requestedQty - escalatedQty} {unit}\n                        </p>\n                      )}\n                    </div>\n                  )}\n                </div>\n              )\n            })}\n          </div>\n\n          {/* Escalation Reason (for quantity escalation) */}\n          {escalationType === 'quantities' && (\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">\n                Escalation Reason <span className=\"text-red-500\">*</span>\n              </label>\n              <textarea\n                value={reason}\n                onChange={(e) => setReason(e.target.value)}\n                placeholder=\"Why are you escalating these quantities?\"\n                rows={3}\n                className=\"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n              />\n            </div>\n          )}\n\n          {/* Additional Notes */}\n          <div>\n            <label className=\"block text-sm font-semibold text-gray-900 mb-2\">\n              Additional Notes (Optional)\n            </label>\n            <textarea\n              value={notes}\n              onChange={(e) => setNotes(e.target.value)}\n              placeholder=\"Add any additional information...\"\n              rows={3}\n              className=\"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n            />\n          </div>\n\n          {/* Info Box */}\n          <div className=\"rounded-lg border border-purple-200 bg-purple-50 p-3\">\n            <div className=\"flex items-start gap-2\">\n              <AlertCircle className=\"h-4 w-4 text-purple-600 flex-shrink-0 mt-0.5\" />\n              <p className=\"text-xs text-purple-900\">\n                {escalationType === 'items'\n                  ? 'Accepted items will be fulfilled by you. Rejected items will be escalated to Admin.'\n                  : 'Specified quantities will be escalated to Admin. Remaining quantities will be fulfilled by you.'}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"vendor-action-panel__actions\">\n          <button\n            type=\"button\"\n            onClick={onClose}\n            disabled={loading}\n            className=\"vendor-action-panel__button is-secondary\"\n          >\n            Cancel\n          </button>\n          <button\n            type=\"button\"\n            onClick={handleSubmit}\n            disabled={loading}\n            className=\"vendor-action-panel__button is-primary flex items-center justify-center gap-1.5\"\n          >\n            {loading ? (\n              'Processing...'\n            ) : (\n              <>\n                <CheckCircle className=\"h-3.5 w-3.5 flex-shrink-0\" />\n                <span className=\"text-[0.7rem]\">\n                  {escalationType === 'items' ? 'Accept & Escalate' : 'Escalate Quantities'}\n                </span>\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\ProductAttributeSelector.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\ToastNotification.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":4,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":4,"endColumn":25},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":82,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":82,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback } from 'react'\r\nimport { cn } from '../../../lib/cn'\r\n\r\nexport const TOAST_TYPES = {\r\n  SUCCESS: 'success',\r\n  ERROR: 'error',\r\n  INFO: 'info',\r\n  WARNING: 'warning',\r\n}\r\n\r\nexport function ToastNotification({ message, type = TOAST_TYPES.INFO, duration = 4000, onDismiss }) {\r\n  const [isVisible, setIsVisible] = useState(true)\r\n  const [isExiting, setIsExiting] = useState(false)\r\n\r\n  const handleDismiss = useCallback(() => {\r\n    setIsExiting(true)\r\n    setTimeout(() => {\r\n      setIsVisible(false)\r\n      onDismiss?.()\r\n    }, 300)\r\n  }, [onDismiss])\r\n\r\n  useEffect(() => {\r\n    if (duration > 0) {\r\n      const timer = setTimeout(() => {\r\n        handleDismiss()\r\n      }, duration)\r\n\r\n      return () => clearTimeout(timer)\r\n    }\r\n  }, [duration, handleDismiss])\r\n\r\n  if (!isVisible) return null\r\n\r\n  const icons = {\r\n    [TOAST_TYPES.SUCCESS]: 'âœ“',\r\n    [TOAST_TYPES.ERROR]: 'âœ•',\r\n    [TOAST_TYPES.INFO]: 'â„¹',\r\n    [TOAST_TYPES.WARNING]: 'âš ',\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'vendor-toast',\r\n        `is-${type}`,\r\n        isExiting && 'is-exiting',\r\n      )}\r\n    >\r\n      <div className=\"vendor-toast__icon\">{icons[type]}</div>\r\n      <div className=\"vendor-toast__content\">\r\n        <p className=\"vendor-toast__message\">{message}</p>\r\n      </div>\r\n      <button\r\n        type=\"button\"\r\n        onClick={handleDismiss}\r\n        className=\"vendor-toast__close\"\r\n        aria-label=\"Dismiss notification\"\r\n      >\r\n        âœ•\r\n      </button>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function ToastContainer({ toasts, onDismiss }) {\r\n  return (\r\n    <div className=\"vendor-toast-container\">\r\n      {toasts.map((toast) => (\r\n        <ToastNotification\r\n          key={toast.id}\r\n          message={toast.message}\r\n          type={toast.type}\r\n          duration={toast.duration}\r\n          onDismiss={() => onDismiss(toast.id)}\r\n        />\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function useToast() {\r\n  const [toasts, setToasts] = useState([])\r\n\r\n  const showToast = useCallback((message, type = TOAST_TYPES.INFO, duration = 4000) => {\r\n    const id = Date.now() + Math.random()\r\n    const newToast = { id, message, type, duration }\r\n    setToasts((prev) => [...prev, newToast])\r\n    return id\r\n  }, [])\r\n\r\n  const dismissToast = useCallback((id) => {\r\n    setToasts((prev) => prev.filter((toast) => toast.id !== id))\r\n  }, [])\r\n\r\n  const success = useCallback((message, duration) => showToast(message, TOAST_TYPES.SUCCESS, duration), [showToast])\r\n  const error = useCallback((message, duration) => showToast(message, TOAST_TYPES.ERROR, duration), [showToast])\r\n  const info = useCallback((message, duration) => showToast(message, TOAST_TYPES.INFO, duration), [showToast])\r\n  const warning = useCallback((message, duration) => showToast(message, TOAST_TYPES.WARNING, duration), [showToast])\r\n\r\n  return {\r\n    toasts,\r\n    showToast,\r\n    dismissToast,\r\n    success,\r\n    error,\r\n    info,\r\n    warning,\r\n  }\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\VendorStatusMessage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\components\\icons.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":14,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[471,486],"text":""},"desc":"Remove unused variable 'active'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":27,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[852,867],"text":""},"desc":"Remove unused variable 'active'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":42,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[1300,1315],"text":""},"desc":"Remove unused variable 'active'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":53,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[1714,1729],"text":""},"desc":"Remove unused variable 'active'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'active' is assigned a value but never used.","line":180,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":180,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"active"},"fix":{"range":[5805,5820],"text":""},"desc":"Remove unused variable 'active'."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export function HomeIcon({ active = false, className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke={active ? 'currentColor' : 'currentColor'}>\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M3 10.5 11.469 3a1 1 0 0 1 1.333 0L21 10.5M5.5 9.5V20a1 1 0 0 0 1 1H10v-5a2 2 0 0 1 4 0v5h3.5a1 1 0 0 0 1-1V9.5\"\n      />\n    </svg>\n  )\n}\n\nexport function BoxIcon({ active = false, className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M4.5 7.5 12 3l7.5 4.5M4.5 7.5V16.5L12 21l7.5-4.5V7.5M4.5 12 12 16.5 19.5 12\"\n      />\n    </svg>\n  )\n}\n\nexport function CartIcon({ active = false, className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M3 4h2l1.6 9.6A2 2 0 0 0 8.57 15h7.86a2 2 0 0 0 1.97-1.4L20 7H6\"\n      />\n      <circle cx=\"9\" cy=\"19\" r=\"1\" />\n      <circle cx=\"17\" cy=\"19\" r=\"1\" />\n    </svg>\n  )\n}\n\nexport function CreditIcon({ active = false, className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <rect x=\"3\" y=\"5\" width=\"18\" height=\"14\" rx=\"3\" ry=\"3\" strokeWidth=\"1.5\" />\n      <path strokeWidth=\"1.5\" strokeLinecap=\"round\" d=\"M3 10h18\" />\n      <circle cx=\"8\" cy=\"15\" r=\"1\" />\n      <circle cx=\"12\" cy=\"15\" r=\"1\" />\n    </svg>\n  )\n}\n\nexport function ReportIcon({ active = false, className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M7 3h7l5 5v11a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z\"\n      />\n      <path strokeLinecap=\"round\" strokeWidth=\"1.5\" d=\"M9 12h6M9 16h4M14 3v4h4\" />\n    </svg>\n  )\n}\n\nexport function MenuIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeWidth=\"1.5\" d=\"M4 7h16M4 12h16M4 17h10\" />\n    </svg>\n  )\n}\n\nexport function CloseIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeWidth=\"1.5\" d=\"m6 6 12 12M18 6 6 18\" />\n    </svg>\n  )\n}\n\nexport function SearchIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n      <circle cx=\"11\" cy=\"11\" r=\"6\" strokeWidth=\"1.5\" />\n      <path d=\"m17 17 3 3\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n    </svg>\n  )\n}\n\nexport function MapPinIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M12 21c4.5-4.2 6.75-7.533 6.75-10.05A6.75 6.75 0 1 0 5.25 10.95C5.25 13.467 7.5 16.8 12 21Z\"\n      />\n      <circle cx=\"12\" cy=\"10.5\" r=\"1.8\" fill=\"currentColor\" />\n    </svg>\n  )\n}\n\nexport function SparkIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\">\n      <path\n        d=\"M12 3 9.4 9.4 3 12l6.4 2.6L12 21l2.6-6.4L21 12l-6.4-2.6L12 3Z\"\n        fill=\"currentColor\"\n        fillOpacity=\".9\"\n      />\n    </svg>\n  )\n}\n\nexport function TruckIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n      <path\n        d=\"M3 7h11v8H3zM14 9h4l3 3v3h-4\"\n        strokeWidth=\"1.5\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n      <circle cx=\"7\" cy=\"17\" r=\"2\" />\n      <circle cx=\"17\" cy=\"17\" r=\"2\" />\n    </svg>\n  )\n}\n\nexport function WalletIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n      <rect x=\"3\" y=\"6\" width=\"18\" height=\"12\" rx=\"3\" strokeWidth=\"1.5\" />\n      <path d=\"M16 12h3\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n      <circle cx=\"15\" cy=\"12\" r=\"1\" fill=\"currentColor\" />\n    </svg>\n  )\n}\n\nexport function ChartIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n      <path d=\"M4 19V5\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n      <path d=\"M9 19V9\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n      <path d=\"M14 19v-6\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n      <path d=\"M19 19v-3\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n    </svg>\n  )\n}\n\nexport function PackageIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z\"\n      />\n    </svg>\n  )\n}\n\nexport function CheckCircleIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\n      />\n    </svg>\n  )\n}\n\nexport function BellIcon({ active = false, className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        d=\"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0\"\n      />\n    </svg>\n  )\n}\n\nexport function ChevronDownIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\" />\n    </svg>\n  )\n}\n\nexport function ChevronUpIcon({ className = 'h-5 w-5' }) {\n  return (\n    <svg className={className} fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M5 15l7-7 7 7\" />\n    </svg>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\context\\VendorContext.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'isInitialized' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":278,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":278,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"isInitialized"},"fix":{"range":[7209,7222],"text":""},"desc":"Remove unused variable 'isInitialized'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'showToast' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":281,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":281,"endColumn":16},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":337,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":337,"endColumn":31},{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":340,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":340,"endColumn":16},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":352,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":352,"endColumn":34},{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":355,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":355,"endColumn":16}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useMemo, useReducer, useEffect, useState } from 'react'\nimport { getVendorProfile } from '../services/vendorApi'\n\nconst initialState = {\n  language: 'en',\n  role: null,\n  authenticated: false,\n  profile: {\n    name: 'Guest Vendor',\n    email: '',\n    phone: '',\n    location: null,\n    coverageRadius: 20,\n  },\n  notifications: [],\n  dashboard: {\n    overview: null,\n    orders: null,\n    inventory: null,\n    credit: null,\n    reports: null,\n    loading: false,\n    error: null,\n  },\n  ordersUpdated: false,\n  inventoryUpdated: false,\n  realtimeConnected: false,\n}\n\n// Use a symbol to detect if context is actually provided\nconst VENDOR_CONTEXT_SYMBOL = Symbol('VendorContextProvided')\n\nconst VendorStateContext = createContext(null)\nconst VendorDispatchContext = createContext(null)\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'SET_LANGUAGE':\n      return { ...state, language: action.payload }\n    case 'SET_ROLE':\n      return { ...state, role: action.payload }\n    case 'AUTH_LOGIN':\n      return {\n        ...state,\n        authenticated: true,\n        profile: {\n          ...state.profile,\n          ...action.payload,\n        },\n      }\n    case 'AUTH_LOGOUT':\n      return {\n        ...state,\n        authenticated: false,\n        profile: initialState.profile,\n        notifications: [],\n        dashboard: initialState.dashboard,\n        ordersUpdated: false,\n        inventoryUpdated: false,\n      }\n    case 'UPDATE_PROFILE':\n      return {\n        ...state,\n        profile: {\n          ...state.profile,\n          ...action.payload,\n        },\n      }\n    case 'SET_DASHBOARD_LOADING':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          loading: action.payload,\n        },\n      }\n    case 'SET_DASHBOARD_ERROR':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          error: action.payload,\n          loading: false,\n        },\n      }\n    case 'SET_DASHBOARD_OVERVIEW':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          overview: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'SET_ORDERS_DATA':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          orders: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'SET_INVENTORY_DATA':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          inventory: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'SET_CREDIT_DATA':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          credit: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'SET_REPORTS_DATA':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          reports: action.payload,\n          loading: false,\n          error: null,\n        },\n      }\n    case 'UPDATE_ORDER_STATUS': {\n      const targetId = action.payload.orderId?.toString?.() ?? String(action.payload.orderId || '')\n      const applyOrderUpdates = (order) => {\n        const currentId =\n          order.id?.toString?.() ??\n          order._id?.toString?.() ??\n          order.orderId?.toString?.() ??\n          ''\n        if (currentId && targetId && currentId === targetId) {\n          return {\n            ...order,\n            status: action.payload.status ?? order.status,\n            ...(action.payload.updates || {}),\n          }\n        }\n        return order\n      }\n\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          orders: state.dashboard.orders\n            ? {\n              ...state.dashboard.orders,\n              orders: state.dashboard.orders.orders?.map(applyOrderUpdates),\n            }\n            : null,\n        },\n        ordersUpdated: true,\n      }\n    }\n    case 'UPDATE_INVENTORY_STOCK':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          inventory: state.dashboard.inventory\n            ? {\n              ...state.dashboard.inventory,\n              items: state.dashboard.inventory.items?.map((item) =>\n                item.id === action.payload.itemId\n                  ? { ...item, stock: action.payload.stock }\n                  : item,\n              ),\n            }\n            : null,\n        },\n        inventoryUpdated: true,\n      }\n    case 'UPDATE_CREDIT_BALANCE': {\n      const currentCredit = state.dashboard.credit || { used: 0, remaining: 0 }\n      const newUsed = action.payload.isIncrement\n        ? currentCredit.used + action.payload.amount\n        : action.payload.amount\n      const newRemaining = (state.dashboard.credit?.limit || 0) - newUsed\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          credit: {\n            ...state.dashboard.credit,\n            used: newUsed,\n            remaining: newRemaining,\n          },\n        },\n      }\n    }\n    case 'ADD_CREDIT_PURCHASE_REQUEST':\n      return {\n        ...state,\n        dashboard: {\n          ...state.dashboard,\n          credit: {\n            ...state.dashboard.credit,\n            purchaseRequests: [\n              ...(state.dashboard.credit?.purchaseRequests || []),\n              action.payload,\n            ],\n          },\n        },\n      }\n    case 'SET_ORDERS_UPDATED':\n      return {\n        ...state,\n        ordersUpdated: action.payload,\n      }\n    case 'SET_INVENTORY_UPDATED':\n      return {\n        ...state,\n        inventoryUpdated: action.payload,\n      }\n    case 'ADD_NOTIFICATION': {\n      // Check if notification already exists (prevent duplicates)\n      const existingIndex = state.notifications.findIndex(\n        (n) => n.id === action.payload.id || (n.type === action.payload.type && n.data?.orderId === action.payload.data?.orderId),\n      )\n      if (existingIndex >= 0) {\n        return state\n      }\n      return {\n        ...state,\n        notifications: [\n          {\n            id: action.payload.id || Date.now().toString(),\n            ...action.payload,\n            read: action.payload.read || false,\n            timestamp: action.payload.timestamp || new Date().toISOString(),\n          },\n          ...state.notifications,\n        ],\n      }\n    }\n    case 'MARK_NOTIFICATION_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) =>\n          notif.id === action.payload.id ? { ...notif, read: true } : notif,\n        ),\n      }\n    case 'MARK_ALL_NOTIFICATIONS_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) => ({ ...notif, read: true })),\n      }\n    case 'SET_NOTIFICATIONS':\n      return {\n        ...state,\n        notifications: action.payload || [],\n      }\n    case 'SET_REALTIME_CONNECTED':\n      return {\n        ...state,\n        realtimeConnected: action.payload,\n      }\n    default:\n      return state\n  }\n}\n\nexport function VendorProvider({ children }) {\n  const [state, dispatch] = useReducer(reducer, initialState)\n  const [isInitialized, setIsInitialized] = useState(false)\n\n  // Get toast functions from context (if available)\n  let showToast = (message, type) => {\n    // Fallback if toast is not available\n    console.log(`[${type.toUpperCase()}] ${message}`)\n  }\n\n  // Initialize vendor profile from token on mount\n  useEffect(() => {\n    const initializeVendor = async () => {\n      const token = localStorage.getItem('vendor_token')\n      if (token && !state.authenticated) {\n        try {\n          const profileResult = await getVendorProfile()\n\n          if (profileResult.success && profileResult.data?.vendor) {\n            const vendor = profileResult.data.vendor\n            dispatch({\n              type: 'AUTH_LOGIN',\n              payload: {\n                id: vendor.id || vendor._id,\n                name: vendor.name,\n                phone: vendor.phone,\n                email: vendor.email,\n                location: vendor.location,\n                status: vendor.status,\n                isActive: vendor.isActive,\n              },\n            })\n          } else {\n            // Token is invalid, remove it\n            localStorage.removeItem('vendor_token')\n          }\n        } catch (error) {\n          console.error('Failed to initialize vendor:', error)\n          // Token might be invalid, remove it\n          localStorage.removeItem('vendor_token')\n        }\n      }\n      setIsInitialized(true)\n    }\n\n    initializeVendor()\n  }, [state.authenticated]) // Run when authenticated state changes\n\n  const value = useMemo(() => ({ ...state, [VENDOR_CONTEXT_SYMBOL]: true }), [state])\n  const dispatchWithSymbol = useMemo(() => {\n    const wrappedDispatch = (action) => dispatch(action)\n    wrappedDispatch[VENDOR_CONTEXT_SYMBOL] = true\n    return wrappedDispatch\n  }, [dispatch])\n  return (\n    <VendorStateContext.Provider value={value}>\n      <VendorDispatchContext.Provider value={dispatchWithSymbol}>{children}</VendorDispatchContext.Provider>\n    </VendorStateContext.Provider>\n  )\n}\n\nexport function useVendorState() {\n  const context = useContext(VendorStateContext)\n  if (!context || !context[VENDOR_CONTEXT_SYMBOL]) {\n    if (process.env.NODE_ENV !== 'production') {\n      console.error('useVendorState must be used within VendorProvider')\n      throw new Error('useVendorState must be used within VendorProvider')\n    }\n    // In production, return initial state to prevent crashes\n    return initialState\n  }\n  // Remove the symbol before returning\n  const { [VENDOR_CONTEXT_SYMBOL]: _, ...state } = context\n  return state\n}\n\nexport function useVendorDispatch() {\n  const dispatch = useContext(VendorDispatchContext)\n  if (!dispatch || !dispatch[VENDOR_CONTEXT_SYMBOL]) {\n    if (process.env.NODE_ENV !== 'production') {\n      console.error('useVendorDispatch must be used within VendorProvider')\n      throw new Error('useVendorDispatch must be used within VendorProvider')\n    }\n    // In production, return a no-op function to prevent crashes\n    return () => {\n      if (import.meta.env.DEV) {\n        console.warn('VendorDispatch called outside VendorProvider')\n      }\n    }\n  }\n  // Return the dispatch function directly\n  return dispatch\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\hooks\\useButtonAction.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\hooks\\useVendorApi.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'dispatch'. Either exclude it or remove the dependency array.","line":40,"column":5,"nodeType":"ArrayExpression","endLine":40,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[1384,1394],"text":"[]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Custom hook for Vendor API integration\n * Provides easy access to API functions with loading states and error handling\n */\n\nimport { useState, useCallback } from 'react'\nimport { useVendorDispatch } from '../context/VendorContext'\nimport * as vendorApi from '../services/vendorApi'\n\nexport function useVendorApi() {\n  const dispatch = useVendorDispatch()\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  const callApi = useCallback(\n    async (apiFunction, ...args) => {\n      setLoading(true)\n      setError(null)\n      try {\n        const result = await apiFunction(...args)\n        if (result.success) {\n          // Extract data from response: { success: true, data: {...} } -> {...}\n          const responseData = result.data || result\n          return { data: responseData, error: null }\n        } else {\n          const error = result.error || { message: 'An error occurred' }\n          setError(error)\n          return { data: null, error: error }\n        }\n      } catch (err) {\n        // Handle errors from handleResponse function\n        const errorMsg = err.error?.message || err.message || 'An unexpected error occurred'\n        const errorObj = err.error || { message: errorMsg }\n        setError(errorObj)\n        return { data: null, error: errorObj }\n      } finally {\n        setLoading(false)\n      }\n    },\n    [dispatch],\n  )\n\n  // Authentication APIs\n  const login = useCallback((credentials) => callApi(vendorApi.loginVendor, credentials), [callApi])\n\n  const logout = useCallback(() => callApi(vendorApi.logoutVendor), [callApi])\n\n  const fetchProfile = useCallback(() => callApi(vendorApi.getVendorProfile), [callApi])\n\n  // Dashboard APIs\n  const fetchDashboardData = useCallback(() => {\n    return callApi(vendorApi.fetchDashboardData).then((result) => {\n      if (result.data) {\n        // Backend returns { data: { overview: {...} } }, so extract overview\n        dispatch({ type: 'SET_DASHBOARD_OVERVIEW', payload: result.data.overview || result.data })\n      }\n      return result\n    })\n  }, [callApi, dispatch])\n\n  // Orders APIs\n  const getOrders = useCallback((params) => callApi(vendorApi.getOrders, params), [callApi])\n\n  const getOrderDetails = useCallback((orderId) => callApi(vendorApi.getOrderDetails, orderId), [callApi])\n\n  const acceptOrder = useCallback(\n    (orderId, notes) => {\n      return callApi(vendorApi.acceptOrder, orderId, notes).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'UPDATE_ORDER_STATUS', payload: { orderId, status: 'pending' } })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const confirmOrderAcceptance = useCallback(\n    (orderId, data) => {\n      return callApi(vendorApi.confirmOrderAcceptance, orderId, data).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'UPDATE_ORDER_STATUS', payload: { orderId, status: 'awaiting' } })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const cancelOrderAcceptance = useCallback(\n    (orderId, data) => {\n      return callApi(vendorApi.cancelOrderAcceptance, orderId, data).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'UPDATE_ORDER_STATUS', payload: { orderId, status: 'pending' } })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const rejectOrder = useCallback(\n    (orderId, reasonData) => {\n      return callApi(vendorApi.rejectOrder, orderId, reasonData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'UPDATE_ORDER_STATUS', payload: { orderId, status: 'rejected' } })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const acceptOrderPartially = useCallback(\n    (orderId, partialData) => {\n      return callApi(vendorApi.acceptOrderPartially, orderId, partialData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'UPDATE_ORDER_STATUS', payload: { orderId, status: 'partially_accepted' } })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const escalateOrderPartial = useCallback(\n    (orderId, escalationData) => {\n      return callApi(vendorApi.escalateOrderPartial, orderId, escalationData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'UPDATE_ORDER_STATUS', payload: { orderId, status: 'partially_accepted' } })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const updateOrderStatus = useCallback(\n    (orderId, statusData) => {\n      return callApi(vendorApi.updateOrderStatus, orderId, statusData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'UPDATE_ORDER_STATUS', payload: { orderId, status: statusData.status } })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getOrderStats = useCallback((params) => callApi(vendorApi.getOrderStats, params), [callApi])\n\n  // Product APIs (for viewing and ordering products)\n  const getProducts = useCallback((params) => callApi(vendorApi.getProducts, params), [callApi])\n\n  const getProductDetails = useCallback((productId) => callApi(vendorApi.getProductDetails, productId), [callApi])\n\n  // Inventory APIs\n  const getInventory = useCallback((params) => callApi(vendorApi.getInventory, params), [callApi])\n\n  const getInventoryItemDetails = useCallback((itemId) => callApi(vendorApi.getInventoryItemDetails, itemId), [callApi])\n\n  const updateInventoryStock = useCallback(\n    (itemId, stockData) => {\n      return callApi(vendorApi.updateInventoryStock, itemId, stockData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'UPDATE_INVENTORY_STOCK', payload: { itemId, stock: stockData.quantity } })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getInventoryStats = useCallback(() => callApi(vendorApi.getInventoryStats), [callApi])\n\n  // Credit Management APIs\n  const getCreditInfo = useCallback(() => callApi(vendorApi.getCreditInfo), [callApi])\n\n  const requestCreditPurchase = useCallback(\n    (purchaseData) => {\n      return callApi(vendorApi.requestCreditPurchase, purchaseData).then((result) => {\n        if (result.data) {\n          dispatch({ type: 'ADD_CREDIT_PURCHASE_REQUEST', payload: result.data })\n        }\n        return result\n      })\n    },\n    [callApi, dispatch],\n  )\n\n  const getCreditPurchases = useCallback((params) => callApi(vendorApi.getCreditPurchases, params), [callApi])\n\n  const getCreditPurchaseDetails = useCallback((requestId) => callApi(vendorApi.getCreditPurchaseDetails, requestId), [callApi])\n\n  const getCreditHistory = useCallback((params) => callApi(vendorApi.getCreditHistory, params), [callApi])\n\n  // Credit Repayment APIs\n  const createRepaymentIntent = useCallback(\n    (repaymentData) => {\n      return callApi(vendorApi.createRepaymentIntent, repaymentData).then((result) => {\n        if (result.data) {\n          // Repayment intent created successfully\n        }\n        return result\n      })\n    },\n    [callApi],\n  )\n\n  const confirmRepayment = useCallback(\n    (confirmationData) => {\n      return callApi(vendorApi.confirmRepayment, confirmationData).then((result) => {\n        if (result.data) {\n          // Update credit balance after successful repayment\n          dispatch({ \n            type: 'UPDATE_CREDIT_BALANCE', \n            payload: { \n              isIncrement: false, \n              amount: result.data.repayment?.amount || 0,\n              creditUsed: result.data.vendor?.creditUsed || 0,\n            } \n          })\n          // Refresh dashboard data to get updated credit info\n          fetchDashboardData()\n        }\n        return result\n      })\n    },\n    [callApi, dispatch, fetchDashboardData],\n  )\n\n  const getRepaymentHistory = useCallback((params) => callApi(vendorApi.getRepaymentHistory, params), [callApi])\n\n  // Notification APIs\n  const getNotifications = useCallback((params) => callApi(vendorApi.getNotifications, params), [callApi])\n\n  const markNotificationAsRead = useCallback((notificationId) => callApi(vendorApi.markNotificationAsRead, notificationId), [callApi])\n\n  const markAllNotificationsAsRead = useCallback(() => callApi(vendorApi.markAllNotificationsAsRead), [callApi])\n\n  const deleteNotification = useCallback((notificationId) => callApi(vendorApi.deleteNotification, notificationId), [callApi])\n\n  // Earnings APIs\n  const getEarningsSummary = useCallback(() => callApi(vendorApi.getEarningsSummary), [callApi])\n\n  const getEarningsHistory = useCallback((params) => callApi(vendorApi.getEarningsHistory, params), [callApi])\n\n  const getEarningsByOrders = useCallback((params) => callApi(vendorApi.getEarningsByOrders, params), [callApi])\n\n  const getBalance = useCallback(() => callApi(vendorApi.getBalance), [callApi])\n\n  // Withdrawal Request APIs\n  const requestWithdrawal = useCallback(\n    (withdrawalData) => {\n      return callApi(vendorApi.requestWithdrawal, withdrawalData).then((result) => {\n        if (result.data) {\n          // Refresh earnings summary after withdrawal request\n          getEarningsSummary()\n        }\n        return result\n      })\n    },\n    [callApi, getEarningsSummary],\n  )\n\n  const getWithdrawals = useCallback((params) => callApi(vendorApi.getWithdrawals, params), [callApi])\n\n  // Bank Account APIs\n  const addBankAccount = useCallback((data) => callApi(vendorApi.addBankAccount, data), [callApi])\n\n  const getBankAccounts = useCallback(() => callApi(vendorApi.getBankAccounts), [callApi])\n\n  const updateBankAccount = useCallback((accountId, data) => callApi(vendorApi.updateBankAccount, accountId, data), [callApi])\n\n  const deleteBankAccount = useCallback((accountId) => callApi(vendorApi.deleteBankAccount, accountId), [callApi])\n\n  // Reports APIs\n  const getReports = useCallback((params) => callApi(vendorApi.getReports, params), [callApi])\n\n  const getPerformanceAnalytics = useCallback((params) => callApi(vendorApi.getPerformanceAnalytics, params), [callApi])\n\n  const getRegionAnalytics = useCallback(() => callApi(vendorApi.getRegionAnalytics), [callApi])\n\n  return {\n    loading,\n    error,\n    // Authentication\n    login,\n    logout,\n    fetchProfile,\n    // Dashboard\n    fetchDashboardData,\n    // Orders\n    getOrders,\n    getOrderDetails,\n    acceptOrder,\n    confirmOrderAcceptance,\n    cancelOrderAcceptance,\n    acceptOrderPartially,\n    rejectOrder,\n    escalateOrderPartial,\n    updateOrderStatus,\n    getOrderStats,\n    // Products\n    getProducts,\n    getProductDetails,\n    // Inventory\n    getInventory,\n    getInventoryItemDetails,\n    updateInventoryStock,\n    getInventoryStats,\n    // Credit\n    getCreditInfo,\n    requestCreditPurchase,\n    getCreditPurchases,\n    getCreditPurchaseDetails,\n    getCreditHistory,\n    // Credit Repayment\n    createRepaymentIntent,\n    confirmRepayment,\n    getRepaymentHistory,\n    // Earnings\n    getEarningsSummary,\n    getEarningsHistory,\n    getEarningsByOrders,\n    getBalance,\n    // Withdrawals\n    requestWithdrawal,\n    getWithdrawals,\n    // Bank Accounts\n    addBankAccount,\n    getBankAccounts,\n    updateBankAccount,\n    deleteBankAccount,\n    // Reports\n    getReports,\n    getPerformanceAnalytics,\n    getRegionAnalytics,\n    // Notifications\n    getNotifications,\n    markNotificationAsRead,\n    markAllNotificationsAsRead,\n    deleteNotification,\n  }\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\pages\\VendorAuth.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\pages\\VendorLogin.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":156,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":156,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\nimport { useVendorDispatch } from '../context/VendorContext'\nimport { VendorStatusMessage } from '../components/VendorStatusMessage'\nimport * as vendorApi from '../services/vendorApi'\n\nexport function VendorLogin({ onSuccess, onSwitchToRegister }) {\n  const navigate = useNavigate()\n  const dispatch = useVendorDispatch()\n  const [step, setStep] = useState('phone') // 'phone' | 'otp' | 'pending' | 'rejected'\n  const [form, setForm] = useState({ phone: '' })\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setForm((prev) => ({ ...prev, [name]: value }))\n    setError(null)\n  }\n\n  const handleRequestOtp = async (e) => {\n    e.preventDefault()\n    setError(null)\n    setLoading(true)\n\n    try {\n      if (!form.phone.trim()) {\n        setError('Contact number is required')\n        setLoading(false)\n        return\n      }\n      if (form.phone.length < 10) {\n        setError('Please enter a valid contact number')\n        setLoading(false)\n        return\n      }\n\n      const result = await vendorApi.requestVendorOTP({ phone: form.phone })\n      \n      if (result.success || result.data) {\n        setStep('otp')\n      } else {\n        // Check for rejected status\n        if (result.error?.status === 'rejected' || result.error?.message?.includes('rejected')) {\n          setStep('rejected')\n      } else {\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\n        }\n      }\n    } catch (err) {\n      setError(err.message || 'Failed to send OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleVerifyOtp = async (otpCode) => {\n    setError(null)\n    setLoading(true)\n\n    try {\n      const result = await vendorApi.loginVendorWithOtp({ phone: form.phone, otp: otpCode })\n\n      if (result.success || result.data) {\n        const responseData = result.data?.data || result.data\n        const vendorData = responseData?.vendor || result.data?.vendor\n        const status = responseData?.status || vendorData?.status\n\n        // Check status\n        if (status === 'pending') {\n          // Show pending message\n          setStep('pending')\n          // Update vendor context with profile (but no token)\n          if (vendorData) {\n            dispatch({\n              type: 'AUTH_LOGIN',\n              payload: {\n                id: vendorData.id || vendorData._id,\n                name: vendorData.name,\n                phone: vendorData.phone || form.phone,\n                email: vendorData.email,\n                location: vendorData.location,\n                status: vendorData.status,\n                isActive: vendorData.isActive,\n              },\n            })\n          }\n          return\n        }\n\n        if (status === 'rejected') {\n          // Show rejected message\n          setStep('rejected')\n          return\n        }\n\n        // Vendor is approved - proceed to dashboard\n        if (responseData?.token || result.data?.token) {\n          localStorage.setItem('vendor_token', responseData?.token || result.data?.token)\n        }\n        \n        // Update vendor context with profile\n        if (vendorData) {\n          dispatch({\n            type: 'AUTH_LOGIN',\n            payload: {\n              id: vendorData.id || vendorData._id,\n              name: vendorData.name,\n              phone: vendorData.phone || form.phone,\n              email: vendorData.email,\n              location: vendorData.location,\n              status: vendorData.status,\n              isActive: vendorData.isActive,\n            },\n          })\n        }\n        \n        onSuccess?.(vendorData || { phone: form.phone })\n        navigate('/vendor/dashboard')\n      } else {\n        // Check if vendor needs to register\n        if (result.error?.message?.includes('not found') || result.error?.message?.includes('Vendor not found')) {\n          setError('Vendor not found. Please register first.')\n          setTimeout(() => {\n            if (onSwitchToRegister) {\n              onSwitchToRegister()\n            }\n          }, 2000)\n        } else if (result.error?.status === 'rejected' || result.error?.message?.includes('rejected')) {\n          setStep('rejected')\n        } else if (result.error?.message?.includes('banned')) {\n          setError(result.error?.message || 'Your account has been banned. Please contact admin.')\n        } else if (result.error?.message?.includes('inactive')) {\n          setError('Your account is inactive. Please contact admin.')\n      } else {\n        setError(result.error?.message || 'Invalid OTP. Please try again.')\n        }\n      }\n    } catch (err) {\n      // Check for rejected status in error response\n      if (err.error?.status === 'rejected' || err.message?.includes('rejected')) {\n        setStep('rejected')\n      } else {\n        setError(err.error?.message || err.message || 'Verification failed. Please try again.')\n      }\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleResendOtp = async () => {\n    setLoading(true)\n    try {\n      await vendorApi.requestVendorOTP({ phone: form.phone })\n    } catch (err) {\n      setError('Failed to resend OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (step === 'otp') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <OtpVerification\n              phone={form.phone}\n              onVerify={handleVerifyOtp}\n              onResend={handleResendOtp}\n              onBack={() => setStep('phone')}\n              loading={loading}\n              error={error}\n              userType=\"vendor\"\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (step === 'pending' || step === 'rejected') {\n    return <VendorStatusMessage status={step} onBack={() => setStep('phone')} />\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4\">\n            <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n            </svg>\n          </div>\n          <p className=\"text-xs uppercase tracking-wide text-green-600 font-semibold\">Welcome Back</p>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Sign in as Vendor</h1>\n          <p className=\"text-sm text-gray-600\">Enter your contact number to continue</p>\n        </div>\n\n        <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\n            {error && (\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\n                <p className=\"text-sm text-red-600\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"login-phone\" className=\"text-xs font-semibold text-gray-700\">\n                Contact Number <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"login-phone\"\n                name=\"phone\"\n                type=\"tel\"\n                required\n                value={form.phone}\n                onChange={handleChange}\n                placeholder=\"+91 90000 00000\"\n                maxLength={15}\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? 'Sending OTP...' : 'Continue'}\n            </button>\n\n            <div className=\"text-center text-sm\">\n              <span className=\"text-gray-600\">Don't have an account? </span>\n              <button\n                type=\"button\"\n                onClick={onSwitchToRegister}\n                className=\"text-green-600 font-semibold hover:underline\"\n              >\n                Sign up\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\pages\\VendorRegister.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'otp' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"otp"},"fix":{"range":[961,964],"text":""},"desc":"Remove unused variable 'otp'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setOtp' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"setOtp"},"fix":{"range":[964,972],"text":""},"desc":"Remove unused variable 'setOtp'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":242,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":242,"endColumn":17}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\nimport { useVendorDispatch } from '../context/VendorContext'\nimport { VendorStatusMessage } from '../components/VendorStatusMessage'\nimport { DocumentUpload } from '../components/DocumentUpload'\nimport { GoogleMapsLocationPicker } from '../../../components/GoogleMapsLocationPicker'\nimport * as vendorApi from '../services/vendorApi'\n\nexport function VendorRegister({ onSuccess, onSwitchToLogin }) {\n  const navigate = useNavigate()\n  const dispatch = useVendorDispatch()\n  const [step, setStep] = useState('register') // 'register' | 'otp' | 'pending' | 'rejected'\n  const [form, setForm] = useState({\n    fullName: '',\n    email: '',\n    contact: '',\n    location: null, // Will contain { address, city, state, pincode, coordinates: { lat, lng } }\n    aadhaarCard: null,\n    panCard: null,\n  })\n  const [otp, setOtp] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setForm((prev) => ({ ...prev, [name]: value }))\n    setError(null)\n  }\n\n  const handleDocumentChange = (documentType) => (documentData) => {\n    setForm((prev) => ({\n      ...prev,\n      [documentType]: documentData,\n    }))\n  }\n\n  const handleRequestOtp = async (e) => {\n    e.preventDefault()\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Validate form\n      if (!form.fullName.trim()) {\n        setError('Full name is required')\n        setLoading(false)\n        return\n      }\n      if (!form.contact.trim()) {\n        setError('Contact number is required')\n        setLoading(false)\n        return\n      }\n      if (form.contact.length < 10) {\n        setError('Please enter a valid contact number')\n        setLoading(false)\n        return\n      }\n      // Validate location - coordinates are required (Google Maps provides this)\n      if (!form.location || !form.location.coordinates) {\n        setError('Please select your location using the map or live location button')\n        setLoading(false)\n        return\n      }\n      // Validate coordinates are valid (not 0,0)\n      if (!form.location.coordinates.lat || !form.location.coordinates.lng || \n          form.location.coordinates.lat === 0 || form.location.coordinates.lng === 0) {\n        setError('Please select a valid location. Coordinates are required.')\n        setLoading(false)\n        return\n      }\n      // Address is required (Google Maps provides formatted_address)\n      if (!form.location.address || !form.location.address.trim()) {\n        setError('Please select a valid address from the location picker')\n        setLoading(false)\n        return\n      }\n      // Validate documents - must be uploaded\n      if (!form.aadhaarCard?.url) {\n        setError('Please upload Aadhaar card image. Image is required and must be less than 2MB.')\n        setLoading(false)\n        return\n      }\n      if (!form.panCard?.url) {\n        setError('Please upload PAN card image. Image is required and must be less than 2MB.')\n        setLoading(false)\n        return\n      }\n\n      // Validate document formats - must be images\n      const imageFormats = ['jpg', 'jpeg', 'png', 'gif', 'webp', 'bmp', 'svg']\n      const aadhaarFormat = form.aadhaarCard.format?.toLowerCase()\n      const panFormat = form.panCard.format?.toLowerCase()\n      \n      if (!aadhaarFormat || !imageFormats.includes(aadhaarFormat)) {\n        setError('Aadhaar card must be an image file (JPG, PNG, GIF, etc.). PDF files are not accepted.')\n        setLoading(false)\n        return\n      }\n      if (!panFormat || !imageFormats.includes(panFormat)) {\n        setError('PAN card must be an image file (JPG, PNG, GIF, etc.). PDF files are not accepted.')\n        setLoading(false)\n        return\n      }\n\n      // Validate document sizes - must be less than 2MB\n      const maxSize = 2000000 // 2MB in bytes\n      if (form.aadhaarCard.size && form.aadhaarCard.size > maxSize) {\n        setError(`Aadhaar card image size (${(form.aadhaarCard.size / 1024 / 1024).toFixed(2)}MB) exceeds 2MB limit. Please upload a smaller image.`)\n        setLoading(false)\n        return\n      }\n      if (form.panCard.size && form.panCard.size > maxSize) {\n        setError(`PAN card image size (${(form.panCard.size / 1024 / 1024).toFixed(2)}MB) exceeds 2MB limit. Please upload a smaller image.`)\n        setLoading(false)\n        return\n      }\n\n      // Register vendor (creates vendor and sends OTP)\n      const location = {\n        address: form.location.address,\n        city: form.location.city,\n        state: form.location.state,\n        pincode: form.location.pincode,\n        coordinates: {\n          lat: form.location.coordinates.lat,\n          lng: form.location.coordinates.lng,\n        },\n      }\n\n      const result = await vendorApi.registerVendor({\n        name: form.fullName,\n        email: form.email || undefined,\n        phone: form.contact,\n        location: location,\n        aadhaarCard: form.aadhaarCard,\n        panCard: form.panCard,\n      })\n      \n      if (result.success || result.data) {\n        setStep('otp')\n      } else {\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Failed to send OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleVerifyOtp = async (otpCode) => {\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Verify OTP to complete registration\n      const result = await vendorApi.loginVendorWithOtp({ phone: form.contact, otp: otpCode })\n\n      if (result.success || result.data) {\n        const responseData = result.data?.data || result.data\n        const vendorData = responseData?.vendor || result.data?.vendor\n        const status = responseData?.status || vendorData?.status\n\n        // Check status\n        if (status === 'pending') {\n          // Show pending message\n          setStep('pending')\n          // Update vendor context with profile (but no token)\n          if (vendorData) {\n            dispatch({\n              type: 'AUTH_LOGIN',\n              payload: {\n                id: vendorData.id || vendorData._id,\n                name: vendorData.name || form.fullName,\n                phone: vendorData.phone || form.contact,\n                email: vendorData.email,\n                location: vendorData.location,\n                status: vendorData.status,\n                isActive: vendorData.isActive,\n              },\n            })\n          }\n          return\n        }\n\n        if (status === 'rejected') {\n          // Show rejected message\n          setStep('rejected')\n          return\n        }\n\n        // Vendor is approved - proceed to dashboard\n        if (responseData?.token || result.data?.token) {\n          localStorage.setItem('vendor_token', responseData?.token || result.data?.token)\n        }\n        \n        // Update vendor context with profile\n        if (vendorData) {\n          dispatch({\n            type: 'AUTH_LOGIN',\n            payload: {\n              id: vendorData.id || vendorData._id,\n              name: vendorData.name || form.fullName,\n              phone: vendorData.phone || form.contact,\n              email: vendorData.email,\n              location: vendorData.location,\n              status: vendorData.status,\n              isActive: vendorData.isActive,\n            },\n          })\n        }\n        \n        onSuccess?.(vendorData || { name: form.fullName, phone: form.contact })\n        navigate('/vendor/dashboard')\n      } else {\n        // Check for rejected status in error response\n        if (result.error?.status === 'rejected' || result.error?.message?.includes('rejected')) {\n          setStep('rejected')\n      } else {\n        setError(result.error?.message || 'Invalid OTP. Please try again.')\n        }\n      }\n    } catch (err) {\n      // Check for rejected status in error response\n      if (err.error?.status === 'rejected' || err.message?.includes('rejected')) {\n        setStep('rejected')\n      } else {\n        setError(err.error?.message || err.message || 'Verification failed. Please try again.')\n      }\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleResendOtp = async () => {\n    setLoading(true)\n    try {\n      await vendorApi.requestVendorOTP({ phone: form.contact })\n    } catch (err) {\n      setError('Failed to resend OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (step === 'otp') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <OtpVerification\n              phone={form.contact}\n              onVerify={handleVerifyOtp}\n              onResend={handleResendOtp}\n              onBack={() => setStep('register')}\n              loading={loading}\n              error={error}\n              userType=\"vendor\"\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (step === 'pending' || step === 'rejected') {\n    return <VendorStatusMessage status={step} onBack={() => setStep('register')} />\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4\">\n            <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n            </svg>\n          </div>\n          <p className=\"text-xs uppercase tracking-wide text-green-600 font-semibold\">Create Account</p>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Register as Vendor</h1>\n          <p className=\"text-sm text-gray-600\">Start your journey to better farming</p>\n        </div>\n\n        <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\n            {error && (\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\n                <p className=\"text-sm text-red-600\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"register-fullName\" className=\"text-xs font-semibold text-gray-700\">\n                Full Name <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"register-fullName\"\n                name=\"fullName\"\n                type=\"text\"\n                required\n                value={form.fullName}\n                onChange={handleChange}\n                placeholder=\"Enter your full name\"\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"register-contact\" className=\"text-xs font-semibold text-gray-700\">\n                Contact Number <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"register-contact\"\n                name=\"contact\"\n                type=\"tel\"\n                required\n                value={form.contact}\n                onChange={handleChange}\n                placeholder=\"+91 90000 00000\"\n                maxLength={15}\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"register-email\" className=\"text-xs font-semibold text-gray-700\">\n                Email <span className=\"text-gray-400 text-xs\">(Optional)</span>\n              </label>\n              <input\n                id=\"register-email\"\n                name=\"email\"\n                type=\"email\"\n                value={form.email}\n                onChange={handleChange}\n                placeholder=\"vendor@email.com\"\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <div className=\"border-t border-gray-200 pt-5 mt-5\">\n              <h3 className=\"text-sm font-semibold text-gray-900 mb-4\">Address & Location</h3>\n              \n              <div className=\"space-y-4\">\n                <GoogleMapsLocationPicker\n                  onLocationSelect={(location) => {\n                    setForm((prev) => ({ ...prev, location }))\n                    setError(null)\n                  }}\n                  initialLocation={form.location}\n                  required={true}\n                  label=\"Select Your Business Location\"\n                />\n              </div>\n            </div>\n\n            {/* Document Uploads */}\n            <div className=\"border-t border-gray-200 pt-5 mt-5\">\n              <h3 className=\"text-sm font-semibold text-gray-900 mb-4\">Verification Documents</h3>\n              <p className=\"text-xs text-gray-600 mb-4\">\n                Please upload clear images or PDFs of your Aadhaar Card and PAN Card for verification.\n              </p>\n              \n              <div className=\"space-y-4\">\n                <DocumentUpload\n                  label=\"Aadhaar Card\"\n                  value={form.aadhaarCard}\n                  onChange={handleDocumentChange('aadhaarCard')}\n                  required\n                  disabled={loading}\n                />\n                \n                <DocumentUpload\n                  label=\"PAN Card\"\n                  value={form.panCard}\n                  onChange={handleDocumentChange('panCard')}\n                  required\n                  disabled={loading}\n                />\n              </div>\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? 'Sending OTP...' : 'Continue'}\n            </button>\n\n            <div className=\"text-center text-sm\">\n              <span className=\"text-gray-600\">Already have an account? </span>\n              <button\n                type=\"button\"\n                onClick={onSwitchToLogin}\n                className=\"text-green-600 font-semibold hover:underline\"\n              >\n                Sign in\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\pages\\common\\LanguageSelect.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\pages\\common\\RoleSelect.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\pages\\vendor\\VendorDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'dashboard' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":75,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"dashboard"},"fix":{"range":[2271,2282],"text":""},"desc":"Remove unused variable 'dashboard'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getBankAccounts' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":80,"column":254,"nodeType":"Identifier","messageId":"unusedVar","endLine":80,"endColumn":269,"suggestions":[{"messageId":"removeVar","data":{"varName":"getBankAccounts"},"fix":{"range":[2713,2730],"text":""},"desc":"Remove unused variable 'getBankAccounts'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'validTabs'. Either include it or remove the dependency array.","line":122,"column":6,"nodeType":"ArrayExpression","endLine":122,"endColumn":54,"suggestions":[{"desc":"Update the dependencies array to be: [urlTab, navigate, closePanel, showOrderDetails, validTabs]","fix":{"range":[4925,4973],"text":"[urlTab, navigate, closePanel, showOrderDetails, validTabs]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'validTabs'. Either include it or remove the dependency array.","line":136,"column":6,"nodeType":"ArrayExpression","endLine":136,"endColumn":46,"suggestions":[{"desc":"Update the dependencies array to be: [validTabs, navigate, showOrderDetails, closePanel]","fix":{"range":[5429,5469],"text":"[validTabs, navigate, showOrderDetails, closePanel]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'dispatch', 'fetchDashboardData', 'fetchProfile', 'location.pathname', 'navigate', 'onLogout', and 'profile?.id'. Either include them or remove the dependency array. If 'onLogout' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":207,"column":6,"nodeType":"ArrayExpression","endLine":207,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [dispatch, fetchDashboardData, fetchProfile, location.pathname, navigate, onLogout, profile?.id]","fix":{"range":[7772,7774],"text":"[dispatch, fetchDashboardData, fetchProfile, location.pathname, navigate, onLogout, profile?.id]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":361,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":361,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":1367,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":1367,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":1381,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":1381,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'profile' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1733,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":1733,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"profile"},"fix":{"range":[72086,72095],"text":""},"desc":"Remove unused variable 'profile'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'orderError' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1744,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1744,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"orderError"},"fix":{"range":[72705,72715],"text":""},"desc":"Remove unused variable 'orderError'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'isPurchaseHistoryLoading' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1764,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1764,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"isPurchaseHistoryLoading"},"fix":{"range":[73676,73700],"text":""},"desc":"Remove unused variable 'isPurchaseHistoryLoading'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleOrderStock' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2017,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":2017,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'handleOrderSubmit' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2023,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":2023,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'duesWarning' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2243,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":2243,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'stockProgress' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2382,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":2382,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'creditLimit' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2418,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":2418,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'projectedCredit' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2419,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":2419,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'canSubmitOrder' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2422,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":2422,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'pendingDeliveryRequests' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2597,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":2597,"endColumn":34},{"ruleId":"no-unused-vars","severity":2,"message":"'formatEta' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2603,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":2603,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'hasSelectedVariants' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2690,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":2690,"endColumn":44},{"ruleId":"no-unused-vars","severity":2,"message":"'quantity' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2936,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":2936,"endColumn":35},{"ruleId":"no-unused-vars","severity":2,"message":"'adminStockStatus' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3450,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":3450,"endColumn":37},{"ruleId":"no-unused-vars","severity":2,"message":"'orders' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3733,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":3733,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'setActiveTab' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5500,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":5500,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"setActiveTab"},"fix":{"range":[238889,238903],"text":""},"desc":"Remove unused variable 'setActiveTab'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'onNavigate' is defined but never used.","line":6040,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":6040,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"onNavigate"},"fix":{"range":[266166,266178],"text":""},"desc":"Remove unused variable 'onNavigate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'dispatch' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6041,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":6041,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"dispatch"},"fix":{"range":[266186,266222],"text":""},"desc":"Remove unused variable 'dispatch'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'toasts' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6043,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":6043,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"toasts"},"fix":{"range":[266355,266362],"text":""},"desc":"Remove unused variable 'toasts'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'dismissToast' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6043,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":6043,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"dismissToast"},"fix":{"range":[266361,266375],"text":""},"desc":"Remove unused variable 'dismissToast'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setHistoryPage' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6050,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":6050,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"setHistoryPage"},"fix":{"range":[266763,266779],"text":""},"desc":"Remove unused variable 'setHistoryPage'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setOrdersPage' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6051,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":6051,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"setOrdersPage"},"fix":{"range":[266814,266829],"text":""},"desc":"Remove unused variable 'setOrdersPage'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadBankAccounts' and 'loadEarningsData'. Either include them or remove the dependency array.","line":6059,"column":6,"nodeType":"ArrayExpression","endLine":6059,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadBankAccounts, loadEarningsData]","fix":{"range":[267144,267146],"text":"[loadBankAccounts, loadEarningsData]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":6084,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":6084,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'bankAccount' is defined but never used.","line":6522,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":6522,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"bankAccount"},"fix":{"range":[287017,287028],"text":""},"desc":"Remove unused variable 'bankAccount'."}]}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchOrders'. Either include it or remove the dependency array.","line":4357,"column":6,"nodeType":"ArrayExpression","endLine":4357,"endColumn":35,"suggestions":[{"desc":"Update the dependencies array to be: [fetchOrders, searchQuery, selectedFilter]","fix":{"range":[190200,190229],"text":"[fetchOrders, searchQuery, selectedFilter]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchOrders'. Either include it or remove the dependency array.","line":4363,"column":6,"nodeType":"ArrayExpression","endLine":4363,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchOrders]","fix":{"range":[190363,190365],"text":"[fetchOrders]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'initialOrder' and 'refreshOrder'. Either include them or remove the dependency array. If 'setOrder' needs the current value of 'initialOrder', you can also switch to useReducer instead of useState and read 'initialOrder' in the reducer.","line":4842,"column":6,"nodeType":"ArrayExpression","endLine":4842,"endColumn":65,"suggestions":[{"desc":"Update the dependencies array to be: [initialOrder.id, initialOrder._id, initialOrder.status, initialOrder, refreshOrder]","fix":{"range":[211136,211195],"text":"[initialOrder.id, initialOrder._id, initialOrder.status, initialOrder, refreshOrder]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":30,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport { useNavigate, useLocation, useParams } from 'react-router-dom'\nimport { useVendorDispatch, useVendorState } from '../../context/VendorContext'\nimport { useVendorApi } from '../../hooks/useVendorApi'\nimport { MobileShell } from '../../components/MobileShell'\nimport { BottomNavItem } from '../../components/BottomNavItem'\nimport { MenuList } from '../../components/MenuList'\nimport {\n  BoxIcon,\n  CartIcon,\n  ChartIcon,\n  CreditIcon,\n  HomeIcon,\n  MenuIcon,\n  ReportIcon,\n  SparkIcon,\n  TruckIcon,\n  WalletIcon,\n  CloseIcon,\n  ChevronDownIcon,\n  ChevronUpIcon,\n} from '../../components/icons'\nimport { cn } from '../../../../lib/cn'\nimport { useButtonAction } from '../../hooks/useButtonAction'\nimport { ButtonActionPanel } from '../../components/ButtonActionPanel'\nimport { useToast, ToastContainer } from '../../components/ToastNotification'\nimport { OrderEscalationModal } from '../../components/OrderEscalationModal'\nimport { OrderPartialEscalationModal } from '../../components/OrderPartialEscalationModal'\nimport { ConfirmationModal } from '../../components/ConfirmationModal'\nimport { ProductAttributeSelector } from '../../components/ProductAttributeSelector'\nimport { BankAccountForm } from '../../components/BankAccountForm'\nimport { NotificationPanel } from '../../components/NotificationPanel'\nimport { openRazorpayCheckout } from '../../../../utils/razorpay'\n\nconst NAV_ITEMS = [\n  {\n    id: 'overview',\n    label: 'Overview',\n    description: 'Orders, sales, and reminders',\n    icon: HomeIcon,\n  },\n  {\n    id: 'inventory',\n    label: 'Stock Manager',\n    description: 'Current stock status',\n    icon: BoxIcon,\n  },\n  {\n    id: 'orders',\n    label: 'Orders',\n    description: 'Confirm availability and delivery',\n    icon: CartIcon,\n  },\n  {\n    id: 'credit',\n    label: 'Credit Status',\n    description: 'Credit limit, fines, payment',\n    icon: CreditIcon,\n  },\n  {\n    id: 'earnings',\n    label: 'Earnings',\n    description: 'Earnings, balance, withdrawals',\n    icon: WalletIcon,\n  },\n  {\n    id: 'reports',\n    label: 'Summary',\n    description: 'Weekly / monthly summary',\n    icon: ReportIcon,\n  },\n]\n\nexport function VendorDashboard({ onLogout }) {\n  const { profile, dashboard, notifications } = useVendorState()\n  const dispatch = useVendorDispatch()\n  const navigate = useNavigate()\n  const location = useLocation()\n  const { tab: urlTab } = useParams()\n  const { acceptOrder, confirmOrderAcceptance, cancelOrderAcceptance, acceptOrderPartially, rejectOrder, updateInventoryStock, requestCreditPurchase, updateOrderStatus, fetchProfile, fetchDashboardData, getOrders, requestWithdrawal, getEarningsSummary, getBankAccounts, createRepaymentIntent, confirmRepayment, getCreditInfo, getNotifications, markNotificationAsRead, markAllNotificationsAsRead, getOrderDetails } = useVendorApi()\n  const [activeTab, setActiveTab] = useState('overview')\n  const [showAllOrders, setShowAllOrders] = useState(false)\n  const [showOrderDetails, setShowOrderDetails] = useState(false)\n  const [selectedOrderForDetails, setSelectedOrderForDetails] = useState(null)\n  const [ordersViewRefreshKey, setOrdersViewRefreshKey] = useState(0)\n  const welcomeName = (profile?.name || 'Partner').split(' ')[0]\n  const { isOpen, isMounted, currentAction, openPanel, closePanel } = useButtonAction()\n  const { toasts, dismissToast, success, error, info, warning } = useToast()\n  const [notificationPanelOpen, setNotificationPanelOpen] = useState(false)\n  const [isNotificationAnimating, setIsNotificationAnimating] = useState(false)\n  const previousNotificationsCountRef = useRef(0)\n\n  // Escalation modal states\n  const [escalationModalOpen, setEscalationModalOpen] = useState(false)\n  const [partialEscalationModalOpen, setPartialEscalationModalOpen] = useState(false)\n  const [selectedOrderForEscalation, setSelectedOrderForEscalation] = useState(null)\n  const [escalationType, setEscalationType] = useState('items') // 'items' or 'quantities'\n\n  // Confirmation modal states\n  const [confirmationModalOpen, setConfirmationModalOpen] = useState(false)\n  const [confirmationData, setConfirmationData] = useState(null)\n  const [confirmationLoading, setConfirmationLoading] = useState(false)\n\n  // Valid tabs for navigation\n  const validTabs = ['overview', 'inventory', 'orders', 'credit', 'earnings', 'reports']\n\n  // Initialize tab from URL parameter on mount or when URL changes\n  useEffect(() => {\n    const tab = urlTab || 'overview'\n    if (validTabs.includes(tab)) {\n      setActiveTab(tab)\n      // Close modals/panels when navigating to a different tab\n      if (tab !== 'orders' || !showOrderDetails) {\n        setShowOrderDetails(false)\n        setSelectedOrderForDetails(null)\n      }\n      closePanel()\n    } else {\n      // Invalid tab, redirect to overview\n      navigate('/vendor/dashboard/overview', { replace: true })\n    }\n  }, [urlTab, navigate, closePanel, showOrderDetails])\n\n  // Navigate function that updates both state and URL\n  const navigateToTab = useCallback((tab) => {\n    if (validTabs.includes(tab)) {\n      setActiveTab(tab)\n      navigate(`/vendor/dashboard/${tab}`, { replace: false })\n      // Close modals/panels when navigating to a different tab\n      if (tab !== 'orders' || !showOrderDetails) {\n        setShowOrderDetails(false)\n        setSelectedOrderForDetails(null)\n      }\n      closePanel()\n    }\n  }, [navigate, closePanel, showOrderDetails])\n\n  // Scroll to top when tab changes\n  useEffect(() => {\n    window.scrollTo(0, 0)\n  }, [activeTab])\n\n  // Fetch vendor profile and dashboard data on mount (only if authenticated or has token)\n  useEffect(() => {\n    const token = localStorage.getItem('vendor_token')\n    if (!token) {\n      // No token, redirect to login only if not already on login page\n      dispatch({ type: 'AUTH_LOGOUT' })\n      if (location.pathname !== '/vendor/login') {\n        navigate('/vendor/login', { replace: true })\n      }\n      return\n    }\n\n    const loadVendorData = async () => {\n      try {\n        // Only fetch profile if not already authenticated\n        if (!profile?.id) {\n          const profileResult = await fetchProfile()\n          if (profileResult.data?.vendor) {\n            dispatch({\n              type: 'AUTH_LOGIN',\n              payload: {\n                id: profileResult.data.vendor.id,\n                name: profileResult.data.vendor.name,\n                phone: profileResult.data.vendor.phone,\n                email: profileResult.data.vendor.email,\n                location: profileResult.data.vendor.location,\n                status: profileResult.data.vendor.status,\n                isActive: profileResult.data.vendor.isActive,\n              },\n            })\n          } else if (profileResult.error?.status === 401) {\n            // Token expired or invalid, redirect to login\n            localStorage.removeItem('vendor_token')\n            dispatch({ type: 'AUTH_LOGOUT' })\n            if (onLogout) {\n              onLogout()\n            }\n            return\n          }\n        }\n\n        // Fetch dashboard overview\n        const dashboardResult = await fetchDashboardData()\n        if (dashboardResult.error?.status === 401) {\n          // Token expired or invalid, redirect to login\n          localStorage.removeItem('vendor_token')\n          dispatch({ type: 'AUTH_LOGOUT' })\n          if (onLogout) {\n            onLogout()\n          }\n        }\n      } catch (err) {\n        console.error('Failed to load vendor data:', err)\n        if (err.error?.status === 401) {\n          localStorage.removeItem('vendor_token')\n          dispatch({ type: 'AUTH_LOGOUT' })\n          if (onLogout) {\n            onLogout()\n          }\n        }\n      }\n    }\n\n    loadVendorData()\n  }, []) // Only run once on mount\n  const tabLabels = useMemo(() => {\n    return NAV_ITEMS.reduce((acc, item) => {\n      acc[item.id] = item.label\n      return acc\n    }, {})\n  }, [])\n  const searchCatalog = useMemo(\n    () =>\n      [\n        {\n          id: 'search-overview-hero',\n          label: 'Today\\'s summary & available money',\n          keywords: ['overview', 'summary', 'wallet', 'balance', 'welcome', 'money'],\n          tab: 'overview',\n          targetId: 'overview-hero',\n        },\n        {\n          id: 'search-overview-services',\n          label: 'Other services shortcuts',\n          keywords: ['overview', 'services', 'reorder', 'support', 'pricing'],\n          tab: 'overview',\n          targetId: 'overview-services',\n        },\n        {\n          id: 'search-overview-activity',\n          label: 'Recent activity timeline',\n          keywords: ['overview', 'activity', 'transactions', 'updates'],\n          tab: 'overview',\n          targetId: 'overview-activity',\n        },\n        {\n          id: 'search-overview-snapshot',\n          label: 'Quick summary',\n          keywords: ['overview', 'snapshot', 'summary', 'highlights'],\n          tab: 'overview',\n          targetId: 'overview-snapshot',\n        },\n        {\n          id: 'search-overview-quick-actions',\n          label: 'Quick actions',\n          keywords: ['overview', 'actions', 'tasks', 'shortcuts'],\n          tab: 'overview',\n          targetId: 'overview-quick-actions',\n        },\n        {\n          id: 'search-inventory-header',\n          label: 'Stock status',\n          keywords: ['inventory', 'stock', 'products', 'items', 'health'],\n          tab: 'inventory',\n          targetId: 'inventory-header',\n        },\n        {\n          id: 'search-inventory-restock',\n          label: 'Need to order more',\n          keywords: ['inventory', 'restock', 'order', 'credit', 'stock'],\n          tab: 'inventory',\n          targetId: 'inventory-restock',\n        },\n        {\n          id: 'search-orders-header',\n          label: 'Orders',\n          keywords: ['orders', 'queue', 'availability'],\n          tab: 'orders',\n          targetId: 'orders-header',\n        },\n        {\n          id: 'search-orders-tracker',\n          label: 'Order status',\n          keywords: ['orders', 'tracker', 'stages', 'dispatched', 'status'],\n          tab: 'orders',\n          targetId: 'orders-tracker',\n        },\n        {\n          id: 'search-orders-fallback',\n          label: 'Backup delivery',\n          keywords: ['orders', 'backup', 'delivery', 'admin', 'send'],\n          tab: 'orders',\n          targetId: 'orders-fallback',\n        },\n        {\n          id: 'search-credit-summary',\n          label: 'Credit summary & usage',\n          keywords: ['credit', 'limit', 'usage', 'fine'],\n          tab: 'credit',\n          targetId: 'credit-summary',\n        },\n        {\n          id: 'search-credit-penalty',\n          label: 'Fine timeline',\n          keywords: ['credit', 'penalty', 'fine', 'timeline', 'payment'],\n          tab: 'credit',\n          targetId: 'credit-penalty',\n        },\n        {\n          id: 'search-reports-overview',\n          label: 'Summary overview',\n          keywords: ['reports', 'summary', 'insights', 'tips'],\n          tab: 'reports',\n          targetId: 'reports-overview',\n        },\n        {\n          id: 'search-reports-top-vendors',\n          label: 'Top sellers',\n          keywords: ['reports', 'summary', 'vendors', 'sellers', 'top'],\n          tab: 'reports',\n          targetId: 'reports-top-vendors',\n        },\n      ].map((item) => ({\n        ...item,\n        tabLabel: tabLabels[item.tab],\n      })),\n    [tabLabels],\n  )\n  const [searchMounted, setSearchMounted] = useState(false)\n  const [searchOpen, setSearchOpen] = useState(false)\n  const [searchQuery, setSearchQuery] = useState('')\n  const [pendingScroll, setPendingScroll] = useState(null)\n  const searchInputRef = useRef(null)\n\n  const handleLogout = () => {\n    localStorage.removeItem('vendor_token')\n    dispatch({ type: 'AUTH_LOGOUT' })\n    onLogout?.()\n  }\n\n  const navigateTo = (target) => {\n    navigateToTab(target)\n  }\n\n  // Calculate unread notification count\n  const unreadNotificationCount = useMemo(() => {\n    return (notifications || []).filter((n) => !n.read).length\n  }, [notifications])\n\n  // Play notification sound\n  const playNotificationSound = useCallback(() => {\n    try {\n      // Create a simple notification sound using Web Audio API\n      const audioContext = new (window.AudioContext || window.webkitAudioContext)()\n      const oscillator = audioContext.createOscillator()\n      const gainNode = audioContext.createGain()\n\n      oscillator.connect(gainNode)\n      gainNode.connect(audioContext.destination)\n\n      oscillator.frequency.value = 800\n      oscillator.type = 'sine'\n\n      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime)\n      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3)\n\n      oscillator.start(audioContext.currentTime)\n      oscillator.stop(audioContext.currentTime + 0.3)\n    } catch (err) {\n      // Fallback: try HTML5 audio if Web Audio API is not available\n      console.log('Notification sound played (fallback)')\n    }\n  }, [])\n\n  // Trigger bell animation and sound when new notification arrives\n  useEffect(() => {\n    const currentUnreadCount = unreadNotificationCount\n    const previousUnreadCount = previousNotificationsCountRef.current\n\n    if (currentUnreadCount > previousUnreadCount) {\n      // New notification arrived\n      playNotificationSound()\n      setIsNotificationAnimating(true)\n\n      // Stop animation after 3 seconds\n      const animationTimer = setTimeout(() => {\n        setIsNotificationAnimating(false)\n      }, 3000)\n\n      return () => clearTimeout(animationTimer)\n    }\n\n    previousNotificationsCountRef.current = currentUnreadCount\n  }, [unreadNotificationCount, playNotificationSound])\n\n  // Handle notification panel open/close\n  const handleNotificationClick = () => {\n    setNotificationPanelOpen(true)\n  }\n\n  const handleNotificationPanelClose = () => {\n    setNotificationPanelOpen(false)\n  }\n\n  // Fetch notifications from backend\n  const fetchNotifications = useCallback(async () => {\n    try {\n      const result = await getNotifications({ page: 1, limit: 50 })\n      if (result.data?.notifications) {\n        dispatch({ type: 'SET_NOTIFICATIONS', payload: result.data.notifications })\n      }\n    } catch (err) {\n      console.error('Failed to fetch notifications:', err)\n    }\n  }, [getNotifications, dispatch])\n\n  // Fetch notifications on mount and periodically\n  useEffect(() => {\n    fetchNotifications()\n\n    // Refresh notifications every 30 seconds\n    const interval = setInterval(() => {\n      fetchNotifications()\n    }, 30000)\n\n    return () => clearInterval(interval)\n  }, [fetchNotifications])\n\n  // Mark notification as read\n  const handleMarkNotificationAsRead = useCallback(async (notificationId) => {\n    try {\n      await markNotificationAsRead(notificationId)\n      dispatch({ type: 'MARK_NOTIFICATION_READ', payload: { id: notificationId } })\n    } catch (err) {\n      console.error('Failed to mark notification as read:', err)\n    }\n  }, [markNotificationAsRead, dispatch])\n\n  // Mark all notifications as read\n  const handleMarkAllNotificationsAsRead = useCallback(async () => {\n    try {\n      await markAllNotificationsAsRead()\n      dispatch({ type: 'MARK_ALL_NOTIFICATIONS_READ' })\n      // Refresh notifications after marking all as read\n      fetchNotifications()\n    } catch (err) {\n      console.error('Failed to mark all notifications as read:', err)\n    }\n  }, [markAllNotificationsAsRead, dispatch, fetchNotifications])\n\n  const buildMenuItems = (close) => [\n    ...NAV_ITEMS.map((item) => ({\n      id: item.id,\n      label: item.label,\n      description: item.description,\n      icon: <item.icon className=\"h-4 w-4\" />,\n      onSelect: () => {\n        navigateToTab(item.id)\n        close()\n      },\n    })),\n    {\n      id: 'logout',\n      label: 'Sign out',\n      icon: <MenuIcon className=\"h-4 w-4\" />,\n      description: 'Log out from vendor account',\n      onSelect: () => {\n        handleLogout()\n        close()\n      },\n    },\n  ]\n  const searchResults = useMemo(() => {\n    const query = searchQuery.trim().toLowerCase()\n    if (!query) {\n      return searchCatalog.slice(0, 7)\n    }\n    const tokens = query.split(/\\s+/).filter(Boolean)\n    const results = searchCatalog\n      .map((item) => {\n        const haystack = `${item.label} ${item.tabLabel} ${item.keywords.join(' ')}`.toLowerCase()\n        const directIndex = haystack.indexOf(query)\n        const directScore = directIndex >= 0 ? 200 - directIndex : 0\n        const tokenScore = tokens.reduce((score, token) => (haystack.includes(token) ? score + 20 : score), 0)\n        const score = directScore + tokenScore\n        return { ...item, score }\n      })\n      .filter((item) => item.score > 0)\n      .sort((a, b) => b.score - a.score)\n    return results.length ? results : searchCatalog.slice(0, 5)\n  }, [searchCatalog, searchQuery])\n\n  const openSearch = () => {\n    setSearchMounted(true)\n    requestAnimationFrame(() => setSearchOpen(true))\n  }\n\n  const closeSearch = () => {\n    setSearchOpen(false)\n    setTimeout(() => {\n      setSearchMounted(false)\n      setSearchQuery('')\n    }, 260)\n  }\n\n  const handleSearchNavigate = (item) => {\n    if (!item) return\n    const delay = item.tab === activeTab ? 150 : 420\n    navigateToTab(item.tab)\n    setPendingScroll({ id: item.targetId, delay })\n    closeSearch()\n  }\n\n  const handleSearchSubmit = () => {\n    if (searchResults.length) {\n      handleSearchNavigate(searchResults[0])\n    }\n  }\n\n  useEffect(() => {\n    if (searchOpen && searchInputRef.current) {\n      searchInputRef.current.focus()\n      searchInputRef.current.select()\n    }\n  }, [searchOpen])\n\n  useEffect(() => {\n    if (!pendingScroll) return\n    const { id, delay } = pendingScroll\n    const timer = setTimeout(() => {\n      const element = document.getElementById(id)\n      if (element) {\n        element.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' })\n      }\n      setPendingScroll(null)\n    }, delay)\n    return () => clearTimeout(timer)\n  }, [pendingScroll, activeTab])\n\n  return (\n    <>\n      <MobileShell\n        title={`Hello ${welcomeName}`}\n        subtitle={profile?.location?.city ? `${profile.location.city}${profile.location.state ? `, ${profile.location.state}` : ''}` : 'Location not set'}\n        onSearchClick={openSearch}\n        onNotificationClick={handleNotificationClick}\n        notificationCount={unreadNotificationCount}\n        isNotificationAnimating={isNotificationAnimating}\n        navigation={NAV_ITEMS.map((item) => (\n          <BottomNavItem\n            key={item.id}\n            label={item.label}\n            active={activeTab === item.id}\n            onClick={() => navigateToTab(item.id)}\n            icon={<item.icon active={activeTab === item.id} className=\"h-5 w-5\" />}\n          />\n        ))}\n        menuContent={({ close }) => <MenuList items={buildMenuItems(close)} active={activeTab} />}\n      >\n        <section className=\"space-y-6\">\n          {activeTab === 'overview' && <OverviewView onNavigate={navigateTo} welcomeName={welcomeName} openPanel={openPanel} />}\n          {activeTab === 'inventory' && <InventoryView onNavigate={navigateTo} openPanel={openPanel} />}\n          {activeTab === 'orders' && !showAllOrders && !showOrderDetails && (\n            <OrdersView\n              openPanel={openPanel}\n              refreshKey={ordersViewRefreshKey}\n              onRefresh={() => setOrdersViewRefreshKey(prev => prev + 1)}\n              onOpenEscalationModal={(order) => {\n                setSelectedOrderForEscalation(order)\n                setEscalationModalOpen(true)\n              }}\n              onOpenPartialEscalationModal={(order, type) => {\n                setSelectedOrderForEscalation(order)\n                setEscalationType(type)\n                setPartialEscalationModalOpen(true)\n              }}\n              onShowAllOrders={() => setShowAllOrders(true)}\n              onViewOrderDetails={(order) => {\n                setSelectedOrderForDetails(order)\n                setShowOrderDetails(true)\n              }}\n            />\n          )}\n          {activeTab === 'orders' && showAllOrders && !showOrderDetails && (\n            <AllOrdersView\n              openPanel={openPanel}\n              onOpenEscalationModal={(order) => {\n                setSelectedOrderForEscalation(order)\n                setEscalationModalOpen(true)\n              }}\n              onOpenPartialEscalationModal={(order, type) => {\n                setSelectedOrderForEscalation(order)\n                setEscalationType(type)\n                setPartialEscalationModalOpen(true)\n              }}\n              onBack={() => setShowAllOrders(false)}\n              onViewOrderDetails={(order) => {\n                setSelectedOrderForDetails(order)\n                setShowOrderDetails(true)\n              }}\n            />\n          )}\n          {activeTab === 'orders' && showOrderDetails && selectedOrderForDetails && (\n            <OrderDetailsView\n              order={selectedOrderForDetails}\n              openPanel={openPanel}\n              onBack={() => {\n                setShowOrderDetails(false)\n                setSelectedOrderForDetails(null)\n              }}\n              onOpenEscalationModal={(order) => {\n                setSelectedOrderForEscalation(order)\n                setEscalationModalOpen(true)\n              }}\n              onOpenPartialEscalationModal={(order, type) => {\n                setSelectedOrderForEscalation(order)\n                setEscalationType(type)\n                setPartialEscalationModalOpen(true)\n              }}\n              onOrderUpdated={() => {\n                // Refresh order details after update\n                getOrders().then((result) => {\n                  if (result.data?.orders) {\n                    const updatedOrder = result.data.orders.find(o => o._id === selectedOrderForDetails.id || o.id === selectedOrderForDetails.id)\n                    if (updatedOrder) {\n                      setSelectedOrderForDetails(updatedOrder)\n                    }\n                  }\n                })\n              }}\n            />\n          )}\n          {activeTab === 'credit' && <CreditView openPanel={openPanel} />}\n          {activeTab === 'earnings' && <EarningsView openPanel={openPanel} onNavigate={navigateTo} />}\n          {activeTab === 'reports' && <ReportsView onNavigate={navigateTo} />}\n        </section>\n      </MobileShell>\n\n      {searchMounted ? (\n        <div className={cn('vendor-search-sheet', searchOpen && 'is-open')}>\n          <div className={cn('vendor-search-sheet__overlay', searchOpen && 'is-open')} onClick={closeSearch} />\n          <div className={cn('vendor-search-sheet__panel', searchOpen && 'is-open')}>\n            <div className=\"vendor-search-sheet__header\">\n              <input\n                ref={searchInputRef}\n                value={searchQuery}\n                onChange={(event) => setSearchQuery(event.target.value)}\n                onKeyDown={(event) => {\n                  if (event.key === 'Enter') {\n                    event.preventDefault()\n                    handleSearchSubmit()\n                  }\n                  if (event.key === 'Escape') {\n                    event.preventDefault()\n                    closeSearch()\n                  }\n                }}\n                placeholder=\"Search stock, orders, summary...\"\n                className=\"vendor-search-input\"\n                aria-label=\"Search vendor console\"\n              />\n              <button type=\"button\" className=\"vendor-search-cancel\" onClick={closeSearch}>\n                Cancel\n              </button>\n            </div>\n            <div className=\"vendor-search-sheet__body\">\n              {searchResults.length ? (\n                searchResults.map((item) => (\n                  <button\n                    key={item.id}\n                    type=\"button\"\n                    onClick={() => handleSearchNavigate(item)}\n                    className=\"vendor-search-result\"\n                  >\n                    <span className=\"vendor-search-result__label\">{item.label}</span>\n                    <span className=\"vendor-search-result__meta\">{item.tabLabel}</span>\n                  </button>\n                ))\n              ) : (\n                <p className=\"vendor-search-empty\">No matches yet. Try another keyword.</p>\n              )}\n            </div>\n          </div>\n        </div>\n      ) : null}\n\n      {isMounted && (\n        <ButtonActionPanel\n          action={currentAction}\n          isOpen={isOpen}\n          onClose={closePanel}\n          onAction={async (actionData) => {\n            // Handle actions with API integration\n            const { type, data, buttonId } = actionData\n\n            try {\n              // Order actions\n              if (buttonId === 'order-available' && data.orderId) {\n                const result = await acceptOrder(data.orderId, data.notes)\n                if (result.data) {\n                  success('Order acceptance initiated. You have 1 hour to confirm or escalate.')\n                  getOrders().then((result) => {\n                    if (result.data) {\n                      dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n                      if (showOrderDetails && selectedOrderForDetails) {\n                        const updatedOrder = result.data.orders?.find((o) => {\n                          const candidateId =\n                            o._id?.toString?.() ||\n                            o.id?.toString?.() ||\n                            ''\n                          const selectedId =\n                            selectedOrderForDetails.id?.toString?.() ||\n                            selectedOrderForDetails._id?.toString?.() ||\n                            ''\n                          return candidateId && selectedId && candidateId === selectedId\n                        })\n                        if (updatedOrder) {\n                          setSelectedOrderForDetails(updatedOrder)\n                        }\n                      }\n                    }\n                  })\n                } else if (result.error) {\n                  error(result.error.message || 'Failed to accept order')\n                }\n              } else if (buttonId === 'confirm-acceptance' && data.orderId) {\n                const result = await confirmOrderAcceptance(data.orderId, { notes: data.notes })\n                if (result.data) {\n                  success('Order acceptance confirmed successfully!')\n                  getOrders().then((result) => {\n                    if (result.data) {\n                      dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n                      if (showOrderDetails && selectedOrderForDetails) {\n                        const updatedOrder = result.data.orders?.find((o) => {\n                          const candidateId =\n                            o._id?.toString?.() ||\n                            o.id?.toString?.() ||\n                            ''\n                          const selectedId =\n                            selectedOrderForDetails.id?.toString?.() ||\n                            selectedOrderForDetails._id?.toString?.() ||\n                            ''\n                          return candidateId && selectedId && candidateId === selectedId\n                        })\n                        if (updatedOrder) {\n                          setSelectedOrderForDetails(updatedOrder)\n                        }\n                      }\n                    }\n                  })\n                } else if (result.error) {\n                  error(result.error.message || 'Failed to confirm acceptance')\n                }\n              } else if (buttonId === 'cancel-acceptance' && data.orderId) {\n                const result = await cancelOrderAcceptance(data.orderId, { reason: data.reason })\n                if (result.data) {\n                  success('Order acceptance cancelled. You can now escalate if needed.')\n                  getOrders().then((result) => {\n                    if (result.data) {\n                      dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n                      if (showOrderDetails && selectedOrderForDetails) {\n                        const updatedOrder = result.data.orders?.find((o) => {\n                          const candidateId =\n                            o._id?.toString?.() ||\n                            o.id?.toString?.() ||\n                            ''\n                          const selectedId =\n                            selectedOrderForDetails.id?.toString?.() ||\n                            selectedOrderForDetails._id?.toString?.() ||\n                            ''\n                          return candidateId && selectedId && candidateId === selectedId\n                        })\n                        if (updatedOrder) {\n                          setSelectedOrderForDetails(updatedOrder)\n                        }\n                      }\n                    }\n                  })\n                } else if (result.error) {\n                  error(result.error.message || 'Failed to cancel acceptance')\n                }\n              } else if (buttonId === 'order-not-available' && data.orderId) {\n                // Open a panel to get reason for rejection\n                openPanel('order-reject-reason', { orderId: data.orderId })\n              } else if (buttonId === 'order-reject-confirm' && data.orderId && data.reason) {\n                const result = await rejectOrder(data.orderId, { reason: data.reason, notes: data.notes })\n                if (result.data) {\n                  success('Order rejected and forwarded to Admin')\n                  // Refresh orders and dashboard\n                  getOrders().then((result) => {\n                    if (result.data) {\n                      dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n                    }\n                  })\n                  fetchDashboardData()\n                  // Navigate to orders tab if not already there\n                  if (activeTab !== 'orders') {\n                    navigateToTab('orders')\n                  }\n                } else if (result.error) {\n                  error(result.error.message || 'Failed to reject order')\n                }\n              } else if (buttonId === 'order-partial-accept' && data.orderId && data.orderItems) {\n                // Handle partial order acceptance\n                const acceptedItems = data.orderItems.filter((item) => item.action === 'accept')\n                const rejectedItems = data.orderItems.filter((item) => item.action === 'reject')\n\n                if (acceptedItems.length === 0 && rejectedItems.length === 0) {\n                  error('Please select at least one item to accept or reject')\n                  return\n                }\n\n                const partialData = {\n                  acceptedItems: acceptedItems.map((item) => ({\n                    itemId: item.itemId,\n                    quantity: item.quantity,\n                  })),\n                  rejectedItems: rejectedItems.map((item) => ({\n                    itemId: item.itemId,\n                    quantity: item.quantity,\n                    reason: item.reason || 'Insufficient stock',\n                  })),\n                  notes: data.notes || '',\n                }\n\n                const result = await acceptOrderPartially(data.orderId, partialData)\n                if (result.data) {\n                  const acceptedCount = acceptedItems.length\n                  const rejectedCount = rejectedItems.length\n                  success(\n                    `Order partially accepted. ${acceptedCount} item(s) will be fulfilled by you, ${rejectedCount} item(s) escalated to Admin.`\n                  )\n                  // Refresh orders and dashboard\n                  getOrders().then((result) => {\n                    if (result.data) {\n                      dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n                      // If viewing order details, refresh the order\n                      if (showOrderDetails && selectedOrderForDetails) {\n                        const updatedOrder = result.data.orders?.find(o =>\n                          (o._id && selectedOrderForDetails.id && o._id.toString() === selectedOrderForDetails.id.toString()) ||\n                          (o.id && selectedOrderForDetails.id && o.id.toString() === selectedOrderForDetails.id.toString()) ||\n                          (o._id && selectedOrderForDetails._id && o._id.toString() === selectedOrderForDetails._id.toString())\n                        )\n                        if (updatedOrder) {\n                          setSelectedOrderForDetails(updatedOrder)\n                        }\n                      }\n                    }\n                  })\n                  fetchDashboardData()\n                  // Navigate to orders tab if not already there\n                  if (activeTab !== 'orders') {\n                    navigateToTab('orders')\n                  }\n                } else if (result.error) {\n                  error(result.error.message || 'Failed to accept order partially')\n                }\n              } else if (buttonId === 'update-order-status' && data.orderId && data.status) {\n                const updatePayload = {\n                  status: data.status\n                }\n                if (data.notes) {\n                  updatePayload.notes = data.notes\n                }\n                if (data.isRevert) {\n                  updatePayload.isRevert = data.isRevert\n                }\n\n                const result = await updateOrderStatus(data.orderId, updatePayload)\n                if (result.data) {\n                  // Show message from backend (includes grace period info if applicable)\n                  success(result.data.message || 'Order status updated successfully!')\n\n                  // If viewing order details, refresh the order details explicitly (only once)\n                  if (showOrderDetails && selectedOrderForDetails) {\n                    const orderId = data.orderId\n                    // Fetch full order details to ensure all data is up to date\n                    getOrderDetails(orderId).then((detailsResult) => {\n                      if (detailsResult.data?.order) {\n                        setSelectedOrderForDetails(detailsResult.data.order)\n                      }\n                    }).catch((err) => {\n                      console.error('Error refreshing order details:', err)\n                    })\n                  }\n\n                  // Refresh orders list and dashboard\n                  getOrders().then((result) => {\n                    if (result.data) {\n                      dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n                    }\n                  })\n                  fetchDashboardData()\n\n                  // Trigger OrdersView refresh (only once)\n                  setOrdersViewRefreshKey(prev => prev + 1)\n                } else if (result.error) {\n                  error(result.error.message || 'Failed to update order status')\n                }\n              }\n              // Inventory actions\n              else if (buttonId === 'update-stock' && data.itemId && data.newStock !== undefined) {\n                const result = await updateInventoryStock(data.itemId, {\n                  quantity: parseFloat(data.newStock),\n                  notes: data.reason,\n                })\n                if (result.data) {\n                  success('Stock updated successfully!')\n                  // Refresh dashboard data to update inventory stats\n                  fetchDashboardData()\n                  // Navigate to inventory tab if not already there\n                  if (activeTab !== 'inventory') {\n                    navigateToTab('inventory')\n                  }\n                } else if (result.error) {\n                  error(result.error.message || 'Failed to update stock')\n                }\n              }\n              // Credit purchase actions\n              else if (buttonId === 'place-credit-purchase' && data.amount) {\n                const purchaseData = {\n                  items: data.items ? [{ description: data.items }] : [],\n                  totalAmount: parseFloat(data.amount),\n                  notes: data.urgency ? `Urgency: ${data.urgency}` : '',\n                }\n                const result = await requestCreditPurchase(purchaseData)\n                if (result.data) {\n                  success('Purchase request submitted successfully. Waiting for Admin approval.')\n                  // Refresh credit info and dashboard\n                  fetchDashboardData()\n                  // Navigate to credit tab if not already there\n                  if (activeTab !== 'credit') {\n                    navigateToTab('credit')\n                  }\n                } else if (result.error) {\n                  error(result.error.message || 'Failed to submit purchase request')\n                }\n              }\n              // Withdrawal request actions\n              else if (buttonId === 'request-withdrawal' && data.amount) {\n                const withdrawalAmount = parseFloat(data.amount)\n                const availableBalance = data.availableBalance || 0\n\n                // Validate amount\n                if (withdrawalAmount < 1000) {\n                  error('Minimum withdrawal amount is â‚¹1,000')\n                  return\n                }\n\n                if (withdrawalAmount > availableBalance) {\n                  error(`Insufficient balance. Available: â‚¹${Math.round(availableBalance).toLocaleString('en-IN')}, Requested: â‚¹${withdrawalAmount.toLocaleString('en-IN')}`)\n                  return\n                }\n\n                // Get bank account details for confirmation\n                let bankAccountDetails = null\n                if (data.bankAccountId && data.bankAccounts) {\n                  const selectedAccount = data.bankAccounts.find(acc => (acc._id || acc.id) === data.bankAccountId)\n                  if (selectedAccount) {\n                    bankAccountDetails = {\n                      'Account Holder': selectedAccount.accountHolderName || 'N/A',\n                      'Account Number': `****${(selectedAccount.accountNumber || '').slice(-4)}`,\n                      'IFSC Code': selectedAccount.ifscCode || 'N/A',\n                      'Bank Name': selectedAccount.bankName || 'N/A',\n                    }\n                  }\n                }\n\n                // Show confirmation modal\n                setConfirmationData({\n                  type: 'withdrawal',\n                  amount: withdrawalAmount,\n                  availableBalance,\n                  bankAccountId: data.bankAccountId,\n                  bankAccountDetails,\n                })\n                setConfirmationModalOpen(true)\n                closePanel() // Close the action panel\n              }\n              // Credit repayment actions\n              else if (buttonId === 'repay-credit' && data.amount) {\n                // Keep amount as-is (can be decimal)\n                const repaymentAmount = parseFloat(data.amount)\n                const creditUsed = data.creditUsed || 0\n\n                // Validate amount\n                if (repaymentAmount < 0.01) {\n                  error('Minimum repayment amount is â‚¹0.01')\n                  return\n                }\n\n                // Check if exceeds creditUsed (can be decimal)\n                if (repaymentAmount > creditUsed) {\n                  error(`Repayment amount cannot exceed outstanding credit. Outstanding: â‚¹${creditUsed.toLocaleString('en-IN', { maximumFractionDigits: 2 })}, Requested: â‚¹${repaymentAmount.toLocaleString('en-IN', { maximumFractionDigits: 2 })}`)\n                  return\n                }\n\n                // Create payment intent and open Razorpay directly\n                // Bank account will be filled in Razorpay interface\n                try {\n                  closePanel() // Close the action panel first\n\n                  console.log('[VendorDashboard] Creating repayment intent with data:', {\n                    amount: repaymentAmount,\n                    creditUsed: creditUsed,\n                  })\n\n                  const intentResult = await createRepaymentIntent({\n                    amount: repaymentAmount,\n                    // bankAccountId not required - will be filled in Razorpay\n                  })\n\n                  console.log('[VendorDashboard] Repayment intent result:', intentResult)\n\n                  if (intentResult.error) {\n                    console.error('[VendorDashboard] Repayment intent error:', intentResult.error)\n                    error(intentResult.error.message || 'Failed to create payment intent')\n                    return\n                  }\n\n                  const repaymentData = intentResult.data?.repayment\n                  const razorpayData = intentResult.data?.razorpay\n\n                  if (!repaymentData || !razorpayData) {\n                    error('Invalid payment intent response')\n                    return\n                  }\n\n                  // Open Razorpay checkout directly\n                  const isTestMode = razorpayData.orderId?.startsWith('order_test_')\n\n                  if (isTestMode) {\n                    // Test mode: Simulate payment\n                    console.log('âš ï¸ Test mode: Simulating payment...')\n\n                    const simulatedPaymentResponse = {\n                      paymentId: `pay_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n                      orderId: razorpayData.orderId,\n                      signature: `sig_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n                    }\n\n                    // Confirm repayment with simulated payment\n                    const confirmResult = await confirmRepayment({\n                      repaymentId: repaymentData.id,\n                      razorpayPaymentId: simulatedPaymentResponse.paymentId,\n                      razorpayOrderId: simulatedPaymentResponse.orderId,\n                      razorpaySignature: simulatedPaymentResponse.signature,\n                    })\n\n                    if (confirmResult.data) {\n                      success(`Repayment of â‚¹${repaymentAmount.toLocaleString('en-IN')} completed successfully!`)\n                      getCreditInfo()\n                      fetchDashboardData()\n                      // Trigger repayment history refresh\n                      window.dispatchEvent(new Event('repayment-success'))\n                      if (activeTab !== 'credit') {\n                        navigateToTab('credit')\n                      }\n                    } else if (confirmResult.error) {\n                      error(confirmResult.error.message || 'Failed to confirm repayment')\n                    }\n                  } else {\n                    // Production mode: Open Razorpay checkout\n                    try {\n                      const paymentResponse = await openRazorpayCheckout({\n                        key: razorpayData.key,\n                        amount: razorpayData.amount / 100, // Convert from paise to rupees\n                        currency: razorpayData.currency || 'INR',\n                        order_id: razorpayData.orderId,\n                        name: 'IRA SATHI',\n                        description: `Credit Repayment - â‚¹${repaymentAmount.toLocaleString('en-IN')}`,\n                        prefill: {\n                          name: profile?.name || '',\n                          email: profile?.email || '',\n                          contact: profile?.phone || '',\n                        },\n                      })\n\n                      if (paymentResponse.success) {\n                        // Confirm repayment after successful payment\n                        const confirmResult = await confirmRepayment({\n                          repaymentId: repaymentData.id,\n                          razorpayPaymentId: paymentResponse.paymentId,\n                          razorpayOrderId: paymentResponse.orderId,\n                          razorpaySignature: paymentResponse.signature,\n                        })\n\n                        if (confirmResult.data) {\n                          success(`Repayment of â‚¹${repaymentAmount.toLocaleString('en-IN')} completed successfully!`)\n                          getCreditInfo()\n                          fetchDashboardData()\n                          // Trigger repayment history refresh\n                          window.dispatchEvent(new Event('repayment-success'))\n                          if (activeTab !== 'credit') {\n                            navigateToTab('credit')\n                          }\n                        } else if (confirmResult.error) {\n                          error(confirmResult.error.message || 'Failed to confirm repayment')\n                        }\n                      }\n                    } catch (paymentErr) {\n                      error(paymentErr.error || paymentErr.message || 'Payment was cancelled or failed')\n                    }\n                  }\n                } catch (err) {\n                  error(err.message || 'Failed to initialize repayment')\n                }\n              }\n              // Admin request actions\n              else if (type === 'update' && data.type === 'admin_request') {\n                // Simulate sending request to admin (this would be a separate API endpoint)\n                success('Request sent to admin successfully. You will be notified once reviewed.')\n              } else {\n                // Default success message for other actions\n                success('Action completed successfully')\n              }\n            } catch (err) {\n              error(err.message || 'An unexpected error occurred')\n            }\n          }}\n          onShowNotification={(message, type = 'info') => {\n            if (type === 'success') success(message)\n            else if (type === 'error') error(message)\n            else if (type === 'warning') warning(message)\n            else info(message)\n          }}\n        />\n      )}\n\n      {/* Confirmation Modal */}\n      <ConfirmationModal\n        isOpen={confirmationModalOpen}\n        onClose={() => {\n          setConfirmationModalOpen(false)\n          setConfirmationData(null)\n        }}\n        onConfirm={async () => {\n          if (!confirmationData) return\n\n          setConfirmationLoading(true)\n          try {\n            if (confirmationData.type === 'withdrawal') {\n              const withdrawalData = {\n                amount: confirmationData.amount,\n                bankAccountId: confirmationData.bankAccountId || undefined,\n              }\n              const result = await requestWithdrawal(withdrawalData)\n              if (result.data) {\n                success('Withdrawal request submitted successfully. Awaiting admin approval.')\n                setConfirmationModalOpen(false)\n                setConfirmationData(null)\n                // Refresh earnings summary and dashboard\n                getEarningsSummary()\n                fetchDashboardData()\n                // Navigate to earnings tab if not already there\n                if (activeTab !== 'earnings') {\n                  navigateToTab('earnings')\n                }\n              } else if (result.error) {\n                error(result.error.message || 'Failed to submit withdrawal request')\n              }\n            } else if (confirmationData.type === 'repayment') {\n              // Handle repayment with Razorpay checkout\n              try {\n                // Check if test mode (simulated payment)\n                const isTestMode = confirmationData.razorpayOrderId?.startsWith('order_test_')\n\n                let paymentResponse = null\n\n                if (isTestMode) {\n                  // Simulate payment in test mode\n                  console.log('âš ï¸ Test mode: Simulating payment...')\n                  paymentResponse = {\n                    success: true,\n                    paymentId: `pay_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n                    orderId: confirmationData.razorpayOrderId,\n                    signature: `sig_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n                  }\n                } else {\n                  // Open Razorpay checkout\n                  paymentResponse = await openRazorpayCheckout({\n                    key: confirmationData.razorpayKey,\n                    amount: confirmationData.razorpayAmount / 100, // Convert from paise to rupees\n                    currency: 'INR',\n                    order_id: confirmationData.razorpayOrderId,\n                    name: 'IRA SATHI',\n                    description: `Credit Repayment - â‚¹${confirmationData.amount.toLocaleString('en-IN')}`,\n                    prefill: {\n                      name: profile?.name || '',\n                      email: profile?.email || '',\n                      contact: profile?.phone || '',\n                    },\n                  })\n                }\n\n                if (paymentResponse.success) {\n                  // Confirm repayment with payment details\n                  const confirmResult = await confirmRepayment({\n                    repaymentId: confirmationData.repaymentId,\n                    razorpayPaymentId: paymentResponse.paymentId,\n                    razorpayOrderId: paymentResponse.orderId,\n                    razorpaySignature: paymentResponse.signature,\n                  })\n\n                  if (confirmResult.data) {\n                    success(`Repayment of â‚¹${confirmationData.amount.toLocaleString('en-IN')} completed successfully!`)\n                    setConfirmationModalOpen(false)\n                    setConfirmationData(null)\n                    // Refresh credit info and dashboard\n                    getCreditInfo()\n                    fetchDashboardData()\n                    // Navigate to credit tab if not already there\n                    if (activeTab !== 'credit') {\n                      navigateToTab('credit')\n                    }\n                  } else if (confirmResult.error) {\n                    error(confirmResult.error.message || 'Failed to confirm repayment')\n                  }\n                } else {\n                  error(paymentResponse.error || 'Payment was cancelled or failed')\n                }\n              } catch (paymentErr) {\n                error(paymentErr.error || paymentErr.message || 'Payment failed. Please try again.')\n              }\n            }\n          } catch (err) {\n            error(err.message || 'An unexpected error occurred')\n          } finally {\n            setConfirmationLoading(false)\n          }\n        }}\n        title={confirmationData?.type === 'repayment' ? 'Confirm Repayment' : 'Confirm Withdrawal Request'}\n        message={confirmationData?.type === 'repayment'\n          ? 'Please verify all repayment details before proceeding. Payment will be processed via Razorpay.'\n          : 'Please verify all bank account details and withdrawal amount before proceeding. Once submitted, this request will be sent to admin for approval.'}\n        details={confirmationData ? (confirmationData.type === 'repayment' ? {\n          'Repayment Amount': `â‚¹${confirmationData.amount.toLocaleString('en-IN')}`,\n          'Penalty Amount': confirmationData.penaltyAmount > 0 ? `â‚¹${confirmationData.penaltyAmount.toLocaleString('en-IN')}` : 'â‚¹0',\n          'Total Amount': `â‚¹${confirmationData.totalAmount.toLocaleString('en-IN')}`,\n          'Outstanding Credit (Before)': `â‚¹${confirmationData.creditUsedBefore.toLocaleString('en-IN')}`,\n          'Outstanding Credit (After)': `â‚¹${confirmationData.creditUsedAfter.toLocaleString('en-IN')}`,\n          ...(confirmationData.bankAccountDetails || {}),\n        } : {\n          'Withdrawal Amount': `â‚¹${confirmationData.amount.toLocaleString('en-IN')}`,\n          'Available Balance': `â‚¹${Math.round(confirmationData.availableBalance).toLocaleString('en-IN')}`,\n          ...(confirmationData.bankAccountDetails || {}),\n        }) : null}\n        loading={confirmationLoading}\n      />\n\n      {/* Escalation Modals */}\n      <OrderEscalationModal\n        isOpen={escalationModalOpen}\n        onClose={() => {\n          setEscalationModalOpen(false)\n          setSelectedOrderForEscalation(null)\n        }}\n        order={selectedOrderForEscalation}\n        onSuccess={() => {\n          // Refresh orders - modal already closes itself\n          if (activeTab === 'orders') {\n            getOrders().then((result) => {\n              if (result.data) {\n                dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n                // If viewing order details, refresh the order\n                if (showOrderDetails && selectedOrderForDetails) {\n                  const updatedOrder = result.data.orders?.find(o =>\n                    (o._id && selectedOrderForDetails.id && o._id.toString() === selectedOrderForDetails.id.toString()) ||\n                    (o.id && selectedOrderForDetails.id && o.id.toString() === selectedOrderForDetails.id.toString()) ||\n                    (o._id && selectedOrderForDetails._id && o._id.toString() === selectedOrderForDetails._id.toString())\n                  )\n                  if (updatedOrder) {\n                    setSelectedOrderForDetails(updatedOrder)\n                  }\n                }\n              }\n            })\n            fetchDashboardData()\n          }\n        }}\n      />\n\n      <OrderPartialEscalationModal\n        isOpen={partialEscalationModalOpen}\n        onClose={() => {\n          setPartialEscalationModalOpen(false)\n          setSelectedOrderForEscalation(null)\n        }}\n        order={selectedOrderForEscalation}\n        escalationType={escalationType}\n        onSuccess={() => {\n          // Refresh orders - modal already closes itself\n          if (activeTab === 'orders') {\n            getOrders().then((result) => {\n              if (result.data) {\n                dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n                // If viewing order details, refresh the order\n                if (showOrderDetails && selectedOrderForDetails) {\n                  const updatedOrder = result.data.orders?.find(o =>\n                    (o._id && selectedOrderForDetails.id && o._id.toString() === selectedOrderForDetails.id.toString()) ||\n                    (o.id && selectedOrderForDetails.id && o.id.toString() === selectedOrderForDetails.id.toString()) ||\n                    (o._id && selectedOrderForDetails._id && o._id.toString() === selectedOrderForDetails._id.toString())\n                  )\n                  if (updatedOrder) {\n                    setSelectedOrderForDetails(updatedOrder)\n                  }\n                }\n              }\n            })\n            fetchDashboardData()\n          }\n        }}\n      />\n\n      <ToastContainer toasts={toasts} onDismiss={dismissToast} />\n\n      {/* Notification Panel */}\n      <NotificationPanel\n        isOpen={notificationPanelOpen}\n        onClose={handleNotificationPanelClose}\n        notifications={notifications}\n        onMarkAsRead={handleMarkNotificationAsRead}\n        onMarkAllAsRead={handleMarkAllNotificationsAsRead}\n      />\n    </>\n  )\n}\n\nfunction OverviewView({ onNavigate, welcomeName, openPanel }) {\n  const { profile, dashboard } = useVendorState()\n  const { fetchDashboardData, getWithdrawals, getRepaymentHistory, getEarningsSummary } = useVendorApi()\n  const servicesRef = useRef(null)\n  const [servicePage, setServicePage] = useState(0)\n  const [recentWithdrawals, setRecentWithdrawals] = useState([])\n  const [recentRepayments, setRecentRepayments] = useState([])\n  const [availableBalance, setAvailableBalance] = useState(0)\n\n  // Fetch dashboard data on mount\n  useEffect(() => {\n    fetchDashboardData().then((result) => {\n      if (result.data) {\n        // Data is stored in context via the API hook\n      }\n    })\n\n    // Fetch available balance from earnings\n    getEarningsSummary().then((result) => {\n      if (result.data?.availableBalance) {\n        setAvailableBalance(result.data.availableBalance)\n      }\n    }).catch(() => {\n      // Silently fail - earnings data is optional\n    })\n  }, [fetchDashboardData, getEarningsSummary])\n\n  const services = [\n    { label: 'Stock', note: 'Reorder stock', tone: 'success', target: 'inventory', icon: BoxIcon, action: null },\n    { label: 'Pricing', note: 'Update price', tone: 'warn', target: 'inventory', icon: ReportIcon, action: 'update-mrp' },\n    { label: 'Send', note: 'Arrange truck', tone: 'success', target: 'orders', icon: TruckIcon, action: null },\n    { label: 'Wallet', note: 'View payments', tone: 'success', target: 'credit', icon: WalletIcon, action: 'view-payouts' },\n    { label: 'Performance', note: 'Summary', tone: 'success', target: 'reports', icon: ChartIcon, action: null },\n    { label: 'Support', note: 'Get help', tone: 'warn', target: 'orders', icon: MenuIcon, action: null },\n    { label: 'Network', note: 'Partner list', tone: 'success', target: 'reports', icon: HomeIcon, action: null },\n    { label: 'Settings', note: 'Profile & verification', tone: 'success', target: 'credit', icon: CreditIcon, action: 'profile-settings' },\n  ]\n\n  // Fetch recent withdrawals for activity\n  useEffect(() => {\n    const loadRecentWithdrawals = async () => {\n      try {\n        const result = await getWithdrawals({ page: 1, limit: 5, status: 'approved' })\n        if (result.data?.withdrawals) {\n          setRecentWithdrawals(result.data.withdrawals)\n        }\n      } catch (err) {\n        // Silently fail - withdrawals are optional for activity\n      }\n    }\n    loadRecentWithdrawals()\n  }, [getWithdrawals])\n\n  // Fetch recent repayments for activity\n  const loadRecentRepayments = useCallback(async () => {\n    try {\n      const result = await getRepaymentHistory({ page: 1, limit: 5, status: 'completed' })\n      if (result.data?.repayments) {\n        setRecentRepayments(result.data.repayments)\n      }\n    } catch (err) {\n      // Silently fail - repayments are optional for activity\n    }\n  }, [getRepaymentHistory])\n\n  useEffect(() => {\n    loadRecentRepayments()\n\n    // Listen for repayment success to refresh\n    const handleRepaymentSuccess = () => {\n      loadRecentRepayments()\n    }\n    window.addEventListener('repayment-success', handleRepaymentSuccess)\n    return () => {\n      window.removeEventListener('repayment-success', handleRepaymentSuccess)\n    }\n  }, [loadRecentRepayments])\n\n  // Use data from context or fallback to snapshot\n  const overviewData = dashboard.overview || {}\n\n  // Transform recent orders from backend to activity format\n  const recentOrders = overviewData.recentOrders || []\n  const orderTransactions = recentOrders.map((order) => {\n    const customerName = order.userId?.name || 'Unknown Customer'\n    const initials = customerName.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase()\n    return {\n      name: customerName,\n      action: `Order ${order.status === 'pending' ? 'received' : order.status === 'awaiting' ? 'accepted' : order.status}`,\n      amount: `+â‚¹${(order.totalAmount || 0).toLocaleString('en-IN')}`,\n      status: order.status === 'delivered' ? 'Completed' : order.status === 'pending' ? 'Pending' : 'In Progress',\n      avatar: initials,\n      orderId: order._id || order.id,\n      orderNumber: order.orderNumber,\n      type: 'order',\n      date: order.createdAt || order.updatedAt,\n    }\n  })\n\n  // Transform recent withdrawals to activity format\n  const withdrawalTransactions = recentWithdrawals.map((withdrawal) => {\n    const statusText = withdrawal.status === 'approved' ? 'Approved' : withdrawal.status === 'completed' ? 'Completed' : withdrawal.status\n    return {\n      name: 'Withdrawal Request',\n      action: `Withdrawal ${statusText}`,\n      amount: `-â‚¹${(withdrawal.amount || 0).toLocaleString('en-IN')}`,\n      status: statusText,\n      avatar: 'WD',\n      withdrawalId: withdrawal._id || withdrawal.id,\n      type: 'withdrawal',\n      date: withdrawal.reviewedAt || withdrawal.createdAt,\n    }\n  })\n\n  // Transform recent repayments to activity format\n  const repaymentTransactions = recentRepayments.map((repayment) => {\n    return {\n      name: 'Credit Repayment',\n      action: `Repayment ${repayment.status === 'completed' ? 'Completed' : repayment.status === 'pending' ? 'Pending' : repayment.status}`,\n      amount: `-â‚¹${(repayment.amount || 0).toLocaleString('en-IN')}`,\n      status: repayment.status === 'completed' ? 'Completed' : repayment.status === 'pending' ? 'Pending' : repayment.status,\n      avatar: 'RP',\n      repaymentId: repayment._id || repayment.id,\n      repaymentNumber: repayment.repaymentId,\n      type: 'repayment',\n      date: repayment.paidAt || repayment.transactionDate || repayment.createdAt,\n      penaltyAmount: repayment.penaltyAmount || 0,\n    }\n  })\n\n  // Combine and sort by date (most recent first)\n  const allTransactions = [...orderTransactions, ...withdrawalTransactions, ...repaymentTransactions].sort((a, b) => {\n    const dateA = a.date ? new Date(a.date).getTime() : 0\n    const dateB = b.date ? new Date(b.date).getTime() : 0\n    return dateB - dateA\n  })\n\n  // If no transactions, use empty array (don't show dummy data)\n  const displayTransactions = allTransactions.length > 0 ? allTransactions.slice(0, 4) : []\n\n  // Format available balance from earnings\n  const formatAvailableBalance = (balance) => {\n    if (!balance || balance === 0) return 'â‚¹0'\n    if (balance >= 100000) return `â‚¹${(balance / 100000).toFixed(1)}L`\n    return `â‚¹${Math.round(balance).toLocaleString('en-IN')}`\n  }\n\n  const walletBalance = formatAvailableBalance(availableBalance)\n\n  const quickActions = [\n    {\n      label: 'Confirm delivery time',\n      description: 'Set delivery time',\n      target: 'orders',\n      icon: TruckIcon,\n      tone: 'green',\n      action: 'confirm-delivery-slot',\n    },\n    {\n      label: 'Update stock',\n      description: 'Add new stock / update stock',\n      target: 'inventory',\n      icon: BoxIcon,\n      tone: 'orange',\n      action: 'update-inventory-batch',\n    },\n    {\n      label: 'Request credit order',\n      description: 'Request stock from admin',\n      target: 'credit',\n      icon: CreditIcon,\n      tone: 'teal',\n      action: 'raise-credit-order',\n    },\n  ]\n\n  useEffect(() => {\n    const container = servicesRef.current\n    if (!container) return\n\n    const handleScroll = () => {\n      const max = container.scrollWidth - container.clientWidth\n      if (max <= 0) {\n        setServicePage(0)\n        return\n      }\n      const progress = container.scrollLeft / max\n      const index = Math.min(2, Math.max(0, Math.round(progress * 2)))\n      setServicePage(index)\n    }\n\n    handleScroll()\n    container.addEventListener('scroll', handleScroll, { passive: true })\n    return () => container.removeEventListener('scroll', handleScroll)\n  }, [services.length])\n\n  return (\n    <div className=\"vendor-overview space-y-6\">\n      <section id=\"overview-hero\" className=\"overview-hero\">\n        <div className=\"overview-hero__card\">\n          <div className=\"overview-hero__meta\">\n            <span className=\"overview-chip overview-chip--success\">\n              Active Zone â€¢ {profile?.coverageRadius || dashboard?.overview?.coverageRadius || 20} km\n            </span>\n            <span className=\"overview-chip overview-chip--warn\">Today {new Date().toLocaleDateString('en-GB')}</span>\n          </div>\n          <div className=\"overview-hero__core\">\n            <div className=\"overview-hero__identity\">\n              <span className=\"overview-hero__greeting\">Today's summary</span>\n              <h2 className=\"overview-hero__welcome\">{welcomeName}</h2>\n            </div>\n            <div className=\"overview-hero__badge\">\n              <SparkIcon className=\"h-6 w-6 text-white\" />\n            </div>\n          </div>\n          <div className=\"overview-hero__balance\">\n            <div>\n              <p className=\"overview-hero__label\">Available money</p>\n              <p className=\"overview-hero__value\">{walletBalance}</p>\n            </div>\n            <button type=\"button\" onClick={() => openPanel('check-credit')} className=\"overview-hero__cta\">\n              Check credit\n            </button>\n          </div>\n          <div className=\"overview-hero__stats\">\n            {[\n              { label: 'Orders waiting for your reply', value: String(overviewData.orders?.pending || 0) },\n              { label: 'Orders in processing', value: String(overviewData.orders?.processing || 0) },\n              { label: 'Low stock alerts', value: String(overviewData.inventory?.lowStockCount || 0) },\n              { label: 'Credit utilization', value: `${Math.round(overviewData.credit?.utilization || 0)}%` },\n            ].map((item) => (\n              <div key={item.label} className=\"overview-stat-card\">\n                <p>{item.label}</p>\n                <span>{item.value}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      <section id=\"overview-services\" className=\"overview-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Shortcuts</h3>\n          </div>\n        </div>\n        <div ref={servicesRef} className=\"overview-services__rail\">\n          {services.map((service) => (\n            <button\n              key={service.label}\n              type=\"button\"\n              onClick={() => {\n                if (service.action) {\n                  openPanel(service.action)\n                } else if (service.target) {\n                  onNavigate(service.target)\n                }\n              }}\n              className=\"overview-service-card\"\n            >\n              <span className={cn('overview-service-card__icon', service.tone === 'warn' ? 'is-warn' : 'is-success')}>\n                <service.icon className=\"h-5 w-5\" />\n              </span>\n              <span className=\"overview-service-card__label\">{service.label}</span>\n              <span className=\"overview-service-card__note\">{service.note}</span>\n            </button>\n          ))}\n        </div>\n        <div className=\"overview-services__dots\" aria-hidden=\"true\">\n          {[0, 1, 2].map((dot) => (\n            <span\n              key={dot}\n              className={cn('overview-services__dot', servicePage === dot && 'is-active')}\n            />\n          ))}\n        </div>\n      </section>\n\n      <section id=\"overview-activity\" className=\"overview-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Recent activity</h3>\n          </div>\n        </div>\n        <div className=\"overview-activity__list\">\n          {displayTransactions.length > 0 ? displayTransactions.map((item, index) => (\n            <div key={item.orderId || item.withdrawalId || item.repaymentId || `${item.name}-${index}`} className=\"overview-activity__item\">\n              <div className=\"overview-activity__avatar\">{item.avatar}</div>\n              <div className=\"overview-activity__details\">\n                <div className=\"overview-activity__row\">\n                  <span className=\"overview-activity__name\">\n                    {item.type === 'repayment' && item.repaymentNumber ? item.repaymentNumber : item.name}\n                  </span>\n                  <span\n                    className={cn(\n                      'overview-activity__amount',\n                      item.amount.startsWith('-') ? 'is-negative' : 'is-positive',\n                    )}\n                  >\n                    {item.amount}\n                  </span>\n                </div>\n                <div className=\"overview-activity__meta\">\n                  <span>{item.action}</span>\n                  <span>{item.status}</span>\n                  {item.type === 'repayment' && item.penaltyAmount > 0 && (\n                    <span className=\"text-xs text-red-600\">\n                      (Penalty: â‚¹{item.penaltyAmount.toLocaleString('en-IN')})\n                    </span>\n                  )}\n                </div>\n              </div>\n            </div>\n          )) : (\n            <div className=\"overview-activity__item\">\n              <div className=\"overview-activity__details\">\n                <p className=\"text-sm text-gray-500\">No recent activity</p>\n              </div>\n            </div>\n          )}\n        </div>\n      </section>\n\n\n      <section id=\"overview-snapshot\" className=\"overview-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Quick summary</h3>\n          </div>\n        </div>\n        <div className=\"overview-metric-grid\">\n          {[\n            {\n              id: 'orders',\n              label: 'Total Orders',\n              value: String(overviewData.orders?.total || 0),\n              trend: 'Today',\n              // Calculate progress based on orders today vs average (if available) or use utilization\n              progress: overviewData.orders?.total ? Math.min(100, Math.max(10, (overviewData.orders.total / Math.max(overviewData.orders.averageDaily || 10, 1)) * 50)) : 0\n            },\n            {\n              id: 'inventory',\n              label: 'Products',\n              value: String(overviewData.inventory?.totalProducts || 0),\n              trend: 'Assigned',\n              // Calculate progress based on in-stock vs total products\n              progress: overviewData.inventory?.totalProducts ? Math.min(100, Math.max(10, ((overviewData.inventory.totalProducts - (overviewData.inventory.outOfStockCount || 0)) / overviewData.inventory.totalProducts) * 100)) : 0\n            },\n            {\n              id: 'credit',\n              label: 'Credit Used',\n              value: overviewData.credit?.used ? `â‚¹${(overviewData.credit.used / 100000).toFixed(1)}L` : 'â‚¹0',\n              trend: `${Math.round(overviewData.credit?.utilization || 0)}%`,\n              // Use actual credit utilization percentage\n              progress: Math.min(100, Math.max(0, overviewData.credit?.utilization || 0))\n            },\n          ].map((item) => (\n            <div key={item.id} className=\"overview-metric-card\">\n              <div className=\"overview-metric-card__head\">\n                <p>{item.label}</p>\n                <span>{item.trend}</span>\n              </div>\n              <h4>{item.value}</h4>\n              <div className=\"overview-metric-card__bar\">\n                <span style={{ width: `${item.progress}%` }} />\n              </div>\n            </div>\n          ))}\n        </div>\n      </section>\n\n      <section id=\"overview-quick-actions\" className=\"overview-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Quick actions</h3>\n          </div>\n        </div>\n        <div className=\"overview-callout-grid\">\n          {quickActions.map((action) => (\n            <button\n              key={action.label}\n              type=\"button\"\n              onClick={() => {\n                if (action.action) {\n                  openPanel(action.action)\n                } else if (action.target) {\n                  onNavigate(action.target)\n                }\n              }}\n              className={cn(\n                'overview-callout',\n                action.tone === 'orange'\n                  ? 'is-warn'\n                  : action.tone === 'teal'\n                    ? 'is-teal'\n                    : 'is-success',\n              )}\n            >\n              <span className=\"overview-callout__icon\">\n                <action.icon className=\"h-5 w-5\" />\n              </span>\n              <span className=\"overview-callout__label\">{action.label}</span>\n              <span className=\"overview-callout__note\">{action.description}</span>\n            </button>\n          ))}\n        </div>\n      </section>\n    </div>\n  )\n}\n\nfunction InventoryView({ openPanel, onNavigate }) {\n  const { dashboard, profile } = useVendorState()\n  const dispatch = useVendorDispatch()\n  const { success, error: showError } = useToast()\n  const { getProducts, getProductDetails, requestCreditPurchase, getCreditPurchases, fetchDashboardData } = useVendorApi()\n  const MIN_PURCHASE_VALUE = 50000\n  const MAX_PURCHASE_VALUE = 100000\n  const [productsData, setProductsData] = useState(null)\n  const [selectedProduct, setSelectedProduct] = useState(null)\n  const [orderQuantity, setOrderQuantity] = useState('')\n  const [confirmProductName, setConfirmProductName] = useState('')\n  const [orderNotes, setOrderNotes] = useState('')\n  const [orderError, setOrderError] = useState('')\n  const [isSubmittingOrder, setIsSubmittingOrder] = useState(false)\n  const [selectedProductAttributes, setSelectedProductAttributes] = useState({}) // For single product ordering\n  const [selectedProductAttributeStock, setSelectedProductAttributeStock] = useState(null)\n  const [showOrderRequestScreen, setShowOrderRequestScreen] = useState(false)\n  const [selectedProducts, setSelectedProducts] = useState([]) // Array of {productId, quantity}\n  const [orderRequestForm, setOrderRequestForm] = useState({\n    reason: '',\n    notes: '',\n    bankAccountName: '',\n    bankAccountNumber: '',\n    bankName: '',\n    bankIfsc: '',\n    bankBranch: '',\n    confirmationText: '',\n    creditPolicyAccepted: false,\n  })\n  const [orderRequestError, setOrderRequestError] = useState('')\n  const [isOrderRequestSubmitting, setIsOrderRequestSubmitting] = useState(false)\n  const [purchaseRequests, setPurchaseRequests] = useState([])\n  const [isPurchaseHistoryLoading, setIsPurchaseHistoryLoading] = useState(false)\n  const [showCreditPolicyModal, setShowCreditPolicyModal] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [expandedProductId, setExpandedProductId] = useState(null) // Track which product's variants are expanded\n  const [productsWithVariants, setProductsWithVariants] = useState({}) // Cache products with full variant details: { productId: product }\n  const [loadingVariants, setLoadingVariants] = useState(false) // Track if variants are being loaded\n  const orderFormRef = useRef(null)\n\n  useEffect(() => {\n    const token = localStorage.getItem('vendor_token')\n    if (!token) return\n\n    setLoading(true)\n    getProducts({ limit: 100 }).then((result) => {\n      if (result.data) {\n        setProductsData(result.data)\n        // Debug: Check if any products have attributeStocks\n        const products = result.data.products || []\n        const productsWithVariants = products.filter(p =>\n          p.attributeStocks &&\n          Array.isArray(p.attributeStocks) &&\n          p.attributeStocks.length > 0\n        )\n        if (productsWithVariants.length > 0) {\n          console.log('Products with variants found:', productsWithVariants.length, productsWithVariants.map(p => ({ name: p.name, attributeStocks: p.attributeStocks })))\n        } else {\n          console.log('No products with attributeStocks found. Total products:', products.length)\n          // Log first product structure for debugging\n          if (products.length > 0) {\n            console.log('Sample product structure:', {\n              name: products[0].name,\n              hasAttributeStocks: !!products[0].attributeStocks,\n              attributeStocks: products[0].attributeStocks,\n              keys: Object.keys(products[0])\n            })\n          }\n        }\n      } else if (result.error?.status === 401) {\n        localStorage.removeItem('vendor_token')\n      }\n    }).catch((err) => {\n      console.error('Failed to load products:', err)\n      if (err.error?.status === 401) {\n        localStorage.removeItem('vendor_token')\n      }\n    }).finally(() => {\n      setLoading(false)\n    })\n  }, [getProducts])\n\n  useEffect(() => {\n    setOrderQuantity('')\n    setConfirmProductName('')\n    setOrderNotes('')\n    setOrderError('')\n    setSelectedProductAttributes({})\n    setSelectedProductAttributeStock(null)\n  }, [selectedProduct?.id])\n\n  const resetOrderRequestForm = () => {\n    setSelectedProducts([])\n    setOrderRequestForm({\n      reason: '',\n      notes: '',\n      bankAccountName: '',\n      bankAccountNumber: '',\n      bankName: '',\n      bankIfsc: '',\n      bankBranch: '',\n      confirmationText: '',\n      creditPolicyAccepted: false,\n    })\n    setOrderRequestError('')\n    setIsOrderRequestSubmitting(false)\n  }\n\n  const openOrderRequestScreen = () => {\n    setSelectedProduct(null)\n    resetOrderRequestForm()\n    setShowOrderRequestScreen(true)\n  }\n\n  const closeOrderRequestScreen = () => {\n    setShowOrderRequestScreen(false)\n    setOrderRequestError('')\n  }\n\n  const handleOrderRequestChange = (field, value) => {\n    setOrderRequestForm((prev) => ({\n      ...prev,\n      [field]: value,\n    }))\n  }\n\n  const handleAddProduct = (productId) => {\n    const exists = selectedProducts.find((p) => p.productId === productId)\n    if (!exists) {\n      setSelectedProducts((prev) => [...prev, { productId, quantity: '' }])\n    }\n  }\n\n  const handleAddVariantToOrder = (productId, variantStock) => {\n    // Check if this exact variant is already added\n    const variantKey = JSON.stringify(variantStock.attributes || {})\n    const exists = selectedProducts.find((p) => {\n      if (p.productId !== productId) return false\n      const existingVariantKey = JSON.stringify(p.attributes || {})\n      return existingVariantKey === variantKey\n    })\n\n    if (!exists) {\n      setSelectedProducts((prev) => [...prev, {\n        productId,\n        quantity: '',\n        attributes: variantStock.attributes || {},\n        attributeStock: variantStock\n      }])\n      // Keep dropdown open so user can add more variants\n      // Don't close: setExpandedProductId(null)\n    }\n  }\n\n  // Fetch product details when user wants to view variants\n  const handleViewVariants = async (productId) => {\n    // If already expanded, just collapse\n    if (expandedProductId === productId) {\n      setExpandedProductId(null)\n      return\n    }\n\n    // If we already have variant details cached, just expand\n    if (productsWithVariants[productId]) {\n      setExpandedProductId(productId)\n      return\n    }\n\n    // Otherwise, fetch product details\n    setLoadingVariants(true)\n    try {\n      const result = await getProductDetails(productId)\n      if (result.data?.product) {\n        const productWithVariants = result.data.product\n        // Check if product actually has variants\n        const hasVariants = productWithVariants.attributeStocks &&\n          Array.isArray(productWithVariants.attributeStocks) &&\n          productWithVariants.attributeStocks.length > 0 &&\n          productWithVariants.attributeStocks.some(stock => {\n            if (!stock) return false\n            if (stock.attributes && typeof stock.attributes === 'object') {\n              const attrKeys = Object.keys(stock.attributes)\n              if (attrKeys.length > 0) {\n                return attrKeys.some(key => stock.attributes[key] != null && stock.attributes[key] !== '')\n              }\n            }\n            return false\n          })\n\n        // Cache the product (even if no variants, cache it to avoid re-fetching)\n        setProductsWithVariants(prev => ({\n          ...prev,\n          [productId]: productWithVariants\n        }))\n        // Update the products list with variant info\n        setProductsData(prev => {\n          if (!prev || !prev.products) return prev\n          const updatedProducts = prev.products.map(p =>\n            (p.id || p._id)?.toString() === productId\n              ? { ...p, attributeStocks: productWithVariants.attributeStocks || [] }\n              : p\n          )\n          return { ...prev, products: updatedProducts }\n        })\n\n        // Only expand if product has variants\n        if (hasVariants) {\n          setExpandedProductId(productId)\n        } else {\n          // Product has no variants, add it directly to order\n          handleAddProduct(productId)\n        }\n      } else {\n        // Product not found or no data, add it directly to order\n        handleAddProduct(productId)\n      }\n    } catch (err) {\n      console.error('Failed to load product variants:', err)\n      showError('Failed to load product variants')\n    } finally {\n      setLoadingVariants(false)\n    }\n  }\n\n  const handleRemoveProduct = (productId) => {\n    setSelectedProducts((prev) => prev.filter((p) => p.productId !== productId))\n  }\n\n  const handleQuantityChange = (productId, quantity, variantAttributes = null) => {\n    setSelectedProducts((prev) =>\n      prev.map((p) => {\n        if (p.productId !== productId) return p\n        // If variantAttributes is provided, only update matching variant\n        if (variantAttributes && Object.keys(variantAttributes).length > 0) {\n          const variantKey = JSON.stringify(variantAttributes)\n          const existingVariantKey = JSON.stringify(p.attributes || {})\n          if (variantKey === existingVariantKey) {\n            return { ...p, quantity }\n          }\n          return p\n        }\n        // If no variant attributes, update if this product has no variants\n        if (!p.attributes || Object.keys(p.attributes).length === 0) {\n          return { ...p, quantity }\n        }\n        return p\n      })\n    )\n  }\n\n  const loadPurchaseRequests = useCallback(async () => {\n    setIsPurchaseHistoryLoading(true)\n    try {\n      const result = await getCreditPurchases({ limit: 5 })\n      if (result.data?.purchases) {\n        setPurchaseRequests(result.data.purchases)\n      }\n    } catch (err) {\n      console.error('Failed to load purchase requests:', err)\n    } finally {\n      setIsPurchaseHistoryLoading(false)\n    }\n  }, [getCreditPurchases])\n\n  useEffect(() => {\n    if (showOrderRequestScreen) {\n      loadPurchaseRequests()\n    }\n  }, [showOrderRequestScreen, loadPurchaseRequests])\n\n  const handleProductClick = async (product) => {\n    setShowOrderRequestScreen(false)\n    setLoading(true)\n    try {\n      const result = await getProductDetails(product.id || product._id)\n      if (result.data) {\n        setSelectedProduct(result.data.product)\n      }\n    } catch (err) {\n      console.error('Failed to load product details:', err)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleOrderStock = () => {\n    if (orderFormRef.current) {\n      orderFormRef.current.scrollIntoView({ behavior: 'smooth', block: 'start' })\n    }\n  }\n\n  const handleOrderSubmit = async () => {\n    if (!selectedProduct) return\n\n    // Check if product has attributes and if they're selected\n    const hasAttributes = selectedProduct.attributeStocks &&\n      Array.isArray(selectedProduct.attributeStocks) &&\n      selectedProduct.attributeStocks.length > 0\n\n    if (hasAttributes && Object.keys(selectedProductAttributes).length === 0) {\n      setOrderError('Please select a variant before ordering.')\n      return\n    }\n\n    // Use attribute-specific stock/price if available, otherwise use main product values\n    const adminStock = selectedProductAttributeStock\n      ? (selectedProductAttributeStock.displayStock || 0)\n      : (selectedProduct.adminStock ?? selectedProduct.displayStock ?? selectedProduct.stock ?? 0)\n    const pricePerUnit = selectedProductAttributeStock\n      ? (selectedProductAttributeStock.vendorPrice || 0)\n      : (selectedProduct.pricePerUnit || selectedProduct.priceToVendor || 0)\n    const quantityNumber = parseFloat(orderQuantity)\n    const orderTotal = quantityNumber * pricePerUnit\n    const creditRemaining = dashboard.credit?.remaining || 0\n\n    setOrderError('')\n\n    if (!quantityNumber || quantityNumber <= 0) {\n      setOrderError('Enter a valid quantity to order.')\n      return\n    }\n    if (quantityNumber > adminStock) {\n      setOrderError('Requested quantity exceeds admin stock availability.')\n      return\n    }\n    if (orderTotal < MIN_PURCHASE_VALUE) {\n      setOrderError(`Minimum order value is â‚¹${MIN_PURCHASE_VALUE.toLocaleString('en-IN')}.`)\n      return\n    }\n    if (orderTotal > creditRemaining) {\n      setOrderError('Insufficient remaining credits to place this request.')\n      return\n    }\n    if (!confirmProductName || confirmProductName.trim().toLowerCase() !== selectedProduct.name.trim().toLowerCase()) {\n      setOrderError('Please type the exact product name to confirm the request.')\n      return\n    }\n\n    setIsSubmittingOrder(true)\n    try {\n      const itemPayload = {\n        productId: selectedProduct.id || selectedProduct._id,\n        productName: selectedProduct.name,\n        quantity: quantityNumber,\n        pricePerUnit,\n      }\n\n      // Add attribute combination if product has attributes\n      if (hasAttributes && Object.keys(selectedProductAttributes).length > 0) {\n        itemPayload.attributeCombination = selectedProductAttributes\n      }\n\n      const payload = {\n        items: [itemPayload],\n        notes: orderNotes ? orderNotes.trim() : undefined,\n      }\n\n      const result = await requestCreditPurchase(payload)\n      if (result.data) {\n        success('Order request submitted. Admin will review and approve.')\n        setSelectedProduct(null)\n        // Refresh dashboard to update credit info\n        fetchDashboardData()\n        // Add notification for stock request\n        dispatch({\n          type: 'ADD_NOTIFICATION',\n          payload: {\n            id: `stock-request-${Date.now()}`,\n            type: 'stock_request',\n            title: 'Stock Request Submitted',\n            message: `Stock request for ${selectedProduct.name || 'product'} submitted. Waiting for admin approval.`,\n            timestamp: new Date().toISOString(),\n            data: { productId: selectedProduct.id || selectedProduct._id, productName: selectedProduct.name },\n            read: false,\n          },\n        })\n        // Navigate to credit tab to see the request\n        if (onNavigate) {\n          onNavigate('credit')\n        }\n      } else if (result.error) {\n        const message = result.error.message || 'Failed to submit order request.'\n        setOrderError(message)\n        showError(message)\n      }\n    } catch (err) {\n      const message = err?.error?.message || err.message || 'Failed to submit order request.'\n      setOrderError(message)\n      showError(message)\n    } finally {\n      setIsSubmittingOrder(false)\n    }\n  }\n\n  const handleOrderRequestSubmit = async () => {\n    setOrderRequestError('')\n\n    if (selectedProducts.length === 0) {\n      setOrderRequestError('Add at least one product to continue.')\n      return\n    }\n\n    const creditInfo = dashboard.credit || {}\n    const hasUnpaidCredits = creditInfo.status?.hasUnpaidCredits || false\n\n    const purchaseItems = []\n    let totalAmount = 0\n\n    for (const selected of selectedProducts) {\n      const product = products.find(\n        (p) => (p.id || p._id)?.toString() === selected.productId\n      )\n      if (!product) {\n        setOrderRequestError(`Product not found: ${selected.productId}`)\n        return\n      }\n\n      // Check if product has attributes - check both product data and cached variant data\n      // Also check if selected.attributeStock exists (indicates variant was selected, so product has variants)\n      const productWithVariants = productsWithVariants[selected.productId] || product\n      const hasAttributesInProduct = productWithVariants.attributeStocks &&\n        Array.isArray(productWithVariants.attributeStocks) &&\n        productWithVariants.attributeStocks.length > 0 &&\n        productWithVariants.attributeStocks.some(stock => {\n          if (!stock) return false\n          if (stock.attributes && typeof stock.attributes === 'object') {\n            const attrKeys = Object.keys(stock.attributes)\n            if (attrKeys.length > 0) {\n              return attrKeys.some(key => stock.attributes[key] != null && stock.attributes[key] !== '')\n            }\n          }\n          return false\n        })\n\n      // If selected.attributeStock exists, product definitely has variants\n      const hasVariantSelected = selected.attributeStock && selected.attributeStock.attributes\n      const hasAttributes = hasAttributesInProduct || hasVariantSelected\n\n      // If product has variants, ensure attributes are selected\n      // Check both selected.attributes and selected.attributeStock as indicators\n      if (hasAttributes) {\n        // Check if variant was selected - attributeStock exists (with attributes) OR attributes object is present and not empty\n        const hasAttributeStock = selected.attributeStock &&\n          selected.attributeStock.attributes &&\n          typeof selected.attributeStock.attributes === 'object' &&\n          Object.keys(selected.attributeStock.attributes).length > 0\n        const hasAttributesObject = selected.attributes &&\n          typeof selected.attributes === 'object' &&\n          Object.keys(selected.attributes).length > 0\n        const hasSelectedAttributes = hasAttributeStock || hasAttributesObject\n\n        if (!hasSelectedAttributes) {\n          setOrderRequestError(`Product ${product.name} requires attribute selection.`)\n          return\n        }\n      }\n\n      const quantityNumber = parseFloat(selected.quantity)\n      if (!quantityNumber || quantityNumber <= 0) {\n        setOrderRequestError(`Enter a valid quantity for ${product.name}.`)\n        return\n      }\n\n      // Use attribute-specific stock/price if available, otherwise use main product values\n      const adminStock = selected.attributeStock\n        ? (selected.attributeStock.displayStock || 0)\n        : (product.adminStock ?? product.displayStock ?? product.stock ?? 0)\n\n      if (quantityNumber > adminStock) {\n        setOrderRequestError(`Requested quantity for ${product.name} exceeds admin stock (${adminStock}).`)\n        return\n      }\n\n      const pricePerUnit = selected.attributeStock\n        ? (selected.attributeStock.vendorPrice || 0)\n        : (product.pricePerUnit || product.priceToVendor || 0)\n      const itemTotal = quantityNumber * pricePerUnit\n      totalAmount += itemTotal\n\n      const itemPayload = {\n        productId: product.id || product._id,\n        productName: product.name,\n        quantity: quantityNumber,\n        pricePerUnit,\n      }\n\n      // Add attribute combination if product has attributes and variant was selected\n      // Use attributes from selected.attributes or from selected.attributeStock.attributes\n      if (hasAttributes && (selected.attributeStock || (selected.attributes && Object.keys(selected.attributes).length > 0))) {\n        // Prefer attributes from attributeStock if available, otherwise use selected.attributes\n        const attributesToUse = selected.attributeStock?.attributes || selected.attributes || {}\n        if (Object.keys(attributesToUse).length > 0) {\n          itemPayload.attributeCombination = attributesToUse\n        }\n      }\n\n      purchaseItems.push(itemPayload)\n    }\n\n    if (totalAmount < MIN_PURCHASE_VALUE) {\n      setOrderRequestError(`Minimum order value is â‚¹${MIN_PURCHASE_VALUE.toLocaleString('en-IN')}.`)\n      return\n    }\n    if (totalAmount > MAX_PURCHASE_VALUE) {\n      setOrderRequestError(`Maximum order value is â‚¹${MAX_PURCHASE_VALUE.toLocaleString('en-IN')}. Your request: â‚¹${totalAmount.toLocaleString('en-IN')}.`)\n      return\n    }\n    // For now, we allow submission but recording the outstanding dues via backend.\n    // The previous hard block is removed.\n    let duesWarning = '';\n    if (hasUnpaidCredits) {\n      duesWarning = 'Warning: You have unpaid credits. While you can still submit a request, Admin approval will depend on your repayment history.';\n    }\n    if (!orderRequestForm.reason || orderRequestForm.reason.trim().length < 10) {\n      setOrderRequestError('Please provide a reason (at least 10 characters).')\n      return\n    }\n    if (!orderRequestForm.creditPolicyAccepted) {\n      setOrderRequestError('Please acknowledge the credit policy to proceed.')\n      return\n    }\n    if (!orderRequestForm.confirmationText || orderRequestForm.confirmationText.trim().toLowerCase() !== 'confirm') {\n      setOrderRequestError('Type \"confirm\" to proceed with the request.')\n      return\n    }\n\n    const trimmedAccountName = orderRequestForm.bankAccountName?.trim()\n    const trimmedAccountNumber = orderRequestForm.bankAccountNumber?.toString().trim()\n    const trimmedBankName = orderRequestForm.bankName?.trim()\n    const trimmedIfsc = orderRequestForm.bankIfsc?.trim().toUpperCase()\n\n    if (!trimmedAccountName || !trimmedAccountNumber || !trimmedBankName || !trimmedIfsc) {\n      setOrderRequestError('Complete bank details are required.')\n      return\n    }\n    if (trimmedAccountNumber.length < 6) {\n      setOrderRequestError('Account number looks incomplete.')\n      return\n    }\n    if (trimmedIfsc.length < 4) {\n      setOrderRequestError('Please provide a valid IFSC code.')\n      return\n    }\n\n    setIsOrderRequestSubmitting(true)\n    try {\n      const payload = {\n        items: purchaseItems,\n        reason: orderRequestForm.reason.trim(),\n        notes: orderRequestForm.notes?.trim() || undefined,\n        bankDetails: {\n          accountName: trimmedAccountName,\n          accountNumber: trimmedAccountNumber,\n          bankName: trimmedBankName,\n          ifsc: trimmedIfsc,\n          bankBranch: orderRequestForm.bankBranch?.trim() || undefined,\n        },\n        confirmationText: orderRequestForm.confirmationText.trim(),\n      }\n\n      const result = await requestCreditPurchase(payload)\n      if (result.data) {\n        success(`Order request submitted successfully! Request ID: ${result.data.purchase?.creditPurchaseId || 'N/A'}. Admin will review shortly.${hasUnpaidCredits ? ' Warning: You have unpaid past dues which may affect approval.' : ''}`)\n        resetOrderRequestForm()\n        setShowOrderRequestScreen(false)\n        loadPurchaseRequests()\n        // Refresh dashboard to update credit info\n        fetchDashboardData()\n        // Add notification for stock request\n        dispatch({\n          type: 'ADD_NOTIFICATION',\n          payload: {\n            id: `stock-request-${Date.now()}`,\n            type: 'stock_request',\n            title: 'Stock Request Submitted',\n            message: `Stock request of â‚¹${totalAmount.toLocaleString('en-IN')} submitted. Waiting for admin approval.`,\n            timestamp: new Date().toISOString(),\n            data: { requestId: result.data.requestId || result.data.purchase?._id, amount: totalAmount },\n            read: false,\n          },\n        })\n        // Navigate to credit tab to see the request\n        if (onNavigate) {\n          onNavigate('credit')\n        }\n      } else if (result.error) {\n        const message = result.error.message || 'Failed to submit stock request.'\n        setOrderRequestError(message)\n        showError(message)\n      }\n    } catch (err) {\n      const message = err?.error?.message || err.message || 'Failed to submit stock request.'\n      setOrderRequestError(message)\n      showError(message)\n    } finally {\n      setIsOrderRequestSubmitting(false)\n    }\n  }\n\n  // Get products from backend\n  const products = productsData?.products || []\n\n  const totalProducts = products.length\n  // Count products where vendor has stock assigned (vendorStock > 0)\n  const inStockCount = products.filter((p) => (p.vendorStock ?? 0) > 0).length\n  // Count products where vendor has no stock (vendorStock <= 0)\n  const outOfStockCount = products.filter((p) => (p.vendorStock ?? 0) <= 0).length\n\n  const getVendorStockStatus = (stock) => {\n    const value = Number(stock) || 0\n    if (value <= 0) {\n      return { label: 'No stock', tone: 'critical', helper: 'Order stock to start selling', message: 'You have no stock yet' }\n    }\n    if (value <= 25) {\n      return { label: 'Low stock', tone: 'warn', helper: 'Plan a stock refill soon', message: 'Order more to avoid delays' }\n    }\n    if (value <= 75) {\n      return { label: 'Mid stock', tone: 'teal', helper: 'Stock looks steady', message: 'Keep tracking demand' }\n    }\n    return { label: 'High stock', tone: 'success', helper: 'You are well stocked', message: 'Ready for incoming orders' }\n  }\n\n  const topStats = [\n    { label: 'Available products', value: inStockCount, note: 'Ready to order', tone: 'success' },\n    { label: 'Out of stock', value: outOfStockCount, note: 'Check back later', tone: 'warn' },\n  ]\n\n  const inventoryStats = [\n    { label: 'Out of stock', value: `${outOfStockCount}`, meta: 'Not available', tone: 'warn' },\n  ]\n\n  const metricIcons = [BoxIcon, ChartIcon, SparkIcon, TruckIcon]\n\n  // Generate dynamic alerts based on low stock items from dashboard\n  const lowStockItems = dashboard.overview?.inventory?.lowStockItems || []\n  const alerts = []\n\n  // Add alert for low stock items if any exist\n  if (lowStockItems.length > 0) {\n    const lowStockCount = lowStockItems.length\n    alerts.push({\n      title: 'Need to order more',\n      body: `${lowStockCount} product${lowStockCount > 1 ? 's' : ''} running low. Request stock before deadline.`,\n      badge: 'Low stock â€¢ Action needed',\n      tone: 'warn',\n      action: 'Raise request',\n    })\n  }\n\n  // Calculate stock progress from actual inventory data\n  const stockProgress = {\n    Healthy: products.filter(p => {\n      const stock = p.vendorStock ?? 0\n      return stock > 75\n    }).length,\n    Low: products.filter(p => {\n      const stock = p.vendorStock ?? 0\n      return stock > 0 && stock <= 75\n    }).length,\n    Critical: products.filter(p => {\n      const stock = p.vendorStock ?? 0\n      return stock === 0\n    }).length,\n  }\n\n  if (selectedProduct) {\n    // Use attribute-specific values if available, otherwise use main product values\n    const adminStock = selectedProductAttributeStock\n      ? (selectedProductAttributeStock.displayStock || 0)\n      : (selectedProduct.adminStock ?? selectedProduct.displayStock ?? selectedProduct.stock ?? 0)\n    const vendorStock = selectedProduct.vendorStock ?? 0\n    const vendorStockStatus = getVendorStockStatus(vendorStock)\n    const ordersCount = selectedProduct.vendorOrdersCount ?? 0\n    const pricePerUnit = selectedProductAttributeStock\n      ? (selectedProductAttributeStock.vendorPrice || 0)\n      : (selectedProduct.pricePerUnit || selectedProduct.priceToVendor || 0)\n    const quantityNumber = parseFloat(orderQuantity) || 0\n    const orderTotal = quantityNumber * pricePerUnit\n\n    // Check if product has attributes and if they're selected\n    const hasAttributes = selectedProduct.attributeStocks &&\n      Array.isArray(selectedProduct.attributeStocks) &&\n      selectedProduct.attributeStocks.length > 0\n    const attributesSelected = hasAttributes ? Object.keys(selectedProductAttributes).length > 0 : true\n    const creditInfo = dashboard.credit || {}\n    const creditRemaining = creditInfo.remaining || 0\n    const creditLimit = creditInfo.limit || 0\n    const projectedCredit = creditRemaining - orderTotal\n    const confirmMatches =\n      confirmProductName.trim().toLowerCase() === (selectedProduct.name || '').trim().toLowerCase()\n    const canSubmitOrder =\n      quantityNumber > 0 &&\n      quantityNumber <= adminStock &&\n      orderTotal >= MIN_PURCHASE_VALUE &&\n      orderTotal <= creditRemaining &&\n      confirmMatches &&\n      attributesSelected &&\n      !isSubmittingOrder\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <button\n              type=\"button\"\n              onClick={() => setSelectedProduct(null)}\n              className=\"text-sm font-semibold text-purple-600 hover:text-purple-800\"\n            >\n              â† Back to products\n            </button>\n            <h2 className=\"mt-2 text-2xl font-bold text-gray-900\">{selectedProduct.name}</h2>\n            <p className=\"text-sm text-gray-500\">SKU: {selectedProduct.sku || 'N/A'}</p>\n          </div>\n          {selectedProduct.stockStatus === 'in_stock' && (\n            <button\n              type=\"button\"\n              onClick={openOrderRequestScreen}\n              className=\"rounded-full bg-purple-600 px-6 py-2 text-sm font-semibold text-white transition-all hover:bg-purple-700\"\n            >\n              Order Stock\n            </button>\n          )}\n        </div>\n\n        <div className=\"grid gap-6 lg:grid-cols-2\">\n          <div className=\"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm\">\n            <div className=\"aspect-video w-full overflow-hidden rounded-xl bg-gray-100\">\n              {selectedProduct.primaryImage || selectedProduct.images?.[0]?.url ? (\n                <img\n                  src={selectedProduct.primaryImage || selectedProduct.images[0].url}\n                  alt={selectedProduct.name}\n                  className=\"h-full w-full object-cover\"\n                />\n              ) : (\n                <div className=\"flex h-full w-full items-center justify-center\">\n                  <BoxIcon className=\"h-16 w-16 text-gray-400\" />\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div className=\"space-y-4 rounded-2xl border border-gray-200 bg-white p-5 shadow-sm\">\n            <div>\n              <h4 className=\"text-sm font-semibold text-gray-700\">Description</h4>\n              <p className=\"text-sm text-gray-600 mt-1\">\n                {selectedProduct.description || 'No description available'}\n              </p>\n            </div>\n\n            <div className=\"grid gap-4 sm:grid-cols-2\">\n              <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-3\">\n                <p className=\"text-xs text-gray-600\">Vendor stock status</p>\n                <p\n                  className={cn(\n                    'text-lg font-bold',\n                    vendorStockStatus.tone === 'success'\n                      ? 'text-green-700'\n                      : vendorStockStatus.tone === 'teal'\n                        ? 'text-blue-700'\n                        : vendorStockStatus.tone === 'warn'\n                          ? 'text-yellow-700'\n                          : 'text-red-700',\n                  )}\n                >\n                  {vendorStockStatus.label}\n                </p>\n                <p className=\"text-[11px] text-gray-500 mt-1\">\n                  You currently hold {vendorStock} {selectedProduct.unit || 'kg'}\n                </p>\n              </div>\n\n              <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-3\">\n                <p className=\"text-xs text-gray-600\">Admin stock available</p>\n                <p className=\"text-lg font-bold text-gray-900\">\n                  {adminStock} {selectedProduct.unit || 'kg'}\n                </p>\n                <p className=\"text-[11px] text-gray-500 mt-1\">You can request this much stock from admin</p>\n              </div>\n\n              <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-3\">\n                <p className=\"text-xs text-gray-600\">Price per {selectedProductAttributeStock?.stockUnit || selectedProduct.unit || 'kg'}</p>\n                <p className=\"text-lg font-bold text-purple-600\">\n                  â‚¹{pricePerUnit.toLocaleString('en-IN')}\n                </p>\n              </div>\n\n              <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-3\">\n                <p className=\"text-xs text-gray-600\">Orders fulfilled</p>\n                <p className=\"text-lg font-bold text-gray-900\">{ordersCount}</p>\n                <p className=\"text-[11px] text-gray-500 mt-1\">Number of orders you handled for this product</p>\n              </div>\n\n              <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-3\">\n                <p className=\"text-xs text-gray-600\">Category</p>\n                <p className=\"text-sm font-semibold text-gray-900 capitalize\">{selectedProduct.category || 'â€”'}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n    )\n  }\n\n  if (showOrderRequestScreen) {\n    const creditInfo = dashboard.credit || {}\n    const hasUnpaidCredits = creditInfo.status?.hasUnpaidCredits || false\n    const totalUnpaid = creditInfo.credit?.totalUnpaid || 0\n\n    // Calculate billing for selected products\n    let billingTotal = 0\n    const billingItems = selectedProducts.map((selected) => {\n      const product = products.find(\n        (p) => (p.id || p._id)?.toString() === selected.productId\n      )\n      if (!product) return null\n      const quantity = parseFloat(selected.quantity) || 0\n\n      // Use variant-specific price if available, otherwise use main product price\n      const pricePerUnit = selected.attributeStock\n        ? (selected.attributeStock.vendorPrice || 0)\n        : (product.pricePerUnit || product.priceToVendor || 0)\n\n      const itemTotal = quantity * pricePerUnit\n      billingTotal += itemTotal\n\n      return {\n        product,\n        quantity,\n        pricePerUnit,\n        unitPrice: pricePerUnit, // Alias for billing display\n        itemTotal,\n        variantAttributes: selected.attributes || {}, // Include variant attributes for display\n      }\n    }).filter(Boolean)\n\n    const confirmMatches = orderRequestForm.confirmationText.trim().toLowerCase() === 'confirm'\n    const trimmedAccountName = orderRequestForm.bankAccountName?.trim() || ''\n    const trimmedAccountNumber = orderRequestForm.bankAccountNumber?.toString().trim() || ''\n    const trimmedBankName = orderRequestForm.bankName?.trim() || ''\n    const trimmedIfsc = orderRequestForm.bankIfsc?.trim() || ''\n    const bankDetailsComplete =\n      trimmedAccountName && trimmedAccountNumber && trimmedBankName && trimmedIfsc\n    const reasonValid = orderRequestForm.reason?.trim().length >= 10\n    const meetsMinValue = billingTotal >= MIN_PURCHASE_VALUE\n    const withinMaxValue = billingTotal <= MAX_PURCHASE_VALUE\n    const allQuantitiesValid = selectedProducts.every((selected) => {\n      const product = products.find((p) => (p.id || p._id)?.toString() === selected.productId)\n      if (!product) return false\n      const quantity = parseFloat(selected.quantity) || 0\n      const adminStock = product.adminStock ?? product.displayStock ?? product.stock ?? 0\n      return quantity > 0 && quantity <= adminStock\n    })\n    const canSubmitOrderRequest =\n      selectedProducts.length > 0 &&\n      allQuantitiesValid &&\n      meetsMinValue &&\n      withinMaxValue &&\n      !hasUnpaidCredits &&\n      orderRequestForm.creditPolicyAccepted &&\n      confirmMatches &&\n      bankDetailsComplete &&\n      reasonValid &&\n      !isOrderRequestSubmitting\n\n    const pendingDeliveryRequests = purchaseRequests.filter(\n      (request) =>\n        request.status === 'approved' &&\n        ['pending', 'scheduled', 'in_transit'].includes(request.deliveryStatus)\n    )\n\n    const formatEta = (request) => {\n      if (!request.expectedDeliveryAt) {\n        return 'Awaiting schedule'\n      }\n      const eta = new Date(request.expectedDeliveryAt)\n      const diffMs = eta.getTime() - Date.now()\n      if (diffMs <= 0) {\n        return 'Delivery in progress'\n      }\n      const hours = Math.max(1, Math.ceil(diffMs / (1000 * 60 * 60)))\n      return `Arriving in ~${hours}h`\n    }\n\n    return (\n      <div className=\"inventory-request-screen space-y-6\">\n        <div className=\"inventory-request-screen__header\">\n          <div>\n            <button\n              type=\"button\"\n              onClick={closeOrderRequestScreen}\n              className=\"text-sm font-semibold text-purple-600 hover:text-purple-800\"\n            >\n              â† Back to inventory\n            </button>\n            <h2 className=\"mt-2 text-2xl font-bold text-gray-900\">Request stock from Admin</h2>\n            <p className=\"text-sm text-gray-500\">\n              Select products, enter quantities, and submit for approval. Stock arrives within 24 hours after approval.\n            </p>\n          </div>\n        </div>\n\n        <div className=\"inventory-request-layout\">\n          <div className=\"inventory-request-card space-y-6\">\n            {/* Unpaid Credits Warning */}\n            {hasUnpaidCredits && (\n              <div className=\"rounded-xl border-2 border-red-300 bg-red-50 p-4\">\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"shrink-0\">\n                    <svg className=\"h-6 w-6 text-red-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n                    </svg>\n                  </div>\n                  <div className=\"flex-1\">\n                    <h4 className=\"text-sm font-bold text-red-900 mb-1\">Unpaid Credits Warning</h4>\n                    <p className=\"text-sm text-red-800 mb-2\">\n                      You have unpaid credits from previous purchase requests (Total: â‚¹{totalUnpaid.toLocaleString('en-IN')}).\n                    </p>\n                    <p className=\"text-xs text-red-700 font-semibold\">\n                      âš ï¸ Making further purchase requests without clearing outstanding payments could lead to suspension or permanent ban of your account.\n                    </p>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Product Cards Section */}\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Available Products</h3>\n              <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\n                {products.map((product) => {\n                  const productId = (product.id || product._id)?.toString()\n                  const isSelected = selectedProducts.some((p) => p.productId === productId)\n                  const isExpanded = expandedProductId === productId\n\n                  // Check if product has variants (either from list or from cached details)\n                  // Use cached variant details if available, otherwise check product.attributeStocks\n                  const productWithVariants = productsWithVariants[productId] || product\n                  const hasVariants = productWithVariants.attributeStocks &&\n                    Array.isArray(productWithVariants.attributeStocks) &&\n                    productWithVariants.attributeStocks.length > 0 &&\n                    productWithVariants.attributeStocks.some(stock => {\n                      if (!stock) return false\n                      // Check if stock has attributes object with at least one key\n                      if (stock.attributes && typeof stock.attributes === 'object') {\n                        const attrKeys = Object.keys(stock.attributes)\n                        if (attrKeys.length > 0) {\n                          // Check if at least one attribute value is not empty\n                          return attrKeys.some(key => stock.attributes[key] != null && stock.attributes[key] !== '')\n                        }\n                      }\n                      return false\n                    })\n\n                  // Use product with variants for rendering\n                  const productToRender = hasVariants && isExpanded ? productWithVariants : product\n\n                  // Check if any variants of this product are selected\n                  const hasSelectedVariants = selectedProducts.some(p => p.productId === productId && p.attributes && Object.keys(p.attributes).length > 0)\n\n                  const adminStock = product.adminStock ?? product.displayStock ?? product.stock ?? 0\n                  const pricePerUnit = product.pricePerUnit || product.priceToVendor || 0\n\n                  // Format attribute label\n                  const formatAttributeLabel = (key) => {\n                    return key\n                      .replace(/([A-Z])/g, ' $1')\n                      .replace(/^./, str => str.toUpperCase())\n                      .trim()\n                  }\n\n                  return (\n                    <div\n                      key={product.id || product._id}\n                      className={cn(\n                        'inventory-product-card rounded-xl border-2 p-4 transition-all',\n                        isSelected\n                          ? 'border-purple-500 bg-purple-50'\n                          : 'border-gray-200 bg-white hover:border-purple-300'\n                      )}\n                    >\n                      <div className=\"flex items-start justify-between mb-3\">\n                        <div className=\"flex-1\">\n                          <h4 className=\"text-sm font-bold text-gray-900 mb-1\">{product.name}</h4>\n                          <p className=\"text-xs text-gray-500\">SKU: {product.sku || 'N/A'}</p>\n                        </div>\n                        {product.primaryImage || product.images?.[0]?.url ? (\n                          <img\n                            src={product.primaryImage || product.images[0].url}\n                            alt={product.name}\n                            className=\"w-12 h-12 rounded-lg object-cover\"\n                          />\n                        ) : (\n                          <div className=\"w-12 h-12 rounded-lg bg-gray-100 flex items-center justify-center\">\n                            <BoxIcon className=\"h-6 w-6 text-gray-400\" />\n                          </div>\n                        )}\n                      </div>\n\n                      {/* Show common info only if no variants */}\n                      {!hasVariants && (\n                        <div className=\"space-y-2 mb-3\">\n                          <div className=\"flex items-center justify-between text-xs\">\n                            <span className=\"text-gray-600\">Admin stock:</span>\n                            <span className=\"font-semibold text-gray-900\">{adminStock} {product.unit || 'kg'}</span>\n                          </div>\n                          <div className=\"flex items-center justify-between text-xs\">\n                            <span className=\"text-gray-600\">Price:</span>\n                            <span className=\"font-semibold text-purple-600\">â‚¹{pricePerUnit.toLocaleString('en-IN')}/{product.unit || 'kg'}</span>\n                          </div>\n                          {product.category && (\n                            <div className=\"flex items-center justify-between text-xs\">\n                              <span className=\"text-gray-600\">Category:</span>\n                              <span className=\"font-semibold text-gray-700 capitalize\">{product.category}</span>\n                            </div>\n                          )}\n                        </div>\n                      )}\n\n                      {/* Show category even if variants exist */}\n                      {hasVariants && product.category && (\n                        <div className=\"mb-3\">\n                          <div className=\"flex items-center justify-between text-xs\">\n                            <span className=\"text-gray-600\">Category:</span>\n                            <span className=\"font-semibold text-gray-700 capitalize\">{product.category}</span>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Button: View Variants or Add to Order */}\n                      {/* Only hide button if non-variant product is selected */}\n                      {!isSelected && (\n                        <>\n                          {/* If product has variants, show \"View Variants\", otherwise show \"Add to Order\" */}\n                          {hasVariants ? (\n                            <button\n                              type=\"button\"\n                              onClick={() => handleViewVariants(productId)}\n                              disabled={adminStock === 0 || (loadingVariants && expandedProductId === productId)}\n                              className={cn(\n                                'w-full rounded-lg px-4 py-2 text-xs font-semibold transition-all flex items-center justify-center gap-2',\n                                adminStock === 0 || (loadingVariants && expandedProductId === productId)\n                                  ? 'bg-gray-100 text-gray-400 cursor-not-allowed'\n                                  : 'bg-purple-600 text-white hover:bg-purple-700'\n                              )}\n                            >\n                              {loadingVariants && expandedProductId === productId ? (\n                                <>Loading variants...</>\n                              ) : adminStock === 0 ? (\n                                'Out of Stock'\n                              ) : (\n                                <>\n                                  View Variants\n                                  {isExpanded ? <ChevronUpIcon className=\"h-4 w-4\" /> : <ChevronDownIcon className=\"h-4 w-4\" />}\n                                </>\n                              )}\n                            </button>\n                          ) : (\n                            <button\n                              type=\"button\"\n                              onClick={() => {\n                                handleAddProduct(productId)\n                                // Scroll to order form after adding\n                                setTimeout(() => {\n                                  if (orderFormRef.current) {\n                                    orderFormRef.current.scrollIntoView({ behavior: 'smooth', block: 'start' })\n                                  }\n                                }, 100)\n                              }}\n                              disabled={adminStock === 0}\n                              className={cn(\n                                'w-full rounded-lg px-4 py-2 text-xs font-semibold transition-all',\n                                adminStock === 0\n                                  ? 'bg-gray-100 text-gray-400 cursor-not-allowed'\n                                  : 'bg-purple-600 text-white hover:bg-purple-700'\n                              )}\n                            >\n                              {adminStock === 0 ? 'Out of Stock' : 'Add to Order'}\n                            </button>\n                          )}\n                        </>\n                      )}\n\n                      {/* Variants Dropdown */}\n                      {hasVariants && isExpanded && productToRender.attributeStocks && (\n                        <div className=\"mt-3 space-y-2 pt-3 border-t border-gray-200\">\n                          {productToRender.attributeStocks.map((variantStock, idx) => {\n                            const variantAttrs = variantStock.attributes || {}\n                            const variantAdminStock = variantStock.displayStock || variantStock.actualStock || 0\n                            const variantPrice = variantStock.vendorPrice || 0\n                            const variantUnit = variantStock.stockUnit || product.unit || 'kg'\n\n                            // Check if this variant is already added\n                            const variantKey = JSON.stringify(variantAttrs)\n                            const isVariantAdded = selectedProducts.some((p) => {\n                              if (p.productId !== productId) return false\n                              const existingVariantKey = JSON.stringify(p.attributes || {})\n                              return existingVariantKey === variantKey\n                            })\n\n                            return (\n                              <div\n                                key={idx}\n                                className={cn(\n                                  'p-3 rounded-lg border-2 transition-all',\n                                  isVariantAdded\n                                    ? 'bg-purple-50 border-purple-300'\n                                    : 'bg-white border-gray-200'\n                                )}\n                              >\n                                <div className=\"space-y-2\">\n                                  {/* Variant Attributes */}\n                                  <div>\n                                    {Object.entries(variantAttrs).map(([key, value]) => (\n                                      <div key={key} className=\"flex items-center gap-1 text-xs mb-1\">\n                                        <span className=\"text-gray-600 font-medium\">{formatAttributeLabel(key)}:</span>\n                                        <span className=\"text-gray-900 font-semibold\">{value}</span>\n                                      </div>\n                                    ))}\n                                  </div>\n\n                                  {/* Variant Stock and Price */}\n                                  <div className=\"grid grid-cols-2 gap-2 text-xs\">\n                                    <div>\n                                      <span className=\"text-gray-600\">Stock:</span>\n                                      <span className=\"ml-1 font-semibold text-gray-900\">\n                                        {variantAdminStock} {variantUnit}\n                                      </span>\n                                    </div>\n                                    <div>\n                                      <span className=\"text-gray-600\">Price:</span>\n                                      <span className=\"ml-1 font-semibold text-purple-600\">\n                                        â‚¹{variantPrice.toLocaleString('en-IN')}/{variantUnit}\n                                      </span>\n                                    </div>\n                                  </div>\n\n                                  {/* Add to Order Button */}\n                                  {!isVariantAdded ? (\n                                    <button\n                                      type=\"button\"\n                                      onClick={() => handleAddVariantToOrder(productId, variantStock)}\n                                      disabled={variantAdminStock === 0}\n                                      className={cn(\n                                        'w-full mt-2 rounded-lg px-3 py-1.5 text-xs font-semibold transition-all',\n                                        variantAdminStock === 0\n                                          ? 'bg-gray-100 text-gray-400 cursor-not-allowed'\n                                          : 'bg-purple-600 text-white hover:bg-purple-700'\n                                      )}\n                                    >\n                                      {variantAdminStock === 0 ? 'Out of Stock' : 'Add to Order'}\n                                    </button>\n                                  ) : (\n                                    <div className=\"mt-2 text-xs text-purple-700 font-semibold text-center\">\n                                      âœ“ Added to order\n                                    </div>\n                                  )}\n                                </div>\n                              </div>\n                            )\n                          })}\n                        </div>\n                      )}\n\n                      {/* Remove button if product is selected (non-variant product) */}\n                      {isSelected && !hasVariants && (\n                        <button\n                          type=\"button\"\n                          onClick={() => handleRemoveProduct(productId)}\n                          className=\"w-full rounded-lg px-4 py-2 text-xs font-semibold bg-red-100 text-red-700 hover:bg-red-200 transition-all\"\n                        >\n                          Remove\n                        </button>\n                      )}\n                    </div>\n                  )\n                })}\n              </div>\n            </div>\n\n            {/* Quantity Inputs Section */}\n            {selectedProducts.length > 0 && (\n              <div className=\"space-y-4 rounded-xl border-2 border-purple-200 bg-purple-50/30 p-5\">\n                <h3 className=\"text-lg font-semibold text-gray-900\">Enter Quantities</h3>\n                <div className=\"space-y-3\">\n                  {selectedProducts.map((selected) => {\n                    const product = products.find(\n                      (p) => (p.id || p._id)?.toString() === selected.productId\n                    )\n                    if (!product) return null\n\n                    // Check if product has attributes\n                    const hasAttributes = product.attributeStocks &&\n                      Array.isArray(product.attributeStocks) &&\n                      product.attributeStocks.length > 0\n\n                    // Use attribute-specific stock/price if available, otherwise use main product values\n                    const adminStock = selected.attributeStock\n                      ? (selected.attributeStock.displayStock || 0)\n                      : (product.adminStock ?? product.displayStock ?? product.stock ?? 0)\n                    const pricePerUnit = selected.attributeStock\n                      ? (selected.attributeStock.vendorPrice || 0)\n                      : (product.pricePerUnit || product.priceToVendor || 0)\n                    const stockUnit = selected.attributeStock?.stockUnit || product.unit || 'kg'\n                    const quantity = parseFloat(selected.quantity) || 0\n\n                    return (\n                      <div\n                        key={selected.productId}\n                        className=\"space-y-3 rounded-lg border border-purple-200 bg-white p-4\"\n                      >\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-semibold text-gray-900\">{product.name}</p>\n                            {/* Show variant info if variant is selected */}\n                            {selected.attributes && Object.keys(selected.attributes).length > 0 && (\n                              <div className=\"mt-1 space-y-0.5\">\n                                {Object.entries(selected.attributes).map(([key, value]) => {\n                                  const formatLabel = (k) => {\n                                    return k\n                                      .replace(/([A-Z])/g, ' $1')\n                                      .replace(/^./, str => str.toUpperCase())\n                                      .trim()\n                                  }\n                                  return (\n                                    <p key={key} className=\"text-xs text-purple-700 font-medium\">\n                                      {formatLabel(key)}: {value}\n                                    </p>\n                                  )\n                                })}\n                              </div>\n                            )}\n                            <p className=\"text-xs text-gray-500\">\n                              Available: {adminStock} {stockUnit} â€¢ â‚¹{pricePerUnit.toLocaleString('en-IN')}/{stockUnit}\n                            </p>\n                          </div>\n                        </div>\n\n                        {/* Attribute Selection - Only show if product has attributes but no variant is selected yet */}\n                        {hasAttributes && (!selected.attributes || Object.keys(selected.attributes).length === 0) && (\n                          <ProductAttributeSelector\n                            product={product}\n                            selectedAttributes={selected.attributes || {}}\n                            onAttributesChange={(attributes, attributeStock) => {\n                              setSelectedProducts(prev => prev.map(p =>\n                                p.productId === selected.productId\n                                  ? { ...p, attributes, attributeStock }\n                                  : p\n                              ))\n                              // Reset quantity when variant changes\n                              setSelectedProducts(prev => prev.map(p =>\n                                p.productId === selected.productId\n                                  ? { ...p, quantity: '' }\n                                  : p\n                              ))\n                            }}\n                          />\n                        )}\n\n                        <div className=\"flex items-center gap-2\">\n                          <input\n                            type=\"number\"\n                            min=\"1\"\n                            max={adminStock}\n                            value={selected.quantity}\n                            onChange={(e) => {\n                              const value = e.target.value\n                              // Only allow numbers and prevent values greater than max\n                              if (value === '' || (parseFloat(value) >= 1 && parseFloat(value) <= adminStock)) {\n                                handleQuantityChange(selected.productId, value, selected.attributes)\n                              }\n                            }}\n                            onKeyDown={(e) => {\n                              // Disable arrow keys (Up/Down) to prevent accidental value changes\n                              if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {\n                                e.preventDefault()\n                              }\n                            }}\n                            onWheel={(e) => {\n                              // Disable mouse wheel scrolling on number input\n                              e.target.blur()\n                            }}\n                            placeholder=\"Qty\"\n                            className=\"vendor-quantity-input w-24 rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/40\"\n                          />\n                          <span className=\"text-xs text-gray-600\">{stockUnit}</span>\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              // If it's a variant, remove only this specific variant, otherwise remove the product\n                              if (selected.attributes && Object.keys(selected.attributes).length > 0) {\n                                const variantKey = JSON.stringify(selected.attributes)\n                                setSelectedProducts(prev => prev.filter(p => {\n                                  if (p.productId !== selected.productId) return true\n                                  const existingVariantKey = JSON.stringify(p.attributes || {})\n                                  return existingVariantKey !== variantKey\n                                }))\n                              } else {\n                                handleRemoveProduct(selected.productId)\n                              }\n                            }}\n                            className=\"text-red-600 hover:text-red-800\"\n                          >\n                            <CloseIcon className=\"h-5 w-5\" />\n                          </button>\n                        </div>\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n\n            {/* Billing Summary */}\n            {billingItems.length > 0 && (\n              <div className=\"rounded-xl border-2 border-gray-200 bg-white p-5\">\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Billing Summary</h3>\n                <div className=\"space-y-3 mb-4\">\n                  {billingItems.map((item, idx) => (\n                    <div key={idx} className=\"flex items-center justify-between border-b border-gray-100 pb-2\">\n                      <div>\n                        <p className=\"text-sm font-semibold text-gray-900\">{item.product.name}</p>\n                        {/* Display variant attributes if present */}\n                        {item.variantAttributes && Object.keys(item.variantAttributes).length > 0 && (\n                          <div className=\"mt-1 space-y-0.5\">\n                            {Object.entries(item.variantAttributes).map(([key, value]) => {\n                              // Format attribute label\n                              const formatLabel = (k) => {\n                                return k\n                                  .replace(/([A-Z])/g, ' $1')\n                                  .replace(/^./, str => str.toUpperCase())\n                                  .trim()\n                              }\n                              return (\n                                <p key={key} className=\"text-xs text-gray-600\">\n                                  <span className=\"font-medium\">{formatLabel(key)}:</span> {value}\n                                </p>\n                              )\n                            })}\n                          </div>\n                        )}\n                        <p className=\"text-xs text-gray-500\">\n                          {item.quantity} {item.product.unit || 'kg'} Ã— â‚¹{(item.unitPrice || item.pricePerUnit || 0).toLocaleString('en-IN')}\n                        </p>\n                      </div>\n                      <p className=\"text-sm font-bold text-gray-900\">\n                        â‚¹{((item.unitPrice || item.pricePerUnit || 0) * item.quantity).toLocaleString('en-IN')}\n                      </p>\n                    </div>\n                  ))}\n                </div>\n                <div className=\"flex items-center justify-between pt-3 border-t-2 border-gray-200\">\n                  <p className=\"text-base font-semibold text-gray-900\">Total Amount</p>\n                  <p\n                    className={cn(\n                      'text-xl font-bold',\n                      meetsMinValue && withinMaxValue ? 'text-gray-900' : 'text-red-600'\n                    )}\n                  >\n                    â‚¹{billingTotal.toLocaleString('en-IN')}\n                  </p>\n                </div>\n                {!meetsMinValue && (\n                  <p className=\"text-xs text-red-600 mt-2\">\n                    Minimum order value is â‚¹{MIN_PURCHASE_VALUE.toLocaleString('en-IN')}\n                  </p>\n                )}\n                {!withinMaxValue && (\n                  <p className=\"text-xs text-red-600 mt-2\">\n                    Maximum order value is â‚¹{MAX_PURCHASE_VALUE.toLocaleString('en-IN')}\n                  </p>\n                )}\n                {hasUnpaidCredits && (\n                  <div className=\"mt-4 rounded-lg border border-red-200 bg-red-50 p-3\">\n                    <p className=\"text-xs font-semibold text-red-800\">\n                      âš ï¸ You have unpaid credits. Clear outstanding payments before making a new request.\n                    </p>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Reason and Notes */}\n            {selectedProducts.length > 0 && (\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                <div className=\"flex flex-col gap-2\">\n                  <label className=\"text-xs font-semibold text-gray-700\">Reason for request *</label>\n                  <textarea\n                    rows={3}\n                    value={orderRequestForm.reason}\n                    onChange={(e) => handleOrderRequestChange('reason', e.target.value)}\n                    placeholder=\"Explain why you need this stock (min 10 characters)\"\n                    className=\"rounded-lg border border-gray-300 px-4 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/40\"\n                  />\n                </div>\n                <div className=\"flex flex-col gap-2\">\n                  <label className=\"text-xs font-semibold text-gray-700\">Additional notes (optional)</label>\n                  <textarea\n                    rows={3}\n                    value={orderRequestForm.notes}\n                    onChange={(e) => handleOrderRequestChange('notes', e.target.value)}\n                    placeholder=\"Mention urgency, delivery instructions, etc.\"\n                    className=\"rounded-lg border border-gray-300 px-4 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/40\"\n                  />\n                </div>\n              </div>\n            )}\n\n            {/* Bank Details */}\n            {selectedProducts.length > 0 && (\n              <div className=\"space-y-3\">\n                <h3 className=\"text-sm font-semibold text-gray-900\">Bank details for billing *</h3>\n                <div className=\"grid gap-3 md:grid-cols-2\">\n                  <input\n                    type=\"text\"\n                    value={orderRequestForm.bankAccountName}\n                    onChange={(e) => handleOrderRequestChange('bankAccountName', e.target.value)}\n                    placeholder=\"Account holder name\"\n                    className=\"rounded-lg border border-gray-300 px-4 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/40\"\n                  />\n                  <input\n                    type=\"text\"\n                    value={orderRequestForm.bankAccountNumber}\n                    onChange={(e) => handleOrderRequestChange('bankAccountNumber', e.target.value)}\n                    placeholder=\"Account number\"\n                    className=\"rounded-lg border border-gray-300 px-4 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/40\"\n                  />\n                  <input\n                    type=\"text\"\n                    value={orderRequestForm.bankName}\n                    onChange={(e) => handleOrderRequestChange('bankName', e.target.value)}\n                    placeholder=\"Bank name\"\n                    className=\"rounded-lg border border-gray-300 px-4 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/40\"\n                  />\n                  <input\n                    type=\"text\"\n                    value={orderRequestForm.bankIfsc}\n                    onChange={(e) => handleOrderRequestChange('bankIfsc', e.target.value)}\n                    placeholder=\"IFSC code\"\n                    className=\"rounded-lg border border-gray-300 px-4 py-2 text-sm uppercase focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/40\"\n                  />\n                  <input\n                    type=\"text\"\n                    value={orderRequestForm.bankBranch}\n                    onChange={(e) => handleOrderRequestChange('bankBranch', e.target.value)}\n                    placeholder=\"Branch (optional)\"\n                    className=\"rounded-lg border border-gray-300 px-4 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/40 md:col-span-2\"\n                  />\n                </div>\n              </div>\n            )}\n\n            {/* Policy Confirmation */}\n            {selectedProducts.length > 0 && (\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"text-sm font-semibold text-gray-900\">Confirm policy</h3>\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowCreditPolicyModal(true)}\n                    className=\"text-xs font-semibold text-purple-600 hover:text-purple-800\"\n                  >\n                    View Credit Policy\n                  </button>\n                </div>\n                <label className=\"flex items-start gap-2 text-sm text-gray-600\">\n                  <input\n                    type=\"checkbox\"\n                    checked={orderRequestForm.creditPolicyAccepted}\n                    onChange={(e) => handleOrderRequestChange('creditPolicyAccepted', e.target.checked)}\n                    className=\"mt-1 h-4 w-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500\"\n                  />\n                  <span>\n                    I have reviewed the credit policy, repayment timeline, and authorize IRA Sathi to adjust my credit balance once the stock is dispatched.\n                  </span>\n                </label>\n                <div className=\"flex flex-col gap-2\">\n                  <label className=\"text-xs font-semibold text-gray-700\">Type \"confirm\" to proceed *</label>\n                  <input\n                    type=\"text\"\n                    value={orderRequestForm.confirmationText}\n                    onChange={(e) => handleOrderRequestChange('confirmationText', e.target.value)}\n                    placeholder=\"confirm\"\n                    className=\"rounded-lg border border-gray-300 px-4 py-2 text-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/40\"\n                  />\n                </div>\n              </div>\n            )}\n\n            {orderRequestError && (\n              <div className=\"rounded-lg border border-red-200 bg-red-50 p-4\">\n                <p className=\"text-sm text-red-600\">{orderRequestError}</p>\n              </div>\n            )}\n\n            {selectedProducts.length > 0 && (\n              <div className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end\">\n                <button\n                  type=\"button\"\n                  onClick={closeOrderRequestScreen}\n                  className=\"rounded-full border border-purple-100 bg-white px-4 py-2 text-xs font-semibold text-purple-700 transition-all hover:border-purple-400 hover:text-purple-900\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={handleOrderRequestSubmit}\n                  disabled={!canSubmitOrderRequest}\n                  className={cn(\n                    'rounded-full px-6 py-2 text-sm font-semibold text-white transition-all',\n                    canSubmitOrderRequest\n                      ? 'bg-purple-600 hover:bg-purple-700'\n                      : 'bg-purple-300 cursor-not-allowed'\n                  )}\n                >\n                  {isOrderRequestSubmitting ? 'Submitting...' : 'Submit for Admin Approval'}\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Credit Policy Modal */}\n        {showCreditPolicyModal && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\">\n            <div className=\"w-full max-w-2xl rounded-2xl border border-gray-200 bg-white p-6 shadow-xl max-h-[90vh] overflow-y-auto\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h3 className=\"text-xl font-bold text-gray-900\">Credit Policy</h3>\n                <button\n                  type=\"button\"\n                  onClick={() => setShowCreditPolicyModal(false)}\n                  className=\"text-gray-400 hover:text-gray-600\"\n                >\n                  <CloseIcon className=\"h-6 w-6\" />\n                </button>\n              </div>\n              <div className=\"space-y-4 text-sm text-gray-700\">\n                <div>\n                  <h4 className=\"font-semibold text-gray-900 mb-2\">Minimum Order Value</h4>\n                  <p>All purchase requests must meet a minimum value of â‚¹{MIN_PURCHASE_VALUE.toLocaleString('en-IN')}.</p>\n                </div>\n                <div>\n                  <h4 className=\"font-semibold text-gray-900 mb-2\">Stock Delivery</h4>\n                  <p>Approved stock requests are scheduled for delivery within 24 hours. Admin stock is adjusted immediately upon approval, and your vendor stock is updated automatically after the delivery window.</p>\n                </div>\n                <div>\n                  <h4 className=\"font-semibold text-gray-900 mb-2\">Credit Adjustment</h4>\n                  <p>Your credit balance is adjusted once the stock is dispatched. Ensure your bank details are accurate for smooth billing and credit management.</p>\n                </div>\n                <div>\n                  <h4 className=\"font-semibold text-gray-900 mb-2\">Repayment Timeline</h4>\n                  <p>Credit repayment is due within {creditInfo.repaymentDays || 30} days. Keep your credit usage under control to avoid penalties and maintain a healthy credit standing.</p>\n                </div>\n                <div>\n                  <h4 className=\"font-semibold text-gray-900 mb-2\">Penalties</h4>\n                  <p>Late payments may incur penalties based on your credit policy. Contact your Admin SPOC for assistance with credit management.</p>\n                </div>\n              </div>\n              <div className=\"mt-6 flex justify-end\">\n                <button\n                  type=\"button\"\n                  onClick={() => setShowCreditPolicyModal(false)}\n                  className=\"rounded-full bg-purple-600 px-6 py-2 text-sm font-semibold text-white hover:bg-purple-700\"\n                >\n                  Close\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <section id=\"inventory-hero\" className=\"inventory-hero\">\n        <div className=\"inventory-hero__shell\">\n          <div className=\"inventory-hero__headline\">\n            <span className=\"inventory-hero__chip\">Stock hub</span>\n            <h3 className=\"inventory-hero__title\">{totalProducts} products available</h3>\n            <p className=\"inventory-hero__meta\">\n              {inStockCount} in stock â€¢ {outOfStockCount} out of stock\n            </p>\n            <div className=\"inventory-order-cta\">\n              <div>\n                <p className=\"inventory-order-cta__title\">Need to top-up stock?</p>\n                <p className=\"inventory-order-cta__meta\">\n                  Review credit policy, enter bank details, and raise a request for Admin approval.\n                </p>\n              </div>\n              <button type=\"button\" onClick={openOrderRequestScreen} className=\"inventory-order-cta__button\">\n                Order stock from Admin\n              </button>\n            </div>\n            <div className=\"inventory-hero__actions\">\n              {[\n                { label: 'Add product', icon: SparkIcon, action: 'add-sku' },\n                { label: 'Reorder', icon: TruckIcon, action: 'reorder' },\n                { label: 'Supplier list', icon: HomeIcon, action: 'supplier-list' },\n                { label: 'Stock summary', icon: ChartIcon, action: 'stock-report' },\n              ].map((action) => (\n                <button\n                  key={action.label}\n                  type=\"button\"\n                  className=\"inventory-hero__action\"\n                  onClick={() => action.action && openPanel(action.action)}\n                >\n                  <span className=\"inventory-hero__action-icon\">\n                    <action.icon className=\"h-4 w-4\" />\n                  </span>\n                  <span>{action.label}</span>\n                </button>\n              ))}\n            </div>\n          </div>\n          <div className=\"inventory-hero__statgrid\">\n            {topStats.map((stat) => (\n              <div\n                key={stat.label}\n                className={cn(\n                  'inventory-hero__stat',\n                  stat.tone === 'warn' ? 'is-warn' : stat.tone === 'teal' ? 'is-teal' : 'is-success',\n                )}\n              >\n                <p>{stat.label}</p>\n                <span>{stat.value}</span>\n                <small>{stat.note}</small>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      <section className=\"inventory-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Stock snapshot</h3>\n          </div>\n        </div>\n        <div className=\"inventory-metric-grid\">\n          {inventoryStats.map((stat, index) => {\n            const Icon = metricIcons[index % metricIcons.length]\n            return (\n              <div key={stat.label} className=\"inventory-metric-card\">\n                <span className=\"inventory-metric-icon\">\n                  <Icon className=\"h-4 w-4\" />\n                </span>\n                <div className=\"inventory-metric-body\">\n                  <p>{stat.label}</p>\n                  <span>{stat.value}</span>\n                  <small>{stat.meta}</small>\n                </div>\n              </div>\n            )\n          })}\n        </div>\n      </section>\n\n      <section className=\"inventory-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Alerts & follow ups</h3>\n          </div>\n        </div>\n        <div className=\"inventory-alert-grid\">\n          {alerts.map((card) => (\n            <div\n              key={card.title}\n              className={cn(\n                'inventory-alert-card',\n                card.tone === 'warn' ? 'is-warn' : card.tone === 'teal' ? 'is-teal' : 'is-neutral',\n              )}\n            >\n              <header>\n                <span className=\"inventory-alert-card__badge\">{card.badge}</span>\n                <h4>{card.title}</h4>\n              </header>\n              <p>{card.body}</p>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  if (card.title === 'Need to order more' || card.action === 'Raise request') {\n                    openPanel('raise-request')\n                  } else if (card.action === 'Contact admin') {\n                    openPanel('ping-admin')\n                  } else if (card.action === 'Upload docs') {\n                    openPanel('upload-docs')\n                  }\n                }}\n              >\n                {card.action}\n              </button>\n            </div>\n          ))}\n        </div>\n      </section>\n\n      {/* Products Grid */}\n      <section className=\"inventory-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Available Products</h3>\n            <p className=\"text-sm text-gray-600 mt-1\">Use the View details button to inspect and order stock</p>\n          </div>\n        </div>\n\n        {loading ? (\n          <div className=\"text-center py-12 text-gray-500\">\n            <p>Loading products...</p>\n          </div>\n        ) : products.length > 0 ? (\n          <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\n            {products.map((product) => {\n              const shortDescription = product.description?.substring(0, 100) || 'No description available'\n              const adminStock = product.adminStock ?? product.stock ?? 0\n              const vendorStock = product.vendorStock ?? 0\n              const vendorStockStatus = getVendorStockStatus(vendorStock)\n              const adminStockStatus = product.stockStatus || (adminStock > 0 ? 'in_stock' : 'out_of_stock')\n              const isArriving = product.isArrivingWithin24Hours || false\n\n              return (\n                <div\n                  key={product.id || product._id}\n                  className=\"group rounded-2xl border border-gray-200 bg-white p-4 shadow-sm transition-all hover:border-purple-300 hover:shadow-md\"\n                >\n                  {/* Product Image */}\n                  <div className=\"mb-3 aspect-square w-full overflow-hidden rounded-xl bg-gray-100\">\n                    {product.primaryImage || product.images?.[0]?.url ? (\n                      <img\n                        src={product.primaryImage || product.images[0].url}\n                        alt={product.name}\n                        className=\"h-full w-full object-cover transition-transform group-hover:scale-105\"\n                      />\n                    ) : (\n                      <div className=\"flex h-full w-full items-center justify-center\">\n                        <BoxIcon className=\"h-12 w-12 text-gray-400\" />\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Product Info */}\n                  <div className=\"space-y-2\">\n                    <h4 className=\"font-bold text-gray-900 line-clamp-1\">{product.name}</h4>\n                    <p className=\"text-xs text-gray-600 line-clamp-2\">{shortDescription}...</p>\n\n                    {/* Arriving Notification */}\n                    {isArriving && (\n                      <div className=\"rounded-lg border border-orange-200 bg-orange-50 p-2\">\n                        <div className=\"flex items-center gap-2\">\n                          <TruckIcon className=\"h-4 w-4 text-orange-600 shrink-0\" />\n                          <p className=\"text-xs font-semibold text-orange-800\">\n                            Product is arriving within 24 hours\n                          </p>\n                        </div>\n                      </div>\n                    )}\n\n                    {/* Stock Status */}\n                    <div className=\"flex items-center gap-2\">\n                      <span\n                        className={cn(\n                          'rounded-full px-2 py-0.5 text-xs font-semibold',\n                          vendorStockStatus.tone === 'success'\n                            ? 'bg-green-100 text-green-700'\n                            : vendorStockStatus.tone === 'teal'\n                              ? 'bg-blue-100 text-blue-700'\n                              : vendorStockStatus.tone === 'warn'\n                                ? 'bg-yellow-100 text-yellow-700'\n                                : 'bg-red-100 text-red-700',\n                        )}\n                      >\n                        Vendor stock â€¢ {vendorStockStatus.label}\n                      </span>\n                      <span className=\"text-xs text-gray-500\">\n                        {vendorStock} {product.unit || 'kg'} with you\n                      </span>\n                    </div>\n\n                    {/* Price */}\n                    <div className=\"pt-2 flex flex-col gap-3\">\n                      <p className=\"text-sm font-bold text-purple-600\">\n                        â‚¹{product.pricePerUnit || product.priceToVendor || 0} per {product.unit || 'kg'}\n                      </p>\n                      <p className=\"text-xs text-gray-500\">\n                        {vendorStockStatus.helper}\n                      </p>\n                      <div className=\"flex justify-end\">\n                        <button\n                          type=\"button\"\n                          onClick={() => handleProductClick(product)}\n                          className=\"rounded-full border border-purple-200 bg-purple-50 px-4 py-1.5 text-xs font-semibold text-purple-700 transition-all hover:border-purple-400 hover:bg-purple-100 hover:text-purple-900 focus:outline-none focus:ring-2 focus:ring-purple-500/50\"\n                        >\n                          View details\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        ) : (\n          <div className=\"text-center py-12 text-gray-500\">\n            <p>No products available</p>\n          </div>\n        )}\n      </section>\n\n      {/* Show restock advisory only if there are low stock items */}\n      {lowStockItems.length > 0 && (\n        <div id=\"inventory-restock\" className=\"vendor-card border border-brand/20 bg-white px-5 py-4 shadow-card\">\n          <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\n            <div>\n              <p className=\"text-sm font-semibold text-surface-foreground\">Need to order more</p>\n              <p className=\"text-xs text-muted-foreground\">\n                {lowStockItems.length} product{lowStockItems.length > 1 ? 's' : ''} running low. Submit a credit request to avoid stockout.\n              </p>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span className=\"vendor-chip warn\">Low stock â€¢ Action needed</span>\n              <button\n                className=\"rounded-full bg-brand px-5 py-2 text-xs font-semibold text-brand-foreground\"\n                onClick={() => openPanel('raise-request')}\n              >\n                Raise request\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\nfunction OrdersView({ openPanel, onOpenEscalationModal, onOpenPartialEscalationModal, onShowAllOrders, onViewOrderDetails, refreshKey, onRefresh }) {\n  const { dashboard } = useVendorState()\n  const dispatch = useVendorDispatch()\n  const { getOrders, getOrderDetails, updateOrderStatus, fetchDashboardData } = useVendorApi()\n  const { success, error } = useToast()\n  const [selectedFilter, setSelectedFilter] = useState('all')\n  const [ordersData, setOrdersData] = useState(null)\n  const lastRefreshKeyRef = useRef(refreshKey || 0)\n\n  const refreshOrders = useCallback(() => {\n    // Always fetch all orders (no status filter) to get accurate totals\n    // We'll filter client-side based on selectedFilter\n    getOrders({}).then((result) => {\n      console.log('ðŸ“¦ OrdersView: getOrders result:', result)\n      if (result.data) {\n        console.log('ðŸ“¦ OrdersView: Orders data:', result.data)\n        console.log('ðŸ“¦ OrdersView: Orders count:', result.data.orders?.length || 0)\n        setOrdersData(result.data)\n        dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n      } else if (result.error) {\n        console.error('âŒ OrdersView: Error fetching orders:', result.error)\n      }\n    }).catch((error) => {\n      console.error('âŒ OrdersView: Exception fetching orders:', error)\n    })\n  }, [getOrders, dispatch])\n\n  useEffect(() => {\n    refreshOrders()\n  }, [refreshOrders])\n\n  // Refresh when refreshKey changes (triggered by parent after status updates)\n  useEffect(() => {\n    if (refreshKey !== undefined && refreshKey !== lastRefreshKeyRef.current) {\n      lastRefreshKeyRef.current = refreshKey\n      refreshOrders()\n    }\n  }, [refreshKey, refreshOrders])\n\n  const STATUS_FLOW = ['awaiting', 'accepted', 'dispatched', 'delivered', 'fully_paid']\n  const STAGES = ['Awaiting', 'Accepted', 'Dispatched', 'Delivered']\n\n  const normalizeStatus = (status) => {\n    if (!status) return 'pending'\n    const normalized = status.toLowerCase()\n    if (normalized === 'fully_paid') return 'fully_paid'\n    if (normalized === 'delivered') return 'delivered'\n    if (normalized === 'out_for_delivery' || normalized === 'ready_for_delivery') return 'dispatched'\n    if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n    if (normalized === 'awaiting' || normalized === 'pending') return 'awaiting'\n    // Fallback\n    if (normalized.includes('deliver')) return 'delivered'\n    if (normalized.includes('dispatch')) return 'dispatched'\n    return 'awaiting'\n  }\n\n  const stageIndex = (status) => {\n    const key = normalizeStatus(status)\n    if (key === 'fully_paid') return 3\n    if (key === 'delivered') return 3\n    if (key === 'dispatched') return 2\n    if (key === 'accepted') return 1\n    return 0\n  }\n\n  // Transform backend orders to frontend format\n  const backendOrders = ordersData?.orders || dashboard.orders?.orders || []\n  console.log('ðŸ“¦ OrdersView: backendOrders count:', backendOrders.length)\n  console.log('ðŸ“¦ OrdersView: ordersData:', ordersData)\n  console.log('ðŸ“¦ OrdersView: dashboard.orders:', dashboard.orders)\n\n  const totals = backendOrders.reduce(\n    (acc, order) => {\n      const normalizedStatus = normalizeStatus(order.status)\n      if (normalizedStatus === 'fully_paid') {\n        acc.delivered += 1\n      } else if (normalizedStatus === 'delivered') {\n        acc.delivered += 1\n      } else if (normalizedStatus === 'dispatched') {\n        acc.dispatched += 1\n      } else if (normalizedStatus === 'accepted') {\n        acc.accepted += 1\n      } else {\n        acc.awaiting += 1\n      }\n      return acc\n    },\n    { awaiting: 0, accepted: 0, dispatched: 0, delivered: 0 },\n  )\n\n  // Filter out orders that already completed their workflow\n  const activeOrders = backendOrders.filter((order) => {\n    const normalizedStatus = normalizeStatus(order.status)\n    const isPartialPayment = order.paymentPreference !== 'full'\n    if (isPartialPayment) {\n      return normalizedStatus !== 'fully_paid'\n    }\n    return normalizedStatus !== 'delivered'\n  })\n  const totalOrders = activeOrders.length\n\n  // Apply client-side status filter based on selectedFilter\n  let filteredOrders = activeOrders\n  if (selectedFilter !== 'all') {\n    filteredOrders = activeOrders.filter((order) => {\n      const normalized = normalizeStatus(order.status)\n      if (selectedFilter === 'delivered') {\n        return normalized === 'delivered' || normalized === 'fully_paid'\n      }\n      return normalized === selectedFilter\n    })\n  }\n\n  // Helper function to map order to display format\n  const mapOrderToDisplay = (order) => {\n    const isFullyPaid = order.paymentStatus === 'fully_paid'\n    const isDelivered = order.status === 'delivered'\n    // Check if order is escalated\n    const isEscalated = order.assignedTo === 'admin' ||\n      order.escalation?.isEscalated === true ||\n      order.status === 'rejected'\n\n    // Determine next message based on status and payment\n    let nextMessage = null\n    if (order.status === 'pending') {\n      nextMessage = 'Confirm availability within 1 hour'\n    } else if (order.status === 'awaiting') {\n      nextMessage = 'Process and dispatch order'\n    } else if (order.status === 'processing') {\n      nextMessage = 'Prepare for delivery'\n    } else if (order.status === 'ready_for_delivery') {\n      nextMessage = 'Mark as out for delivery'\n    } else if (order.status === 'out_for_delivery') {\n      nextMessage = 'Mark as delivered'\n    } else if (isDelivered) {\n      // For delivered orders, check payment status\n      if (isFullyPaid) {\n        nextMessage = 'Payment completed'\n      } else {\n        nextMessage = 'Mark payment as done'\n      }\n    }\n\n    return {\n      id: order._id || order.id,\n      orderNumber: order.orderNumber,\n      farmer: order.userId?.name || 'Unknown Customer',\n      value: `â‚¹${(order.totalAmount || 0).toLocaleString('en-IN')}`,\n      payment: isFullyPaid ? 'Paid' : order.paymentStatus === 'partial_paid' ? 'Partial' : 'Pending',\n      paymentStatus: order.paymentStatus || 'pending',\n      paymentPreference: order.paymentPreference || 'partial',\n      status: order.status || 'pending',\n      items: order.items || [],\n      customerPhone: order.userId?.phone || '',\n      deliveryAddress: order.deliveryAddress || {},\n      createdAt: order.createdAt,\n      statusUpdateGracePeriod: order.statusUpdateGracePeriod || null,\n      acceptanceGracePeriod: order.acceptanceGracePeriod || null,\n      isEscalated,\n      assignedTo: order.assignedTo,\n      escalation: order.escalation,\n      next: nextMessage,\n    }\n  }\n\n  // Map filtered orders for display (for main orders list)\n  const orders = filteredOrders.map(mapOrderToDisplay)\n\n  // Get 3 most recent orders for tracker section (regardless of status)\n  // Keep original order objects but sort by date\n  const recentOrdersForTrackerRaw = backendOrders\n    .slice()\n    .sort((a, b) => {\n      const dateA = new Date(a.createdAt || a.updatedAt || 0)\n      const dateB = new Date(b.createdAt || b.updatedAt || 0)\n      return dateB - dateA // Descending order (most recent first)\n    })\n    .slice(0, 3)\n\n  // Map to display format for tracker\n  const recentOrdersForTracker = recentOrdersForTrackerRaw.map(mapOrderToDisplay)\n\n  const filterChips = [\n    { id: 'all', label: 'All orders', value: totalOrders },\n    { id: 'awaiting', label: 'Awaiting', value: totals.awaiting },\n    { id: 'accepted', label: 'Accepted', value: totals.accepted },\n    { id: 'dispatched', label: 'Dispatched', value: totals.dispatched },\n    { id: 'delivered', label: 'Delivered', value: totals.delivered },\n  ]\n\n  const getHeroStats = (filter) => {\n    switch (filter) {\n      case 'all':\n        return [\n          {\n            label: 'Waiting for your reply',\n            value: totals.awaiting,\n            meta: 'Needs your reply',\n            tone: 'warn',\n          },\n          {\n            label: 'Orders in transit',\n            value: totals.dispatched,\n            meta: 'Delivery in progress',\n            tone: 'teal',\n          },\n          {\n            label: 'Ready to deliver',\n            value: totals.delivered,\n            meta: 'Track delivery',\n            tone: 'success',\n          },\n        ]\n      case 'awaiting':\n        return [\n          {\n            label: 'Waiting for your reply',\n            value: totals.awaiting,\n            meta: 'Action required',\n            tone: 'warn',\n          },\n          {\n            label: 'Average wait time',\n            value: '2.5h',\n            meta: 'Time to reply',\n            tone: 'teal',\n          },\n          {\n            label: 'Urgent orders',\n            value: Math.max(0, totals.awaiting - 2),\n            meta: 'Taking too long',\n            tone: 'warn',\n          },\n        ]\n      case 'accepted':\n        return [\n          {\n            label: 'Ready to dispatch',\n            value: totals.accepted,\n            meta: 'Accepted & pending dispatch',\n            tone: 'teal',\n          },\n          {\n            label: 'Dispatch SLA',\n            value: '24h',\n            meta: 'Target to dispatch',\n            tone: 'teal',\n          },\n          {\n            label: 'Next actions',\n            value: totals.accepted > 0 ? 'Pack & assign' : 'All clear',\n            meta: 'Keep SLA green',\n            tone: totals.accepted > 0 ? 'warn' : 'success',\n          },\n        ]\n      case 'dispatched':\n        return [\n          {\n            label: 'In transit',\n            value: totals.dispatched,\n            meta: 'On the way to farmer',\n            tone: 'teal',\n          },\n          {\n            label: 'Awaiting delivery',\n            value: Math.max(0, totals.dispatched - totals.delivered),\n            meta: 'Deliver within 24h SLA',\n            tone: 'success',\n          },\n          {\n            label: 'Average dispatch time',\n            value: '4.2h',\n            meta: 'After confirmation',\n            tone: 'teal',\n          },\n        ]\n      case 'delivered':\n        return [\n          {\n            label: 'Completed today',\n            value: totals.delivered,\n            meta: 'Successfully delivered',\n            tone: 'success',\n          },\n          {\n            label: 'Delivered on time',\n            value: '94%',\n            meta: 'On-time delivery',\n            tone: 'success',\n          },\n          {\n            label: 'Average delivery time',\n            value: '18.5h',\n            meta: 'After order placed',\n            tone: 'teal',\n          },\n        ]\n      default:\n        return []\n    }\n  }\n\n  const heroStats = getHeroStats(selectedFilter)\n\n  return (\n    <div className=\"orders-view space-y-6\">\n      <section id=\"orders-hero\" className=\"orders-hero\">\n        <div className=\"orders-hero__shell\">\n          <div className=\"orders-hero__headline\">\n            <span className=\"orders-hero__chip\">Orders</span>\n            <h3 className=\"orders-hero__title\">{totalOrders} active orders</h3>\n            <p className=\"orders-hero__meta\">\n              {totals.awaiting} awaiting â€¢ {totals.dispatched} dispatched â€¢ {totals.delivered} delivered\n            </p>\n          </div>\n          <div className=\"orders-hero__filters\" role=\"group\" aria-label=\"Filter orders\">\n            {filterChips.map((chip) => (\n              <button\n                key={chip.id}\n                type=\"button\"\n                className={cn('orders-hero__filter', selectedFilter === chip.id && 'is-active')}\n                aria-pressed={selectedFilter === chip.id}\n                onClick={() => setSelectedFilter(chip.id)}\n              >\n                <span>{chip.label}</span>\n                <strong>{chip.value}</strong>\n              </button>\n            ))}\n          </div>\n          <div className=\"orders-hero__stats\">\n            {heroStats.map((stat) => (\n              <div\n                key={stat.label}\n                className={cn(\n                  'orders-hero__stat',\n                  stat.tone === 'warn' ? 'is-warn' : stat.tone === 'teal' ? 'is-teal' : 'is-success',\n                )}\n              >\n                <small>{stat.label}</small>\n                <span>{stat.value}</span>\n                <p>{stat.meta}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      <section id=\"orders-tracker\" className=\"orders-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Orders</h3>\n          </div>\n          <div style={{ display: 'flex', gap: '0.75rem', alignItems: 'center' }}>\n            {onShowAllOrders && backendOrders.length > 0 && (\n              <button\n                type=\"button\"\n                className=\"orders-section__cta\"\n                onClick={onShowAllOrders}\n              >\n                See All\n              </button>\n            )}\n            <button type=\"button\" className=\"orders-section__cta\" onClick={() => openPanel('view-sla-policy')}>\n              View delivery policy\n            </button>\n          </div>\n        </div>\n        <div className=\"orders-list\">\n          {backendOrders.length > 0 ? recentOrdersForTrackerRaw.map((originalOrder, index) => {\n            // Map to display format for this order\n            const orderDisplay = recentOrdersForTracker[index]\n            const order = originalOrder // Use original order for all status/grace period checks\n\n            const normalizedStatus = normalizeStatus(order.status)\n            // Check if order is in acceptance grace period\n            const isInGracePeriod = order.acceptanceGracePeriod?.isActive\n            const gracePeriodExpiresAt = order.acceptanceGracePeriod?.expiresAt\n            const timeRemaining = gracePeriodExpiresAt ? Math.max(0, Math.floor((new Date(gracePeriodExpiresAt) - new Date()) / 1000 / 60)) : 0\n            // Check if order is in status update grace period\n            const isInStatusUpdateGracePeriod = order.statusUpdateGracePeriod?.isActive\n            const statusUpdateGracePeriodExpiresAt = order.statusUpdateGracePeriod?.expiresAt\n            const statusUpdateTimeRemaining = statusUpdateGracePeriodExpiresAt ? Math.max(0, Math.floor((new Date(statusUpdateGracePeriodExpiresAt) - new Date()) / 1000 / 60)) : 0\n            const previousStatus = order.statusUpdateGracePeriod?.previousStatus\n            const isPartialPayment = order.paymentPreference !== 'full'\n            const paymentStatus = order.paymentStatus || 'pending'\n            const paymentCompleted = paymentStatus === 'fully_paid'\n            // Check if order is escalated\n            const isEscalated = orderDisplay.isEscalated || false\n            // Show accept/reject actions only while awaiting confirmation and not escalated\n            const showAvailabilityActions = normalizedStatus === 'awaiting' && !isInGracePeriod && !isEscalated\n            const workflowCompleted = isPartialPayment ? normalizedStatus === 'fully_paid' : normalizedStatus === 'delivered'\n            const canShowStatusUpdate = !showAvailabilityActions && !isInStatusUpdateGracePeriod && !isInGracePeriod && !workflowCompleted && normalizedStatus !== 'awaiting' && !isEscalated\n            const nextMessage =\n              orderDisplay.next ||\n              (isInGracePeriod\n                ? `Confirm or escalate within ${timeRemaining} minutes`\n                : isInStatusUpdateGracePeriod\n                  ? `You can revert status within ${statusUpdateTimeRemaining} minutes`\n                  : normalizedStatus === 'awaiting'\n                    ? 'Accept or escalate this order'\n                    : normalizedStatus === 'accepted'\n                      ? 'Dispatch items before SLA ends'\n                      : normalizedStatus === 'dispatched'\n                        ? 'Deliver before the 24h SLA'\n                        : normalizedStatus === 'delivered'\n                          ? (isPartialPayment ? 'Collect remaining payment' : 'Delivery completed')\n                          : normalizedStatus === 'fully_paid'\n                            ? 'Payment completed'\n                            : 'Update order status')\n\n            return (\n              <article key={orderDisplay.id} className=\"orders-card\">\n                <header className=\"orders-card__header\">\n                  <div className=\"orders-card__identity\">\n                    <span className=\"orders-card__icon\">\n                      <TruckIcon className=\"h-5 w-5\" />\n                    </span>\n                    <div className=\"orders-card__details\">\n                      <p className=\"orders-card__name\">{orderDisplay.farmer}</p>\n                      <p className=\"orders-card__value\">{orderDisplay.value}</p>\n                      {orderDisplay.orderNumber && (\n                        <p style={{ fontSize: '12px', color: '#6B7280', marginTop: '2px' }}>{orderDisplay.orderNumber}</p>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"orders-card__status\">\n                    <span className={cn(\n                      'orders-card__payment',\n                      paymentStatus === 'fully_paid' && 'is-paid'\n                    )}>\n                      {orderDisplay.payment}\n                    </span>\n                    <span className=\"orders-card__stage-label\" style={\n                      normalizedStatus === 'delivered' && isPartialPayment && !paymentCompleted\n                        ? { display: 'flex', flexDirection: 'column', gap: '2px' }\n                        : normalizedStatus === 'fully_paid'\n                          ? { display: 'flex', flexDirection: 'column', gap: '2px' }\n                          : isEscalated\n                            ? { display: 'flex', flexDirection: 'column', gap: '2px', alignItems: 'flex-end' }\n                            : {}\n                    }>\n                      {normalizedStatus === 'awaiting'\n                        ? 'Awaiting'\n                        : normalizedStatus === 'accepted'\n                          ? 'Accepted'\n                          : normalizedStatus === 'dispatched'\n                            ? 'Dispatched'\n                            : normalizedStatus === 'delivered'\n                              ? (isPartialPayment && !paymentCompleted ? (\n                                <>\n                                  <span>Delivered</span>\n                                  <span>Awaiting Payment</span>\n                                </>\n                              ) : 'Delivered')\n                              : normalizedStatus === 'fully_paid'\n                                ? (\n                                  <>\n                                    <span>Delivered</span>\n                                    <span>Paid</span>\n                                  </>\n                                )\n                                : order.status}\n                      {isEscalated && (\n                        <span style={{\n                          padding: '2px 8px',\n                          backgroundColor: '#FEF3C7',\n                          color: '#92400E',\n                          borderRadius: '4px',\n                          fontSize: '11px',\n                          fontWeight: '600',\n                          textTransform: 'uppercase'\n                        }}>\n                          Escalated\n                        </span>\n                      )}\n                    </span>\n                  </div>\n                </header>\n                <div className=\"orders-card__next\">\n                  <span className=\"orders-card__next-label\">Next</span>\n                  <span className=\"orders-card__next-value\">{nextMessage}</span>\n                </div>\n                <div className=\"orders-card__stages\">\n                  {STAGES.map((stage, stageIdx) => (\n                    <div\n                      key={stage}\n                      className={cn('orders-card__stage', stageIdx <= stageIndex(order.status) && 'is-active')}\n                    >\n                      <span className=\"orders-card__stage-index\">{stageIdx + 1}</span>\n                      <span className=\"orders-card__stage-text\">{stage}</span>\n                    </div>\n                  ))}\n                </div>\n                <div className=\"orders-card__actions\">\n                  {isInGracePeriod ? (\n                    <>\n                      <div className=\"orders-card__grace-period-notice\" style={{\n                        padding: '8px 12px',\n                        marginBottom: '8px',\n                        backgroundColor: '#FEF3C7',\n                        border: '1px solid #FCD34D',\n                        borderRadius: '8px',\n                        fontSize: '12px',\n                        color: '#92400E'\n                      }}>\n                        â° Grace Period: {timeRemaining} minutes remaining. Confirm or escalate now.\n                      </div>\n                      <button\n                        type=\"button\"\n                        className=\"orders-card__action is-primary\"\n                        onClick={() => openPanel('confirm-acceptance', { orderId: orderDisplay.id })}\n                      >\n                        Confirm Acceptance\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"orders-card__action is-secondary\"\n                        onClick={() => openPanel('cancel-acceptance', { orderId: orderDisplay.id })}\n                      >\n                        Cancel & Escalate\n                      </button>\n                    </>\n                  ) : (\n                    <>\n                      {/* Show status update grace period notice if active */}\n                      {isInStatusUpdateGracePeriod && (\n                        <div className=\"orders-card__grace-period-notice\" style={{\n                          padding: '8px 12px',\n                          marginBottom: '8px',\n                          backgroundColor: '#DBEAFE',\n                          border: '1px solid #93C5FD',\n                          borderRadius: '8px',\n                          fontSize: '12px',\n                          color: '#1E40AF'\n                        }}>\n                          â° Status Update Grace Period: {statusUpdateTimeRemaining} minutes remaining. You can revert to \"{previousStatus}\" status or confirm now.\n                        </div>\n                      )}\n                      {/* Show update status button for accepted orders (not pending, not paid, not in grace period) - Hide for escalated orders */}\n                      {canShowStatusUpdate && !isEscalated && (\n                        <button\n                          type=\"button\"\n                          className=\"orders-card__action is-primary\"\n                          onClick={() =>\n                            openPanel('update-order-status', {\n                              orderId: orderDisplay.id,\n                              status: normalizedStatus,\n                            })\n                          }\n                        >\n                          Update status\n                        </button>\n                      )}\n                      {/* Show confirm and revert buttons during grace period - Hide for escalated orders */}\n                      {!workflowCompleted && isInStatusUpdateGracePeriod && !isEscalated && (\n                        <>\n                          <button\n                            type=\"button\"\n                            className=\"orders-card__action is-primary\"\n                            onClick={async () => {\n                              const result = await updateOrderStatus(orderDisplay.id, { finalizeGracePeriod: true })\n                              if (result.data) {\n                                success(result.data.message || 'Status update confirmed successfully!')\n                                // Refresh orders list\n                                getOrders().then((result) => {\n                                  if (result.data) {\n                                    dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n                                    // If order details view is open, refresh it\n                                    const updatedOrder = result.data.orders?.find(o =>\n                                      (o._id && orderDisplay.id && o._id.toString() === orderDisplay.id.toString()) ||\n                                      (o.id && orderDisplay.id && o.id.toString() === orderDisplay.id.toString())\n                                    )\n                                    if (updatedOrder && onViewOrderDetails) {\n                                      // Trigger refresh by calling onViewOrderDetails with updated order\n                                      getOrderDetails(orderDisplay.id).then((detailsResult) => {\n                                        if (detailsResult.data?.order) {\n                                          onViewOrderDetails(detailsResult.data.order)\n                                        }\n                                      })\n                                    }\n                                  }\n                                })\n                                fetchDashboardData()\n                                // Trigger OrdersView refresh (only once)\n                                if (onRefresh) {\n                                  onRefresh()\n                                }\n                              } else if (result.error) {\n                                error(result.error.message || 'Failed to confirm status update')\n                              }\n                            }}\n                          >\n                            Confirm Status Update\n                          </button>\n                          {previousStatus && (\n                            <button\n                              type=\"button\"\n                              className=\"orders-card__action is-secondary\"\n                              onClick={() =>\n                                openPanel('update-order-status', {\n                                  orderId: orderDisplay.id,\n                                  status: previousStatus,\n                                  revert: true,\n                                })\n                              }\n                            >\n                              Revert to {previousStatus}\n                            </button>\n                          )}\n                        </>\n                      )}\n                      {/* Show paid badge if order is fully paid */}\n                      {(normalizedStatus === 'fully_paid' || (!isPartialPayment && paymentCompleted && normalizedStatus === 'delivered')) && (\n                        <div className=\"orders-card__action is-success\" style={{\n                          padding: '8px 16px',\n                          borderRadius: '8px',\n                          backgroundColor: '#D1FAE5',\n                          color: '#065F46',\n                          fontWeight: '600',\n                          fontSize: '14px',\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: '6px'\n                        }}>\n                          âœ“ Paid\n                        </div>\n                      )}\n                      {showAvailabilityActions && (\n                        <>\n                          <button\n                            type=\"button\"\n                            className=\"orders-card__action is-primary\"\n                            onClick={() => openPanel('order-available', { orderId: orderDisplay.id })}\n                          >\n                            Accept Order\n                          </button>\n                          <button\n                            type=\"button\"\n                            className=\"orders-card__action is-secondary\"\n                            onClick={async () => {\n                              const details = await getOrderDetails(orderDisplay.id)\n                              if (details.data?.order) {\n                                onOpenEscalationModal?.(details.data.order)\n                              }\n                            }}\n                          >\n                            Escalate All\n                          </button>\n                          <button\n                            type=\"button\"\n                            className=\"orders-card__action is-secondary\"\n                            onClick={async () => {\n                              const details = await getOrderDetails(orderDisplay.id)\n                              if (details.data?.order) {\n                                onOpenPartialEscalationModal?.(details.data.order, 'items')\n                              }\n                            }}\n                          >\n                            Partial Items\n                          </button>\n                          <button\n                            type=\"button\"\n                            className=\"orders-card__action is-secondary\"\n                            onClick={async () => {\n                              const details = await getOrderDetails(orderDisplay.id)\n                              if (details.data?.order) {\n                                onOpenPartialEscalationModal?.(details.data.order, 'quantities')\n                              }\n                            }}\n                          >\n                            Partial Qty\n                          </button>\n                        </>\n                      )}\n                    </>\n                  )}\n                </div>\n                {/* View Details Button */}\n                <div style={{ padding: '0 16px 12px', borderTop: '1px solid #E5E7EB', marginTop: '12px', paddingTop: '12px' }}>\n                  <button\n                    type=\"button\"\n                    className=\"orders-card__action is-secondary\"\n                    style={{ width: '100%', justifyContent: 'center' }}\n                    onClick={async () => {\n                      const details = await getOrderDetails(orderDisplay.id)\n                      if (details.data?.order) {\n                        onViewOrderDetails?.(details.data.order)\n                      }\n                    }}\n                  >\n                    View Details\n                  </button>\n                </div>\n              </article>\n            )\n          }) : (\n            <div className=\"orders-card\">\n              <div className=\"orders-card__details\">\n                <p className=\"text-sm text-gray-500 text-center py-4\">No orders found</p>\n              </div>\n            </div>\n          )}\n        </div>\n      </section>\n\n      <section id=\"orders-fallback\" className=\"orders-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Backup delivery</h3>\n\n          </div>\n        </div>\n        <div className=\"orders-fallback-card\">\n          <p className=\"orders-fallback-card__body\">\n            Western hub reporting a mild delay. Send low-priority orders to Admin delivery if it takes more than 24 hours.\n          </p>\n          <div className=\"orders-fallback-card__footer\">\n            <span className=\"orders-fallback-card__badge\">Delay â€¢ Western hub</span>\n            <button type=\"button\" className=\"orders-fallback-card__cta\" onClick={() => openPanel('escalate-to-admin')}>\n              Send to admin\n            </button>\n          </div>\n        </div>\n      </section>\n    </div>\n  )\n}\n\nfunction AllOrdersView({ openPanel, onOpenEscalationModal, onOpenPartialEscalationModal, onBack, onViewOrderDetails }) {\n  const { dashboard } = useVendorState()\n  const dispatch = useVendorDispatch()\n  const { getOrders, getOrderDetails } = useVendorApi()\n  const [ordersData, setOrdersData] = useState(null)\n  const [selectedFilter, setSelectedFilter] = useState('all')\n  const [searchQuery, setSearchQuery] = useState('')\n  const [isLoading, setIsLoading] = useState(false)\n\n  const filterTabs = [\n    { id: 'all', label: 'All Orders' },\n    { id: 'awaiting', label: 'Awaiting' },\n    { id: 'accepted', label: 'Accepted' },\n    { id: 'dispatched', label: 'Dispatched' },\n    { id: 'delivered', label: 'Delivered' },\n    { id: 'fully_paid', label: 'Fully Paid' },\n    { id: 'escalated', label: 'Escalated' },\n  ]\n\n  const fetchOrders = useCallback(async () => {\n    setIsLoading(true)\n    const params = {}\n\n    // Handle escalated filter\n    if (selectedFilter === 'escalated') {\n      params.escalated = true\n    } else if (selectedFilter !== 'all') {\n      // Add status filter for non-escalated filters\n      if (selectedFilter === 'fully_paid') {\n        params.paymentStatus = 'fully_paid'\n      } else {\n        params.status = selectedFilter\n      }\n    }\n\n    // Add search query (only if not empty)\n    const trimmedSearch = searchQuery.trim()\n    if (trimmedSearch) {\n      params.search = trimmedSearch\n    }\n\n    try {\n      const result = await getOrders(params)\n      if (result.data) {\n        setOrdersData(result.data)\n        dispatch({ type: 'SET_ORDERS_DATA', payload: result.data })\n      }\n    } catch (error) {\n      console.error('Error fetching orders:', error)\n    } finally {\n      setIsLoading(false)\n    }\n  }, [getOrders, selectedFilter, searchQuery, dispatch])\n\n  // Debounce search - fetch when user stops typing or filter changes\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      fetchOrders()\n    }, 500) // Wait 500ms after user stops typing\n\n    return () => clearTimeout(timer)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchQuery, selectedFilter])\n\n  // Initial fetch on mount\n  useEffect(() => {\n    fetchOrders()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  const STATUS_FLOW = ['awaiting', 'accepted', 'dispatched', 'delivered', 'fully_paid']\n  const STAGES = ['Awaiting', 'Accepted', 'Dispatched', 'Delivered']\n\n  const normalizeStatus = (status) => {\n    if (!status) return 'awaiting'\n    const normalized = status.toLowerCase()\n    if (normalized === 'fully_paid') return 'fully_paid'\n    if (normalized === 'delivered') return 'delivered'\n    if (normalized === 'out_for_delivery' || normalized === 'ready_for_delivery') return 'dispatched'\n    if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n    if (normalized === 'awaiting' || normalized === 'pending') return 'awaiting'\n    if (normalized.includes('deliver')) return 'delivered'\n    if (normalized.includes('dispatch')) return 'dispatched'\n    return 'awaiting'\n  }\n\n  const stageIndex = (status) => {\n    const key = normalizeStatus(status)\n    if (key === 'fully_paid' || key === 'delivered') return 3\n    if (key === 'dispatched') return 2\n    if (key === 'accepted') return 1\n    return 0\n  }\n\n  const backendOrders = ordersData?.orders || dashboard.orders?.orders || []\n\n  const orders = backendOrders.map((order) => {\n    const normalizedStatus = normalizeStatus(order.status)\n    const isPartialPayment = order.paymentPreference !== 'full'\n    const paymentStatus = order.paymentStatus || 'pending'\n    // Check if order is escalated\n    const isEscalated = order.assignedTo === 'admin' ||\n      order.escalation?.isEscalated === true ||\n      order.status === 'rejected'\n    const next =\n      normalizedStatus === 'awaiting'\n        ? 'Accept or escalate this order'\n        : normalizedStatus === 'accepted'\n          ? 'Dispatch items before SLA ends'\n          : normalizedStatus === 'dispatched'\n            ? 'Deliver before the 24h SLA'\n            : normalizedStatus === 'delivered'\n              ? (isPartialPayment ? 'Collect remaining payment' : 'Delivery completed')\n              : normalizedStatus === 'fully_paid'\n                ? 'Payment completed'\n                : null\n\n    return {\n      id: order._id || order.id,\n      orderNumber: order.orderNumber,\n      farmer: order.userId?.name || 'Unknown Customer',\n      value: `â‚¹${(order.totalAmount || 0).toLocaleString('en-IN')}`,\n      payment: paymentStatus === 'fully_paid' ? 'Paid' : paymentStatus === 'partial_paid' ? 'Partial' : 'Pending',\n      paymentStatus,\n      paymentPreference: order.paymentPreference || 'partial',\n      status: order.status || 'awaiting',\n      items: order.items || [],\n      customerPhone: order.userId?.phone || '',\n      deliveryAddress: order.deliveryAddress || {},\n      createdAt: order.createdAt,\n      statusUpdateGracePeriod: order.statusUpdateGracePeriod || null,\n      acceptanceGracePeriod: order.acceptanceGracePeriod || null,\n      isEscalated,\n      assignedTo: order.assignedTo,\n      escalation: order.escalation,\n      next,\n    }\n  })\n\n  const handleSearchChange = (e) => {\n    setSearchQuery(e.target.value)\n  }\n\n  const handleSearchSubmit = (e) => {\n    e.preventDefault()\n    // Search is handled by debounced effect, but we can trigger immediate search on submit\n    fetchOrders()\n  }\n\n  return (\n    <div className=\"orders-view space-y-6\">\n      {/* Header with back button */}\n      <div className=\"overview-section__header\">\n        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\n          <button\n            type=\"button\"\n            onClick={onBack}\n            className=\"orders-section__cta\"\n            style={{\n              fontSize: '14px',\n              fontWeight: '500',\n              textDecoration: 'none'\n            }}\n          >\n            â† Back\n          </button>\n          <h3 className=\"overview-section__title\">All Orders</h3>\n        </div>\n      </div>\n\n      {/* Search bar */}\n      <div className=\"orders-section\" style={{ marginBottom: '20px' }}>\n        <form onSubmit={handleSearchSubmit} style={{ display: 'flex', gap: '8px' }}>\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={handleSearchChange}\n            placeholder=\"Search by order number...\"\n            className=\"vendor-action-panel__input\"\n            style={{ flex: 1 }}\n          />\n          <button\n            type=\"submit\"\n            className=\"orders-section__cta\"\n          >\n            Search\n          </button>\n        </form>\n      </div>\n\n      {/* Filter tabs */}\n      <div className=\"orders-hero__filters\" role=\"group\" aria-label=\"Filter orders\" style={{\n        marginBottom: '24px',\n        overflowX: 'auto',\n        WebkitOverflowScrolling: 'touch',\n        scrollbarWidth: 'thin'\n      }}>\n        {filterTabs.map((tab) => (\n          <button\n            key={tab.id}\n            type=\"button\"\n            onClick={() => setSelectedFilter(tab.id)}\n            className={cn('orders-hero__filter', selectedFilter === tab.id && 'is-active')}\n            aria-pressed={selectedFilter === tab.id}\n            style={{ whiteSpace: 'nowrap' }}\n          >\n            <span>{tab.label}</span>\n          </button>\n        ))}\n      </div>\n\n      {/* Orders list */}\n      <div className=\"orders-list\">\n        {isLoading ? (\n          <div className=\"orders-card\">\n            <div className=\"orders-card__details\">\n              <p className=\"text-sm text-gray-500 text-center py-4\">Loading orders...</p>\n            </div>\n          </div>\n        ) : orders.length > 0 ? orders.map((order) => {\n          const normalizedStatus = normalizeStatus(order.status)\n          const isInGracePeriod = order.acceptanceGracePeriod?.isActive\n          const gracePeriodExpiresAt = order.acceptanceGracePeriod?.expiresAt\n          const timeRemaining = gracePeriodExpiresAt ? Math.max(0, Math.floor((new Date(gracePeriodExpiresAt) - new Date()) / 1000 / 60)) : 0\n          const isInStatusUpdateGracePeriod = order.statusUpdateGracePeriod?.isActive\n          const statusUpdateGracePeriodExpiresAt = order.statusUpdateGracePeriod?.expiresAt\n          const statusUpdateTimeRemaining = statusUpdateGracePeriodExpiresAt ? Math.max(0, Math.floor((new Date(statusUpdateGracePeriodExpiresAt) - new Date()) / 1000 / 60)) : 0\n          const previousStatus = order.statusUpdateGracePeriod?.previousStatus\n          const isPartialPayment = order.paymentPreference !== 'full'\n          const paymentStatus = order.paymentStatus || 'pending'\n          const paymentCompleted = paymentStatus === 'fully_paid'\n          const isEscalated = order.isEscalated || false\n          const showAvailabilityActions = normalizedStatus === 'awaiting' && !isInGracePeriod && !isEscalated\n          const workflowCompleted = isPartialPayment ? normalizedStatus === 'fully_paid' : normalizedStatus === 'delivered'\n          const canShowStatusUpdate = !showAvailabilityActions && !isInStatusUpdateGracePeriod && !isInGracePeriod && !workflowCompleted && normalizedStatus !== 'awaiting' && !isEscalated\n          const nextMessage =\n            order.next ||\n            (isInGracePeriod\n              ? `Confirm or escalate within ${timeRemaining} minutes`\n              : isInStatusUpdateGracePeriod\n                ? `You can revert status within ${statusUpdateTimeRemaining} minutes`\n                : normalizedStatus === 'awaiting'\n                  ? 'Accept or escalate this order'\n                  : normalizedStatus === 'accepted'\n                    ? 'Dispatch items before SLA ends'\n                    : normalizedStatus === 'dispatched'\n                      ? 'Deliver before the 24h SLA'\n                      : normalizedStatus === 'delivered'\n                        ? (isPartialPayment ? 'Collect remaining payment' : 'Delivery completed')\n                        : normalizedStatus === 'fully_paid'\n                          ? 'Payment completed'\n                          : 'Mark payment as collected')\n\n          return (\n            <article key={order.id} className=\"orders-card\">\n              <header className=\"orders-card__header\">\n                <div className=\"orders-card__identity\">\n                  <span className=\"orders-card__icon\">\n                    <TruckIcon className=\"h-5 w-5\" />\n                  </span>\n                  <div className=\"orders-card__details\">\n                    <p className=\"orders-card__name\">{order.farmer}</p>\n                    <p className=\"orders-card__value\">{order.value}</p>\n                    {order.orderNumber && (\n                      <p style={{ fontSize: '12px', color: '#6B7280', marginTop: '2px' }}>{order.orderNumber}</p>\n                    )}\n                  </div>\n                </div>\n                <div className=\"orders-card__status\">\n                  <span className={cn(\n                    'orders-card__payment',\n                    order.paymentStatus === 'fully_paid' && 'is-paid'\n                  )}>\n                    {order.payment}\n                  </span>\n                  <span className=\"orders-card__stage-label\" style={\n                    normalizedStatus === 'delivered' && isPartialPayment && !paymentCompleted\n                      ? { display: 'flex', flexDirection: 'column', gap: '2px' }\n                      : normalizedStatus === 'fully_paid'\n                        ? { display: 'flex', flexDirection: 'column', gap: '2px' }\n                        : isEscalated\n                          ? { display: 'flex', flexDirection: 'column', gap: '2px', alignItems: 'flex-end' }\n                          : {}\n                  }>\n                    {normalizedStatus === 'awaiting'\n                      ? 'Awaiting'\n                      : normalizedStatus === 'accepted'\n                        ? 'Accepted'\n                        : normalizedStatus === 'dispatched'\n                          ? 'Dispatched'\n                          : normalizedStatus === 'delivered'\n                            ? (isPartialPayment && !paymentCompleted ? (\n                              <>\n                                <span>Delivered</span>\n                                <span>Awaiting Payment</span>\n                              </>\n                            ) : 'Delivered')\n                            : normalizedStatus === 'fully_paid'\n                              ? (\n                                <>\n                                  <span>Delivered</span>\n                                  <span>Paid</span>\n                                </>\n                              )\n                              : order.status}\n                    {isEscalated && (\n                      <span style={{\n                        padding: '2px 8px',\n                        backgroundColor: '#FEF3C7',\n                        color: '#92400E',\n                        borderRadius: '4px',\n                        fontSize: '11px',\n                        fontWeight: '600',\n                        textTransform: 'uppercase'\n                      }}>\n                        Escalated\n                      </span>\n                    )}\n                  </span>\n                </div>\n              </header>\n              <div className=\"orders-card__next\">\n                <span className=\"orders-card__next-label\">Next</span>\n                <span className=\"orders-card__next-value\">{nextMessage}</span>\n              </div>\n              <div className=\"orders-card__stages\">\n                {STAGES.map((stage, index) => (\n                  <div\n                    key={stage}\n                    className={cn('orders-card__stage', index <= stageIndex(order.status) && 'is-active')}\n                  >\n                    <span className=\"orders-card__stage-index\">{index + 1}</span>\n                    <span className=\"orders-card__stage-text\">{stage}</span>\n                  </div>\n                ))}\n              </div>\n              <div className=\"orders-card__actions\">\n                {isInGracePeriod ? (\n                  <>\n                    <div className=\"orders-card__grace-period-notice\" style={{\n                      padding: '8px 12px',\n                      marginBottom: '8px',\n                      backgroundColor: '#FEF3C7',\n                      border: '1px solid #FCD34D',\n                      borderRadius: '8px',\n                      fontSize: '12px',\n                      color: '#92400E'\n                    }}>\n                      â° Grace Period: {timeRemaining} minutes remaining. Confirm or escalate now.\n                    </div>\n                    <button\n                      type=\"button\"\n                      className=\"orders-card__action is-primary\"\n                      onClick={() => openPanel('confirm-acceptance', { orderId: order.id })}\n                    >\n                      Confirm Acceptance\n                    </button>\n                    <button\n                      type=\"button\"\n                      className=\"orders-card__action is-secondary\"\n                      onClick={() => openPanel('cancel-acceptance', { orderId: order.id })}\n                    >\n                      Cancel & Escalate\n                    </button>\n                  </>\n                ) : (\n                  <>\n                    {isInStatusUpdateGracePeriod && (\n                      <div className=\"orders-card__grace-period-notice\" style={{\n                        padding: '8px 12px',\n                        marginBottom: '8px',\n                        backgroundColor: '#DBEAFE',\n                        border: '1px solid #93C5FD',\n                        borderRadius: '8px',\n                        fontSize: '12px',\n                        color: '#1E40AF'\n                      }}>\n                        â° Status Update Grace Period: {statusUpdateTimeRemaining} minutes remaining. You can revert to \"{previousStatus}\" status.\n                      </div>\n                    )}\n                    {/* Show update status button once acceptance is finalized - Hide for escalated orders */}\n                    {canShowStatusUpdate && !isEscalated && (\n                      <button\n                        type=\"button\"\n                        className=\"orders-card__action is-primary\"\n                        onClick={() =>\n                          openPanel('update-order-status', {\n                            orderId: order.id,\n                            status: normalizedStatus,\n                          })\n                        }\n                      >\n                        Update status\n                      </button>\n                    )}\n                    {/* Show revert button during grace period - Hide for escalated orders */}\n                    {!workflowCompleted && isInStatusUpdateGracePeriod && previousStatus && !isEscalated && (\n                      <button\n                        type=\"button\"\n                        className=\"orders-card__action is-secondary\"\n                        onClick={() =>\n                          openPanel('update-order-status', {\n                            orderId: order.id,\n                            status: previousStatus,\n                            revert: true,\n                          })\n                        }\n                      >\n                        Revert to {previousStatus}\n                      </button>\n                    )}\n                    {(normalizedStatus === 'fully_paid' || (!isPartialPayment && paymentCompleted && normalizedStatus === 'delivered')) && (\n                      <div className=\"orders-card__action is-success\" style={{\n                        padding: '8px 16px',\n                        borderRadius: '8px',\n                        backgroundColor: '#D1FAE5',\n                        color: '#065F46',\n                        fontWeight: '600',\n                        fontSize: '14px',\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px'\n                      }}>\n                        âœ“ Paid\n                      </div>\n                    )}\n                    {showAvailabilityActions && (\n                      <>\n                        <button\n                          type=\"button\"\n                          className=\"orders-card__action is-primary\"\n                          onClick={() => openPanel('order-available', { orderId: order.id })}\n                        >\n                          Accept Order\n                        </button>\n                        <button\n                          type=\"button\"\n                          className=\"orders-card__action is-secondary\"\n                          onClick={async () => {\n                            const details = await getOrderDetails(order.id)\n                            if (details.data?.order) {\n                              onOpenEscalationModal?.(details.data.order)\n                            }\n                          }}\n                        >\n                          Escalate All\n                        </button>\n                        <button\n                          type=\"button\"\n                          className=\"orders-card__action is-secondary\"\n                          onClick={async () => {\n                            const details = await getOrderDetails(order.id)\n                            if (details.data?.order) {\n                              onOpenPartialEscalationModal?.(details.data.order, 'items')\n                            }\n                          }}\n                        >\n                          Partial Items\n                        </button>\n                        <button\n                          type=\"button\"\n                          className=\"orders-card__action is-secondary\"\n                          onClick={async () => {\n                            const details = await getOrderDetails(order.id)\n                            if (details.data?.order) {\n                              onOpenPartialEscalationModal?.(details.data.order, 'quantities')\n                            }\n                          }}\n                        >\n                          Partial Qty\n                        </button>\n                      </>\n                    )}\n                  </>\n                )}\n              </div>\n              {/* View Details Button */}\n              <div style={{ padding: '0 16px 12px', borderTop: '1px solid #E5E7EB', marginTop: '12px', paddingTop: '12px' }}>\n                <button\n                  type=\"button\"\n                  className=\"orders-card__action is-secondary\"\n                  style={{ width: '100%', justifyContent: 'center' }}\n                  onClick={async () => {\n                    const details = await getOrderDetails(order.id)\n                    if (details.data?.order) {\n                      onViewOrderDetails?.(details.data.order)\n                    }\n                  }}\n                >\n                  View Details\n                </button>\n              </div>\n            </article>\n          )\n        }) : (\n          <div className=\"orders-card\">\n            <div className=\"orders-card__details\">\n              <p className=\"text-sm text-gray-500 text-center py-4\">No orders found</p>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nfunction OrderDetailsView({ order: initialOrder, openPanel, onBack, onOpenEscalationModal, onOpenPartialEscalationModal, onOrderUpdated }) {\n  const { getOrderDetails, updateOrderStatus } = useVendorApi()\n  const { success, error } = useToast()\n  const [order, setOrder] = useState(initialOrder)\n  const [isLoading, setIsLoading] = useState(false)\n  const lastRefreshedStatusRef = useRef(initialOrder?.status)\n\n  // Refresh order details\n  const refreshOrder = useCallback(async () => {\n    const orderId = initialOrder?.id || initialOrder?._id || order?.id || order?._id\n    if (!orderId) return\n\n    setIsLoading(true)\n    try {\n      const result = await getOrderDetails(orderId)\n      if (result.data?.order) {\n        setOrder(result.data.order)\n        lastRefreshedStatusRef.current = result.data.order.status\n        onOrderUpdated?.()\n      }\n    } catch (error) {\n      console.error('Error refreshing order:', error)\n    } finally {\n      setIsLoading(false)\n    }\n  }, [initialOrder?.id, initialOrder?._id, order?.id, order?._id, getOrderDetails, onOrderUpdated])\n\n  useEffect(() => {\n    if (initialOrder) {\n      const currentStatus = initialOrder.status\n      const previousRefreshedStatus = lastRefreshedStatusRef.current\n\n      // Update local state with initialOrder\n      setOrder(initialOrder)\n\n      // Refresh if status changed (only refresh once per status change)\n      if (currentStatus !== previousRefreshedStatus) {\n        refreshOrder()\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [initialOrder?.id, initialOrder?._id, initialOrder?.status]) // Refresh when order ID or status changes\n\n  const normalizeStatus = (status) => {\n    if (!status) return 'awaiting'\n    const normalized = status.toLowerCase()\n    if (normalized === 'fully_paid') return 'fully_paid'\n    if (normalized === 'delivered') return 'delivered'\n    if (normalized === 'out_for_delivery' || normalized === 'ready_for_delivery') return 'dispatched'\n    if (normalized === 'accepted' || normalized === 'processing') return 'accepted'\n    if (normalized === 'awaiting' || normalized === 'pending') return 'awaiting'\n    if (normalized.includes('deliver')) return 'delivered'\n    if (normalized.includes('dispatch')) return 'dispatched'\n    return 'awaiting'\n  }\n\n  const stageIndex = (status) => {\n    const key = normalizeStatus(status)\n    if (key === 'fully_paid' || key === 'delivered') return 3\n    if (key === 'dispatched') return 2\n    if (key === 'accepted') return 1\n    return 0\n  }\n\n  const STATUS_FLOW = ['awaiting', 'accepted', 'dispatched', 'delivered', 'fully_paid']\n  const STAGES = ['Awaiting', 'Accepted', 'Dispatched', 'Delivered']\n\n  const normalizedStatus = normalizeStatus(order?.status)\n  const isInGracePeriod = order?.acceptanceGracePeriod?.isActive\n  const gracePeriodExpiresAt = order?.acceptanceGracePeriod?.expiresAt\n  const timeRemaining = gracePeriodExpiresAt ? Math.max(0, Math.floor((new Date(gracePeriodExpiresAt) - new Date()) / 1000 / 60)) : 0\n  const isInStatusUpdateGracePeriod = order?.statusUpdateGracePeriod?.isActive\n  const statusUpdateGracePeriodExpiresAt = order?.statusUpdateGracePeriod?.expiresAt\n  const statusUpdateTimeRemaining = statusUpdateGracePeriodExpiresAt ? Math.max(0, Math.floor((new Date(statusUpdateGracePeriodExpiresAt) - new Date()) / 1000 / 60)) : 0\n  const previousStatus = order?.statusUpdateGracePeriod?.previousStatus\n  const isPartialPayment = order?.paymentPreference !== 'full'\n  const paymentStatus = order?.paymentStatus || 'pending'\n  const paymentCompleted = paymentStatus === 'fully_paid'\n  // Check if order is escalated\n  const isEscalated = order?.assignedTo === 'admin' ||\n    order?.escalation?.isEscalated === true ||\n    order?.status === 'rejected'\n  const showAvailabilityActions = normalizedStatus === 'awaiting' && !isInGracePeriod && !isEscalated\n  const workflowCompleted = isPartialPayment ? normalizedStatus === 'fully_paid' : normalizedStatus === 'delivered'\n  const isApproved = normalizedStatus !== 'awaiting'\n  const canShowStatusUpdate = isApproved && !workflowCompleted && !isInStatusUpdateGracePeriod && !isInGracePeriod && !isEscalated\n\n  if (isLoading) {\n    return (\n      <div className=\"orders-view\">\n        <div className=\"overview-section__header\">\n          <button type=\"button\" className=\"orders-section__cta\" onClick={onBack}>\n            â† Back\n          </button>\n          <h3 className=\"overview-section__title\">Order Details</h3>\n        </div>\n        <div className=\"orders-card\">\n          <div className=\"orders-card__details\">\n            <p className=\"text-sm text-gray-500 text-center py-4\">Loading order details...</p>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"orders-view space-y-6\">\n      {/* Header */}\n      <div className=\"overview-section__header\">\n        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\n          <button type=\"button\" className=\"orders-section__cta\" onClick={onBack}>\n            â† Back\n          </button>\n          <h3 className=\"overview-section__title\">Order Details</h3>\n        </div>\n      </div>\n\n      {/* Order Information Card */}\n      <div className=\"orders-card\">\n        <header className=\"orders-card__header\">\n          <div className=\"orders-card__identity\">\n            <span className=\"orders-card__icon\">\n              <TruckIcon className=\"h-5 w-5\" />\n            </span>\n            <div className=\"orders-card__details\">\n              <p className=\"orders-card__name\">Order #{order?.orderNumber || order?.id}</p>\n              <p className=\"orders-card__value\">â‚¹{(order?.totalAmount || 0).toLocaleString('en-IN')}</p>\n            </div>\n          </div>\n          <div className=\"orders-card__status\">\n            <span className={cn(\n              'orders-card__payment',\n              order?.paymentStatus === 'fully_paid' && 'is-paid'\n            )}>\n              {order?.paymentStatus === 'fully_paid' ? 'Paid' : order?.paymentStatus === 'partial_paid' ? 'Partial' : 'Pending'}\n            </span>\n            <span className=\"orders-card__stage-label\" style={\n              normalizedStatus === 'delivered' && isPartialPayment && !paymentCompleted\n                ? { display: 'flex', flexDirection: 'column', gap: '2px' }\n                : normalizedStatus === 'fully_paid'\n                  ? { display: 'flex', flexDirection: 'column', gap: '2px' }\n                  : isEscalated\n                    ? { display: 'flex', flexDirection: 'column', gap: '2px', alignItems: 'flex-start' }\n                    : {}\n            }>\n              {normalizedStatus === 'awaiting'\n                ? 'Awaiting'\n                : normalizedStatus === 'accepted'\n                  ? 'Accepted'\n                  : normalizedStatus === 'dispatched'\n                    ? 'Dispatched'\n                    : normalizedStatus === 'delivered'\n                      ? (isPartialPayment && !paymentCompleted ? (\n                        <>\n                          <span>Delivered</span>\n                          <span>Awaiting Payment</span>\n                        </>\n                      ) : 'Delivered')\n                      : normalizedStatus === 'fully_paid'\n                        ? (\n                          <>\n                            <span>Delivered</span>\n                            <span>Paid</span>\n                          </>\n                        )\n                        : order?.status}\n              {isEscalated && (\n                <span style={{\n                  padding: '2px 8px',\n                  backgroundColor: '#FEF3C7',\n                  color: '#92400E',\n                  borderRadius: '4px',\n                  fontSize: '11px',\n                  fontWeight: '600',\n                  textTransform: 'uppercase'\n                }}>\n                  Escalated\n                </span>\n              )}\n            </span>\n          </div>\n        </header>\n\n        {/* Customer Information */}\n        <div style={{ padding: '16px', borderTop: '1px solid #E5E7EB' }}>\n          <h4 style={{ fontSize: '14px', fontWeight: '600', marginBottom: '12px', color: '#1F2937' }}>Customer Information</h4>\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '8px', fontSize: '14px', color: '#4B5563' }}>\n            <p><strong>Name:</strong> {order?.userId?.name || order?.farmer || 'Unknown Customer'}</p>\n            <p><strong>Contact:</strong> {order?.userId?.phone || order?.customerPhone || 'N/A'}</p>\n            {order?.deliveryAddress && (\n              <>\n                <p><strong>Address:</strong> {order.deliveryAddress.address || 'N/A'}</p>\n                <p><strong>City:</strong> {order.deliveryAddress.city || 'N/A'}, {order.deliveryAddress.state || 'N/A'} - {order.deliveryAddress.pincode || 'N/A'}</p>\n              </>\n            )}\n          </div>\n        </div>\n\n        {/* Order Items */}\n        {order?.items && order.items.length > 0 && (\n          <div style={{ padding: '16px', borderTop: '1px solid #E5E7EB' }}>\n            <h4 style={{ fontSize: '14px', fontWeight: '600', marginBottom: '12px', color: '#1F2937' }}>Order Items</h4>\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n              {order.items.map((item, index) => (\n                <div key={index} style={{\n                  padding: '12px',\n                  backgroundColor: '#F9FAFB',\n                  borderRadius: '8px',\n                  fontSize: '14px'\n                }}>\n                  <p style={{ fontWeight: '600', marginBottom: '4px' }}>{item.productName || 'Product'}</p>\n                  <p style={{ color: '#6B7280' }}>Quantity: {item.quantity} Ã— â‚¹{item.unitPrice?.toLocaleString('en-IN')} = â‚¹{item.totalPrice?.toLocaleString('en-IN')}</p>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Order Stages */}\n        <div className=\"orders-card__stages\" style={{ padding: '16px', borderTop: '1px solid #E5E7EB' }}>\n          {STAGES.map((stage, index) => (\n            <div\n              key={stage}\n              className={cn('orders-card__stage', index <= stageIndex(order?.status) && 'is-active')}\n            >\n              <span className=\"orders-card__stage-index\">{index + 1}</span>\n              <span className=\"orders-card__stage-text\">{stage}</span>\n            </div>\n          ))}\n        </div>\n\n        {/* Actions Section */}\n        <div className=\"orders-card__actions\" style={{ padding: '16px', borderTop: '1px solid #E5E7EB', display: 'flex', flexDirection: 'column', gap: '8px' }}>\n          {/* Grace Period Notices */}\n          {isInGracePeriod && (\n            <div className=\"orders-card__grace-period-notice\" style={{\n              padding: '8px 12px',\n              marginBottom: '8px',\n              backgroundColor: '#FEF3C7',\n              border: '1px solid #FCD34D',\n              borderRadius: '8px',\n              fontSize: '12px',\n              color: '#92400E'\n            }}>\n              â° Grace Period: {timeRemaining} minutes remaining. Confirm or escalate now.\n            </div>\n          )}\n          {isInStatusUpdateGracePeriod && (\n            <div className=\"orders-card__grace-period-notice\" style={{\n              padding: '8px 12px',\n              marginBottom: '8px',\n              backgroundColor: '#DBEAFE',\n              border: '1px solid #93C5FD',\n              borderRadius: '8px',\n              fontSize: '12px',\n              color: '#1E40AF'\n            }}>\n              â° Status Update Grace Period: {statusUpdateTimeRemaining} minutes remaining. You can revert to \"{previousStatus}\" status.\n            </div>\n          )}\n\n          {/* Approve Button (for pending orders) */}\n          {showAvailabilityActions && !isInGracePeriod && (\n            <button\n              type=\"button\"\n              className=\"orders-card__action is-primary\"\n              onClick={() => openPanel('order-available', { orderId: order.id || order._id })}\n            >\n              Accept Order\n            </button>\n          )}\n\n          {/* Update Status Button (after approved) - Hide for escalated orders */}\n          {canShowStatusUpdate && !isEscalated && (\n            <button\n              type=\"button\"\n              className=\"orders-card__action is-primary\"\n              onClick={() =>\n                openPanel('update-order-status', {\n                  orderId: order.id || order._id,\n                  status: normalizedStatus,\n                })\n              }\n            >\n              Update Status\n            </button>\n          )}\n\n          {/* Confirm Status Update and Revert Buttons (during grace period) - Hide for escalated orders */}\n          {!workflowCompleted && isInStatusUpdateGracePeriod && !isEscalated && (\n            <>\n              <button\n                type=\"button\"\n                className=\"orders-card__action is-primary\"\n                onClick={async () => {\n                  const orderId = order.id || order._id\n                  if (!orderId) return\n\n                  const result = await updateOrderStatus(orderId, { finalizeGracePeriod: true })\n                  if (result.data) {\n                    success(result.data.message || 'Status update confirmed successfully!')\n                    // Refresh order details\n                    refreshOrder()\n                  } else if (result.error) {\n                    error(result.error.message || 'Failed to confirm status update')\n                  }\n                }}\n              >\n                Confirm Status Update\n              </button>\n              {previousStatus && (\n                <button\n                  type=\"button\"\n                  className=\"orders-card__action is-secondary\"\n                  onClick={() =>\n                    openPanel('update-order-status', {\n                      orderId: order.id || order._id,\n                      status: previousStatus,\n                      revert: true,\n                    })\n                  }\n                >\n                  Revert to {previousStatus}\n                </button>\n              )}\n            </>\n          )}\n\n          {/* Escalation Buttons */}\n          {showAvailabilityActions && (\n            <>\n              <button\n                type=\"button\"\n                className=\"orders-card__action is-secondary\"\n                onClick={() => {\n                  onOpenEscalationModal?.(order)\n                }}\n              >\n                Escalate All\n              </button>\n              <button\n                type=\"button\"\n                className=\"orders-card__action is-secondary\"\n                onClick={() => {\n                  onOpenPartialEscalationModal?.(order, 'items')\n                }}\n              >\n                Partial Items\n              </button>\n              <button\n                type=\"button\"\n                className=\"orders-card__action is-secondary\"\n                onClick={() => {\n                  onOpenPartialEscalationModal?.(order, 'quantities')\n                }}\n              >\n                Partial Qty\n              </button>\n            </>\n          )}\n\n          {/* Grace Period Actions */}\n          {isInGracePeriod && (\n            <>\n              <button\n                type=\"button\"\n                className=\"orders-card__action is-primary\"\n                onClick={() => openPanel('confirm-acceptance', { orderId: order.id || order._id })}\n              >\n                Confirm Acceptance\n              </button>\n              <button\n                type=\"button\"\n                className=\"orders-card__action is-secondary\"\n                onClick={() => openPanel('cancel-acceptance', { orderId: order.id || order._id })}\n              >\n                Cancel & Escalate\n              </button>\n            </>\n          )}\n\n          {/* Paid Badge */}\n          {(normalizedStatus === 'fully_paid' || (!isPartialPayment && paymentCompleted && normalizedStatus === 'delivered')) && (\n            <div className=\"orders-card__action is-success\" style={{\n              padding: '8px 16px',\n              borderRadius: '8px',\n              backgroundColor: '#D1FAE5',\n              color: '#065F46',\n              fontWeight: '600',\n              fontSize: '14px',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              gap: '6px'\n            }}>\n              âœ“ Paid\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction CreditView({ openPanel }) {\n  const { dashboard } = useVendorState()\n  const dispatch = useVendorDispatch()\n  const { getCreditInfo, getRepaymentHistory } = useVendorApi()\n  const [repaymentHistory, setRepaymentHistory] = useState([])\n  const [repaymentRefreshKey, setRepaymentRefreshKey] = useState(0)\n\n  // Refresh repayment history function\n  const refreshRepaymentHistory = useCallback(() => {\n    getRepaymentHistory({ page: 1, limit: 10 }).then((result) => {\n      if (result.data?.repayments) {\n        setRepaymentHistory(result.data.repayments)\n      }\n    })\n  }, [getRepaymentHistory])\n\n  useEffect(() => {\n    getCreditInfo().then((result) => {\n      if (result.data) {\n        dispatch({ type: 'SET_CREDIT_DATA', payload: result.data })\n      }\n    })\n\n    // Fetch repayment history\n    refreshRepaymentHistory()\n  }, [getCreditInfo, refreshRepaymentHistory, dispatch, repaymentRefreshKey])\n\n  // Listen for repayment success event to refresh history\n  useEffect(() => {\n    const handleRepaymentSuccess = () => {\n      setRepaymentRefreshKey(prev => prev + 1)\n    }\n\n    window.addEventListener('repayment-success', handleRepaymentSuccess)\n    return () => {\n      window.removeEventListener('repayment-success', handleRepaymentSuccess)\n    }\n  }, [])\n\n  // Use real credit data from backend\n  // Backend getCreditInfo returns: { credit: { used, totalUnpaid, unpaidCount, dueDate, repaymentDays, penaltyRate }, status: { isOverdue, daysOverdue, daysUntilDue, penalty, status, hasUnpaidCredits } }\n  // Dashboard overview also includes credit info\n  const creditData = dashboard.credit || {}\n  const creditInfo = creditData.credit || {}\n  const creditStatus = creditData.status || {}\n\n  const creditUsed = creditInfo.used || dashboard.overview?.credit?.used || 0\n  const penalty = creditStatus.penalty || dashboard.overview?.credit?.penalty || 0\n\n  // Calculate total repaid from repayment history\n  const totalRepaid = repaymentHistory\n    .filter(r => r.status === 'completed')\n    .reduce((sum, r) => sum + (r.amount || 0), 0)\n\n  // Get last repayment date\n  const lastRepayment = repaymentHistory\n    .filter(r => r.status === 'completed')\n    .sort((a, b) => {\n      const dateA = new Date(a.paidAt || a.transactionDate || a.createdAt || 0)\n      const dateB = new Date(b.paidAt || b.transactionDate || b.createdAt || 0)\n      return dateB - dateA\n    })[0]\n\n  // Calculate repayment count\n  const repaymentCount = repaymentHistory.filter(r => r.status === 'completed').length\n\n  // Format currency helper\n  const formatCurrency = (amount) => {\n    if (amount === 0) return 'â‚¹0'\n    if (amount >= 100000) return `â‚¹${(amount / 100000).toFixed(1)}L`\n    return `â‚¹${Math.round(amount).toLocaleString('en-IN')}`\n  }\n\n  const credit = {\n    outstanding: creditUsed > 0 ? formatCurrency(creditUsed) : 'â‚¹0',\n    repaid: totalRepaid > 0 ? formatCurrency(totalRepaid) : 'â‚¹0',\n    penalty: penalty === 0 ? 'No penalty' : `â‚¹${penalty.toLocaleString('en-IN')}`,\n    due: creditInfo.dueDate || dashboard.overview?.credit?.dueDate ? new Date(creditInfo.dueDate || dashboard.overview?.credit?.dueDate).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }) : 'Not set',\n    lastRepaymentDate: lastRepayment ? new Date(lastRepayment.paidAt || lastRepayment.transactionDate || lastRepayment.createdAt).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }) : 'Never',\n  }\n\n  const creditMetrics = [\n    { label: 'Outstanding Credit', value: credit.outstanding, icon: CreditIcon, tone: 'success' },\n    { label: totalRepaid > 0 ? 'Total Repaid' : 'To Repay', value: totalRepaid > 0 ? credit.repaid : credit.outstanding, icon: WalletIcon, tone: 'success' },\n    { label: repaymentCount > 0 ? 'Last Repayment' : 'Due Date', value: repaymentCount > 0 ? credit.lastRepaymentDate : credit.due, icon: repaymentCount > 0 ? WalletIcon : ReportIcon, tone: repaymentCount > 0 ? 'success' : 'teal' },\n  ]\n\n  // Get penalty rate for display\n  const penaltyRate = creditInfo.penaltyRate || creditStatus.penaltyRate || dashboard?.overview?.credit?.penaltyRate || 2\n\n  const penaltyTimeline = [\n    {\n      period: 'Days 0-5',\n      title: 'Grace Period',\n      description: 'No penalties applied. Automated reminders will be sent.',\n      tone: 'success'\n    },\n    {\n      period: 'Days 6-10',\n      title: 'Penalty Period',\n      description: `${penaltyRate}% daily penalty applied. Finance team notified.`,\n      tone: 'warn'\n    },\n    {\n      period: 'Days 11+',\n      title: 'Restrictions Active',\n      description: 'New credit orders blocked. Daily penalties continue until repayment.',\n      tone: 'critical'\n    },\n  ]\n\n  return (\n    <div className=\"credit-view space-y-6\">\n\n      <section id=\"credit-status\" className=\"credit-status-section\">\n        <div className=\"credit-status-card\">\n          <div className=\"credit-status-card__main\">\n            <div className=\"credit-status-card__details\">\n              <div className=\"credit-status-card__amount\">\n                <span className=\"credit-status-card__amount-value\">{credit.outstanding}</span>\n                <span className=\"credit-status-card__amount-label\">Outstanding Credit</span>\n              </div>\n              <div className=\"credit-status-card__quick-info\">\n                <div className=\"credit-status-card__info-item\">\n                  <span className=\"credit-status-card__info-label\">To Repay</span>\n                  <span className=\"credit-status-card__info-value\">{credit.outstanding}</span>\n                </div>\n                {totalRepaid > 0 && (\n                  <div className=\"credit-status-card__info-item\">\n                    <span className=\"credit-status-card__info-label\">Total Repaid</span>\n                    <span className=\"credit-status-card__info-value\">{credit.repaid}</span>\n                  </div>\n                )}\n                {repaymentCount > 0 && (\n                  <div className=\"credit-status-card__info-item\">\n                    <span className=\"credit-status-card__info-label\">Repayments</span>\n                    <span className=\"credit-status-card__info-value\">{repaymentCount}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n          <div className=\"credit-status-card__footer\">\n            <div className=\"credit-status-card__status-badge\">\n              <span className=\"credit-status-card__status-text\">{credit.penalty === 'No penalty' ? 'No fine' : credit.penalty}</span>\n            </div>\n            <button type=\"button\" className=\"credit-status-card__action\" onClick={() => openPanel('view-details')}>\n              View Details\n            </button>\n          </div>\n        </div>\n      </section>\n\n      <section id=\"credit-summary\" className=\"credit-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Credit Summary</h3>\n          </div>\n        </div>\n        <div className=\"credit-metric-grid\">\n          {creditMetrics.map((metric) => {\n            const Icon = metric.icon\n            return (\n              <div key={metric.label} className=\"credit-metric-card\">\n                <span className={cn('credit-metric-icon', metric.tone === 'warn' ? 'is-warn' : metric.tone === 'teal' ? 'is-teal' : 'is-success')}>\n                  <Icon className=\"h-4 w-4\" />\n                </span>\n                <div className=\"credit-metric-body\">\n                  <p>{metric.label}</p>\n                  <span>{metric.value}</span>\n                </div>\n              </div>\n            )\n          })}\n        </div>\n      </section>\n\n      <section id=\"credit-actions\" className=\"credit-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Credit management</h3>\n          </div>\n        </div>\n        <div className=\"credit-action-grid\">\n          {creditUsed > 0 && (\n            <div className=\"credit-action-card\">\n              <header>\n                <span className=\"credit-action-card__icon\">\n                  <CreditIcon className=\"h-5 w-5\" />\n                </span>\n                <h4 className=\"credit-action-card__title\">Repay Credit</h4>\n              </header>\n              <p className=\"credit-action-card__body\">\n                Repay your outstanding credit to avoid penalties. Ensure you have added bank account details before proceeding.\n              </p>\n              <button\n                type=\"button\"\n                className=\"credit-action-card__cta\"\n                onClick={async () => {\n                  // Refresh credit info to get latest creditUsed value\n                  const latestCreditResult = await getCreditInfo()\n                  const latestCreditUsed = latestCreditResult.data?.credit?.used || creditUsed\n\n                  openPanel('repay-credit', {\n                    creditUsed: latestCreditUsed,\n                  })\n                }}\n              >\n                Repay Now\n              </button>\n            </div>\n          )}\n        </div>\n      </section>\n\n      <section id=\"credit-penalty\" className=\"credit-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Fine timeline</h3>\n          </div>\n        </div>\n        <div className=\"credit-timeline\">\n          {penaltyTimeline.map((item) => (\n            <div\n              key={item.period}\n              className={cn(\n                'credit-timeline-item',\n                item.tone === 'critical' ? 'is-critical' : item.tone === 'warn' ? 'is-warn' : 'is-success',\n              )}\n            >\n              <div className=\"credit-timeline-item__marker\" />\n              <div className=\"credit-timeline-item__content\">\n                <span className=\"credit-timeline-item__period\">{item.period}</span>\n                {item.title && <h5 className=\"credit-timeline-item__title\" style={{ fontSize: '0.875rem', fontWeight: '600', marginTop: '0.25rem', marginBottom: '0.25rem' }}>{item.title}</h5>}\n                <p className=\"credit-timeline-item__description\">{item.description}</p>\n              </div>\n            </div>\n          ))}\n        </div>\n      </section>\n\n      {/* Recent Repayments Section */}\n      {repaymentHistory.length > 0 && (\n        <section id=\"credit-repayments\" className=\"credit-section\">\n          <div className=\"overview-section__header\">\n            <div>\n              <h3 className=\"overview-section__title\">Recent repayments</h3>\n            </div>\n          </div>\n          <div className=\"overview-activity__list\">\n            {repaymentHistory.slice(0, 5).map((repayment) => {\n              const repaymentDate = repayment.paidAt || repayment.createdAt || repayment.transactionDate\n              const formattedDate = repaymentDate\n                ? new Date(repaymentDate).toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' })\n                : 'N/A'\n\n              return (\n                <div key={repayment.id || repayment._id} className=\"overview-activity__item\">\n                  <div className=\"overview-activity__avatar\">RP</div>\n                  <div className=\"overview-activity__details\">\n                    <div className=\"overview-activity__row\">\n                      <span className=\"overview-activity__name\">\n                        {repayment.repaymentId || `Repayment #${(repayment.id || repayment._id).toString().slice(-6)}`}\n                      </span>\n                      <span className=\"overview-activity__amount is-positive\">\n                        -â‚¹{(repayment.amount || 0).toLocaleString('en-IN')}\n                      </span>\n                    </div>\n                    <div className=\"overview-activity__meta\">\n                      <span>\n                        {repayment.status === 'completed' ? 'Completed' : repayment.status === 'pending' ? 'Pending' : repayment.status}\n                      </span>\n                      <span>{formattedDate}</span>\n                      {repayment.penaltyAmount > 0 && (\n                        <span className=\"text-xs text-red-600\">\n                          (Penalty: â‚¹{repayment.penaltyAmount.toLocaleString('en-IN')})\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </section>\n      )}\n    </div>\n  )\n}\n\nfunction ReportsView({ onNavigate }) {\n  const { dashboard } = useVendorState()\n  const dispatch = useVendorDispatch()\n  const { getReports, getEarningsSummary } = useVendorApi()\n\n  const [activeTab, setActiveTab] = useState('revenue')\n  const [timePeriod, setTimePeriod] = useState('week')\n  const [earningsSummary, setEarningsSummary] = useState(null)\n\n  useEffect(() => {\n    // Convert timePeriod to days for backend\n    const periodMap = {\n      'week': '7',\n      'month': '30',\n      'year': '365',\n      'all': '3650', // ~10 years for \"all time\"\n    }\n    const periodDays = periodMap[timePeriod] || '30'\n\n    // Fetch both reports and earnings summary\n    Promise.all([\n      getReports({ period: periodDays }),\n      getEarningsSummary(),\n    ]).then(([reportsResult, earningsResult]) => {\n      if (reportsResult.data) {\n        dispatch({ type: 'SET_REPORTS_DATA', payload: reportsResult.data })\n      }\n      if (earningsResult.data) {\n        setEarningsSummary(earningsResult.data)\n      }\n    })\n  }, [getReports, getEarningsSummary, dispatch, timePeriod])\n  // Remove static topVendors - this is vendor-specific data, not needed here\n  // If needed in future, can be fetched from backend analytics\n\n  const reportIcons = [ChartIcon, WalletIcon, CreditIcon, HomeIcon]\n\n  const tabs = [\n    { id: 'revenue', label: 'Earnings Summary' },\n    { id: 'performance', label: 'Performance' },\n    { id: 'trends', label: 'Trends' },\n    { id: 'insights', label: 'Tips' },\n  ]\n\n  const timePeriods = [\n    { id: 'week', label: '1 Week' },\n    { id: 'month', label: '1 Month' },\n    { id: 'year', label: '1 Year' },\n    { id: 'all', label: 'All Time' },\n  ]\n\n  // Get reports data from state\n  const reportsData = dashboard?.reports || null\n\n  // Transform backend reports data to chart format\n  const getRevenueData = (period) => {\n    // Use real data from backend if available\n    // Backend returns orders.breakdown grouped by status, we can use that for trends\n    if (reportsData?.orders?.breakdown && Array.isArray(reportsData.orders.breakdown)) {\n      const breakdown = reportsData.orders.breakdown\n      return {\n        labels: breakdown.map((_, index) => {\n          // Generate labels based on period\n          if (period === 'week') {\n            const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\n            return days[index % 7] || `Day ${index + 1}`\n          }\n          if (period === 'month') return `Week ${index + 1}`\n          if (period === 'year') return `Q${index + 1}`\n          return `Period ${index + 1}`\n        }),\n        revenue: breakdown.map(b => (b.totalAmount || 0) / 100000), // Convert to Lakhs\n        orders: breakdown.map(b => b.count || 0),\n      }\n    }\n\n    // Fallback to empty data if no backend data\n    return {\n      labels: [],\n      revenue: [],\n      orders: [],\n    }\n  }\n\n  const chartData = getRevenueData(timePeriod)\n\n  // Get revenue data from backend (backend returns 'revenue', not 'sales')\n  const revenueData = reportsData?.revenue || {}\n  // Use earnings summary for total earnings (vendor earnings), fallback to revenue if not available\n  const totalEarnings = earningsSummary?.totalEarnings || 0\n  const orderCount = revenueData.orderCount || 0\n  const averageOrderValue = revenueData.averageOrderValue || 0\n  const maxValue = Math.max(...chartData.revenue, ...chartData.orders)\n  const yAxisSteps = 5\n  const yAxisLabels = Array.from({ length: yAxisSteps + 1 }, (_, i) => {\n    const value = (maxValue / yAxisSteps) * (yAxisSteps - i)\n    return value >= 1000 ? `${(value / 1000).toFixed(1)}k` : value.toFixed(0)\n  })\n\n  return (\n    <div className=\"reports-view space-y-6\">\n\n      <section id=\"reports-summary\" className=\"reports-summary-section\">\n        <div className=\"reports-summary-card\">\n          <div className=\"reports-summary-card__content\">\n            <div className=\"reports-summary-card__main\">\n              <div className=\"reports-summary-card__icon\">\n                <ChartIcon className=\"h-6 w-6\" />\n              </div>\n              <div className=\"reports-summary-card__stats\">\n                <div className=\"reports-summary-card__stat\">\n                  <span className=\"reports-summary-card__stat-label\">Total Earnings</span>\n                  <span className=\"reports-summary-card__stat-value\">\n                    {totalEarnings >= 100000\n                      ? `â‚¹${(totalEarnings / 100000).toFixed(1)}L`\n                      : totalEarnings > 0\n                        ? `â‚¹${Math.round(totalEarnings).toLocaleString('en-IN')}`\n                        : 'â‚¹0'}\n                  </span>\n                </div>\n                <div className=\"reports-summary-card__stat\">\n                  <span className=\"reports-summary-card__stat-label\">Total Orders</span>\n                  <span className=\"reports-summary-card__stat-value\">{orderCount}</span>\n                </div>\n              </div>\n            </div>\n            <div className=\"reports-summary-card__insights\">\n              {orderCount > 0 && (\n                <div className=\"reports-summary-card__insight\">\n                  <span className=\"reports-summary-card__insight-icon\">âš¡</span>\n                  <span className=\"reports-summary-card__insight-text\">{orderCount} orders completed this {timePeriod}</span>\n                </div>\n              )}\n              {averageOrderValue > 0 && (\n                <div className=\"reports-summary-card__insight\">\n                  <span className=\"reports-summary-card__insight-icon\">ðŸ“ˆ</span>\n                  <span className=\"reports-summary-card__insight-text\">Average order value: â‚¹{averageOrderValue.toLocaleString('en-IN')}</span>\n                </div>\n              )}\n              {orderCount === 0 && (\n                <div className=\"reports-summary-card__insight\">\n                  <span className=\"reports-summary-card__insight-icon\">â„¹ï¸</span>\n                  <span className=\"reports-summary-card__insight-text\">No orders data available for this period</span>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <section id=\"reports-metrics\" className=\"reports-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Performance metrics</h3>\n          </div>\n        </div>\n        <div className=\"reports-metric-grid\">\n          {[\n            { label: 'Avg Order Value', value: averageOrderValue > 0 ? `â‚¹${averageOrderValue.toLocaleString('en-IN')}` : 'â‚¹0', meta: 'Per order', icon: WalletIcon },\n            { label: 'Orders Completed', value: String(orderCount), meta: 'Delivered orders', icon: CreditIcon },\n            { label: 'Performance', value: orderCount > 0 ? 'Active' : 'No activity', meta: 'This period', icon: HomeIcon },\n          ].map((metric, index) => {\n            const Icon = metric.icon || reportIcons[index % reportIcons.length]\n            return (\n              <div key={metric.label} className=\"reports-metric-card\">\n                <span className=\"reports-metric-icon\">\n                  <Icon className=\"h-4 w-4\" />\n                </span>\n                <div className=\"reports-metric-body\">\n                  <p>{metric.label}</p>\n                  <span>{metric.value}</span>\n                  <small>{metric.meta}</small>\n                </div>\n              </div>\n            )\n          })}\n        </div>\n      </section>\n\n      <section id=\"reports-analytics\" className=\"reports-tab-section\">\n        <div className=\"reports-tab-header\">\n          {tabs.map((tab) => (\n            <button\n              key={tab.id}\n              type=\"button\"\n              className={cn('reports-tab-button', activeTab === tab.id && 'is-active')}\n              onClick={() => onNavigate?.(tab.id)}\n            >\n              {tab.label}\n            </button>\n          ))}\n        </div>\n        <div className=\"reports-tab-content\">\n          {activeTab === 'revenue' && (\n            <div className=\"reports-tab-panel is-active\">\n              <div className=\"reports-analytics-card\">\n                <div className=\"reports-analytics-card__header\">\n                  <div className=\"reports-analytics-card__header-top\">\n                    <div>\n                      <h4 className=\"reports-analytics-card__title\">Earnings from orders</h4>\n                      <span className=\"reports-analytics-card__subtitle\">\n                        {timePeriod === 'week' && 'Last 7 days'}\n                        {timePeriod === 'month' && 'Last 30 days'}\n                        {timePeriod === 'year' && 'Last 12 months'}\n                        {timePeriod === 'all' && 'From start'}\n                      </span>\n                    </div>\n                    <div className=\"reports-time-period-selector\">\n                      {timePeriods.map((period) => (\n                        <button\n                          key={period.id}\n                          type=\"button\"\n                          className={cn(\n                            'reports-time-period-button',\n                            timePeriod === period.id && 'is-active',\n                          )}\n                          onClick={() => setTimePeriod(period.id)}\n                        >\n                          {period.label}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n                <div className=\"reports-analytics-card__chart\">\n                  <div className=\"reports-line-chart\">\n                    <div className=\"reports-line-chart__legend\">\n                      <div className=\"reports-line-chart__legend-item\">\n                        <span className=\"reports-line-chart__legend-dot is-revenue\" />\n                        <span className=\"reports-line-chart__legend-label\">Earnings (â‚¹L)</span>\n                      </div>\n                      <div className=\"reports-line-chart__legend-item\">\n                        <span className=\"reports-line-chart__legend-dot is-orders\" />\n                        <span className=\"reports-line-chart__legend-label\">Orders</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-line-chart__container\">\n                      <div className=\"reports-line-chart__y-axis\">\n                        {yAxisLabels.map((label, index) => (\n                          <span key={index} className=\"reports-line-chart__y-label\">\n                            {label}\n                          </span>\n                        ))}\n                      </div>\n                      <div className=\"reports-line-chart__graph\">\n                        <svg className=\"reports-line-chart__svg\" viewBox={`0 0 ${(chartData.labels.length - 1) * 100} 200`} preserveAspectRatio=\"none\">\n                          <defs>\n                            <linearGradient id=\"revenueGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                              <stop offset=\"0%\" stopColor=\"rgba(43, 118, 79, 0.3)\" />\n                              <stop offset=\"100%\" stopColor=\"rgba(43, 118, 79, 0.05)\" />\n                            </linearGradient>\n                            <linearGradient id=\"ordersGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                              <stop offset=\"0%\" stopColor=\"rgba(33, 150, 173, 0.3)\" />\n                              <stop offset=\"100%\" stopColor=\"rgba(33, 150, 173, 0.05)\" />\n                            </linearGradient>\n                          </defs>\n                          {/* Grid lines */}\n                          {yAxisLabels.map((_, index) => {\n                            const y = (index / yAxisSteps) * 200\n                            return (\n                              <line\n                                key={index}\n                                x1=\"0\"\n                                y1={y}\n                                x2={(chartData.labels.length - 1) * 100}\n                                y2={y}\n                                stroke=\"rgba(34, 94, 65, 0.08)\"\n                                strokeWidth=\"1\"\n                                strokeDasharray=\"2,2\"\n                              />\n                            )\n                          })}\n                          {/* Revenue area */}\n                          <path\n                            d={`M 0,${200 - (chartData.revenue[0] / maxValue) * 200} ${chartData.revenue\n                              .slice(1)\n                              .map((value, index) => `L ${(index + 1) * 100},${200 - (value / maxValue) * 200}`)\n                              .join(' ')} L ${(chartData.labels.length - 1) * 100},200 L 0,200 Z`}\n                            fill=\"url(#revenueGradient)\"\n                          />\n                          {/* Orders area */}\n                          <path\n                            d={`M 0,${200 - (chartData.orders[0] / maxValue) * 200} ${chartData.orders\n                              .slice(1)\n                              .map((value, index) => `L ${(index + 1) * 100},${200 - (value / maxValue) * 200}`)\n                              .join(' ')} L ${(chartData.labels.length - 1) * 100},200 L 0,200 Z`}\n                            fill=\"url(#ordersGradient)\"\n                          />\n                          {/* Revenue line */}\n                          <path\n                            d={`M 0,${200 - (chartData.revenue[0] / maxValue) * 200} ${chartData.revenue\n                              .slice(1)\n                              .map((value, index) => `L ${(index + 1) * 100},${200 - (value / maxValue) * 200}`)\n                              .join(' ')}`}\n                            fill=\"none\"\n                            stroke=\"rgba(43, 118, 79, 0.9)\"\n                            strokeWidth=\"2.5\"\n                            strokeLinecap=\"round\"\n                            strokeLinejoin=\"round\"\n                          />\n                          {/* Orders line */}\n                          <path\n                            d={`M 0,${200 - (chartData.orders[0] / maxValue) * 200} ${chartData.orders\n                              .slice(1)\n                              .map((value, index) => `L ${(index + 1) * 100},${200 - (value / maxValue) * 200}`)\n                              .join(' ')}`}\n                            fill=\"none\"\n                            stroke=\"rgba(33, 150, 173, 0.9)\"\n                            strokeWidth=\"2.5\"\n                            strokeLinecap=\"round\"\n                            strokeLinejoin=\"round\"\n                          />\n                          {/* Data points */}\n                          {chartData.revenue.map((value, index) => (\n                            <circle\n                              key={`revenue-${index}`}\n                              cx={index * 100}\n                              cy={200 - (value / maxValue) * 200}\n                              r=\"4\"\n                              fill=\"rgba(43, 118, 79, 0.95)\"\n                              stroke=\"rgba(255, 255, 255, 0.9)\"\n                              strokeWidth=\"2\"\n                            />\n                          ))}\n                          {chartData.orders.map((value, index) => (\n                            <circle\n                              key={`orders-${index}`}\n                              cx={index * 100}\n                              cy={200 - (value / maxValue) * 200}\n                              r=\"4\"\n                              fill=\"rgba(33, 150, 173, 0.95)\"\n                              stroke=\"rgba(255, 255, 255, 0.9)\"\n                              strokeWidth=\"2\"\n                            />\n                          ))}\n                        </svg>\n                        <div className=\"reports-line-chart__x-axis\">\n                          {chartData.labels.map((label, index) => (\n                            <span key={index} className=\"reports-line-chart__x-label\">\n                              {label}\n                            </span>\n                          ))}\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"reports-line-chart__stats\">\n                      <div className=\"reports-line-chart__stat\">\n                        <span className=\"reports-line-chart__stat-label\">Earnings</span>\n                        <span className=\"reports-line-chart__stat-value\">\n                          {(\n                            chartData.revenue.reduce((a, b) => a + b, 0) /\n                            chartData.revenue.length\n                          ).toFixed(1)}\n                          {timePeriod === 'year' || timePeriod === 'all' ? 'k' : ''} â‚¹L\n                        </span>\n                        <span className=\"reports-line-chart__stat-change is-positive\">+12.5%</span>\n                      </div>\n                      <div className=\"reports-line-chart__stat\">\n                        <span className=\"reports-line-chart__stat-label\">Orders</span>\n                        <span className=\"reports-line-chart__stat-value\">\n                          {Math.round(\n                            chartData.orders.reduce((a, b) => a + b, 0) / chartData.orders.length,\n                          )}\n                        </span>\n                        <span className=\"reports-line-chart__stat-change is-positive\">+8.3%</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n          {activeTab === 'performance' && (\n            <div className=\"reports-tab-panel is-active\">\n              <div className=\"reports-analytics-card\">\n                <div className=\"reports-analytics-card__header\">\n                  <span className=\"reports-analytics-card__badge\">Last 30 days</span>\n                  <h4 className=\"reports-analytics-card__title\">Order delivery performance</h4>\n                </div>\n                <div className=\"reports-analytics-card__chart\">\n                  <div className=\"reports-chart\">\n                    <div className=\"reports-chart__legend\">\n                      <div className=\"reports-chart__legend-item\">\n                        <span className=\"reports-chart__legend-dot is-revenue\" />\n                        <span className=\"reports-chart__legend-label\">On-time delivery</span>\n                      </div>\n                      <div className=\"reports-chart__legend-item\">\n                        <span className=\"reports-chart__legend-dot is-fulfilment\" />\n                        <span className=\"reports-chart__legend-label\">Average delay</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-chart__bars\">\n                      {[\n                        { label: 'Week 1', revenue: 92, fulfilment: 8 },\n                        { label: 'Week 2', revenue: 88, fulfilment: 12 },\n                        { label: 'Week 3', revenue: 95, fulfilment: 5 },\n                        { label: 'Week 4', revenue: 90, fulfilment: 10 },\n                      ].map((week, index) => (\n                        <div key={index} className=\"reports-chart__bar-group\">\n                          <div className=\"reports-chart__bar-container\">\n                            <div className=\"reports-chart__bar is-revenue\" style={{ height: `${week.revenue}%` }}>\n                              <span className=\"reports-chart__bar-value\">{week.revenue}%</span>\n                            </div>\n                            <div className=\"reports-chart__bar is-fulfilment\" style={{ height: `${week.fulfilment}%` }}>\n                              <span className=\"reports-chart__bar-value\">{week.fulfilment}%</span>\n                            </div>\n                          </div>\n                          <span className=\"reports-chart__bar-label\">{week.label}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n                <div className=\"reports-performance-metrics\">\n                  <div className=\"reports-performance-metric\">\n                    <span className=\"reports-performance-metric__label\">Average time to deliver</span>\n                    <span className=\"reports-performance-metric__value\">18.5h</span>\n                  </div>\n                  <div className=\"reports-performance-metric\">\n                    <span className=\"reports-performance-metric__label\">Order correctness</span>\n                    <span className=\"reports-performance-metric__value\">96.2%</span>\n                  </div>\n                  <div className=\"reports-performance-metric\">\n                    <span className=\"reports-performance-metric__label\">Customer rating</span>\n                    <span className=\"reports-performance-metric__value\">4.7/5</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n          {activeTab === 'trends' && (\n            <div className=\"reports-tab-panel is-active\">\n              <div className=\"reports-analytics-card\">\n                <div className=\"reports-analytics-card__header\">\n                  <span className=\"reports-analytics-card__badge\">Last 3 months</span>\n                  <h4 className=\"reports-analytics-card__title\">Growth summary</h4>\n                </div>\n                <div className=\"reports-analytics-card__chart\">\n                  <div className=\"reports-chart\">\n                    <div className=\"reports-chart__legend\">\n                      <div className=\"reports-chart__legend-item\">\n                        <span className=\"reports-chart__legend-dot is-revenue\" />\n                        <span className=\"reports-chart__legend-label\">Number of orders</span>\n                      </div>\n                      <div className=\"reports-chart__legend-item\">\n                        <span className=\"reports-chart__legend-dot is-fulfilment\" />\n                        <span className=\"reports-chart__legend-label\">Earnings growth</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-chart__bars\">\n                      {[\n                        { label: 'Month 1', revenue: 68, fulfilment: 72 },\n                        { label: 'Month 2', revenue: 75, fulfilment: 78 },\n                        { label: 'Month 3', revenue: 82, fulfilment: 85 },\n                      ].map((month, index) => (\n                        <div key={index} className=\"reports-chart__bar-group\">\n                          <div className=\"reports-chart__bar-container\">\n                            <div className=\"reports-chart__bar is-revenue\" style={{ height: `${month.revenue}%` }}>\n                              <span className=\"reports-chart__bar-value\">{month.revenue}%</span>\n                            </div>\n                            <div className=\"reports-chart__bar is-fulfilment\" style={{ height: `${month.fulfilment}%` }}>\n                              <span className=\"reports-chart__bar-value\">{month.fulfilment}%</span>\n                            </div>\n                          </div>\n                          <span className=\"reports-chart__bar-label\">{month.label}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n                <div className=\"reports-trends-insights\">\n                  <div className=\"reports-trend-item\">\n                    <span className=\"reports-trend-item__icon\">ðŸ“ˆ</span>\n                    <div className=\"reports-trend-item__content\">\n                      <span className=\"reports-trend-item__label\">Busy season coming</span>\n                      <span className=\"reports-trend-item__value\">+24% expected growth</span>\n                    </div>\n                  </div>\n                  <div className=\"reports-trend-item\">\n                    <span className=\"reports-trend-item__icon\">ðŸŒ¾</span>\n                    <div className=\"reports-trend-item__content\">\n                      <span className=\"reports-trend-item__label\">Top product category</span>\n                      <span className=\"reports-trend-item__value\">Organic fertilizers</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n          {activeTab === 'insights' && (\n            <div className=\"reports-tab-panel is-active\">\n              <div className=\"reports-analytics-card\">\n                <div className=\"reports-analytics-card__header\">\n                  <span className=\"reports-analytics-card__badge\">Smart suggestions</span>\n                  <h4 className=\"reports-analytics-card__title\">Important tips</h4>\n                </div>\n                <div className=\"reports-insights-list\">\n                  <div className=\"reports-insight-card\">\n                    <div className=\"reports-insight-card__icon is-success\">âœ“</div>\n                    <div className=\"reports-insight-card__content\">\n                      <h5 className=\"reports-insight-card__title\">Manage stock better</h5>\n                      <p className=\"reports-insight-card__description\">\n                        Your top 3 products show 15% higher demand. Consider increasing stock by 20% to meet busy season.\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"reports-insight-card\">\n                    <div className=\"reports-insight-card__icon is-warn\">âš </div>\n                    <div className=\"reports-insight-card__content\">\n                      <h5 className=\"reports-insight-card__title\">Faster delivery</h5>\n                      <p className=\"reports-insight-card__description\">\n                        Western hub routes show 8% delay. Consider other delivery partners for faster delivery.\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"reports-insight-card\">\n                    <div className=\"reports-insight-card__icon is-info\">ðŸ’¡</div>\n                    <div className=\"reports-insight-card__content\">\n                      <h5 className=\"reports-insight-card__title\">Credit usage</h5>\n                      <p className=\"reports-insight-card__description\">\n                        Your credit usage is good at 68%. You can safely increase number of orders by 25% without risk.\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"reports-insight-card\">\n                    <div className=\"reports-insight-card__icon is-success\">ðŸ“Š</div>\n                    <div className=\"reports-insight-card__content\">\n                      <h5 className=\"reports-insight-card__title\">Repeat customers</h5>\n                      <p className=\"reports-insight-card__description\">\n                        Repeat orders increased by 12% this month. Focus on maintaining quality standards.\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </section>\n\n      {/* Top sellers section removed - not relevant for vendor's own dashboard */}\n    </div>\n  )\n}\n\nfunction EarningsView({ openPanel, onNavigate }) {\n  const dispatch = useVendorDispatch()\n  const { getEarningsSummary, getEarningsHistory, getEarningsByOrders, getWithdrawals, getBankAccounts } = useVendorApi()\n  const { toasts, dismissToast, success, error } = useToast()\n  const [earningsData, setEarningsData] = useState(null)\n  const [earningsHistory, setEarningsHistory] = useState([])\n  const [earningsByOrders, setEarningsByOrders] = useState([])\n  const [withdrawals, setWithdrawals] = useState([])\n  const [bankAccounts, setBankAccounts] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [historyPage, setHistoryPage] = useState(1)\n  const [ordersPage, setOrdersPage] = useState(1)\n  const [activeSection, setActiveSection] = useState('summary') // 'summary', 'history', 'orders', 'withdrawals'\n  const [showBankAccountForm, setShowBankAccountForm] = useState(false)\n  const bankAccountFormRef = useRef(null)\n\n  useEffect(() => {\n    loadEarningsData()\n    loadBankAccounts()\n  }, [])\n\n  // Scroll to form when it opens\n  useEffect(() => {\n    if (showBankAccountForm && bankAccountFormRef.current) {\n      setTimeout(() => {\n        bankAccountFormRef.current?.scrollIntoView({ behavior: 'smooth', block: 'start' })\n      }, 100)\n    }\n  }, [showBankAccountForm])\n\n  const loadEarningsData = async () => {\n    setLoading(true)\n    try {\n      const [summaryResult, historyResult, ordersResult, withdrawalsResult] = await Promise.all([\n        getEarningsSummary(),\n        getEarningsHistory({ page: historyPage, limit: 10 }),\n        getEarningsByOrders({ page: ordersPage, limit: 10 }),\n        getWithdrawals({ page: 1, limit: 10 }),\n      ])\n\n      if (summaryResult.data) setEarningsData(summaryResult.data)\n      if (historyResult.data?.earnings) setEarningsHistory(historyResult.data.earnings)\n      if (ordersResult.data?.earningsByOrder) setEarningsByOrders(ordersResult.data.earningsByOrder)\n      if (withdrawalsResult.data?.withdrawals) setWithdrawals(withdrawalsResult.data.withdrawals)\n    } catch (err) {\n      error('Failed to load earnings data')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadBankAccounts = async () => {\n    const result = await getBankAccounts()\n    if (result.data?.bankAccounts) {\n      setBankAccounts(result.data.bankAccounts)\n    }\n  }\n\n  const formatCurrency = (amount) => {\n    if (!amount) return 'â‚¹0'\n    return `â‚¹${Math.round(amount).toLocaleString('en-IN')}`\n  }\n\n  const formatDate = (date) => {\n    if (!date) return 'N/A'\n    return new Date(date).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n  }\n\n  if (loading && !earningsData) {\n    return (\n      <div className=\"earnings-view space-y-6\">\n        <div className=\"credit-status-card\">\n          <div className=\"credit-status-card__main\">\n            <p>Loading earnings data...</p>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  const summary = earningsData || {\n    totalEarnings: 0,\n    availableBalance: 0,\n    pendingWithdrawal: 0,\n    totalWithdrawn: 0,\n    thisMonthEarnings: 0,\n    lastWithdrawalDate: null,\n  }\n\n  const earningsMetrics = [\n    { label: 'Available Balance', value: formatCurrency(summary.availableBalance), icon: SparkIcon, tone: 'success' },\n    { label: 'Total Withdrawn', value: formatCurrency(summary.totalWithdrawn || 0), icon: WalletIcon, tone: 'info' },\n    { label: 'Pending Withdrawal', value: formatCurrency(summary.pendingWithdrawal), icon: CreditIcon, tone: 'warn' },\n    { label: 'This Month', value: formatCurrency(summary.thisMonthEarnings), icon: ChartIcon, tone: 'teal' },\n  ]\n\n  return (\n    <div className=\"earnings-view space-y-6\">\n      {/* Earnings Summary Section */}\n      <section id=\"earnings-summary\" className=\"credit-status-section\">\n        <div className=\"credit-status-card\">\n          <div className=\"credit-status-card__main\">\n            <div className=\"credit-status-card__progress-wrapper\">\n              <div className=\"credit-status-card__progress-ring\">\n                <svg className=\"credit-status-card__progress-svg\" viewBox=\"0 0 120 120\">\n                  <circle\n                    className=\"credit-status-card__progress-bg\"\n                    cx=\"60\"\n                    cy=\"60\"\n                    r=\"54\"\n                    fill=\"none\"\n                    strokeWidth=\"8\"\n                  />\n                  <circle\n                    className=\"credit-status-card__progress-fill\"\n                    cx=\"60\"\n                    cy=\"60\"\n                    r=\"54\"\n                    fill=\"none\"\n                    strokeWidth=\"8\"\n                    strokeDasharray={`${2 * Math.PI * 54}`}\n                    strokeDashoffset={`${2 * Math.PI * 54 * (1 - (summary.availableBalance / Math.max(summary.totalEarnings, 1)))}`}\n                    transform=\"rotate(-90 60 60)\"\n                  />\n                </svg>\n                <div className=\"credit-status-card__progress-content\">\n                  <span className=\"credit-status-card__progress-percent\">\n                    {summary.totalEarnings > 0\n                      ? Math.round((summary.availableBalance / summary.totalEarnings) * 100)\n                      : 0}%\n                  </span>\n                  <span className=\"credit-status-card__progress-label\">Available</span>\n                </div>\n              </div>\n              <div className=\"credit-status-card__details\">\n                <div className=\"credit-status-card__amount\">\n                  <span className=\"credit-status-card__amount-value\">{formatCurrency(summary.totalEarnings)}</span>\n                  <span className=\"credit-status-card__amount-label\">Total Earnings</span>\n                </div>\n                <div className=\"credit-status-card__quick-info\">\n                  <div className=\"credit-status-card__info-item\">\n                    <span className=\"credit-status-card__info-label\">Available</span>\n                    <span className=\"credit-status-card__info-value\">{formatCurrency(summary.availableBalance)}</span>\n                  </div>\n                  <div className=\"credit-status-card__info-item\">\n                    <span className=\"credit-status-card__info-label\">Withdrawn</span>\n                    <span className=\"credit-status-card__info-value\">{formatCurrency(summary.totalWithdrawn || 0)}</span>\n                  </div>\n                  <div className=\"credit-status-card__info-item\">\n                    <span className=\"credit-status-card__info-label\">Pending</span>\n                    <span className=\"credit-status-card__info-value\">{formatCurrency(summary.pendingWithdrawal)}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"credit-status-card__footer\">\n            <div className=\"credit-status-card__status-badge\">\n              <span className=\"credit-status-card__status-text\">\n                {summary.lastWithdrawalDate\n                  ? `Last withdrawal: ${formatDate(summary.lastWithdrawalDate)}`\n                  : 'No withdrawals yet'}\n              </span>\n            </div>\n            <button\n              type=\"button\"\n              className=\"credit-status-card__action\"\n              onClick={() => {\n                if (bankAccounts.length === 0) {\n                  error('Please add a bank account before requesting withdrawal')\n                  return\n                }\n\n                // Prepare bank account options for the select field\n                const bankAccountOptions = bankAccounts.map((account) => ({\n                  value: account._id || account.id,\n                  label: `${account.accountHolderName} - ${account.bankName} (${account.accountNumber.slice(-4)})${account.isPrimary ? ' - Primary' : ''}`,\n                }))\n\n                // Set default to primary account if available\n                const primaryAccount = bankAccounts.find((acc) => acc.isPrimary)\n                const defaultBankAccountId = primaryAccount?._id || primaryAccount?.id || bankAccounts[0]?._id || bankAccounts[0]?.id\n\n                // Update the field options dynamically\n                openPanel('request-withdrawal', {\n                  availableBalance: summary.availableBalance,\n                  bankAccountOptions,\n                  bankAccountId: defaultBankAccountId,\n                  bankAccounts: bankAccounts, // Pass full bank accounts array for confirmation modal\n                })\n              }}\n              disabled={summary.availableBalance < 1000 || bankAccounts.length === 0}\n            >\n              Request Withdrawal\n            </button>\n          </div>\n          {bankAccounts.length === 0 && (\n            <div style={{ marginTop: '1rem', padding: '1rem', background: '#fef3c7', borderRadius: '0.5rem', fontSize: '0.875rem', color: '#92400e' }}>\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>\n                <p style={{ margin: 0 }}>\n                  <strong>No bank account added.</strong> Please add a bank account to request withdrawals.\n                </p>\n                <button\n                  type=\"button\"\n                  onClick={() => setShowBankAccountForm(true)}\n                  style={{\n                    alignSelf: 'flex-start',\n                    padding: '0.5rem 1rem',\n                    borderRadius: '0.5rem',\n                    background: '#1b8f5b',\n                    color: 'white',\n                    fontSize: '0.875rem',\n                    fontWeight: '600',\n                    border: 'none',\n                    cursor: 'pointer',\n                    transition: 'background 0.2s',\n                  }}\n                  onMouseEnter={(e) => e.target.style.background = '#157a4d'}\n                  onMouseLeave={(e) => e.target.style.background = '#1b8f5b'}\n                >\n                  Add Bank Account\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </section>\n\n      {/* Earnings Metrics Grid */}\n      <section id=\"earnings-metrics\" className=\"credit-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Earnings Summary</h3>\n          </div>\n        </div>\n        <div className=\"credit-metric-grid\">\n          {earningsMetrics.map((metric) => {\n            const Icon = metric.icon\n            return (\n              <div key={metric.label} className=\"credit-metric-card\">\n                <span\n                  className={cn(\n                    'credit-metric-icon',\n                    metric.tone === 'warn' ? 'is-warn' : metric.tone === 'teal' ? 'is-teal' : 'is-success',\n                  )}\n                >\n                  <Icon className=\"h-4 w-4\" />\n                </span>\n                <div className=\"credit-metric-body\">\n                  <p>{metric.label}</p>\n                  <span>{metric.value}</span>\n                </div>\n              </div>\n            )\n          })}\n        </div>\n      </section>\n\n      {/* Navigation Tabs */}\n      <section id=\"earnings-tabs\" className=\"credit-section\">\n        <div className=\"overview-section__header\">\n          <div>\n            <h3 className=\"overview-section__title\">Earnings Details</h3>\n          </div>\n        </div>\n        <div className=\"credit-action-grid credit-action-grid--scrollable\">\n          <button\n            type=\"button\"\n            className={cn('credit-action-card', activeSection === 'history' && 'is-active')}\n            onClick={() => setActiveSection('history')}\n          >\n            <header>\n              <span className=\"credit-action-card__icon\">\n                <ReportIcon className=\"h-5 w-5\" />\n              </span>\n              <h4 className=\"credit-action-card__title\">History</h4>\n            </header>\n          </button>\n          <button\n            type=\"button\"\n            className={cn('credit-action-card', activeSection === 'orders' && 'is-active')}\n            onClick={() => setActiveSection('orders')}\n          >\n            <header>\n              <span className=\"credit-action-card__icon\">\n                <CartIcon className=\"h-5 w-5\" />\n              </span>\n              <h4 className=\"credit-action-card__title\">By Orders</h4>\n            </header>\n          </button>\n          <button\n            type=\"button\"\n            className={cn('credit-action-card', activeSection === 'withdrawals' && 'is-active')}\n            onClick={() => setActiveSection('withdrawals')}\n          >\n            <header>\n              <span className=\"credit-action-card__icon\">\n                <WalletIcon className=\"h-5 w-5\" />\n              </span>\n              <h4 className=\"credit-action-card__title\">Withdrawals</h4>\n            </header>\n          </button>\n        </div>\n      </section>\n\n      {/* Earnings History */}\n      {activeSection === 'history' && (\n        <section id=\"earnings-history\" className=\"credit-section\">\n          <div className=\"overview-section__header\">\n            <div>\n              <h3 className=\"overview-section__title\">Earnings History</h3>\n            </div>\n          </div>\n          {earningsHistory.length === 0 ? (\n            <div className=\"credit-usage-card\">\n              <p style={{ textAlign: 'center', padding: '2rem', color: '#666' }}>No earnings history yet</p>\n            </div>\n          ) : (\n            <div className=\"credit-usage-card\">\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>\n                {earningsHistory.map((earning) => (\n                  <div\n                    key={earning._id || earning.id}\n                    style={{\n                      padding: '1rem',\n                      borderBottom: '1px solid #e5e7eb',\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'center',\n                    }}\n                  >\n                    <div>\n                      <p style={{ fontWeight: '600', marginBottom: '0.25rem' }}>\n                        {earning.productName || 'Product'}\n                      </p>\n                      <p style={{ fontSize: '0.875rem', color: '#666' }}>\n                        Order: {earning.orderId?.orderNumber || 'N/A'} â€¢ Qty: {earning.quantity}\n                      </p>\n                      <p style={{ fontSize: '0.75rem', color: '#999', marginTop: '0.25rem' }}>\n                        {formatDate(earning.processedAt)}\n                      </p>\n                    </div>\n                    <div style={{ textAlign: 'right' }}>\n                      <p style={{ fontWeight: '600', color: '#10b981' }}>{formatCurrency(earning.earnings)}</p>\n                      <p style={{ fontSize: '0.75rem', color: '#666' }}>\n                        {formatCurrency(earning.userPrice - earning.vendorPrice)} per unit\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </section>\n      )}\n\n      {/* Earnings by Orders */}\n      {activeSection === 'orders' && (\n        <section id=\"earnings-orders\" className=\"credit-section\">\n          <div className=\"overview-section__header\">\n            <div>\n              <h3 className=\"overview-section__title\">Earnings by Orders</h3>\n            </div>\n          </div>\n          {earningsByOrders.length === 0 ? (\n            <div className=\"credit-usage-card\">\n              <p style={{ textAlign: 'center', padding: '2rem', color: '#666' }}>No earnings from orders yet</p>\n            </div>\n          ) : (\n            <div className=\"credit-usage-card\">\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>\n                {earningsByOrders.map((orderEarning) => (\n                  <div\n                    key={orderEarning.orderId}\n                    style={{\n                      padding: '1rem',\n                      borderBottom: '1px solid #e5e7eb',\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'center',\n                    }}\n                  >\n                    <div>\n                      <p style={{ fontWeight: '600', marginBottom: '0.25rem' }}>\n                        {orderEarning.orderNumber || 'Order'}\n                      </p>\n                      <p style={{ fontSize: '0.875rem', color: '#666' }}>\n                        {orderEarning.itemCount} item{orderEarning.itemCount !== 1 ? 's' : ''}\n                      </p>\n                      <p style={{ fontSize: '0.75rem', color: '#999', marginTop: '0.25rem' }}>\n                        {formatDate(orderEarning.processedAt)}\n                      </p>\n                    </div>\n                    <div style={{ textAlign: 'right' }}>\n                      <p style={{ fontWeight: '600', color: '#10b981' }}>\n                        {formatCurrency(orderEarning.totalEarnings)}\n                      </p>\n                      <p style={{ fontSize: '0.75rem', color: '#666' }}>\n                        Order: {formatCurrency(orderEarning.orderTotal)}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </section>\n      )}\n\n      {/* Withdrawals Section */}\n      {activeSection === 'withdrawals' && (\n        <section id=\"earnings-withdrawals\" className=\"credit-section\">\n          <div className=\"overview-section__header\">\n            <div>\n              <h3 className=\"overview-section__title\">Withdrawal History</h3>\n            </div>\n          </div>\n          {withdrawals.length === 0 ? (\n            <div className=\"credit-usage-card\">\n              <p style={{ textAlign: 'center', padding: '2rem', color: '#666' }}>No withdrawal requests yet</p>\n            </div>\n          ) : (\n            <div className=\"credit-usage-card\">\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>\n                {withdrawals.map((withdrawal) => {\n                  const statusColor = withdrawal.status === 'approved' || withdrawal.status === 'completed'\n                    ? '#10b981'\n                    : withdrawal.status === 'rejected'\n                      ? '#ef4444'\n                      : '#f59e0b'\n                  const statusText = withdrawal.status === 'approved' ? 'Approved'\n                    : withdrawal.status === 'completed' ? 'Completed'\n                      : withdrawal.status === 'rejected' ? 'Rejected'\n                        : 'Pending'\n                  return (\n                    <div\n                      key={withdrawal._id || withdrawal.id}\n                      style={{\n                        padding: '1rem',\n                        borderBottom: '1px solid #e5e7eb',\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                      }}\n                    >\n                      <div>\n                        <p style={{ fontWeight: '600', marginBottom: '0.25rem' }}>\n                          Withdrawal Request\n                        </p>\n                        <p style={{ fontSize: '0.875rem', color: '#666' }}>\n                          {withdrawal.bankAccountId?.bankName || 'Bank'} â€¢ {withdrawal.bankAccountId?.accountNumber ? `****${withdrawal.bankAccountId.accountNumber.slice(-4)}` : 'N/A'}\n                        </p>\n                        <p style={{ fontSize: '0.75rem', color: '#999', marginTop: '0.25rem' }}>\n                          {formatDate(withdrawal.reviewedAt || withdrawal.createdAt)}\n                        </p>\n                      </div>\n                      <div style={{ textAlign: 'right' }}>\n                        <p style={{ fontWeight: '600', color: statusColor }}>{formatCurrency(withdrawal.amount)}</p>\n                        <p style={{ fontSize: '0.75rem', color: statusColor }}>\n                          {statusText}\n                        </p>\n                        {withdrawal.paymentReference && (\n                          <p style={{ fontSize: '0.7rem', color: '#999', marginTop: '0.25rem' }}>\n                            Ref: {withdrawal.paymentReference.slice(-8)}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n            </div>\n          )}\n        </section>\n      )}\n\n      {/* Bank Account Form */}\n      {showBankAccountForm ? (\n        <div ref={bankAccountFormRef}>\n          <BankAccountForm\n            isOpen={showBankAccountForm}\n            onClose={() => setShowBankAccountForm(false)}\n            onSuccess={async (bankAccount) => {\n              success('Bank account added successfully!')\n              // Reload bank accounts\n              await loadBankAccounts()\n              setShowBankAccountForm(false)\n              // Refresh earnings summary\n              const summaryResult = await getEarningsSummary()\n              if (summaryResult.data) {\n                setEarningsData((prev) => ({\n                  ...prev,\n                  summary: summaryResult.data,\n                }))\n              }\n            }}\n          />\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\pages\\vendor\\VendorLogin.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":108,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":108,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\r\nimport { OtpVerification } from '../../../../components/auth/OtpVerification'\r\nimport { useVendorDispatch } from '../../context/VendorContext'\r\nimport * as vendorApi from '../../services/vendorApi'\r\n\r\nexport function VendorLogin({ onSuccess, onSwitchToRegister }) {\r\n  const dispatch = useVendorDispatch()\r\n  const [step, setStep] = useState('phone') // 'phone' | 'otp'\r\n  const [form, setForm] = useState({ phone: '' })\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(null)\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target\r\n    setForm((prev) => ({ ...prev, [name]: value }))\r\n    setError(null)\r\n  }\r\n\r\n  const handleRequestOtp = async (e) => {\r\n    e.preventDefault()\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    try {\r\n      if (!form.phone.trim()) {\r\n        setError('Contact number is required')\r\n        setLoading(false)\r\n        return\r\n      }\r\n      if (form.phone.length < 10) {\r\n        setError('Please enter a valid contact number')\r\n        setLoading(false)\r\n        return\r\n      }\r\n\r\n      const result = await vendorApi.requestVendorOTP({ phone: form.phone })\r\n      \r\n      if (result.success || result.data) {\r\n        setStep('otp')\r\n      } else {\r\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      setError(err.message || 'Failed to send OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleVerifyOtp = async (otpCode) => {\r\n    setError(null)\r\n    setLoading(true)\r\n\r\n    try {\r\n      const result = await vendorApi.loginVendorWithOtp({ phone: form.phone, otp: otpCode })\r\n\r\n      if (result.success || result.data) {\r\n        const vendorData = result.data?.vendor || result.data?.data?.vendor\r\n        if (result.data?.token || result.data?.data?.token) {\r\n          localStorage.setItem('vendor_token', result.data?.token || result.data?.data?.token)\r\n        }\r\n        \r\n        // Update vendor context with profile\r\n        if (vendorData) {\r\n          dispatch({\r\n            type: 'AUTH_LOGIN',\r\n            payload: {\r\n              id: vendorData.id || vendorData._id,\r\n              name: vendorData.name,\r\n              phone: vendorData.phone || form.phone,\r\n              email: vendorData.email,\r\n              location: vendorData.location,\r\n              status: vendorData.status,\r\n              isActive: vendorData.isActive,\r\n            },\r\n          })\r\n        }\r\n        \r\n        onSuccess?.(vendorData || { phone: form.phone })\r\n      } else {\r\n        // Check if vendor needs to register\r\n        if (result.error?.message?.includes('not found') || result.error?.message?.includes('Vendor not found')) {\r\n          setError('Vendor not found. Please register first.')\r\n          setTimeout(() => {\r\n            if (onSwitchToRegister) {\r\n              onSwitchToRegister()\r\n            }\r\n          }, 2000)\r\n        } else if (result.error?.message?.includes('banned')) {\r\n          setError(result.error?.message || 'Your account has been banned. Please contact admin.')\r\n        } else if (result.error?.message?.includes('inactive')) {\r\n          setError('Your account is inactive. Please contact admin.')\r\n        } else {\r\n          setError(result.error?.message || 'Invalid OTP. Please try again.')\r\n        }\r\n      }\r\n    } catch (err) {\r\n      setError(err.message || 'Verification failed. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleResendOtp = async () => {\r\n    setLoading(true)\r\n    try {\r\n      await vendorApi.requestVendorOTP({ phone: form.phone })\r\n    } catch (err) {\r\n      setError('Failed to resend OTP. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  if (step === 'otp') {\r\n    return (\r\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\r\n        <div className=\"w-full max-w-md space-y-6\">\r\n          <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\r\n            <OtpVerification\r\n              phone={form.phone}\r\n              onVerify={handleVerifyOtp}\r\n              onResend={handleResendOtp}\r\n              onBack={() => setStep('phone')}\r\n              loading={loading}\r\n              error={error}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\r\n      <div className=\"w-full max-w-md space-y-6\">\r\n        <div className=\"text-center space-y-2\">\r\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4\">\r\n            <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n            </svg>\r\n          </div>\r\n          <p className=\"text-xs uppercase tracking-wide text-green-600 font-semibold\">Welcome Back</p>\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Sign in as Vendor</h1>\r\n          <p className=\"text-sm text-gray-600\">Enter your contact number to continue</p>\r\n        </div>\r\n\r\n        <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\r\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\r\n            {error && (\r\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\r\n                <p className=\"text-sm text-red-600\">{error}</p>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"space-y-1.5\">\r\n              <label htmlFor=\"login-phone\" className=\"text-xs font-semibold text-gray-700\">\r\n                Contact Number <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              <input\r\n                id=\"login-phone\"\r\n                name=\"phone\"\r\n                type=\"tel\"\r\n                required\r\n                value={form.phone}\r\n                onChange={handleChange}\r\n                placeholder=\"+91 90000 00000\"\r\n                maxLength={15}\r\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\r\n              />\r\n            </div>\r\n\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {loading ? 'Sending OTP...' : 'Continue'}\r\n            </button>\r\n\r\n            <div className=\"text-center text-sm\">\r\n              <span className=\"text-gray-600\">Don't have an account? </span>\r\n              <button\r\n                type=\"button\"\r\n                onClick={onSwitchToRegister}\r\n                className=\"text-green-600 font-semibold hover:underline\"\r\n              >\r\n                Sign up\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\pages\\vendor\\VendorRegistration.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\routes\\VendorDashboardPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\routes\\VendorLanguagePage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\routes\\VendorLoginPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\routes\\VendorRegisterPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\routes\\VendorRolePage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\routes\\VendorRouteContainer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\services\\vendorApi.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\Vendor\\services\\vendorDashboard.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\WebComponents\\WebFooter.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\WebComponents\\WebHeader.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\WebComponents\\WebNavbar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\WebPages\\WebDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\components\\Layout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\components\\WebsiteFooter.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\components\\WebsiteHeader.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\context\\WebsiteContext.jsx","messages":[{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":82,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":82,"endColumn":98,"suggestions":[{"messageId":"addBrackets","fix":{"range":[2164,2635],"text":"{ const existingItem = state.cart.find((item) => item.productId === action.payload.productId)\n      if (existingItem) {\n        return {\n          ...state,\n          cart: state.cart.map((item) =>\n            item.productId === action.payload.productId\n              ? { ...item, quantity: item.quantity + action.payload.quantity }\n              : item,\n          ),\n        }\n      }\n      return {\n        ...state,\n        cart: [...state.cart, action.payload],\n      } }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":670,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":670,"endColumn":32},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":678,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":678,"endColumn":35}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useMemo, useReducer, useEffect, useCallback } from 'react'\nimport { initializeRealtimeConnection, handleRealtimeNotification, getUserProfile, getCart, getOrders, getAddresses, getOffers } from '../services/websiteApi'\n\nconst WebsiteStateContext = createContext(null)\nconst WebsiteDispatchContext = createContext(() => {})\n\nconst initialState = {\n  authenticated: false,\n  profile: {\n    name: 'Guest User',\n    email: '',\n    phone: '',\n    sellerId: null, // Seller ID linked to user\n    location: {\n      address: '',\n      city: '',\n      state: '',\n      pincode: '',\n      coordinates: null,\n    },\n  },\n  cart: [],\n  orders: [],\n  addresses: [],\n  paymentMethods: [],\n  favourites: [],\n  notifications: [],\n  assignedVendor: null, // Vendor assigned based on location (20km radius)\n  vendorAvailability: {\n    vendorAvailable: false,\n    canPlaceOrder: false,\n    isInBufferZone: false, // Within 300m buffer (20km to 20.3km) - no warning shown\n  },\n  realtimeConnected: false,\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'AUTH_LOGIN':\n      return {\n        ...state,\n        authenticated: true,\n        profile: {\n          ...state.profile,\n          ...action.payload,\n          sellerId: action.payload.sellerId || state.profile.sellerId, // Preserve sellerId if not provided\n        },\n      }\n    case 'UPDATE_SELLER_ID':\n      return {\n        ...state,\n        profile: {\n          ...state.profile,\n          sellerId: action.payload,\n        },\n      }\n    case 'SET_ASSIGNED_VENDOR':\n      return {\n        ...state,\n        assignedVendor: action.payload,\n      }\n    case 'SET_VENDOR_AVAILABILITY':\n      return {\n        ...state,\n        vendorAvailability: action.payload,\n      }\n    case 'SET_REALTIME_CONNECTED':\n      return {\n        ...state,\n        realtimeConnected: action.payload,\n      }\n    case 'AUTH_LOGOUT':\n      return { \n        ...state, \n        authenticated: false, \n        profile: initialState.profile, \n        cart: [],\n        vendorAvailability: initialState.vendorAvailability,\n        assignedVendor: null,\n      }\n    case 'ADD_TO_CART':\n      const existingItem = state.cart.find((item) => item.productId === action.payload.productId)\n      if (existingItem) {\n        return {\n          ...state,\n          cart: state.cart.map((item) =>\n            item.productId === action.payload.productId\n              ? { ...item, quantity: item.quantity + action.payload.quantity }\n              : item,\n          ),\n        }\n      }\n      return {\n        ...state,\n        cart: [...state.cart, action.payload],\n      }\n    case 'UPDATE_CART_ITEM':\n      return {\n        ...state,\n        cart: state.cart.map((item) =>\n          item.productId === action.payload.productId\n            ? { ...item, quantity: action.payload.quantity }\n            : item,\n        ),\n      }\n    case 'REMOVE_FROM_CART':\n      return {\n        ...state,\n        cart: state.cart.filter((item) => item.productId !== action.payload.productId),\n      }\n    case 'CLEAR_CART':\n      return {\n        ...state,\n        cart: [],\n      }\n    case 'SET_CART_ITEMS':\n      return {\n        ...state,\n        cart: Array.isArray(action.payload) ? action.payload : [],\n      }\n    case 'ADD_ORDER':\n      // Note: Cart is NOT cleared here. It will be cleared only after successful payment confirmation\n      // This ensures cart items remain available if user cancels payment or payment fails\n      return {\n        ...state,\n        orders: [...state.orders, action.payload],\n        // cart: [] - Removed: Cart should only be cleared after payment is confirmed\n      }\n    case 'UPDATE_ORDER':\n      return {\n        ...state,\n        orders: state.orders.map((order) =>\n          order.id === action.payload.id ? { ...order, ...action.payload } : order,\n        ),\n      }\n    case 'ADD_ADDRESS':\n      return {\n        ...state,\n        addresses: [...state.addresses, action.payload],\n      }\n    case 'UPDATE_ADDRESS':\n      return {\n        ...state,\n        addresses: state.addresses.map((addr) =>\n          addr.id === action.payload.id ? { ...addr, ...action.payload } : addr,\n        ),\n      }\n    case 'SET_DEFAULT_ADDRESS':\n      return {\n        ...state,\n        addresses: state.addresses.map((addr) => ({\n          ...addr,\n          isDefault: addr.id === action.payload.id,\n        })),\n      }\n    case 'DELETE_ADDRESS':\n      return {\n        ...state,\n        addresses: state.addresses.filter((addr) => addr.id !== action.payload.id),\n      }\n    case 'CLEAR_ADDRESSES':\n      return {\n        ...state,\n        addresses: [],\n      }\n    case 'ADD_TO_FAVOURITES':\n      if (state.favourites.includes(action.payload.productId)) {\n        return state\n      }\n      return {\n        ...state,\n        favourites: [...state.favourites, action.payload.productId],\n      }\n    case 'REMOVE_FROM_FAVOURITES':\n      return {\n        ...state,\n        favourites: state.favourites.filter((id) => id !== action.payload.productId),\n      }\n    case 'ADD_NOTIFICATION':\n      return {\n        ...state,\n        notifications: [\n          {\n            id: Date.now().toString(),\n            ...action.payload,\n            read: false,\n            timestamp: new Date().toISOString(),\n          },\n          ...state.notifications,\n        ],\n      }\n    case 'MARK_NOTIFICATION_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) =>\n          notif.id === action.payload.id ? { ...notif, read: true } : notif,\n        ),\n      }\n    case 'MARK_ALL_NOTIFICATIONS_READ':\n      return {\n        ...state,\n        notifications: state.notifications.map((notif) => ({ ...notif, read: true })),\n      }\n    default:\n      return state\n  }\n}\n\nexport function WebsiteProvider({ children }) {\n  const [state, dispatch] = useReducer(reducer, initialState)\n  \n  // Helper function to resolve IDs (supports both _id and id fields)\n  const resolveId = useCallback((value) => {\n    if (!value) return ''\n    if (typeof value === 'string' || typeof value === 'number') return value.toString()\n    if (typeof value === 'object') {\n      if (value._id) return value._id.toString()\n      if (value.id) return value.id.toString()\n      if (typeof value.toString === 'function') return value.toString()\n    }\n    return ''\n  }, [])\n\n  // Map cart items from API response with variant handling\n  const mapCartItemsFromResponse = useCallback((cartData) => {\n    if (!cartData?.items) {\n      return []\n    }\n    \n    const mappedItems = cartData.items\n      .map((item) => {\n        const cartItemId = resolveId(item.id || item._id)\n        const product = item.product || item.productId || {}\n        const productId = resolveId(product.id || product._id || item.productId)\n        \n        if (!productId) {\n          return null\n        }\n        \n        // Use variant-specific price (unitPrice) if available, otherwise fallback\n        const price =\n          typeof item.unitPrice === 'number'\n            ? item.unitPrice\n            : typeof product.priceToUser === 'number'\n              ? product.priceToUser\n              : typeof product.price === 'number'\n                ? product.price\n                : 0\n        \n        // Extract variant attributes if present\n        const variantAttributes = item.variantAttributes || null\n        \n        const mappedItem = {\n          id: cartItemId,\n          cartItemId,\n          productId,\n          name: product.name || item.productName || 'Unknown Product',\n          price,\n          unitPrice: item.unitPrice || price,\n          image: item.image || product.images?.[0]?.url || product.primaryImage || product.image || '',\n          quantity: item.quantity || 1,\n          vendor: product.vendor || null,\n          deliveryTime: product.deliveryTime || null,\n          variantAttributes: variantAttributes,\n        }\n        \n        return mappedItem\n      })\n      .filter(Boolean)\n    \n    return mappedItems\n  }, [resolveId])\n\n  const syncCartState = useCallback(\n    (cartData) => {\n      const items = mapCartItemsFromResponse(cartData)\n      dispatch({ type: 'SET_CART_ITEMS', payload: items })\n    },\n    [mapCartItemsFromResponse],\n  )\n\n  // Fetch user profile from API on mount\n  useEffect(() => {\n    const token = localStorage.getItem('user_token')\n    if (token) {\n      const fetchProfile = async () => {\n        try {\n          const result = await getUserProfile()\n          if (result.success && result.data?.user) {\n            const userData = result.data.user\n            dispatch({\n              type: 'AUTH_LOGIN',\n              payload: {\n                name: userData.name || 'User',\n                phone: userData.phone || '',\n                email: userData.email || '',\n                sellerId: userData.sellerId || null,\n                location: userData.location || null,\n              },\n            })\n            \n            // Set vendor availability status from profile\n            if (result.data?.vendorAvailability) {\n              dispatch({\n                type: 'SET_VENDOR_AVAILABILITY',\n                payload: result.data.vendorAvailability,\n              })\n              \n              // Set assigned vendor if available\n              if (result.data.vendorAvailability.assignedVendor) {\n                dispatch({\n                  type: 'SET_ASSIGNED_VENDOR',\n                  payload: result.data.vendorAvailability.assignedVendor,\n                })\n              }\n            }\n          }\n        } catch (error) {\n          console.error('Error fetching user profile:', error)\n          // If token is invalid, remove it but don't redirect (website allows guest access)\n          if (error.error?.message?.includes('unauthorized') || error.error?.message?.includes('token')) {\n            localStorage.removeItem('user_token')\n          }\n        }\n      }\n      fetchProfile()\n    }\n  }, [dispatch])\n\n  // Fetch orders, cart, and addresses from API on mount (when authenticated)\n  useEffect(() => {\n    const token = localStorage.getItem('user_token')\n    if (!token || !state.authenticated) return\n\n    const loadData = async () => {\n      try {\n        // Fetch orders\n        const ordersResult = await getOrders()\n        if (ordersResult.success && ordersResult.data?.orders) {\n          ordersResult.data.orders.forEach((order) => {\n            dispatch({\n              type: 'ADD_ORDER',\n              payload: {\n                id: order.id || order._id,\n                orderNumber: order.orderNumber,\n                status: order.status,\n                totalAmount: order.totalAmount,\n                subtotal: order.subtotal,\n                deliveryCharge: order.deliveryCharge,\n                paymentPreference: order.paymentPreference,\n                upfrontAmount: order.upfrontAmount,\n                remainingAmount: order.remainingAmount,\n                paymentStatus: order.paymentStatus,\n                items: order.items,\n                statusTimeline: order.statusTimeline,\n                createdAt: order.createdAt,\n              },\n            })\n          })\n        }\n\n        // Fetch cart\n        const cartResult = await getCart()\n        if (cartResult.success && cartResult.data?.cart) {\n          syncCartState(cartResult.data.cart)\n        } else {\n          dispatch({ type: 'SET_CART_ITEMS', payload: [] })\n        }\n\n        // Fetch addresses\n        const addressesResult = await getAddresses()\n        if (addressesResult.success && addressesResult.data?.addresses) {\n          // Clear existing addresses first\n          dispatch({ type: 'CLEAR_ADDRESSES' })\n          // Add addresses from API\n          addressesResult.data.addresses.forEach((address) => {\n            dispatch({\n              type: 'ADD_ADDRESS',\n              payload: {\n                id: address.id || address._id,\n                name: address.name || address.label,\n                label: address.label || address.name,\n                address: address.address || address.street,\n                street: address.street || address.address,\n                city: address.city,\n                state: address.state,\n                pincode: address.pincode,\n                phone: address.phone,\n                isDefault: address.isDefault || false,\n              },\n            })\n          })\n        }\n      } catch (error) {\n        console.error('Error loading data:', error)\n      }\n    }\n    loadData()\n  }, [state.authenticated, syncCartState])\n\n  // Initialize welcome notification (only first time user enters website)\n  useEffect(() => {\n    if (!state.authenticated) return\n    \n    const hasSeenWelcome = localStorage.getItem('hasSeenWelcomeNotification_website')\n    if (!hasSeenWelcome && state.notifications.length === 0) {\n      dispatch({\n        type: 'ADD_NOTIFICATION',\n        payload: {\n          title: 'Welcome to IRA Sathi!',\n          message: 'Start shopping for your farming needs',\n          type: 'welcome',\n        },\n      })\n      localStorage.setItem('hasSeenWelcomeNotification_website', 'true')\n    }\n  }, [state.authenticated, state.notifications.length, dispatch])\n\n  // Initialize real-time connection when authenticated\n  useEffect(() => {\n    if (state.authenticated && state.profile.phone) {\n      const cleanup = initializeRealtimeConnection((notification) => {\n        const processedNotification = handleRealtimeNotification(notification)\n        \n        // Handle different notification types\n        switch (processedNotification.type) {\n          case 'payment_reminder':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'payment',\n                title: 'Payment Reminder',\n                message: `Please complete the remaining payment of â‚¹${processedNotification.amount} for Order #${processedNotification.orderId}`,\n                orderId: processedNotification.orderId,\n                amount: processedNotification.amount,\n                read: false,\n              },\n            })\n            break\n            \n          case 'delivery_update':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'delivery',\n                title: 'Delivery Update',\n                message: processedNotification.message || `Your order #${processedNotification.orderId} status has been updated`,\n                orderId: processedNotification.orderId,\n                status: processedNotification.status,\n                read: false,\n              },\n            })\n            // Update order status if order exists\n            if (processedNotification.orderId) {\n              dispatch({\n                type: 'UPDATE_ORDER',\n                payload: {\n                  id: processedNotification.orderId,\n                  status: processedNotification.status,\n                },\n              })\n            }\n            break\n            \n          case 'order_assigned':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'order',\n                title: 'Order Assigned',\n                message: `Your order #${processedNotification.orderId} has been assigned to ${processedNotification.vendorName}`,\n                orderId: processedNotification.orderId,\n                read: false,\n              },\n            })\n            break\n            \n          case 'order_delivered':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: 'delivery',\n                title: 'Order Delivered',\n                message: `Your order #${processedNotification.orderId} has been delivered. Please complete the remaining payment.`,\n                orderId: processedNotification.orderId,\n                read: false,\n              },\n            })\n            // Update order status\n            if (processedNotification.orderId) {\n              dispatch({\n                type: 'UPDATE_ORDER',\n                payload: {\n                  id: processedNotification.orderId,\n                  status: 'delivered',\n                  deliveryDate: processedNotification.deliveryDate || new Date().toISOString(),\n                },\n              })\n            }\n            break\n            \n          case 'offer':\n          case 'announcement':\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                type: processedNotification.type,\n                title: processedNotification.title,\n                message: processedNotification.message,\n                read: false,\n              },\n            })\n            break\n            \n          default:\n            dispatch({\n              type: 'ADD_NOTIFICATION',\n              payload: {\n                id: processedNotification.id,\n                ...processedNotification,\n                read: false,\n              },\n            })\n        }\n      })\n      \n      dispatch({ type: 'SET_REALTIME_CONNECTED', payload: true })\n      \n      return () => {\n        cleanup()\n        dispatch({ type: 'SET_REALTIME_CONNECTED', payload: false })\n      }\n    }\n  }, [state.authenticated, state.profile.phone])\n\n  // Track order status changes and send notifications (poll every 30 seconds)\n  useEffect(() => {\n    const token = localStorage.getItem('user_token')\n    if (!token || !state.authenticated || state.orders.length === 0) return\n\n    const checkOrderStatusChanges = async () => {\n      try {\n        const ordersResult = await getOrders()\n        if (ordersResult.success && ordersResult.data?.orders) {\n          ordersResult.data.orders.forEach((order) => {\n            const existingOrder = state.orders.find((o) => {\n              const orderId = order.id || order._id\n              return o.id === orderId || o.id === order._id\n            })\n            if (existingOrder && existingOrder.status !== order.status) {\n              // Order status changed - send notification\n              const statusMessages = {\n                accepted: 'Your order has been accepted and is being prepared',\n                dispatched: 'Your order has been dispatched and is on the way',\n                delivered: 'Your order has been delivered successfully',\n              }\n              \n              const message = statusMessages[order.status] || `Your order status has been updated to ${order.status}`\n              \n              dispatch({\n                type: 'ADD_NOTIFICATION',\n                payload: {\n                  type: 'order_status',\n                  title: 'Order Status Update',\n                  message: `${message}. Order #${order.orderNumber?.slice(-8) || (order.id || order._id)?.slice(-8) || 'N/A'}`,\n                  orderId: order.id || order._id,\n                  orderNumber: order.orderNumber,\n                  status: order.status,\n                },\n              })\n\n              // Update order in state\n              dispatch({\n                type: 'UPDATE_ORDER',\n                payload: {\n                  id: order.id || order._id,\n                  status: order.status,\n                  paymentStatus: order.paymentStatus,\n                  statusTimeline: order.statusTimeline,\n                },\n              })\n            }\n          })\n        }\n      } catch (error) {\n        console.error('Error checking order status changes:', error)\n      }\n    }\n\n    // Check immediately\n    checkOrderStatusChanges()\n\n    // Poll every 30 seconds for order status changes\n    const interval = setInterval(checkOrderStatusChanges, 30000)\n\n    return () => clearInterval(interval)\n  }, [state.orders, state.authenticated])\n\n  // Check for new offers and send notifications (poll every 5 minutes)\n  useEffect(() => {\n    const token = localStorage.getItem('user_token')\n    if (!token || !state.authenticated) return\n\n    const checkNewOffers = async () => {\n      try {\n        const offersResult = await getOffers()\n        if (offersResult.success && offersResult.data) {\n          const activeCarousels = (offersResult.data.carousels || [])\n            .filter(c => c.isActive !== false)\n          const specialOffers = offersResult.data.specialOffers || []\n          \n          // Check for new offers (created in last 24 hours)\n          const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000)\n          const newCarousels = activeCarousels.filter(c => {\n            const createdAt = new Date(c.createdAt)\n            return createdAt > oneDayAgo\n          })\n          const newSpecialOffers = specialOffers.filter(o => {\n            const createdAt = new Date(o.createdAt)\n            return createdAt > oneDayAgo\n          })\n          \n          // Send notification for new offers (only once per day)\n          if (newCarousels.length > 0 || newSpecialOffers.length > 0) {\n            const lastOfferCheck = localStorage.getItem('lastOfferCheckTime_website')\n            const now = Date.now()\n            const oneDayInMs = 24 * 60 * 60 * 1000\n            \n            if (!lastOfferCheck || (now - parseInt(lastOfferCheck)) > oneDayInMs) {\n              const offerCount = newCarousels.length + newSpecialOffers.length\n              dispatch({\n                type: 'ADD_NOTIFICATION',\n                payload: {\n                  type: 'offer',\n                  title: 'New Offers Available!',\n                  message: `${offerCount} new ${offerCount === 1 ? 'offer' : 'offers'} ${offerCount === 1 ? 'is' : 'are'} now available. Check them out!`,\n                },\n              })\n              localStorage.setItem('lastOfferCheckTime_website', now.toString())\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error checking new offers:', error)\n      }\n    }\n\n    // Check immediately\n    checkNewOffers()\n\n    // Poll every 5 minutes for new offers\n    const interval = setInterval(checkNewOffers, 5 * 60 * 1000)\n\n    return () => clearInterval(interval)\n  }, [state.authenticated, dispatch])\n  \n  const value = useMemo(() => state, [state])\n  return (\n    <WebsiteStateContext.Provider value={value}>\n      <WebsiteDispatchContext.Provider value={dispatch}>{children}</WebsiteDispatchContext.Provider>\n    </WebsiteStateContext.Provider>\n  )\n}\n\nexport function useWebsiteState() {\n  const context = useContext(WebsiteStateContext)\n  if (!context) {\n    throw new Error('useWebsiteState must be used within WebsiteProvider')\n  }\n  return context\n}\n\nexport function useWebsiteDispatch() {\n  const context = useContext(WebsiteDispatchContext)\n  if (!context) {\n    throw new Error('useWebsiteDispatch must be used within WebsiteProvider')\n  }\n  return context\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\hooks\\useWebsiteApi.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used.","line":483,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":483,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[13153,13157],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used.","line":529,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":529,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[14259,14263],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used.","line":543,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":543,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[14592,14596],"text":""},"desc":"Remove unused variable 'data'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Custom hook for Website API integration\n * Provides easy access to API functions with loading states and error handling\n * Completely separate from User module\n */\n\nimport { useState, useCallback } from 'react'\nimport { useWebsiteDispatch } from '../context/WebsiteContext'\nimport * as websiteApi from '../services/websiteApi'\n\nexport function useWebsiteApi() {\n  const dispatch = useWebsiteDispatch()\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  const handleApiCall = useCallback(\n    async (apiFunction, successAction, errorMessage, ...args) => {\n      setLoading(true)\n      setError(null)\n      try {\n        const result = await apiFunction(...args)\n        if (result.success) {\n          if (successAction) {\n            // Extract the actual data object from result.data before dispatching\n            dispatch(successAction(result.data))\n          }\n          return { data: result.data, error: null }\n        } else {\n          setError(result.error?.message || errorMessage || 'An error occurred')\n          return { data: null, error: result.error }\n        }\n      } catch (err) {\n        const errorMsg = err.error?.message || err.message || errorMessage || 'An unexpected error occurred'\n        setError(errorMsg)\n        return { data: null, error: { message: errorMsg } }\n      } finally {\n        setLoading(false)\n      }\n    },\n    [dispatch],\n  )\n\n  // Authentication APIs\n  const requestOTP = useCallback(\n    async (phone, language = 'en') => {\n      return handleApiCall(\n        () => websiteApi.requestOTP({ phone, language }),\n        null,\n        'Failed to send OTP',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const verifyOTP = useCallback(\n    async (phone, otp, sellerId = null) => {\n      return handleApiCall(\n        () => websiteApi.verifyOTP({ phone, otp, sellerId }),\n        (data) => ({\n          type: 'AUTH_LOGIN',\n          payload: {\n            ...data.user,\n            sellerId: data.user?.sellerId || sellerId,\n          },\n        }),\n        'Failed to verify OTP',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const loginWithOtp = useCallback(\n    async (phone, otp) => {\n      return handleApiCall(\n        () => websiteApi.loginWithOtp({ phone, otp }),\n        (data) => ({\n          type: 'AUTH_LOGIN',\n          payload: {\n            ...data.user,\n            sellerId: data.user?.sellerId || null,\n          },\n        }),\n        'Failed to login',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const register = useCallback(\n    async (fullName, phone, otp, sellerId = null) => {\n      return handleApiCall(\n        () => websiteApi.register({ fullName, phone, otp, sellerId }),\n        (data) => ({\n          type: 'AUTH_LOGIN',\n          payload: {\n            ...data.user,\n            sellerId: data.user?.sellerId || sellerId,\n          },\n        }),\n        'Failed to register',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const getSellerID = useCallback(\n    async () => {\n      return handleApiCall(\n        () => websiteApi.getSellerID(),\n        (data) => ({\n          type: 'UPDATE_SELLER_ID',\n          payload: data.sellerId,\n        }),\n        'Failed to get Seller ID',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Product APIs\n  const fetchProducts = useCallback(\n    async (params = {}) => {\n      return handleApiCall(\n        () => websiteApi.getProducts(params),\n        null,\n        'Failed to load products',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchProductDetails = useCallback(\n    async (productId) => {\n      return handleApiCall(\n        () => websiteApi.getProductDetails(productId),\n        null,\n        'Failed to load product details',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchCategories = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.getCategories,\n      null,\n      'Failed to load categories',\n    )\n  }, [handleApiCall])\n\n  const fetchPopularProducts = useCallback(\n    async (params = {}) => {\n      return handleApiCall(\n        () => websiteApi.getPopularProducts(params),\n        null,\n        'Failed to load popular products',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchOffers = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.getOffers,\n      null,\n      'Failed to load offers',\n    )\n  }, [handleApiCall])\n\n  const searchProducts = useCallback(\n    async (params = {}) => {\n      return handleApiCall(\n        () => websiteApi.searchProducts(params),\n        null,\n        'Failed to search products',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Helper function to resolve IDs (supports both _id and id fields)\n  const resolveId = useCallback((value) => {\n    if (!value) return ''\n    if (typeof value === 'string' || typeof value === 'number') return value.toString()\n    if (typeof value === 'object') {\n      if (value._id) return value._id.toString()\n      if (value.id) return value.id.toString()\n      if (typeof value.toString === 'function') return value.toString()\n    }\n    return ''\n  }, [])\n\n  // Map cart items from API response with variant handling\n  const mapCartItemsFromResponse = useCallback((cartData) => {\n    if (!cartData?.items) {\n      return []\n    }\n    \n    const mappedItems = cartData.items\n      .map((item) => {\n        const cartItemId = resolveId(item.id || item._id)\n        const product = item.product || item.productId || {}\n        const productId = resolveId(product.id || product._id || item.productId)\n        \n        if (!productId) {\n          return null\n        }\n        \n        // Use variant-specific price (unitPrice) if available, otherwise fallback\n        const price =\n          typeof item.unitPrice === 'number'\n            ? item.unitPrice\n            : typeof product.priceToUser === 'number'\n              ? product.priceToUser\n              : typeof product.price === 'number'\n                ? product.price\n                : 0\n        \n        // Extract variant attributes if present\n        const variantAttributes = item.variantAttributes || null\n        \n        const mappedItem = {\n          id: cartItemId,\n          cartItemId,\n          productId,\n          name: product.name || item.productName || 'Unknown Product',\n          price,\n          unitPrice: item.unitPrice || price,\n          image: item.image || product.images?.[0]?.url || product.primaryImage || product.image || '',\n          quantity: item.quantity || 1,\n          vendor: product.vendor || null,\n          deliveryTime: product.deliveryTime || null,\n          variantAttributes: variantAttributes,\n        }\n        \n        return mappedItem\n      })\n      .filter(Boolean)\n    \n    return mappedItems\n  }, [resolveId])\n\n  // Sync cart state helper\n  const syncCartState = useCallback((cartData) => {\n    const items = mapCartItemsFromResponse(cartData)\n    dispatch({ type: 'SET_CART_ITEMS', payload: items })\n  }, [mapCartItemsFromResponse, dispatch])\n\n  // Cart APIs\n  const addToCart = useCallback(\n    async (productId, quantity, variantAttributes = null) => {\n      const payload = { productId, quantity }\n      if (variantAttributes && Object.keys(variantAttributes).length > 0) {\n        payload.attributes = variantAttributes\n      }\n      \n      setLoading(true)\n      setError(null)\n      try {\n        const result = await websiteApi.addToCart(payload)\n        if (result.success) {\n          // Sync cart state after successful add\n          if (result.data?.cart) {\n            syncCartState(result.data.cart)\n          }\n          return { data: result.data, error: null }\n        } else {\n          setError(result.error?.message || 'Failed to add to cart')\n          return { data: null, error: result.error }\n        }\n      } catch (err) {\n        const errorMsg = err.error?.message || err.message || 'Failed to add to cart'\n        setError(errorMsg)\n        return { data: null, error: { message: errorMsg } }\n      } finally {\n        setLoading(false)\n      }\n    },\n    [syncCartState],\n  )\n\n  const updateCartItem = useCallback(\n    async (itemId, quantity) => {\n      setLoading(true)\n      setError(null)\n      try {\n        const result = await websiteApi.updateCartItem(itemId, { quantity })\n        if (result.success) {\n          // Sync cart state after successful update\n          if (result.data?.cart) {\n            syncCartState(result.data.cart)\n          }\n          return { data: result.data, error: null }\n        } else {\n          setError(result.error?.message || 'Failed to update cart')\n          return { data: null, error: result.error }\n        }\n      } catch (err) {\n        const errorMsg = err.error?.message || err.message || 'Failed to update cart'\n        setError(errorMsg)\n        return { data: null, error: { message: errorMsg } }\n      } finally {\n        setLoading(false)\n      }\n    },\n    [syncCartState],\n  )\n\n  const removeFromCart = useCallback(\n    async (itemId) => {\n      setLoading(true)\n      setError(null)\n      try {\n        const result = await websiteApi.removeFromCart(itemId)\n        if (result.success) {\n          // Sync cart state after successful remove\n          if (result.data?.cart) {\n            syncCartState(result.data.cart)\n          }\n          return { data: result.data, error: null }\n        } else {\n          setError(result.error?.message || 'Failed to remove from cart')\n          return { data: null, error: result.error }\n        }\n      } catch (err) {\n        const errorMsg = err.error?.message || err.message || 'Failed to remove from cart'\n        setError(errorMsg)\n        return { data: null, error: { message: errorMsg } }\n      } finally {\n        setLoading(false)\n      }\n    },\n    [syncCartState],\n  )\n\n  const fetchCart = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.getCart,\n      null, // Don't auto-dispatch, handle manually\n      'Failed to load cart',\n    )\n  }, [handleApiCall])\n\n  const validateCart = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.validateCart,\n      null,\n      'Failed to validate cart',\n    )\n  }, [handleApiCall])\n\n  const clearCart = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.clearCart,\n      null,\n      'Failed to clear cart',\n    )\n  }, [handleApiCall])\n\n  // Vendor Assignment APIs\n  const assignVendor = useCallback(\n    async (location) => {\n      return handleApiCall(\n        () => websiteApi.getAssignedVendor({ location }),\n        (data) => ({\n          type: 'SET_ASSIGNED_VENDOR',\n          payload: data.vendor,\n        }),\n        'Failed to assign vendor',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const checkVendorStock = useCallback(\n    async (vendorId, productIds) => {\n      return handleApiCall(\n        () => websiteApi.checkVendorStock({ vendorId, productIds }),\n        null,\n        'Failed to check vendor stock',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Order APIs\n  const createOrder = useCallback(\n    async (orderData) => {\n      return handleApiCall(\n        () => websiteApi.createOrder(orderData),\n        (data) => ({\n          type: 'ADD_ORDER',\n          payload: data.order || data,\n        }),\n        'Failed to create order',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchOrders = useCallback(\n    async (params = {}) => {\n      return handleApiCall(\n        () => websiteApi.getOrders(params),\n        null,\n        'Failed to load orders',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchOrderDetails = useCallback(\n    async (orderId) => {\n      return handleApiCall(\n        () => websiteApi.getOrderDetails(orderId),\n        null,\n        'Failed to load order details',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const trackOrder = useCallback(\n    async (orderId) => {\n      return handleApiCall(\n        () => websiteApi.trackOrder(orderId),\n        null,\n        'Failed to track order',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const cancelOrder = useCallback(\n    async (orderId, reason = '') => {\n      return handleApiCall(\n        () => websiteApi.cancelOrder(orderId, { reason }),\n        null,\n        'Failed to cancel order',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Payment APIs\n  const createPaymentIntent = useCallback(\n    async (data) => {\n      return handleApiCall(\n        () => websiteApi.createPaymentIntent(data),\n        null,\n        'Failed to create payment intent',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const confirmPayment = useCallback(\n    async (paymentData) => {\n      return handleApiCall(\n        () => websiteApi.confirmPayment(paymentData),\n        null,\n        'Failed to confirm payment',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const createRemainingPaymentIntent = useCallback(\n    async (orderId, paymentMethod) => {\n      return handleApiCall(\n        () => websiteApi.createRemainingPaymentIntent({ orderId, paymentMethod }),\n        null,\n        'Failed to create remaining payment intent',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const confirmRemainingPayment = useCallback(\n    async (paymentData) => {\n      return handleApiCall(\n        () => websiteApi.confirmRemainingPayment(paymentData),\n        (data) => ({\n          type: 'UPDATE_ORDER',\n          payload: {\n            id: paymentData.orderId,\n            paymentStatus: 'fully_paid',\n          },\n        }),\n        'Failed to confirm remaining payment',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Address APIs\n  const addAddress = useCallback(\n    async (addressData) => {\n      return handleApiCall(\n        () => websiteApi.addAddress(addressData),\n        (data) => ({\n          type: 'ADD_ADDRESS',\n          payload: data.address || data,\n        }),\n        'Failed to add address',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const updateAddress = useCallback(\n    async (addressId, addressData) => {\n      return handleApiCall(\n        () => websiteApi.updateAddress(addressId, addressData),\n        (data) => ({\n          type: 'UPDATE_ADDRESS',\n          payload: { id: addressId, ...data },\n        }),\n        'Failed to update address',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const deleteAddress = useCallback(\n    async (addressId) => {\n      return handleApiCall(\n        () => websiteApi.deleteAddress(addressId),\n        (data) => ({\n          type: 'DELETE_ADDRESS',\n          payload: { id: addressId },\n        }),\n        'Failed to delete address',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const setDefaultAddress = useCallback(\n    async (addressId) => {\n      return handleApiCall(\n        () => websiteApi.setDefaultAddress(addressId),\n        (data) => ({\n          type: 'SET_DEFAULT_ADDRESS',\n          payload: { id: addressId },\n        }),\n        'Failed to set default address',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchAddresses = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.getAddresses,\n      null,\n      'Failed to load addresses',\n    )\n  }, [handleApiCall])\n\n  // Favourites APIs\n  const addToFavourites = useCallback(\n    async (productId) => {\n      return handleApiCall(\n        () => websiteApi.addToFavourites({ productId }),\n        () => ({\n          type: 'ADD_TO_FAVOURITES',\n          payload: { productId },\n        }),\n        'Failed to add to favourites',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const removeFromFavourites = useCallback(\n    async (productId) => {\n      return handleApiCall(\n        () => websiteApi.removeFromFavourites(productId),\n        () => ({\n          type: 'REMOVE_FROM_FAVOURITES',\n          payload: { productId },\n        }),\n        'Failed to remove from favourites',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const fetchFavourites = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.getFavourites,\n      null,\n      'Failed to load favourites',\n    )\n  }, [handleApiCall])\n\n  // Profile APIs\n  const fetchUserProfile = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.getUserProfile,\n      (data) => ({\n        type: 'AUTH_LOGIN',\n        payload: data.user || data,\n      }),\n      'Failed to load profile',\n    )\n  }, [handleApiCall])\n\n  const updateUserProfile = useCallback(\n    async (profileData) => {\n      return handleApiCall(\n        () => websiteApi.updateUserProfile(profileData),\n        (data) => ({\n          type: 'AUTH_LOGIN',\n          payload: data.user || data,\n        }),\n        'Failed to update profile',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Phone update APIs\n  const requestOTPForCurrentPhone = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.requestOTPForCurrentPhone,\n      null,\n      'Failed to request OTP for current phone',\n    )\n  }, [handleApiCall])\n\n  const verifyOTPForCurrentPhone = useCallback(\n    async (otp) => {\n      return handleApiCall(\n        () => websiteApi.verifyOTPForCurrentPhone({ otp }),\n        null,\n        'Failed to verify OTP for current phone',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const requestOTPForNewPhone = useCallback(\n    async (newPhone) => {\n      return handleApiCall(\n        () => websiteApi.requestOTPForNewPhone({ newPhone }),\n        null,\n        'Failed to request OTP for new phone',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const verifyOTPForNewPhone = useCallback(\n    async (otp) => {\n      return handleApiCall(\n        () => websiteApi.verifyOTPForNewPhone({ otp }),\n        (data) => ({\n          type: 'AUTH_LOGIN',\n          payload: data.user || data,\n        }),\n        'Failed to verify OTP for new phone',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Support APIs\n  const createSupportTicket = useCallback(\n    async (ticketData) => {\n      return handleApiCall(\n        () => websiteApi.createSupportTicket(ticketData),\n        null,\n        'Failed to create support ticket',\n      )\n    },\n    [handleApiCall],\n  )\n\n  const initiateSupportCall = useCallback(\n    async (orderId, issue) => {\n      return handleApiCall(\n        () => websiteApi.initiateSupportCall({ orderId, issue }),\n        null,\n        'Failed to initiate support call',\n      )\n    },\n    [handleApiCall],\n  )\n\n  // Logout\n  const logout = useCallback(async () => {\n    return handleApiCall(\n      websiteApi.websiteLogout,\n      () => ({ type: 'AUTH_LOGOUT' }),\n      'Failed to logout',\n    )\n  }, [handleApiCall])\n\n  return {\n    loading,\n    error,\n    requestOTP,\n    verifyOTP,\n    loginWithOtp,\n    register,\n    getSellerID,\n    fetchProducts,\n    fetchProductDetails,\n    fetchCategories,\n    fetchPopularProducts,\n    fetchOffers,\n    searchProducts,\n    fetchCart,\n    addToCart,\n    updateCartItem,\n    removeFromCart,\n    clearCart,\n    validateCart,\n    assignVendor,\n    checkVendorStock,\n    createOrder,\n    fetchOrders,\n    fetchOrderDetails,\n    trackOrder,\n    cancelOrder,\n    createPaymentIntent,\n    confirmPayment,\n    createRemainingPaymentIntent,\n    confirmRemainingPayment,\n    fetchAddresses,\n    addAddress,\n    updateAddress,\n    deleteAddress,\n    setDefaultAddress,\n    fetchFavourites,\n    addToFavourites,\n    removeFromFavourites,\n    fetchUserProfile,\n    updateUserProfile,\n    requestOTPForCurrentPhone,\n    verifyOTPForCurrentPhone,\n    requestOTPForNewPhone,\n    verifyOTPForNewPhone,\n    createSupportTicket,\n    initiateSupportCall,\n    logout,\n  }\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\AccountPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'profile' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":63,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"profile"},"fix":{"range":[2074,2082],"text":""},"desc":"Remove unused variable 'profile'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'profile' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":527,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":527,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"profile"},"fix":{"range":[21589,21597],"text":""},"desc":"Remove unused variable 'profile'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'addresses' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":527,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":527,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"addresses"},"fix":{"range":[21596,21607],"text":""},"desc":"Remove unused variable 'addresses'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'navigate' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":570,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":570,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"navigate"},"fix":{"range":[23137,23167],"text":""},"desc":"Remove unused variable 'navigate'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Layout, Container } from '../components/Layout'\nimport { useState, useMemo, useEffect } from 'react'\nimport { useWebsiteState, useWebsiteDispatch } from '../context/WebsiteContext'\nimport { Link, Outlet, useNavigate, useLocation } from 'react-router-dom'\nimport { useWebsiteApi } from '../hooks/useWebsiteApi'\nimport { getPrimaryImageUrl } from '../utils/productImages'\nimport { cn } from '../../../lib/cn'\nimport { openRazorpayCheckout } from '../../../utils/razorpay'\nimport * as websiteApi from '../services/websiteApi'\nimport '../styles/website.css'\n\nconst FILTER_TABS = [\n  { id: 'all', label: 'All' },\n  { id: 'awaiting', label: 'Awaiting' },\n  { id: 'dispatched', label: 'Dispatched' },\n  { id: 'delivered', label: 'Delivered' },\n  { id: 'added_to_cart', label: 'In Cart' },\n]\n\nconst USER_ORDER_STATUSES = ['awaiting', 'dispatched', 'delivered']\nconst STATUS_LABELS = {\n  awaiting: 'Awaiting',\n  dispatched: 'Dispatched',\n  delivered: 'Delivered',\n}\nconst STATUS_DESCRIPTIONS = {\n  awaiting: 'Vendor is confirming stock and assigning a delivery partner.',\n  dispatched: 'Order handed over for delivery. Track updates in real time.',\n  delivered: 'Order delivered. Complete remaining payment if pending.',\n}\n\nconst getStatusKey = (status) => {\n  if (!status) return 'awaiting'\n  const normalized = status.toLowerCase()\n  if (normalized.includes('deliver')) return 'delivered'\n  if (normalized.includes('dispatch')) return 'dispatched'\n  if (normalized.includes('await')) return 'awaiting'\n  return normalized\n}\n\nconst getDisplayStatus = (status) => {\n  if (status === 'added_to_cart') return 'In Cart'\n  const key = getStatusKey(status)\n  return STATUS_LABELS[key] || key.charAt(0).toUpperCase() + key.slice(1)\n}\n\nconst formatTimelineTimestamp = (timestamp) => {\n  if (!timestamp) return ''\n  try {\n    const date = new Date(timestamp)\n    return date.toLocaleString('en-IN', {\n      day: 'numeric',\n      month: 'short',\n      hour: 'numeric',\n      minute: '2-digit',\n    })\n  } catch {\n    return timestamp\n  }\n}\n\nexport function AccountPage() {\n  const { profile, authenticated } = useWebsiteState()\n  const location = useLocation()\n  const [activeSection, setActiveSection] = useState(() => {\n    if (location.pathname.includes('/orders')) return 'orders'\n    if (location.pathname.includes('/addresses')) return 'addresses'\n    if (location.pathname.includes('/support')) return 'support'\n    return 'profile'\n  })\n\n  if (!authenticated) {\n    return (\n      <Layout>\n        <Container>\n          <div className=\"account-page__not-logged-in\">\n            <p>Please log in to access your account</p>\n            <Link to=\"/login\">Login</Link>\n          </div>\n        </Container>\n      </Layout>\n    )\n  }\n\n  return (\n    <Layout>\n      <Container className=\"account-page\">\n        <div className=\"account-page__layout\">\n          {/* Sidebar Navigation - Desktop */}\n          <aside className=\"account-page__sidebar\">\n            <nav className=\"account-page__nav\">\n              <Link \n                to=\"/account/profile\" \n                className={cn('account-page__nav-link', activeSection === 'profile' && 'account-page__nav-link--active')}\n                onClick={() => setActiveSection('profile')}\n              >\n                Profile\n              </Link>\n              <Link \n                to=\"/account/orders\" \n                className={cn('account-page__nav-link', activeSection === 'orders' && 'account-page__nav-link--active')}\n                onClick={() => setActiveSection('orders')}\n              >\n                Orders\n              </Link>\n              <Link \n                to=\"/account/addresses\" \n                className={cn('account-page__nav-link', activeSection === 'addresses' && 'account-page__nav-link--active')}\n                onClick={() => setActiveSection('addresses')}\n              >\n                Addresses\n              </Link>\n              <Link \n                to=\"/account/support\" \n                className={cn('account-page__nav-link', activeSection === 'support' && 'account-page__nav-link--active')}\n                onClick={() => setActiveSection('support')}\n              >\n                Support\n              </Link>\n            </nav>\n          </aside>\n\n          {/* Main Content */}\n          <main className=\"account-page__content\">\n            <Outlet />\n          </main>\n        </div>\n      </Container>\n    </Layout>\n  )\n}\n\nexport function AccountProfilePage() {\n  const { profile } = useWebsiteState()\n  const dispatch = useWebsiteDispatch()\n  const { updateUserProfile } = useWebsiteApi()\n  const [editingName, setEditingName] = useState(false)\n  const [editedName, setEditedName] = useState(profile?.name || '')\n  const [showPhoneUpdatePanel, setShowPhoneUpdatePanel] = useState(false)\n  const [phoneUpdateStep, setPhoneUpdateStep] = useState(1) // 1: request current OTP, 2: verify current OTP, 3: enter new phone, 4: request new OTP, 5: verify new OTP\n  const [currentPhoneOTP, setCurrentPhoneOTP] = useState('')\n  const [newPhone, setNewPhone] = useState('')\n  const [newPhoneOTP, setNewPhoneOTP] = useState('')\n  const [phoneUpdateLoading, setPhoneUpdateLoading] = useState(false)\n\n  // Update edited name when profile changes\n  useEffect(() => {\n    if (profile?.name) {\n      setEditedName(profile.name)\n    }\n  }, [profile?.name])\n\n  const handleSaveName = async () => {\n    if (!editedName.trim()) {\n      alert('Name cannot be empty')\n      return\n    }\n    \n    try {\n      const result = await updateUserProfile({ name: editedName.trim() })\n      setEditingName(false)\n      \n      if (result && !result.error && result.data) {\n        dispatch({\n          type: 'AUTH_LOGIN',\n          payload: { ...profile, name: result.data.user?.name || editedName.trim() },\n        })\n        alert('Name updated successfully')\n      } else {\n        alert(result?.error?.message || result?.data?.message || 'Failed to update name')\n      }\n    } catch (error) {\n      console.error('Error updating name:', error)\n      setEditingName(false)\n      alert(error?.error?.message || error?.message || 'Failed to update name')\n    }\n  }\n\n  return (\n    <div className=\"account-profile\">\n      <div className=\"account-profile__header\">\n        <div className=\"account-profile__avatar\">\n          <svg className=\"h-12 w-12\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n          </svg>\n        </div>\n        <div className=\"account-profile__info\">\n          <h2 className=\"account-profile__name\">{profile?.name || 'User'}</h2>\n          <p className=\"account-profile__email\">{profile?.email || profile?.phone || 'No contact info'}</p>\n        </div>\n      </div>\n\n      <div className=\"account-profile__section\">\n        <h3 className=\"account-profile__section-title\">Personal Information</h3>\n        \n        {/* Name Field */}\n        <div className=\"account-profile__field\">\n          <label className=\"account-profile__field-label\">Full Name</label>\n          <div className=\"account-profile__field-content\">\n            {editingName ? (\n              <div className=\"account-profile__field-edit\">\n                <input\n                  type=\"text\"\n                  value={editedName}\n                  onChange={(e) => setEditedName(e.target.value)}\n                  className=\"account-profile__field-input\"\n                  placeholder=\"Enter your name\"\n                  autoFocus\n                />\n                <div className=\"account-profile__field-actions\">\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setEditedName(profile?.name || '')\n                      setEditingName(false)\n                    }}\n                    className=\"account-profile__field-cancel\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={handleSaveName}\n                    className=\"account-profile__field-save\"\n                  >\n                    Save\n                  </button>\n                </div>\n              </div>\n            ) : (\n              <>\n                <span className=\"account-profile__field-value\">{profile?.name || 'Not set'}</span>\n                <button\n                  type=\"button\"\n                  onClick={() => setEditingName(true)}\n                  className=\"account-profile__field-edit-btn\"\n                >\n                  <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n                  </svg>\n                  Edit\n                </button>\n              </>\n            )}\n          </div>\n        </div>\n\n        {/* Phone Field */}\n        <div className=\"account-profile__field\">\n          <label className=\"account-profile__field-label\">Phone Number</label>\n          <div className=\"account-profile__field-content\">\n            <span className=\"account-profile__field-value\">{profile?.phone || 'Not set'}</span>\n            <button\n              type=\"button\"\n              onClick={() => {\n                setPhoneUpdateStep(1)\n                setShowPhoneUpdatePanel(true)\n                setCurrentPhoneOTP('')\n                setNewPhone('')\n                setNewPhoneOTP('')\n              }}\n              className=\"account-profile__field-edit-btn\"\n            >\n              <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n              </svg>\n              Update\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Phone Update Panel */}\n      {showPhoneUpdatePanel && (\n        <div\n          className=\"account-profile__panel\"\n          onClick={(e) => {\n            if (e.target === e.currentTarget) {\n              setShowPhoneUpdatePanel(false)\n              setPhoneUpdateStep(1)\n              setCurrentPhoneOTP('')\n              setNewPhone('')\n              setNewPhoneOTP('')\n            }\n          }}\n        >\n          <div className=\"account-profile__panel-content\">\n            <div className=\"account-profile__panel-header\">\n              <h3 className=\"account-profile__panel-title\">Update Phone Number</h3>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setShowPhoneUpdatePanel(false)\n                  setPhoneUpdateStep(1)\n                  setCurrentPhoneOTP('')\n                  setNewPhone('')\n                  setNewPhoneOTP('')\n                }}\n                className=\"account-profile__panel-close\"\n              >\n                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n            </div>\n            <div className=\"account-profile__panel-body\">\n              {/* Step 1: Request OTP for current phone */}\n              {phoneUpdateStep === 1 && (\n                <div className=\"account-profile__panel-step\">\n                  <div className=\"account-profile__panel-info\">\n                    <p>We'll send an OTP to your current phone number <strong>{profile?.phone}</strong> to verify your identity.</p>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={async () => {\n                      setPhoneUpdateLoading(true)\n                      try {\n                        const result = await websiteApi.requestOTPForCurrentPhone()\n                        if (result.success) {\n                          alert('OTP sent to your current phone number')\n                          setPhoneUpdateStep(2)\n                        } else {\n                          alert(result.message || 'Failed to send OTP')\n                        }\n                      } catch (error) {\n                        console.error('Error requesting OTP:', error)\n                        alert(error.error?.message || 'Failed to send OTP')\n                      } finally {\n                        setPhoneUpdateLoading(false)\n                      }\n                    }}\n                    disabled={phoneUpdateLoading}\n                    className=\"account-profile__panel-button\"\n                  >\n                    {phoneUpdateLoading ? 'Sending...' : 'Send OTP to Current Phone'}\n                  </button>\n                </div>\n              )}\n\n              {/* Step 2: Verify OTP for current phone */}\n              {phoneUpdateStep === 2 && (\n                <div className=\"account-profile__panel-step\">\n                  <div className=\"account-profile__panel-info\">\n                    <p>Enter the OTP sent to <strong>{profile?.phone}</strong></p>\n                  </div>\n                  <input\n                    type=\"text\"\n                    value={currentPhoneOTP}\n                    onChange={(e) => setCurrentPhoneOTP(e.target.value.replace(/\\D/g, '').slice(0, 6))}\n                    placeholder=\"Enter 6-digit OTP\"\n                    maxLength={6}\n                    className=\"account-profile__panel-input\"\n                  />\n                  <div className=\"account-profile__panel-actions\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setPhoneUpdateStep(1)}\n                      className=\"account-profile__panel-button account-profile__panel-button--secondary\"\n                    >\n                      Back\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={async () => {\n                        if (!currentPhoneOTP || currentPhoneOTP.length !== 6) {\n                          alert('Please enter a valid 6-digit OTP')\n                          return\n                        }\n                        setPhoneUpdateLoading(true)\n                        try {\n                          const result = await websiteApi.verifyOTPForCurrentPhone({ otp: currentPhoneOTP })\n                          if (result.success) {\n                            alert('Current phone verified successfully')\n                            setPhoneUpdateStep(3)\n                          } else {\n                            alert(result.message || 'Invalid OTP')\n                          }\n                        } catch (error) {\n                          console.error('Error verifying OTP:', error)\n                          alert(error.error?.message || 'Invalid OTP')\n                        } finally {\n                          setPhoneUpdateLoading(false)\n                        }\n                      }}\n                      disabled={phoneUpdateLoading || !currentPhoneOTP || currentPhoneOTP.length !== 6}\n                      className=\"account-profile__panel-button\"\n                    >\n                      {phoneUpdateLoading ? 'Verifying...' : 'Verify OTP'}\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              {/* Step 3: Enter new phone number */}\n              {phoneUpdateStep === 3 && (\n                <div className=\"account-profile__panel-step\">\n                  <div className=\"account-profile__panel-info\">\n                    <p>Current phone verified! Now enter your new phone number.</p>\n                  </div>\n                  <input\n                    type=\"tel\"\n                    value={newPhone}\n                    onChange={(e) => setNewPhone(e.target.value.replace(/\\D/g, ''))}\n                    placeholder=\"Enter new phone number\"\n                    className=\"account-profile__panel-input\"\n                  />\n                  <div className=\"account-profile__panel-actions\">\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        setPhoneUpdateStep(2)\n                        setNewPhone('')\n                      }}\n                      className=\"account-profile__panel-button account-profile__panel-button--secondary\"\n                    >\n                      Back\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={async () => {\n                        if (!newPhone || newPhone.length < 10) {\n                          alert('Please enter a valid phone number')\n                          return\n                        }\n                        if (newPhone === profile?.phone) {\n                          alert('New phone number must be different from current phone number')\n                          return\n                        }\n                        setPhoneUpdateLoading(true)\n                        try {\n                          const result = await websiteApi.requestOTPForNewPhone({ newPhone })\n                          if (result.success) {\n                            alert('OTP sent to your new phone number')\n                            setPhoneUpdateStep(4)\n                          } else {\n                            alert(result.message || 'Failed to send OTP')\n                          }\n                        } catch (error) {\n                          console.error('Error requesting OTP:', error)\n                          alert(error.error?.message || 'Failed to send OTP')\n                        } finally {\n                          setPhoneUpdateLoading(false)\n                        }\n                      }}\n                      disabled={phoneUpdateLoading || !newPhone || newPhone.length < 10}\n                      className=\"account-profile__panel-button\"\n                    >\n                      {phoneUpdateLoading ? 'Sending...' : 'Send OTP to New Phone'}\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              {/* Step 4: Verify OTP for new phone */}\n              {phoneUpdateStep === 4 && (\n                <div className=\"account-profile__panel-step\">\n                  <div className=\"account-profile__panel-info\">\n                    <p>Enter the OTP sent to <strong>{newPhone}</strong></p>\n                  </div>\n                  <input\n                    type=\"text\"\n                    value={newPhoneOTP}\n                    onChange={(e) => setNewPhoneOTP(e.target.value.replace(/\\D/g, '').slice(0, 6))}\n                    placeholder=\"Enter 6-digit OTP\"\n                    maxLength={6}\n                    className=\"account-profile__panel-input\"\n                  />\n                  <div className=\"account-profile__panel-actions\">\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        setPhoneUpdateStep(3)\n                        setNewPhoneOTP('')\n                      }}\n                      className=\"account-profile__panel-button account-profile__panel-button--secondary\"\n                    >\n                      Back\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={async () => {\n                        if (!newPhoneOTP || newPhoneOTP.length !== 6) {\n                          alert('Please enter a valid 6-digit OTP')\n                          return\n                        }\n                        setPhoneUpdateLoading(true)\n                        try {\n                          const result = await websiteApi.verifyOTPForNewPhone({ otp: newPhoneOTP })\n                          if (result.success) {\n                            alert('Phone number updated successfully')\n                            dispatch({\n                              type: 'AUTH_LOGIN',\n                              payload: { ...profile, phone: result.data?.user?.phone || newPhone },\n                            })\n                            setShowPhoneUpdatePanel(false)\n                            setPhoneUpdateStep(1)\n                            setCurrentPhoneOTP('')\n                            setNewPhone('')\n                            setNewPhoneOTP('')\n                          } else {\n                            alert(result.message || 'Invalid OTP')\n                          }\n                        } catch (error) {\n                          console.error('Error verifying OTP:', error)\n                          alert(error.error?.message || 'Invalid OTP')\n                        } finally {\n                          setPhoneUpdateLoading(false)\n                        }\n                      }}\n                      disabled={phoneUpdateLoading || !newPhoneOTP || newPhoneOTP.length !== 6}\n                      className=\"account-profile__panel-button\"\n                    >\n                      {phoneUpdateLoading ? 'Updating...' : 'Update Phone Number'}\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport function AccountAddressesPage() {\n  const { profile, addresses } = useWebsiteState()\n  \n  return (\n    <div className=\"account-addresses\">\n      <h2 className=\"account-addresses__title\">Delivery Addresses</h2>\n      <p className=\"account-addresses__description\">\n        Manage your delivery addresses for faster checkout.\n      </p>\n      {/* Address management will be implemented in a future enhancement */}\n    </div>\n  )\n}\n\nexport function AccountSupportPage() {\n  return (\n    <div className=\"account-support\">\n      <h2 className=\"account-support__title\">Support & Help</h2>\n      <div className=\"account-support__sections\">\n        <div className=\"account-support__section\">\n          <h3 className=\"account-support__section-title\">Help Center</h3>\n          <p className=\"account-support__section-text\">\n            Browse FAQs and guides to find answers to common questions.\n          </p>\n          <button className=\"account-support__button\">Visit Help Center</button>\n        </div>\n        <div className=\"account-support__section\">\n          <h3 className=\"account-support__section-title\">Contact Support</h3>\n          <p className=\"account-support__section-text\">\n            <strong>Phone:</strong> +91 1800-XXX-XXXX\n          </p>\n          <p className=\"account-support__section-text\">\n            <strong>Email:</strong> support@irasathi.com\n          </p>\n          <p className=\"account-support__section-text\">\n            <strong>Hours:</strong> Mon-Sat, 9 AM - 6 PM\n          </p>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport function AccountOrdersPage() {\n  const navigate = useNavigate()\n  const { orders, cart } = useWebsiteState()\n  const { createRemainingPaymentIntent, confirmRemainingPayment } = useWebsiteApi()\n  const [activeFilter, setActiveFilter] = useState('all')\n  const [processingPayment, setProcessingPayment] = useState(null)\n\n  // Combine orders and cart items\n  const allItems = useMemo(() => {\n    const orderItems = orders.map((order) => {\n      const normalizedStatus = getStatusKey(order.status)\n      return {\n        ...order,\n        type: 'order',\n        status: normalizedStatus,\n        statusTimeline: order.statusTimeline || [],\n      }\n    })\n\n    // Add cart items as \"added_to_cart\" status\n    const cartItems = cart.length > 0\n      ? [\n          {\n            id: 'cart',\n            type: 'cart',\n            status: 'added_to_cart',\n            date: new Date().toISOString(),\n            items: cart,\n            total: cart.reduce((sum, item) => {\n              const price = item.unitPrice || item.price || 0\n              return sum + price * item.quantity\n            }, 0),\n            paymentStatus: 'pending',\n          },\n        ]\n      : []\n\n    return [...cartItems, ...orderItems]\n  }, [orders, cart])\n\n  // Filter items based on active filter\n  const filteredItems = useMemo(() => {\n    if (activeFilter === 'all') {\n      return allItems\n    }\n    if (activeFilter === 'added_to_cart') {\n      return allItems.filter((item) => item.status === 'added_to_cart')\n    }\n    return allItems.filter((item) => item.status === activeFilter)\n  }, [allItems, activeFilter])\n\n  const getStatusIcon = (status) => {\n    if (status === 'added_to_cart') {\n      return (\n        <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\" />\n        </svg>\n      )\n    }\n    const key = getStatusKey(status)\n    if (key === 'awaiting') {\n      return (\n        <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n        </svg>\n      )\n    }\n    if (key === 'dispatched') {\n      return (\n        <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n        </svg>\n      )\n    }\n    if (key === 'delivered') {\n      return (\n        <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n        </svg>\n      )\n    }\n    return (\n      <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\" />\n      </svg>\n    )\n  }\n\n  const getStatusColor = (status) => {\n    if (status === 'added_to_cart') return 'bg-blue-100 text-blue-700'\n    const key = getStatusKey(status)\n    if (key === 'awaiting') return 'bg-yellow-100 text-yellow-700'\n    if (key === 'dispatched') return 'bg-indigo-100 text-indigo-700'\n    if (key === 'delivered') return 'bg-green-100 text-[#1b8f5b]'\n    return 'bg-gray-100 text-gray-700'\n  }\n\n  const formatDate = (dateString) => {\n    if (!dateString) return 'N/A'\n    try {\n      const date = new Date(dateString)\n      return date.toLocaleDateString('en-IN', {\n        day: 'numeric',\n        month: 'short',\n        year: 'numeric',\n      })\n    } catch {\n      return dateString\n    }\n  }\n\n  const handlePayRemaining = async (order) => {\n    if (!order || !order.id) {\n      alert('Invalid order')\n      return\n    }\n\n    setProcessingPayment(order.id)\n\n    try {\n      // Create remaining payment intent\n      const paymentIntentResult = await createRemainingPaymentIntent(order.id, 'razorpay')\n\n      if (paymentIntentResult.error) {\n        alert(paymentIntentResult.error.message || 'Failed to initialize payment')\n        setProcessingPayment(null)\n        return\n      }\n\n      const { paymentIntent } = paymentIntentResult.data\n      const { razorpayOrderId, keyId, amount } = paymentIntent\n\n      // Open Razorpay Checkout for remaining payment\n      try {\n        const razorpayResponse = await openRazorpayCheckout({\n          key: keyId,\n          amount: amount,\n          currency: 'INR',\n          order_id: razorpayOrderId,\n          name: 'IRA SATHI',\n          description: `Remaining payment for Order ${order.orderNumber || order.id}`,\n          prefill: {\n            name: order.userName || '',\n            email: order.userEmail || '',\n            contact: order.userPhone || '',\n          },\n        })\n\n        // Confirm remaining payment with Razorpay response\n        const confirmResult = await confirmRemainingPayment({\n          orderId: order.id,\n          paymentIntentId: paymentIntent.id,\n          gatewayPaymentId: razorpayResponse.paymentId,\n          gatewayOrderId: razorpayResponse.orderId,\n          gatewaySignature: razorpayResponse.signature,\n          paymentMethod: 'razorpay',\n        })\n\n        if (confirmResult.error) {\n          alert(confirmResult.error.message || 'Payment failed')\n          setProcessingPayment(null)\n          return\n        }\n\n        alert(`Remaining payment of â‚¹${amount.toLocaleString('en-IN')} completed successfully!`)\n        setProcessingPayment(null)\n      } catch (razorpayError) {\n        if (razorpayError.error) {\n          alert(razorpayError.error || 'Payment was cancelled or failed')\n        } else {\n          alert('Payment was cancelled')\n        }\n        setProcessingPayment(null)\n      }\n    } catch (error) {\n      console.error('Error processing remaining payment:', error)\n      alert(error.message || 'An error occurred while processing payment')\n      setProcessingPayment(null)\n    }\n  }\n\n  const renderStatusTracker = (item) => {\n    if (item.type !== 'order') return null\n    const currentStatus = getStatusKey(item.status)\n    const currentIndex = USER_ORDER_STATUSES.indexOf(currentStatus)\n    return (\n      <div className=\"account-orders__tracker\">\n        {USER_ORDER_STATUSES.map((status, index) => {\n          const timelineEntry = item.statusTimeline?.find((entry) => entry.status === status)\n          return (\n            <div\n              key={`${item.id}-${status}`}\n              className={cn(\n                'account-orders__tracker-step',\n                index <= currentIndex && 'account-orders__tracker-step--active',\n              )}\n            >\n              <span className=\"account-orders__tracker-step-index\">{index + 1}</span>\n              <div className=\"account-orders__tracker-step-body\">\n                <p className=\"account-orders__tracker-step-title\">{STATUS_LABELS[status]}</p>\n                <p className=\"account-orders__tracker-step-desc\">{STATUS_DESCRIPTIONS[status]}</p>\n                {timelineEntry?.timestamp && (\n                  <p className=\"account-orders__tracker-step-time\">\n                    {formatTimelineTimestamp(timelineEntry.timestamp)}\n                  </p>\n                )}\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"account-orders\">\n      <div className=\"account-orders__header\">\n        <h2 className=\"account-orders__title\">My Orders</h2>\n      </div>\n\n      {/* Filter Tabs */}\n      <div className=\"account-orders__filters\">\n        {FILTER_TABS.map((tab) => (\n          <button\n            key={tab.id}\n            type=\"button\"\n            className={cn(\n              'account-orders__filter-tab',\n              activeFilter === tab.id && 'account-orders__filter-tab--active'\n            )}\n            onClick={() => setActiveFilter(tab.id)}\n          >\n            {tab.label}\n          </button>\n        ))}\n      </div>\n\n      {/* Orders List */}\n      <div className=\"account-orders__list\">\n        {filteredItems.length === 0 ? (\n          <div className=\"account-orders__empty\">\n            <p className=\"account-orders__empty-text\">No orders found</p>\n            {activeFilter === 'added_to_cart' && (\n              <Link to=\"/cart\" className=\"account-orders__empty-link\">\n                View Cart\n              </Link>\n            )}\n          </div>\n        ) : (\n          filteredItems.map((item) => (\n            <div key={item.id} className=\"account-orders__card\">\n              <div className=\"account-orders__card-header\">\n                <div className=\"account-orders__card-header-left\">\n                  <div className=\"account-orders__card-id\">\n                    {item.type === 'cart' ? 'Cart' : `Order #${item.id?.slice(-8) || 'N/A'}`}\n                  </div>\n                  <div className=\"account-orders__card-date\">{formatDate(item.date)}</div>\n                </div>\n                <div className={cn('account-orders__card-status', getStatusColor(item.status))}>\n                  {getStatusIcon(item.status)}\n                  <span className=\"account-orders__card-status-text\">\n                    {getDisplayStatus(item.status)}\n                  </span>\n                </div>\n              </div>\n\n              {renderStatusTracker(item)}\n\n              <div className=\"account-orders__card-items\">\n                {item.items?.map((orderItem, index) => {\n                  const variantAttrs = orderItem.variantAttributes || {}\n                  const variantKeys = Object.keys(variantAttrs)\n                  const hasVariants = variantKeys.length > 0\n                  const productName = orderItem.productName || orderItem.name || (orderItem.product?.name || 'Product')\n                  const unitPrice = orderItem.unitPrice || orderItem.price || 0\n                  \n                  return (\n                    <div key={index} className=\"account-orders__card-item\">\n                      <div className=\"account-orders__card-item-image\">\n                        <img\n                          src={orderItem.product ? getPrimaryImageUrl(orderItem.product) : (orderItem.image || 'https://via.placeholder.com/60')}\n                          alt={productName}\n                          className=\"w-full h-full object-cover\"\n                        />\n                      </div>\n                      <div className=\"account-orders__card-item-details\">\n                        <h4 className=\"account-orders__card-item-name\">{productName}</h4>\n                        {hasVariants && (\n                          <div className=\"account-orders__card-item-variants\">\n                            {variantKeys.map((key) => (\n                              <span key={key} className=\"text-xs text-gray-600\">\n                                {key}: {variantAttrs[key]}\n                              </span>\n                            ))}\n                          </div>\n                        )}\n                        <div className=\"account-orders__card-item-meta\">\n                          <span className=\"account-orders__card-item-quantity\">\n                            Qty: {orderItem.quantity}\n                          </span>\n                          <span className=\"account-orders__card-item-price\">\n                            â‚¹{unitPrice.toLocaleString('en-IN')}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n\n              <div className=\"account-orders__card-footer\">\n                {/* Order Amount Breakdown */}\n                <div className=\"account-orders__card-summary\">\n                  {item.subtotal !== undefined && (\n                    <div className=\"account-orders__card-summary-row\">\n                      <span>Subtotal:</span>\n                      <span>â‚¹{item.subtotal?.toLocaleString('en-IN') || '0'}</span>\n                    </div>\n                  )}\n                  {item.deliveryCharge !== undefined && item.deliveryCharge > 0 && (\n                    <div className=\"account-orders__card-summary-row\">\n                      <span>Delivery:</span>\n                      <span>â‚¹{item.deliveryCharge?.toLocaleString('en-IN') || '0'}</span>\n                    </div>\n                  )}\n                  <div className=\"account-orders__card-summary-row account-orders__card-summary-row--total\">\n                    <span>Total:</span>\n                    <span>â‚¹{(item.totalAmount || item.total || 0).toLocaleString('en-IN')}</span>\n                  </div>\n                </div>\n                \n                {/* Payment Status */}\n                {item.paymentStatus && item.paymentStatus !== 'fully_paid' && (\n                  <div className=\"account-orders__card-payment\">\n                    {item.paymentPreference === 'partial' && item.upfrontAmount !== undefined && (\n                      <div className=\"account-orders__card-summary-row\">\n                        <span>Advance (30%):</span>\n                        <span className=\"text-green-600\">â‚¹{item.upfrontAmount?.toLocaleString('en-IN') || '0'}</span>\n                      </div>\n                    )}\n                    {item.paymentPreference === 'partial' && item.remainingAmount !== undefined && (\n                      <div className=\"account-orders__card-summary-row\">\n                        <span>Remaining (70%):</span>\n                        <span className={cn(\n                          item.paymentStatus === 'partial_paid' ? 'text-orange-600' : 'text-red-600'\n                        )}>\n                          â‚¹{item.remainingAmount?.toLocaleString('en-IN') || '0'}\n                        </span>\n                      </div>\n                    )}\n                    <div className=\"account-orders__card-summary-row\">\n                      <span>Payment Status:</span>\n                      <span className={cn(\n                        'font-semibold',\n                        item.paymentStatus === 'partial_paid' && 'text-orange-600',\n                        item.paymentStatus === 'pending' && 'text-red-600'\n                      )}>\n                        {item.paymentStatus === 'partial_paid'\n                          ? 'Partial Paid'\n                          : item.paymentStatus === 'pending'\n                            ? 'Pending'\n                            : item.paymentStatus}\n                      </span>\n                    </div>\n                  </div>\n                )}\n                \n                {/* Pay Remaining Button */}\n                {item.status === 'delivered' && item.paymentStatus === 'partial_paid' && (item.remainingAmount || item.remaining) > 0 && (\n                  <button\n                    type=\"button\"\n                    onClick={() => handlePayRemaining(item)}\n                    disabled={processingPayment === item.id}\n                    className=\"account-orders__pay-button\"\n                  >\n                    {processingPayment === item.id\n                      ? 'Processing...'\n                      : `Pay Remaining â‚¹${((item.remainingAmount || item.remaining) || 0).toLocaleString('en-IN')}`}\n                  </button>\n                )}\n\n                {/* View Cart Button for cart items */}\n                {item.type === 'cart' && (\n                  <Link to=\"/cart\" className=\"account-orders__view-cart-button\">\n                    View Cart\n                  </Link>\n                )}\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\CartPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'dispatch' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":14,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'getProductDetails' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":16,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":75,"suggestions":[{"messageId":"removeVar","data":{"varName":"getProductDetails"},"fix":{"range":[740,759],"text":""},"desc":"Remove unused variable 'getProductDetails'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo, useState, useEffect, useRef } from 'react'\nimport { useNavigate, Link } from 'react-router-dom'\nimport { Layout, Container } from '../components/Layout'\nimport { useWebsiteState, useWebsiteDispatch } from '../context/WebsiteContext'\nimport { useWebsiteApi } from '../hooks/useWebsiteApi'\nimport { MIN_ORDER_VALUE } from '../services/websiteData'\nimport * as websiteApi from '../services/websiteApi'\nimport { getPrimaryImageUrl } from '../utils/productImages'\nimport { cn } from '../../../lib/cn'\nimport '../styles/website.css'\n\nexport function CartPage() {\n  const navigate = useNavigate()\n  const dispatch = useWebsiteDispatch()\n  const { cart } = useWebsiteState()\n  const { updateCartItem, removeFromCart, fetchProducts, getProductDetails, addToCart } = useWebsiteApi()\n  \n  const [suggestedProducts, setSuggestedProducts] = useState([])\n  const [cartProducts, setCartProducts] = useState({})\n  const [expandedVariants, setExpandedVariants] = useState({})\n  const fetchingProductsRef = useRef(new Set())\n\n  // Fetch suggested products\n  useEffect(() => {\n    const loadSuggested = async () => {\n      try {\n        const cartProductIds = cart.map((item) => item.productId)\n        const result = await fetchProducts({ limit: 20 })\n        if (result.data?.products) {\n          const available = result.data.products.filter(\n            (p) => !cartProductIds.includes(p._id || p.id)\n          )\n          const shuffled = [...available].sort(() => Math.random() - 0.5)\n          setSuggestedProducts(shuffled.slice(0, 8))\n        }\n      } catch (error) {\n        console.error('Error loading suggested products:', error)\n      }\n    }\n    \n    if (cart.length > 0) {\n      loadSuggested()\n    }\n  }, [cart, fetchProducts])\n\n  // Fetch product details for cart items\n  useEffect(() => {\n    const loadCartProducts = async () => {\n      setCartProducts(currentProducts => {\n        const productsToFetch = cart.filter(item => \n          !currentProducts[item.productId] && !fetchingProductsRef.current.has(item.productId)\n        )\n        \n        if (productsToFetch.length === 0) {\n          return currentProducts\n        }\n        \n        productsToFetch.forEach(item => fetchingProductsRef.current.add(item.productId))\n        \n        productsToFetch.forEach(async (item) => {\n          try {\n            const result = await websiteApi.getProductDetails(item.productId)\n            if (result.success && result.data?.product) {\n              setCartProducts(prev => ({\n                ...prev,\n                [item.productId]: result.data.product\n              }))\n            }\n          } catch (error) {\n            console.error(`Error loading product ${item.productId}:`, error)\n          } finally {\n            fetchingProductsRef.current.delete(item.productId)\n          }\n        })\n        \n        return currentProducts\n      })\n    }\n    \n    if (cart.length > 0) {\n      loadCartProducts()\n    } else {\n      setCartProducts({})\n      fetchingProductsRef.current.clear()\n    }\n  }, [cart])\n\n  // Group items by productId with variants\n  const groupedCartItems = useMemo(() => {\n    const grouped = {}\n    \n    cart.forEach((item) => {\n      const product = cartProducts[item.productId]\n      const unitPrice = item.unitPrice || item.price || (product ? (product.priceToUser || product.price || 0) : 0)\n      const variantAttrs = item.variantAttributes || {}\n      const hasVariants = variantAttrs && typeof variantAttrs === 'object' && Object.keys(variantAttrs).length > 0\n      const key = item.productId\n      \n      if (!grouped[key]) {\n        grouped[key] = {\n          productId: item.productId,\n          product,\n          name: item.name || product?.name || 'Product',\n          image: product ? getPrimaryImageUrl(product) : (item.image || 'https://via.placeholder.com/400'),\n          variants: [],\n          hasVariants: false,\n        }\n      }\n      \n      const variantItem = {\n        ...item,\n        id: item.id || item._id || item.cartItemId,\n        cartItemId: item.id || item._id || item.cartItemId,\n        product,\n        unitPrice,\n        variantAttributes: variantAttrs,\n        hasVariants,\n      }\n      \n      grouped[key].variants.push(variantItem)\n      \n      if (hasVariants) {\n        grouped[key].hasVariants = true\n      }\n    })\n    \n    return Object.values(grouped)\n  }, [cart, cartProducts])\n\n  const totals = useMemo(() => {\n    const subtotal = groupedCartItems.reduce((sum, group) => {\n      return sum + group.variants.reduce((variantSum, variant) => {\n        return variantSum + (variant.unitPrice * variant.quantity)\n      }, 0)\n    }, 0)\n    const delivery = subtotal >= 5000 ? 0 : 50\n    const total = subtotal + delivery\n    const meetsMinimum = total >= MIN_ORDER_VALUE\n\n    return {\n      subtotal,\n      delivery,\n      total,\n      meetsMinimum,\n      shortfall: meetsMinimum ? 0 : MIN_ORDER_VALUE - total,\n    }\n  }, [groupedCartItems])\n\n  const totalItemsCount = useMemo(() => {\n    return groupedCartItems.reduce((sum, group) => sum + group.variants.length, 0)\n  }, [groupedCartItems])\n\n  const handleUpdateQuantity = async (variantId, newQuantity) => {\n    if (newQuantity < 1) return\n    try {\n      await updateCartItem(variantId, newQuantity)\n    } catch (error) {\n      console.error('Error updating quantity:', error)\n    }\n  }\n\n  const handleRemove = async (cartItemId) => {\n    try {\n      await removeFromCart(cartItemId)\n    } catch (error) {\n      console.error('Error removing item:', error)\n    }\n  }\n\n  const handleAddSuggestedToCart = async (productId) => {\n    try {\n      await addToCart(productId, 1)\n    } catch (error) {\n      console.error('Error adding to cart:', error)\n    }\n  }\n\n  const handleCheckout = () => {\n    if (totals.meetsMinimum) {\n      navigate('/checkout')\n    }\n  }\n\n  if (groupedCartItems.length === 0) {\n    return (\n      <Layout>\n        <Container className=\"cart-page\">\n          <div className=\"cart-page__empty\">\n            <h1 className=\"cart-page__title\">Your cart is empty</h1>\n            <p className=\"cart-page__empty-text\">Add some products to get started</p>\n            <Link to=\"/products\" className=\"cart-page__continue\">\n              Continue Shopping\n            </Link>\n          </div>\n        </Container>\n      </Layout>\n    )\n  }\n\n  return (\n    <Layout>\n      <Container className=\"cart-page\">\n        <div className=\"cart-page__header\">\n          <h1 className=\"cart-page__title\">Shopping Cart</h1>\n          <p className=\"cart-page__count\">{totalItemsCount} {totalItemsCount === 1 ? 'item' : 'items'}</p>\n        </div>\n\n        <div className=\"cart-page__layout\">\n          {/* Left: Cart Items */}\n          <div className=\"cart-page__items\">\n            {groupedCartItems.map((group) => (\n              <div key={group.productId} className=\"cart-page__item-group\">\n                {/* Product Header */}\n                <div className=\"cart-page__item-header\">\n                  <div className=\"cart-page__item-image-wrapper\">\n                    <img src={group.image} alt={group.name} className=\"cart-page__item-image\" />\n                  </div>\n                  <div className=\"cart-page__item-info\">\n                    <h3 className=\"cart-page__item-name\">{group.name}</h3>\n                    {group.product?.vendor && (\n                      <p className=\"cart-page__item-vendor\">{group.product.vendor.name}</p>\n                    )}\n                  </div>\n                </div>\n\n                {/* Variants List */}\n                <div className=\"cart-page__variants\">\n                  {group.variants.map((variant, variantIdx) => {\n                    const variantId = variant.id || variant._id || variant.cartItemId\n                    const cartItemId = variant.cartItemId || variant.id || variant._id\n                    const isExpanded = expandedVariants[variantId] || false\n                    \n                    return (\n                      <div key={variantId} className=\"cart-page__variant\">\n                        {/* Variant Header - Collapsible */}\n                        <button\n                          type=\"button\"\n                          onClick={() => setExpandedVariants(prev => ({ ...prev, [variantId]: !prev[variantId] }))}\n                          className=\"cart-page__variant-header\"\n                        >\n                          <div className=\"cart-page__variant-info\">\n                            <div className=\"cart-page__variant-label\">\n                              <span>Variant {variantIdx + 1}</span>\n                              {variant.variantAttributes && Object.keys(variant.variantAttributes).length > 0 && (\n                                <span>({Object.keys(variant.variantAttributes).length} properties)</span>\n                              )}\n                            </div>\n                            {variant.variantAttributes && Object.keys(variant.variantAttributes).length > 0 ? (\n                              <div className=\"cart-page__variant-preview\">\n                                {Object.entries(variant.variantAttributes).slice(0, 1).map(([key, value]) => (\n                                  <span key={key}>\n                                    <span className=\"font-medium\">{key}:</span> {value}\n                                    {Object.keys(variant.variantAttributes).length > 1 && ' + more'}\n                                  </span>\n                                ))}\n                              </div>\n                            ) : (\n                              <p className=\"cart-page__variant-preview\">Standard variant</p>\n                            )}\n                            <div className=\"cart-page__variant-price\">\n                              â‚¹{(variant.unitPrice || 0).toLocaleString('en-IN')} per unit\n                            </div>\n                          </div>\n                          <svg \n                            className={cn(\n                              \"cart-page__variant-chevron\",\n                              isExpanded && \"cart-page__variant-chevron--expanded\"\n                            )}\n                            fill=\"none\" \n                            viewBox=\"0 0 24 24\" \n                            stroke=\"currentColor\"\n                          >\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                          </svg>\n                        </button>\n                        \n                        {/* Expanded Variant Details */}\n                        {isExpanded && (\n                          <div className=\"cart-page__variant-details\">\n                            {variant.variantAttributes && Object.keys(variant.variantAttributes).length > 0 ? (\n                              <div className=\"cart-page__variant-properties\">\n                                <p className=\"cart-page__variant-properties-title\">Variant Properties:</p>\n                                {Object.entries(variant.variantAttributes).map(([key, value]) => (\n                                  <div key={key} className=\"cart-page__variant-property\">\n                                    <span className=\"cart-page__variant-property-key\">{key}:</span>\n                                    <span className=\"cart-page__variant-property-value\">{value}</span>\n                                  </div>\n                                ))}\n                              </div>\n                            ) : (\n                              <p className=\"cart-page__variant-no-properties\">No variant properties available</p>\n                            )}\n                          </div>\n                        )}\n                        \n                        {/* Variant Controls */}\n                        <div className=\"cart-page__variant-controls\">\n                          <div className=\"cart-page__quantity-controls\">\n                            <button\n                              type=\"button\"\n                              className=\"cart-page__quantity-button\"\n                              onClick={(e) => {\n                                e.stopPropagation()\n                                handleUpdateQuantity(variantId, variant.quantity - 1)\n                              }}\n                              disabled={variant.quantity <= 1}\n                            >\n                              <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20 12H4\" />\n                              </svg>\n                            </button>\n                            <span className=\"cart-page__quantity-value\">{variant.quantity}</span>\n                            <button\n                              type=\"button\"\n                              className=\"cart-page__quantity-button\"\n                              onClick={(e) => {\n                                e.stopPropagation()\n                                handleUpdateQuantity(variantId, variant.quantity + 1)\n                              }}\n                            >\n                              <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\n                              </svg>\n                            </button>\n                          </div>\n                          \n                          <div className=\"cart-page__variant-total\">\n                            â‚¹{((variant.unitPrice || 0) * variant.quantity).toLocaleString('en-IN')}\n                          </div>\n                          \n                          <button\n                            type=\"button\"\n                            className=\"cart-page__variant-remove\"\n                            onClick={(e) => {\n                              e.stopPropagation()\n                              handleRemove(cartItemId)\n                            }}\n                          >\n                            <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                            </svg>\n                          </button>\n                        </div>\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            ))}\n          </div>\n\n          {/* Right: Summary */}\n          <div className=\"cart-page__summary\">\n            <div className=\"cart-page__summary-card\">\n              <h3 className=\"cart-page__summary-title\">Order Summary</h3>\n              \n              <div className=\"cart-page__summary-row\">\n                <span>Subtotal</span>\n                <span>â‚¹{totals.subtotal.toLocaleString('en-IN')}</span>\n              </div>\n              \n              <div className=\"cart-page__summary-row\">\n                <span>Delivery</span>\n                <span>{totals.delivery === 0 ? 'Free' : `â‚¹${totals.delivery}`}</span>\n              </div>\n              \n              <div className=\"cart-page__summary-row cart-page__summary-row--total\">\n                <span>Total</span>\n                <span>â‚¹{totals.total.toLocaleString('en-IN')}</span>\n              </div>\n              \n              {!totals.meetsMinimum && (\n                <div className=\"cart-page__summary-warning\">\n                  <p>\n                    Add â‚¹{totals.shortfall.toLocaleString('en-IN')} more to reach minimum order value of â‚¹{MIN_ORDER_VALUE.toLocaleString('en-IN')}\n                  </p>\n                </div>\n              )}\n              \n              <button\n                type=\"button\"\n                className={cn(\n                  'cart-page__checkout-button',\n                  !totals.meetsMinimum && 'cart-page__checkout-button--disabled'\n                )}\n                onClick={handleCheckout}\n                disabled={!totals.meetsMinimum}\n              >\n                {totals.meetsMinimum ? 'Proceed to Checkout' : `Add â‚¹${totals.shortfall.toLocaleString('en-IN')} more`}\n              </button>\n            </div>\n          </div>\n        </div>\n\n        {/* Suggested Items Section */}\n        {suggestedProducts.length > 0 && (\n          <div className=\"cart-page__suggested\">\n            <h3 className=\"cart-page__suggested-title\">You might also like</h3>\n            <div className=\"cart-page__suggested-grid\">\n              {suggestedProducts.map((product) => {\n                const productId = product._id || product.id\n                return (\n                  <div key={productId} className=\"cart-page__suggested-card\">\n                    <div className=\"cart-page__suggested-image-wrapper\">\n                      <img \n                        src={getPrimaryImageUrl(product)} \n                        alt={product.name} \n                        className=\"cart-page__suggested-image\"\n                        onClick={() => navigate(`/product/${productId}`)}\n                      />\n                    </div>\n                    <div className=\"cart-page__suggested-content\">\n                      <h4 \n                        className=\"cart-page__suggested-name\"\n                        onClick={() => navigate(`/product/${productId}`)}\n                      >\n                        {product.name}\n                      </h4>\n                      <div className=\"cart-page__suggested-price\">\n                        â‚¹{(product.priceToUser || product.price || 0).toLocaleString('en-IN')}\n                      </div>\n                      <button\n                        type=\"button\"\n                        className=\"cart-page__suggested-add-btn\"\n                        onClick={() => handleAddSuggestedToCart(productId)}\n                      >\n                        <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\n                        </svg>\n                        <span>Add</span>\n                      </button>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          </div>\n        )}\n      </Container>\n    </Layout>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\CategoryProductsPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'websiteApi' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"websiteApi"},"fix":{"range":[321,342],"text":""},"desc":"Remove unused variable 'websiteApi'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo } from 'react'\r\nimport { useNavigate, useSearchParams } from 'react-router-dom'\r\nimport { Layout, Container } from '../components/Layout'\r\nimport { useWebsiteApi } from '../hooks/useWebsiteApi'\r\nimport { useWebsiteState, useWebsiteDispatch } from '../context/WebsiteContext'\r\nimport * as websiteApi from '../services/websiteApi'\r\nimport { getPrimaryImageUrl } from '../utils/productImages'\r\nimport { cn } from '../../../lib/cn'\r\nimport '../styles/website.css'\r\n\r\nexport function CategoryProductsPage() {\r\n  const navigate = useNavigate()\r\n  const dispatch = useWebsiteDispatch()\r\n  const [searchParams] = useSearchParams()\r\n  const initialCategoryId = searchParams.get('category') || 'all'\r\n  \r\n  const { favourites, authenticated } = useWebsiteState()\r\n  const { fetchCategories, fetchProducts, addToCart, addToFavourites, removeFromFavourites } = useWebsiteApi()\r\n  \r\n  const [selectedCategory, setSelectedCategory] = useState(initialCategoryId)\r\n  const [products, setProducts] = useState([])\r\n  const [categories, setCategories] = useState([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [sortBy, setSortBy] = useState('popular')\r\n\r\n  // Fetch categories\r\n  useEffect(() => {\r\n    const loadCategories = async () => {\r\n      try {\r\n        const result = await fetchCategories()\r\n        if (result.data?.categories) {\r\n          setCategories(result.data.categories)\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading categories:', error)\r\n      }\r\n    }\r\n    loadCategories()\r\n  }, [fetchCategories])\r\n\r\n  // Fetch products for selected category\r\n  useEffect(() => {\r\n    const loadProducts = async () => {\r\n      setLoading(true)\r\n      try {\r\n        const params = { limit: 100 }\r\n        \r\n        if (selectedCategory !== 'all') {\r\n          params.category = selectedCategory\r\n        }\r\n        \r\n        // Map sortBy to API sort parameter\r\n        if (sortBy === 'price-low') {\r\n          params.sort = 'price_asc'\r\n        } else if (sortBy === 'price-high') {\r\n          params.sort = 'price_desc'\r\n        } else if (sortBy === 'rating') {\r\n          params.sort = 'rating_desc'\r\n        } else {\r\n          params.sort = 'popular'\r\n        }\r\n        \r\n        const result = await fetchProducts(params)\r\n        if (result.data?.products) {\r\n          setProducts(result.data.products)\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading products:', error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n    \r\n    loadProducts()\r\n  }, [selectedCategory, sortBy, fetchProducts])\r\n\r\n  // Update selected category when URL param changes\r\n  useEffect(() => {\r\n    if (initialCategoryId) {\r\n      setSelectedCategory(initialCategoryId)\r\n    }\r\n  }, [initialCategoryId])\r\n\r\n  const category = useMemo(() => {\r\n    if (selectedCategory === 'all') return null\r\n    return categories.find((cat) => (cat.id || cat._id) === selectedCategory)\r\n  }, [selectedCategory, categories])\r\n\r\n  const handleCategoryClick = (categoryId) => {\r\n    setSelectedCategory(categoryId)\r\n    navigate(`/category?category=${categoryId}`, { replace: true })\r\n  }\r\n\r\n  const handleProductClick = (productId) => {\r\n    navigate(`/product/${productId}`)\r\n  }\r\n\r\n  const handleAddToCart = async (e, productId) => {\r\n    e.stopPropagation()\r\n    if (!authenticated) {\r\n      navigate('/login')\r\n      return\r\n    }\r\n    try {\r\n      await addToCart(productId, 1)\r\n    } catch (error) {\r\n      console.error('Failed to add to cart:', error)\r\n    }\r\n  }\r\n\r\n  const handleToggleFavourite = async (e, productId) => {\r\n    e.stopPropagation()\r\n    if (!authenticated) {\r\n      navigate('/login')\r\n      return\r\n    }\r\n    try {\r\n      if (favourites.includes(productId)) {\r\n        await removeFromFavourites(productId)\r\n        dispatch({ type: 'REMOVE_FROM_FAVOURITES', payload: { productId } })\r\n      } else {\r\n        await addToFavourites(productId)\r\n        dispatch({ type: 'ADD_TO_FAVOURITES', payload: { productId } })\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to toggle favourite:', error)\r\n    }\r\n  }\r\n\r\n  const allCategories = [\r\n    { id: 'all', name: 'All Categories' },\r\n    ...categories,\r\n  ]\r\n\r\n  return (\r\n    <Layout>\r\n      <Container className=\"category-products-page\">\r\n        {/* Header */}\r\n        <div className=\"category-products-page__header\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"category-products-page__back\"\r\n            onClick={() => navigate(-1)}\r\n            aria-label=\"Go back\"\r\n          >\r\n            <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n          </button>\r\n          <div className=\"category-products-page__header-content\">\r\n            <h1 className=\"category-products-page__title\">\r\n              {category ? category.name : 'All Products'}\r\n            </h1>\r\n            <p className=\"category-products-page__subtitle\">\r\n              {products.length} {products.length === 1 ? 'product' : 'products'} available\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Category Tabs */}\r\n        <div className=\"category-products-page__tabs\">\r\n          <div className=\"category-products-page__tabs-container\">\r\n            {allCategories.map((cat) => {\r\n              const catId = cat.id || cat._id\r\n              return (\r\n                <button\r\n                  key={catId}\r\n                  type=\"button\"\r\n                  className={cn(\r\n                    'category-products-page__tab',\r\n                    selectedCategory === catId && 'category-products-page__tab--active'\r\n                  )}\r\n                  onClick={() => handleCategoryClick(catId)}\r\n                >\r\n                  {cat.name}\r\n                </button>\r\n              )\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Sort and Filter Bar */}\r\n        <div className=\"category-products-page__toolbar\">\r\n          <div className=\"category-products-page__sort\">\r\n            <label htmlFor=\"sort-select\" className=\"category-products-page__sort-label\">\r\n              Sort by:\r\n            </label>\r\n            <select\r\n              id=\"sort-select\"\r\n              value={sortBy}\r\n              onChange={(e) => setSortBy(e.target.value)}\r\n              className=\"category-products-page__sort-select\"\r\n            >\r\n              <option value=\"popular\">Most Popular</option>\r\n              <option value=\"price-low\">Price: Low to High</option>\r\n              <option value=\"price-high\">Price: High to Low</option>\r\n              <option value=\"rating\">Highest Rated</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Products Grid */}\r\n        {loading ? (\r\n          <div className=\"category-products-page__loading\">\r\n            <p className=\"text-gray-500\">Loading products...</p>\r\n          </div>\r\n        ) : products.length === 0 ? (\r\n          <div className=\"category-products-page__empty\">\r\n            <p className=\"category-products-page__empty-text\">No products found in this category</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"category-products-page__grid\">\r\n            {products.map((product) => {\r\n              const productId = product._id || product.id\r\n              const inStock = (product.stock || 0) > 0\r\n              const productImage = getPrimaryImageUrl(product)\r\n              const isWishlisted = favourites.includes(productId)\r\n              \r\n              return (\r\n                <div\r\n                  key={productId}\r\n                  className=\"category-products-page__card\"\r\n                  onClick={() => handleProductClick(productId)}\r\n                >\r\n                  <div className=\"category-products-page__card-image-wrapper\">\r\n                    <img\r\n                      src={productImage}\r\n                      alt={product.name}\r\n                      className=\"category-products-page__card-image\"\r\n                    />\r\n                    {authenticated && (\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"category-products-page__card-wishlist\"\r\n                        onClick={(e) => handleToggleFavourite(e, productId)}\r\n                      >\r\n                        <svg\r\n                          className=\"h-5 w-5\"\r\n                          fill={isWishlisted ? '#ef4444' : 'none'}\r\n                          stroke={isWishlisted ? '#ef4444' : 'currentColor'}\r\n                          viewBox=\"0 0 24 24\"\r\n                        >\r\n                          <path\r\n                            strokeLinecap=\"round\"\r\n                            strokeLinejoin=\"round\"\r\n                            strokeWidth={2}\r\n                            d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"\r\n                          />\r\n                        </svg>\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                  <h3 className=\"category-products-page__card-title\">{product.name}</h3>\r\n                  <div className=\"category-products-page__card-price\">\r\n                    â‚¹{(product.priceToUser || product.price || 0).toLocaleString('en-IN')}\r\n                  </div>\r\n                  <button\r\n                    className=\"category-products-page__card-button\"\r\n                    onClick={(e) => handleAddToCart(e, productId)}\r\n                    disabled={!inStock}\r\n                  >\r\n                    {inStock ? 'Add to Cart' : 'Out of Stock'}\r\n                  </button>\r\n                </div>\r\n              )\r\n            })}\r\n          </div>\r\n        )}\r\n      </Container>\r\n    </Layout>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\CheckoutPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'assignedVendor' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"assignedVendor"},"fix":{"range":[894,910],"text":""},"desc":"Remove unused variable 'assignedVendor'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'summaryExpanded' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":26,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"summaryExpanded"},"fix":{"range":[1094,1109],"text":""},"desc":"Remove unused variable 'summaryExpanded'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setSummaryExpanded' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":26,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"setSummaryExpanded"},"fix":{"range":[1109,1129],"text":""},"desc":"Remove unused variable 'setSummaryExpanded'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setPaymentMethod' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":28,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"setPaymentMethod"},"fix":{"range":[1237,1255],"text":""},"desc":"Remove unused variable 'setPaymentMethod'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'paymentAmount' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":264,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":264,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"paymentAmount"},"fix":{"range":[9105,9179],"text":""},"desc":"Remove unused variable 'paymentAmount'."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect } from 'react'\nimport { useNavigate, Link } from 'react-router-dom'\nimport { Layout, Container } from '../components/Layout'\nimport { useWebsiteState, useWebsiteDispatch } from '../context/WebsiteContext'\nimport { useWebsiteApi } from '../hooks/useWebsiteApi'\nimport { ADVANCE_PAYMENT_PERCENTAGE, REMAINING_PAYMENT_PERCENTAGE } from '../services/websiteData'\nimport * as websiteApi from '../services/websiteApi'\nimport { getPrimaryImageUrl } from '../utils/productImages'\nimport { openRazorpayCheckout } from '../../../utils/razorpay'\nimport { cn } from '../../../lib/cn'\nimport '../styles/website.css'\n\nconst STEPS = [\n  { id: 1, label: 'Summary' },\n  { id: 2, label: 'Address & Shipping' },\n  { id: 3, label: 'Payment' },\n]\n\nexport function CheckoutPage() {\n  const navigate = useNavigate()\n  const dispatch = useWebsiteDispatch()\n  const { cart, profile, assignedVendor, vendorAvailability } = useWebsiteState()\n  const { createOrder, createPaymentIntent, confirmPayment } = useWebsiteApi()\n\n  const [currentStep, setCurrentStep] = useState(1)\n  const [summaryExpanded, setSummaryExpanded] = useState(true)\n  const [shippingMethod, setShippingMethod] = useState('standard')\n  const [paymentMethod, setPaymentMethod] = useState('razorpay')\n  const [paymentPreference, setPaymentPreference] = useState('partial')\n  const [showPaymentConfirm, setShowPaymentConfirm] = useState(false)\n  const [pendingOrder, setPendingOrder] = useState(null)\n  const [cartProducts, setCartProducts] = useState({})\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  // Redirect if cart is empty\n  useEffect(() => {\n    if (cart.length === 0) {\n      navigate('/cart')\n    }\n  }, [cart, navigate])\n\n  // Get delivery address from user profile\n  const deliveryAddress = useMemo(() => {\n    if (!profile?.location || !profile.location.city || !profile.location.state || !profile.location.pincode) {\n      return null\n    }\n    return {\n      name: profile.name || 'Home',\n      address: profile.location.address || '',\n      city: profile.location.city,\n      state: profile.location.state,\n      pincode: profile.location.pincode,\n      phone: profile.phone || '',\n    }\n  }, [profile])\n\n  // Fetch product details for cart items\n  useEffect(() => {\n    const loadCartProducts = async () => {\n      const productMap = {}\n      for (const item of cart) {\n        try {\n          const result = await websiteApi.getProductDetails(item.productId)\n          if (result.success && result.data?.product) {\n            productMap[item.productId] = result.data.product\n          }\n        } catch (error) {\n          console.error(`Error loading product ${item.productId}:`, error)\n        }\n      }\n      setCartProducts(productMap)\n    }\n\n    if (cart.length > 0) {\n      loadCartProducts()\n    }\n  }, [cart])\n\n  const cartItems = useMemo(() => {\n    return cart.map((item) => {\n      const product = cartProducts[item.productId]\n      const price = item.unitPrice || item.price || (product ? (product.priceToUser || product.price || 0) : 0)\n      return {\n        ...item,\n        product,\n        price: typeof price === 'number' && !isNaN(price) ? price : 0,\n        unitPrice: price,\n        image: item.image || (product ? getPrimaryImageUrl(product) : 'https://via.placeholder.com/300'),\n        name: item.name || product?.name || 'Unknown Product',\n      }\n    })\n  }, [cart, cartProducts])\n\n  // Group items by productId with variants\n  const groupedCartItems = useMemo(() => {\n    const grouped = {}\n\n    cartItems.forEach((item) => {\n      const product = cartProducts[item.productId]\n      const unitPrice = item.unitPrice || item.price || (product ? (product.priceToUser || product.price || 0) : 0)\n      const variantAttrs = item.variantAttributes || {}\n      const hasVariants = variantAttrs && typeof variantAttrs === 'object' && Object.keys(variantAttrs).length > 0\n      const key = item.productId\n\n      if (!grouped[key]) {\n        grouped[key] = {\n          productId: item.productId,\n          product,\n          name: item.name || product?.name || 'Product',\n          image: product ? getPrimaryImageUrl(product) : (item.image || 'https://via.placeholder.com/400'),\n          variants: [],\n          hasVariants: false,\n        }\n      }\n\n      const variantItem = {\n        ...item,\n        id: item.id || item._id || item.cartItemId,\n        cartItemId: item.id || item._id || item.cartItemId,\n        product,\n        unitPrice,\n        variantAttributes: variantAttrs,\n        hasVariants,\n      }\n\n      grouped[key].variants.push(variantItem)\n\n      if (hasVariants) {\n        grouped[key].hasVariants = true\n      }\n    })\n\n    return Object.values(grouped)\n  }, [cartItems, cartProducts])\n\n  const isFullPayment = paymentPreference === 'full'\n\n  const paymentOptions = [\n    {\n      id: 'partial',\n      title: 'Pay 30% now, 70% later',\n      description: 'Keep the standard split. Remaining amount is collected after delivery.',\n      badge: 'Standard',\n    },\n    {\n      id: 'full',\n      title: 'Pay 100% now',\n      description: 'Settle the entire order upfront and skip delivery charges automatically.',\n      badge: 'Free Delivery',\n    },\n  ]\n\n  const shippingOptions = [\n    { id: 'standard', label: 'Standard Delivery', cost: 50, time: '24 hours', minOrder: 5000 },\n  ]\n\n  const selectedShipping = shippingOptions.find((s) => s.id === shippingMethod) || shippingOptions[0]\n\n  const totals = useMemo(() => {\n    const subtotal = groupedCartItems.reduce((sum, group) => {\n      return sum + group.variants.reduce((variantSum, variant) => {\n        const itemPrice = typeof variant.unitPrice === 'number' && !isNaN(variant.unitPrice) ? variant.unitPrice : 0\n        const itemQuantity = typeof variant.quantity === 'number' && !isNaN(variant.quantity) ? variant.quantity : 0\n        return variantSum + (itemPrice * itemQuantity)\n      }, 0)\n    }, 0)\n\n    const deliveryBeforeBenefit = subtotal >= (selectedShipping.minOrder || Infinity) ? 0 : selectedShipping.cost\n    const delivery = paymentPreference === 'full' ? 0 : deliveryBeforeBenefit\n    const discount = 0\n    const total = subtotal + delivery - discount\n    const advance =\n      paymentPreference === 'full'\n        ? total\n        : Math.round((total * ADVANCE_PAYMENT_PERCENTAGE) / 100)\n    const remaining = total - advance\n\n    return {\n      subtotal: isNaN(subtotal) ? 0 : subtotal,\n      delivery: isNaN(delivery) ? 0 : delivery,\n      deliveryBeforeBenefit: isNaN(deliveryBeforeBenefit) ? 0 : deliveryBeforeBenefit,\n      discount: isNaN(discount) ? 0 : discount,\n      total: isNaN(total) ? 0 : total,\n      advance: isNaN(advance) ? 0 : advance,\n      remaining: isNaN(remaining) ? 0 : remaining,\n    }\n  }, [groupedCartItems, selectedShipping, paymentPreference])\n\n  const amountDueNow = totals.advance\n  const amountDueLater = totals.remaining\n  const paymentDueNowLabel = isFullPayment ? 'Full Payment (100%)' : `Advance (${ADVANCE_PAYMENT_PERCENTAGE}%)`\n  const paymentDueLaterLabel = isFullPayment\n    ? 'After Delivery'\n    : `Remaining (${REMAINING_PAYMENT_PERCENTAGE}%)`\n\n  const handleNext = () => {\n    if (currentStep < 3) {\n      setCurrentStep(currentStep + 1)\n    }\n  }\n\n  const handleBack = () => {\n    if (currentStep > 1) {\n      setCurrentStep(currentStep - 1)\n    } else {\n      navigate('/cart')\n    }\n  }\n\n  const handlePlaceOrder = () => {\n    if (!vendorAvailability?.canPlaceOrder && !vendorAvailability?.isInBufferZone) {\n      setError('No vendor available in your region. You cannot place orders at this location.')\n      return\n    }\n    if (!deliveryAddress) {\n      setError('Please update your delivery address in settings before placing an order')\n      return\n    }\n\n    // Show payment confirmation modal WITHOUT creating order\n    // Order will only be created when user confirms payment\n    const uiPayment = {\n      paymentPreference,\n      amountDueNow,\n      amountDueLater,\n      deliveryWaived: isFullPayment && totals.deliveryBeforeBenefit > 0,\n    }\n\n    // Store preview data (not actual order) - order will be created on confirmation\n    setPendingOrder({\n      preview: true, // Flag to indicate this is preview, not actual order\n      uiPayment,\n      total: totals.total,\n    })\n    setShowPaymentConfirm(true)\n  }\n\n  const handleConfirmPayment = async () => {\n    if (!pendingOrder) {\n      setError('Order information is missing')\n      return\n    }\n\n    // Block order placement if no vendor available (beyond 20.3km)\n    // Allow if in buffer zone (20km to 20.3km)\n    if (!vendorAvailability?.canPlaceOrder && !vendorAvailability?.isInBufferZone) {\n      setError('No vendor available in your region. You cannot place orders at this location.')\n      setShowPaymentConfirm(false)\n      setPendingOrder(null)\n      return\n    }\n    if (!deliveryAddress) {\n      setError('Please update your delivery address in settings before placing an order')\n      setShowPaymentConfirm(false)\n      setPendingOrder(null)\n      return\n    }\n\n    setLoading(true)\n    setError(null)\n\n    try {\n      const paymentAmount = pendingOrder.uiPayment?.amountDueNow ?? amountDueNow\n\n      // Create order via API FIRST (only when user confirms payment)\n      const orderData = {\n        paymentPreference,\n        notes: `Shipping method: ${selectedShipping.label}`,\n      }\n\n      const orderResult = await createOrder(orderData)\n      if (orderResult.error) {\n        setError(orderResult.error.message || 'Failed to create order')\n        setLoading(false)\n        setShowPaymentConfirm(false)\n        setPendingOrder(null)\n        return\n      }\n\n      const order = orderResult.data.order\n\n      // Update pendingOrder with actual order data\n      const updatedPendingOrder = {\n        ...order,\n        uiPayment: pendingOrder.uiPayment,\n      }\n      setPendingOrder(updatedPendingOrder)\n\n      const paymentIntentResult = await createPaymentIntent({\n        orderId: order.id,\n        paymentMethod: paymentMethod,\n      })\n\n      if (paymentIntentResult.error) {\n        setError(paymentIntentResult.error.message || 'Failed to initialize payment')\n        setLoading(false)\n        return\n      }\n\n      const { paymentIntent } = paymentIntentResult.data\n      const { razorpayOrderId, keyId, amount } = paymentIntent\n\n      if (!razorpayOrderId || !keyId || !amount || amount <= 0) {\n        setError('Invalid payment configuration. Please try again.')\n        setLoading(false)\n        return\n      }\n\n      try {\n        const razorpayResponse = await openRazorpayCheckout({\n          key: keyId,\n          amount: amount,\n          currency: 'INR',\n          order_id: razorpayOrderId,\n          name: 'IRA SATHI',\n          description: `Payment for Order ${pendingOrder.orderNumber || pendingOrder.id}`,\n          prefill: {\n            name: profile.name || '',\n            email: profile.email || '',\n            contact: profile.phone || '',\n          },\n        })\n\n        const confirmResult = await confirmPayment({\n          orderId: order.id,\n          paymentIntentId: paymentIntent.id,\n          gatewayPaymentId: razorpayResponse.paymentId,\n          gatewayOrderId: razorpayResponse.orderId,\n          gatewaySignature: razorpayResponse.signature,\n          paymentMethod: paymentMethod,\n        })\n\n        if (confirmResult.error) {\n          setError(confirmResult.error.message || 'Payment failed')\n          setLoading(false)\n          setShowPaymentConfirm(false)\n          setPendingOrder(null)\n          return\n        }\n\n        // Clear cart after successful payment\n        dispatch({ type: 'CLEAR_CART' })\n\n        // Navigate to order confirmation\n        navigate('/order-confirmation', {\n          state: { orderId: order.id, orderNumber: order.orderNumber }\n        })\n      } catch (razorpayError) {\n        if (razorpayError.error) {\n          setError(razorpayError.error || 'Payment was cancelled or failed')\n        } else {\n          setError('Payment was cancelled')\n        }\n        setLoading(false)\n        setShowPaymentConfirm(false)\n        setPendingOrder(null)\n      }\n    } catch (err) {\n      console.error('Payment processing error:', err)\n      setError(err.message || 'Payment processing failed. Please try again.')\n      setLoading(false)\n      setShowPaymentConfirm(false)\n      setPendingOrder(null)\n    }\n  }\n\n  // Redirect if not authenticated\n  useEffect(() => {\n    if (!profile || !profile.phone) {\n      navigate('/login', { state: { from: '/checkout' } })\n    }\n  }, [profile, navigate])\n\n  if (cart.length === 0) {\n    return null // Will redirect\n  }\n\n  return (\n    <Layout>\n      <Container className=\"checkout-page\">\n        <div className=\"checkout-page__header\">\n          <button\n            type=\"button\"\n            onClick={handleBack}\n            className=\"checkout-page__back-button\"\n          >\n            â† {currentStep === 1 ? 'Back to Cart' : 'Back'}\n          </button>\n          <h1 className=\"checkout-page__title\">Checkout</h1>\n        </div>\n\n        {error && (\n          <div className=\"checkout-page__error\">\n            {error}\n            <button onClick={() => setError(null)}>Ã—</button>\n          </div>\n        )}\n\n        {/* Progress Indicator */}\n        <div className=\"checkout-page__progress\">\n          {STEPS.map((step, index) => {\n            const isActive = currentStep === step.id\n            const isCompleted = currentStep > step.id\n            return (\n              <div key={step.id} className=\"checkout-page__progress-item\">\n                <div className={cn(\n                  'checkout-page__progress-circle',\n                  isActive && 'checkout-page__progress-circle--active',\n                  isCompleted && 'checkout-page__progress-circle--completed'\n                )}>\n                  {isCompleted ? 'âœ“' : step.id}\n                </div>\n                <label className={cn(\n                  'checkout-page__progress-label',\n                  isActive && 'checkout-page__progress-label--active'\n                )}>\n                  {step.label}\n                </label>\n                {index < STEPS.length - 1 && (\n                  <div className={cn(\n                    'checkout-page__progress-connector',\n                    isCompleted && 'checkout-page__progress-connector--completed'\n                  )} />\n                )}\n              </div>\n            )\n          })}\n        </div>\n\n        <div className=\"checkout-page__layout\">\n          {/* Main Content */}\n          <div className=\"checkout-page__main\">\n            {/* Step 1: Summary */}\n            {currentStep === 1 && (\n              <div className=\"checkout-page__step\">\n                <h2 className=\"checkout-page__step-title\">Order Summary</h2>\n\n                {/* Order Items */}\n                <div className=\"checkout-page__items\">\n                  {groupedCartItems.map((group) => (\n                    <div key={group.productId} className=\"checkout-page__item-group\">\n                      <div className=\"checkout-page__item-header\">\n                        <img src={group.image} alt={group.name} className=\"checkout-page__item-image\" />\n                        <div className=\"checkout-page__item-info\">\n                          <h4>{group.name}</h4>\n                          <p>{group.variants.length} variant{group.variants.length > 1 ? 's' : ''}</p>\n                        </div>\n                      </div>\n                      {group.variants.map((variant) => (\n                        <div key={variant.id} className=\"checkout-page__item-variant\">\n                          <div className=\"checkout-page__variant-details\">\n                            {variant.variantAttributes && Object.keys(variant.variantAttributes).length > 0 && (\n                              <div className=\"checkout-page__variant-attrs\">\n                                {Object.entries(variant.variantAttributes).map(([key, value]) => (\n                                  <span key={key}>{key}: {value}</span>\n                                ))}\n                              </div>\n                            )}\n                            <p>Qty: {variant.quantity} Ã— â‚¹{variant.unitPrice?.toLocaleString('en-IN')}</p>\n                          </div>\n                          <p className=\"checkout-page__variant-total\">\n                            â‚¹{((variant.unitPrice || 0) * variant.quantity).toLocaleString('en-IN')}\n                          </p>\n                        </div>\n                      ))}\n                    </div>\n                  ))}\n                </div>\n\n                {/* Payment Preference */}\n                <div className=\"checkout-page__payment-preference\">\n                  <h3 className=\"checkout-page__section-title\">Payment Preference</h3>\n                  <div className=\"checkout-page__payment-options\">\n                    {paymentOptions.map((option) => (\n                      <button\n                        key={option.id}\n                        type=\"button\"\n                        onClick={() => setPaymentPreference(option.id)}\n                        className={cn(\n                          'checkout-page__payment-option',\n                          paymentPreference === option.id && 'checkout-page__payment-option--active'\n                        )}\n                      >\n                        <div className=\"checkout-page__payment-option-header\">\n                          <span>{option.title}</span>\n                          <span className=\"checkout-page__payment-badge\">{option.badge}</span>\n                        </div>\n                        <p>{option.description}</p>\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Payment Breakdown */}\n                <div className=\"checkout-page__payment-breakdown\">\n                  <h3 className=\"checkout-page__section-title\">Payment Breakdown</h3>\n                  <div className=\"checkout-page__breakdown-grid\">\n                    <div className=\"checkout-page__breakdown-item\">\n                      <p className=\"checkout-page__breakdown-label\">{paymentDueNowLabel}</p>\n                      <p className=\"checkout-page__breakdown-amount\">â‚¹{amountDueNow.toLocaleString('en-IN')}</p>\n                      <p className=\"checkout-page__breakdown-note\">Pay now</p>\n                    </div>\n                    <div className=\"checkout-page__breakdown-item\">\n                      <p className=\"checkout-page__breakdown-label\">{paymentDueLaterLabel}</p>\n                      <p className=\"checkout-page__breakdown-amount\">â‚¹{amountDueLater.toLocaleString('en-IN')}</p>\n                      <p className=\"checkout-page__breakdown-note\">\n                        {isFullPayment ? 'No pending payment' : 'Pay after delivery'}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Step 2: Address & Shipping */}\n            {currentStep === 2 && (\n              <div className=\"checkout-page__step\">\n                <h2 className=\"checkout-page__step-title\">Delivery Address</h2>\n\n                {deliveryAddress ? (\n                  <div className=\"checkout-page__address-card\">\n                    <div className=\"checkout-page__address-header\">\n                      <span className=\"checkout-page__address-name\">{deliveryAddress.name}</span>\n                      <span className=\"checkout-page__address-badge\">Delivery Address</span>\n                    </div>\n                    {deliveryAddress.address && (\n                      <p className=\"checkout-page__address-line\">{deliveryAddress.address}</p>\n                    )}\n                    <p className=\"checkout-page__address-line\">\n                      {deliveryAddress.city}, {deliveryAddress.state} - {deliveryAddress.pincode}\n                    </p>\n                    {deliveryAddress.phone && (\n                      <p className=\"checkout-page__address-phone\">Phone: {deliveryAddress.phone}</p>\n                    )}\n                    <Link to=\"/account/profile\" className=\"checkout-page__address-change\">\n                      Change Delivery Address\n                    </Link>\n                  </div>\n                ) : (\n                  <div className=\"checkout-page__address-empty\">\n                    <p>Delivery address is required to place an order.</p>\n                    <Link to=\"/account/profile\" className=\"checkout-page__address-add\">\n                      Add Delivery Address\n                    </Link>\n                  </div>\n                )}\n\n                <div className=\"checkout-page__shipping\">\n                  <h3 className=\"checkout-page__section-title\">Shipping Method</h3>\n                  <div className=\"checkout-page__shipping-options\">\n                    {shippingOptions.map((option) => {\n                      const isAvailable = !option.minOrder || totals.subtotal >= option.minOrder\n                      return (\n                        <label\n                          key={option.id}\n                          className={cn(\n                            'checkout-page__shipping-option',\n                            shippingMethod === option.id && 'checkout-page__shipping-option--active',\n                            !isAvailable && 'checkout-page__shipping-option--disabled'\n                          )}\n                        >\n                          <input\n                            type=\"radio\"\n                            name=\"shipping\"\n                            value={option.id}\n                            checked={shippingMethod === option.id}\n                            onChange={(e) => setShippingMethod(e.target.value)}\n                            disabled={!isAvailable}\n                          />\n                          <div>\n                            <div className=\"checkout-page__shipping-header\">\n                              <span>{option.label}</span>\n                              <span>\n                                {option.cost === 0 || isFullPayment ? 'Free' : `â‚¹${option.cost}`}\n                              </span>\n                            </div>\n                            <p>Estimated delivery: {option.time}</p>\n                          </div>\n                        </label>\n                      )\n                    })}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Step 3: Payment */}\n            {currentStep === 3 && (\n              <div className=\"checkout-page__step\">\n                <h2 className=\"checkout-page__step-title\">Payment Method</h2>\n\n                <div className=\"checkout-page__payment-method\">\n                  <div className=\"checkout-page__payment-method-card checkout-page__payment-method-card--active\">\n                    <div className=\"checkout-page__payment-method-icon\">ðŸ’³</div>\n                    <div>\n                      <h4>Razorpay</h4>\n                      <p>Secure payment gateway</p>\n                    </div>\n                    <span className=\"checkout-page__payment-method-check\">âœ“</span>\n                  </div>\n                </div>\n\n                {/* Final Summary */}\n                <div className=\"checkout-page__final-summary\">\n                  <h3 className=\"checkout-page__section-title\">Final Summary</h3>\n                  <div className=\"checkout-page__summary-list\">\n                    <div className=\"checkout-page__summary-row\">\n                      <span>Subtotal</span>\n                      <span>â‚¹{totals.subtotal.toLocaleString('en-IN')}</span>\n                    </div>\n                    <div className=\"checkout-page__summary-row\">\n                      <span>Delivery</span>\n                      <span>{totals.delivery === 0 ? 'Free' : `â‚¹${totals.delivery}`}</span>\n                    </div>\n                    <div className=\"checkout-page__summary-row checkout-page__summary-row--total\">\n                      <span>Total</span>\n                      <span>â‚¹{totals.total.toLocaleString('en-IN')}</span>\n                    </div>\n                  </div>\n                  <div className=\"checkout-page__breakdown-grid\">\n                    <div className=\"checkout-page__breakdown-item\">\n                      <p className=\"checkout-page__breakdown-label\">{paymentDueNowLabel}</p>\n                      <p className=\"checkout-page__breakdown-amount\">â‚¹{amountDueNow.toLocaleString('en-IN')}</p>\n                    </div>\n                    <div className=\"checkout-page__breakdown-item\">\n                      <p className=\"checkout-page__breakdown-label\">{paymentDueLaterLabel}</p>\n                      <p className=\"checkout-page__breakdown-amount\">â‚¹{amountDueLater.toLocaleString('en-IN')}</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Navigation Buttons */}\n            <div className=\"checkout-page__navigation\">\n              {currentStep > 1 && (\n                <button\n                  type=\"button\"\n                  onClick={handleBack}\n                  className=\"checkout-page__nav-button checkout-page__nav-button--secondary\"\n                >\n                  Back\n                </button>\n              )}\n              {currentStep < 3 ? (\n                <button\n                  type=\"button\"\n                  onClick={handleNext}\n                  disabled={currentStep === 2 && !deliveryAddress}\n                  className=\"checkout-page__nav-button checkout-page__nav-button--primary\"\n                >\n                  Continue\n                </button>\n              ) : (\n                <button\n                  type=\"button\"\n                  onClick={handlePlaceOrder}\n                  disabled={loading || !deliveryAddress || (!vendorAvailability?.canPlaceOrder && !vendorAvailability?.isInBufferZone)}\n                  className=\"checkout-page__nav-button checkout-page__nav-button--primary\"\n                >\n                  {loading ? 'Processing...' : `Pay â‚¹${amountDueNow.toLocaleString('en-IN')} & Place Order`}\n                </button>\n              )}\n            </div>\n          </div>\n\n          {/* Sidebar Summary */}\n          <div className=\"checkout-page__sidebar\">\n            <div className=\"checkout-page__sidebar-card\">\n              <h3 className=\"checkout-page__sidebar-title\">Order Summary</h3>\n              <div className=\"checkout-page__sidebar-items\">\n                {groupedCartItems.map((group) => (\n                  <div key={group.productId} className=\"checkout-page__sidebar-item\">\n                    <img src={group.image} alt={group.name} className=\"checkout-page__sidebar-image\" />\n                    <div>\n                      <p className=\"checkout-page__sidebar-item-name\">{group.name}</p>\n                      <p className=\"checkout-page__sidebar-item-qty\">\n                        {group.variants.reduce((sum, v) => sum + v.quantity, 0)} items\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n              <div className=\"checkout-page__sidebar-totals\">\n                <div className=\"checkout-page__sidebar-row\">\n                  <span>Subtotal</span>\n                  <span>â‚¹{totals.subtotal.toLocaleString('en-IN')}</span>\n                </div>\n                <div className=\"checkout-page__sidebar-row\">\n                  <span>Delivery</span>\n                  <span>{totals.delivery === 0 ? 'Free' : `â‚¹${totals.delivery}`}</span>\n                </div>\n                <div className=\"checkout-page__sidebar-row checkout-page__sidebar-row--total\">\n                  <span>Total</span>\n                  <span>â‚¹{totals.total.toLocaleString('en-IN')}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Payment Confirmation Modal */}\n        {showPaymentConfirm && pendingOrder && (\n          <div\n            className=\"checkout-page__modal\"\n            onClick={(e) => {\n              if (e.target === e.currentTarget) {\n                setShowPaymentConfirm(false)\n                setPendingOrder(null)\n              }\n            }}\n          >\n            <div className=\"checkout-page__modal-content\">\n              <div className=\"checkout-page__modal-header\">\n                <h3>Confirm Payment</h3>\n                <button onClick={() => {\n                  setShowPaymentConfirm(false)\n                  setPendingOrder(null)\n                }}>Ã—</button>\n              </div>\n              <div className=\"checkout-page__modal-body\">\n                <p>Order Preview</p>\n                <div className=\"checkout-page__modal-summary\">\n                  <div>\n                    <span>Total Amount</span>\n                    <span>â‚¹{pendingOrder.total.toLocaleString('en-IN')}</span>\n                  </div>\n                  <div>\n                    <span>{paymentDueNowLabel}</span>\n                    <span>â‚¹{pendingOrder.uiPayment.amountDueNow.toLocaleString('en-IN')}</span>\n                  </div>\n                  {pendingOrder.uiPayment.amountDueLater > 0 && (\n                    <div>\n                      <span>{paymentDueLaterLabel}</span>\n                      <span>â‚¹{pendingOrder.uiPayment.amountDueLater.toLocaleString('en-IN')}</span>\n                    </div>\n                  )}\n                </div>\n                <div style={{ display: 'flex', gap: '12px', marginTop: '16px' }}>\n                  <button\n                    onClick={() => {\n                      setShowPaymentConfirm(false)\n                      setPendingOrder(null)\n                    }}\n                    className=\"checkout-page__modal-button\"\n                    style={{\n                      background: '#f3f4f6',\n                      color: '#172022',\n                      flex: 1\n                    }}\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleConfirmPayment}\n                    disabled={loading}\n                    className=\"checkout-page__modal-button\"\n                    style={{ flex: 1 }}\n                  >\n                    {loading ? 'Processing...' : `Pay â‚¹${pendingOrder.uiPayment.amountDueNow.toLocaleString('en-IN')}`}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </Container>\n    </Layout>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\FavouritesPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[403,439],"text":""},"desc":"Remove unused variable 'cn'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":133,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":133,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"e"},"fix":{"range":[5261,5262],"text":""},"desc":"Remove unused variable 'e'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport { Layout, Container } from '../components/Layout'\r\nimport { useWebsiteState, useWebsiteDispatch } from '../context/WebsiteContext'\r\nimport { useWebsiteApi } from '../hooks/useWebsiteApi'\r\nimport * as websiteApi from '../services/websiteApi'\r\nimport { getPrimaryImageUrl } from '../utils/productImages'\r\nimport { cn } from '../../../lib/cn'\r\nimport '../styles/website.css'\r\n\r\nexport function FavouritesPage() {\r\n  const navigate = useNavigate()\r\n  const dispatch = useWebsiteDispatch()\r\n  const { favourites, authenticated } = useWebsiteState()\r\n  const { removeFromFavourites, addToCart } = useWebsiteApi()\r\n  \r\n  const [favouriteProducts, setFavouriteProducts] = useState([])\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  // Fetch favourite products from API\r\n  useEffect(() => {\r\n    const loadFavourites = async () => {\r\n      setLoading(true)\r\n      try {\r\n        const productPromises = favourites.map(async (id) => {\r\n          try {\r\n            const result = await websiteApi.getProductDetails(id)\r\n            if (result.success && result.data?.product) {\r\n              return result.data.product\r\n            }\r\n            return null\r\n          } catch (error) {\r\n            console.error(`Error loading favourite product ${id}:`, error)\r\n            return null\r\n          }\r\n        })\r\n        const products = await Promise.all(productPromises)\r\n        setFavouriteProducts(products.filter(Boolean))\r\n      } catch (error) {\r\n        console.error('Error loading favourites:', error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n    \r\n    if (favourites.length > 0) {\r\n      loadFavourites()\r\n    } else {\r\n      setFavouriteProducts([])\r\n      setLoading(false)\r\n    }\r\n  }, [favourites])\r\n\r\n  const handleRemoveFromFavourites = async (productId) => {\r\n    try {\r\n      await removeFromFavourites(productId)\r\n      dispatch({ type: 'REMOVE_FROM_FAVOURITES', payload: { productId } })\r\n    } catch (error) {\r\n      console.error('Error removing from favourites:', error)\r\n    }\r\n  }\r\n\r\n  const handleAddToCart = async (e, productId) => {\r\n    e.stopPropagation()\r\n    if (!authenticated) {\r\n      navigate('/login')\r\n      return\r\n    }\r\n    try {\r\n      await addToCart(productId, 1)\r\n    } catch (error) {\r\n      console.error('Failed to add to cart:', error)\r\n    }\r\n  }\r\n\r\n  const handleProductClick = (productId) => {\r\n    navigate(`/product/${productId}`)\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <Container className=\"favourites-page\">\r\n        <div className=\"favourites-page__header\">\r\n          <h1 className=\"favourites-page__title\">My Favourites</h1>\r\n          <p className=\"favourites-page__subtitle\">\r\n            {favouriteProducts.length} {favouriteProducts.length === 1 ? 'item' : 'items'} saved\r\n          </p>\r\n        </div>\r\n\r\n        {loading ? (\r\n          <div className=\"favourites-page__empty\">\r\n            <div className=\"favourites-page__empty-icon\">\r\n              <svg className=\"w-16 h-16 text-gray-300\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"favourites-page__empty-title\">Loading favourites...</h3>\r\n          </div>\r\n        ) : favouriteProducts.length === 0 ? (\r\n          <div className=\"favourites-page__empty\">\r\n            <div className=\"favourites-page__empty-icon\">\r\n              <svg className=\"w-16 h-16 text-gray-300\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"favourites-page__empty-title\">No favourites yet</h3>\r\n            <p className=\"favourites-page__empty-text\">\r\n              Start adding products to your favourites by clicking the heart icon on any product\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"favourites-page__grid\">\r\n            {favouriteProducts.map((product) => {\r\n              const productId = product._id || product.id\r\n              const inStock = (product.stock || 0) > 0\r\n              const productImage = getPrimaryImageUrl(product)\r\n              \r\n              return (\r\n                <div\r\n                  key={productId}\r\n                  className=\"favourites-page__card\"\r\n                  onClick={() => handleProductClick(productId)}\r\n                >\r\n                  <div className=\"favourites-page__card-image-wrapper\">\r\n                    <img\r\n                      src={productImage}\r\n                      alt={product.name}\r\n                      className=\"favourites-page__card-image\"\r\n                    />\r\n                    <button\r\n                      type=\"button\"\r\n                      className=\"favourites-page__card-wishlist\"\r\n                      onClick={(e) => handleRemoveFromFavourites(productId)}\r\n                    >\r\n                      <svg\r\n                        className=\"h-5 w-5\"\r\n                        fill=\"#ef4444\"\r\n                        stroke=\"#ef4444\"\r\n                        viewBox=\"0 0 24 24\"\r\n                      >\r\n                        <path\r\n                          strokeLinecap=\"round\"\r\n                          strokeLinejoin=\"round\"\r\n                          strokeWidth={2}\r\n                          d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"\r\n                        />\r\n                      </svg>\r\n                    </button>\r\n                  </div>\r\n                  <h3 className=\"favourites-page__card-title\">{product.name}</h3>\r\n                  <div className=\"favourites-page__card-price\">\r\n                    â‚¹{(product.priceToUser || product.price || 0).toLocaleString('en-IN')}\r\n                  </div>\r\n                  <button\r\n                    className=\"favourites-page__card-button\"\r\n                    onClick={(e) => handleAddToCart(e, productId)}\r\n                    disabled={!inStock}\r\n                  >\r\n                    {inStock ? 'Add to Cart' : 'Out of Stock'}\r\n                  </button>\r\n                </div>\r\n              )\r\n            })}\r\n          </div>\r\n        )}\r\n      </Container>\r\n    </Layout>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\HomePage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'fetchPopularProducts' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":25,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"fetchPopularProducts"},"fix":{"range":[987,1009],"text":""},"desc":"Remove unused variable 'fetchPopularProducts'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'selectedCategory' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"selectedCategory"},"fix":{"range":[1144,1160],"text":""},"desc":"Remove unused variable 'selectedCategory'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchCategories'. Either include it or remove the dependency array.","line":78,"column":6,"nodeType":"ArrayExpression","endLine":78,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCategories]","fix":{"range":[3004,3006],"text":"[fetchCategories]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleCategoryClick' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":173,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":173,"endColumn":28}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react'\nimport { Link, useNavigate } from 'react-router-dom'\nimport { Layout, Container, Section } from '../components/Layout'\nimport { useWebsiteApi } from '../hooks/useWebsiteApi'\nimport { useWebsiteState, useWebsiteDispatch } from '../context/WebsiteContext'\nimport * as websiteApi from '../services/websiteApi'\nimport { getPrimaryImageUrl } from '../utils/productImages'\nimport { cn } from '../../../lib/cn'\nimport '../styles/website.css'\n\n// Helper function to format category names\nconst formatCategoryName = (name) => {\n  if (!name) return name\n  const fertilizerMatch = name.match(/(\\w+)(Fertilizer)/i)\n  if (fertilizerMatch && fertilizerMatch[1] && fertilizerMatch[2]) {\n    return `${fertilizerMatch[1]} ${fertilizerMatch[2]}`\n  }\n  return name\n}\n\nexport function HomePage() {\n  const navigate = useNavigate()\n  const dispatch = useWebsiteDispatch()\n  const { favourites, authenticated } = useWebsiteState()\n  const { fetchCategories, fetchPopularProducts, addToCart, addToFavourites, removeFromFavourites } = useWebsiteApi()\n  \n  const [bannerIndex, setBannerIndex] = useState(0)\n  const [selectedCategory, setSelectedCategory] = useState(null)\n  const [isUserInteracting, setIsUserInteracting] = useState(false)\n  const autoSlideTimeoutRef = useRef(null)\n  const touchStartXRef = useRef(null)\n  const touchEndXRef = useRef(null)\n  \n  // Data state\n  const [categories, setCategories] = useState([])\n  const [popularProducts, setPopularProducts] = useState([])\n  const [carousels, setCarousels] = useState([])\n  const [specialOffers, setSpecialOffers] = useState([])\n  const [loading, setLoading] = useState(true)\n\n  // Fetch data on mount\n  useEffect(() => {\n    const loadData = async () => {\n      setLoading(true)\n      try {\n        // Fetch categories\n        const categoriesResult = await fetchCategories()\n        if (categoriesResult.data?.categories) {\n          const cats = categoriesResult.data.categories\n          setCategories(cats)\n          if (cats.length > 0) {\n            setSelectedCategory(cats[0].id)\n          }\n        }\n\n        // Fetch popular products - limit to 4 for home screen\n        const popularResult = await websiteApi.getPopularProducts({ limit: 4 })\n        if (popularResult.success && popularResult.data?.products) {\n          setPopularProducts(popularResult.data.products)\n        }\n\n        // Fetch offers (carousels and special offers)\n        const offersResult = await websiteApi.getOffers()\n        if (offersResult.success && offersResult.data) {\n          const activeCarousels = (offersResult.data.carousels || [])\n            .filter(c => c.isActive !== false)\n            .sort((a, b) => (a.order || 0) - (b.order || 0))\n          setCarousels(activeCarousels)\n          setSpecialOffers(offersResult.data.specialOffers || [])\n        }\n      } catch (error) {\n        console.error('Error loading data:', error)\n      } finally {\n        setLoading(false)\n      }\n    }\n    loadData()\n  }, [])\n\n  // Banner carousel logic\n  const banners = carousels.length > 0 \n    ? carousels.map(carousel => ({\n        id: carousel.id || carousel._id,\n        title: carousel.title || '',\n        subtitle: carousel.description || '',\n        image: carousel.image || '',\n        productIds: carousel.productIds || [],\n      }))\n    : []\n\n  const goToNextSlide = () => {\n    if (banners.length === 0) return\n    setBannerIndex((prev) => (prev + 1) % banners.length)\n  }\n\n  const goToPreviousSlide = () => {\n    if (banners.length === 0) return\n    setBannerIndex((prev) => (prev - 1 + banners.length) % banners.length)\n  }\n\n  const goToSlide = (index) => {\n    if (banners.length === 0 || index < 0 || index >= banners.length) return\n    setBannerIndex(index)\n    setIsUserInteracting(true)\n    resetAutoSlide()\n  }\n\n  const resetAutoSlide = () => {\n    if (autoSlideTimeoutRef.current) {\n      clearTimeout(autoSlideTimeoutRef.current)\n    }\n    autoSlideTimeoutRef.current = setTimeout(() => {\n      setIsUserInteracting(false)\n    }, 3000)\n  }\n\n  // Auto-slide when user is not interacting\n  useEffect(() => {\n    if (isUserInteracting || banners.length === 0) return\n\n    const interval = setInterval(() => {\n      setBannerIndex((prev) => (prev + 1) % banners.length)\n    }, 3000)\n    \n    return () => clearInterval(interval)\n  }, [isUserInteracting, banners.length])\n\n  useEffect(() => {\n    if (banners.length > 0 && bannerIndex >= banners.length) {\n      setBannerIndex(0)\n    }\n    return () => {\n      if (autoSlideTimeoutRef.current) {\n        clearTimeout(autoSlideTimeoutRef.current)\n      }\n    }\n  }, [banners.length, bannerIndex])\n\n  // Touch handlers for swipe\n  const handleTouchStart = (e) => {\n    touchStartXRef.current = e.touches[0].clientX\n    setIsUserInteracting(true)\n  }\n\n  const handleTouchMove = (e) => {\n    touchEndXRef.current = e.touches[0].clientX\n  }\n\n  const handleTouchEnd = () => {\n    if (!touchStartXRef.current || !touchEndXRef.current) return\n\n    const distance = touchStartXRef.current - touchEndXRef.current\n    const minSwipeDistance = 50\n\n    if (Math.abs(distance) > minSwipeDistance) {\n      if (distance > 0) {\n        goToNextSlide()\n      } else {\n        goToPreviousSlide()\n      }\n    }\n\n    resetAutoSlide()\n    touchStartXRef.current = null\n    touchEndXRef.current = null\n  }\n\n  // Handlers\n  const handleProductClick = (productId) => {\n    navigate(`/product/${productId}`)\n  }\n\n  const handleCategoryClick = (categoryId) => {\n    if (categoryId === 'all') {\n      navigate('/products')\n    } else {\n      navigate(`/products?category=${categoryId}`)\n    }\n  }\n\n  const handleAddToCart = async (e, productId) => {\n    e.stopPropagation()\n    if (!authenticated) {\n      navigate('/login')\n      return\n    }\n    try {\n      await addToCart(productId, 1)\n      // Cart will be updated via context\n    } catch (error) {\n      console.error('Failed to add to cart:', error)\n    }\n  }\n\n  const handleToggleFavourite = async (e, productId) => {\n    e.stopPropagation()\n    if (!authenticated) {\n      navigate('/login')\n      return\n    }\n    try {\n      if (favourites.includes(productId)) {\n        await removeFromFavourites(productId)\n        dispatch({ type: 'REMOVE_FROM_FAVOURITES', payload: { productId } })\n      } else {\n        await addToFavourites(productId)\n        dispatch({ type: 'ADD_TO_FAVOURITES', payload: { productId } })\n      }\n    } catch (error) {\n      console.error('Failed to toggle favourite:', error)\n    }\n  }\n\n  const handleBannerClick = (banner) => {\n    if (banner.productIds && banner.productIds.length > 0) {\n      navigate(`/products?carousel=${banner.id}`)\n    }\n  }\n\n  return (\n    <Layout>\n      {/* Hero/Banner Section - Only show if carousels exist */}\n      {banners.length > 0 && (\n        <Section className=\"home-hero\">\n          <Container>\n            <div\n              className=\"home-hero__carousel\"\n              onTouchStart={handleTouchStart}\n              onTouchMove={handleTouchMove}\n              onTouchEnd={handleTouchEnd}\n            >\n              {banners.map((banner, index) => (\n                <div\n                  key={banner.id}\n                  className={cn(\n                    'home-hero__slide',\n                    index === bannerIndex ? 'home-hero__slide--active' : 'home-hero__slide--hidden'\n                  )}\n                  style={{ backgroundImage: `url(${banner.image})` }}\n                  onClick={() => handleBannerClick(banner)}\n                >\n                  <div className=\"home-hero__overlay\" />\n                  <div className=\"home-hero__content\">\n                    <h1 className=\"home-hero__title\">{banner.title}</h1>\n                    <p className=\"home-hero__subtitle\">{banner.subtitle}</p>\n                  </div>\n                </div>\n              ))}\n            </div>\n            {banners.length > 1 && (\n              <div className=\"home-hero__indicators\">\n                {banners.map((_, index) => (\n                  <button\n                    key={index}\n                    type=\"button\"\n                    className={cn(\n                      'home-hero__indicator',\n                      index === bannerIndex && 'home-hero__indicator--active'\n                    )}\n                    onClick={() => goToSlide(index)}\n                    aria-label={`Go to slide ${index + 1}`}\n                  />\n                ))}\n              </div>\n            )}\n          </Container>\n        </Section>\n      )}\n\n      {/* Categories Section */}\n      <Section className=\"home-categories\">\n        <Container>\n          <div className=\"home-section__header\">\n            <h2 className=\"home-section__title\">Browse Categories</h2>\n            <Link to=\"/products\" className=\"home-section__link\">\n              See All\n            </Link>\n          </div>\n          <div className=\"home-categories__grid\">\n            {loading ? (\n              <div className=\"col-span-full text-center py-12\">\n                <p className=\"text-gray-500\">Loading categories...</p>\n              </div>\n            ) : categories.length === 0 ? (\n              <div className=\"col-span-full text-center py-12\">\n                <p className=\"text-gray-500\">No categories available</p>\n              </div>\n            ) : (\n              categories.slice(0, 6).map((category) => (\n                <Link\n                  key={category.id}\n                  to={`/products?category=${category.id}`}\n                  className=\"home-category-card\"\n                >\n                  <div className=\"home-category-card__image\">\n                    {category.icon ? (\n                      <img src={category.icon} alt={category.name} />\n                    ) : (\n                      <span className=\"text-4xl\">{category.emoji || 'ðŸ“¦'}</span>\n                    )}\n                  </div>\n                  <div className=\"home-category-card__title\">\n                    {formatCategoryName(category.name)}\n                  </div>\n                </Link>\n              ))\n            )}\n          </div>\n        </Container>\n      </Section>\n\n      {/* Featured/Popular Products Section */}\n      <Section className=\"home-featured\">\n        <Container>\n          <div className=\"home-section__header\">\n            <div>\n              <h2 className=\"home-section__title\">Featured Products</h2>\n              <p className=\"home-section__subtitle\">Best sellers this week</p>\n            </div>\n            <Link to=\"/products\" className=\"home-section__link\">\n              View All\n            </Link>\n          </div>\n          <div className=\"home-featured__grid\">\n            {loading ? (\n              <div className=\"col-span-full text-center py-12\">\n                <p className=\"text-gray-500\">Loading products...</p>\n              </div>\n            ) : popularProducts.length === 0 ? (\n              <div className=\"col-span-full text-center py-12\">\n                <p className=\"text-gray-500\">No products available</p>\n              </div>\n            ) : (\n              popularProducts.map((product) => {\n                const productId = product._id || product.id\n                const inStock = (product.stock || 0) > 0\n                const productImage = getPrimaryImageUrl(product)\n                const isWishlisted = favourites.includes(productId)\n                \n                return (\n                  <div\n                    key={productId}\n                    className=\"home-product-card\"\n                    onClick={() => handleProductClick(productId)}\n                  >\n                    <div className=\"home-product-card__image-wrapper\">\n                      <img\n                        src={productImage}\n                        alt={product.name}\n                        className=\"home-product-card__image\"\n                      />\n                      {authenticated && (\n                        <button\n                          type=\"button\"\n                          className=\"home-product-card__wishlist\"\n                          onClick={(e) => handleToggleFavourite(e, productId)}\n                        >\n                          <svg\n                            className=\"h-5 w-5\"\n                            fill={isWishlisted ? '#ef4444' : 'none'}\n                            stroke={isWishlisted ? '#ef4444' : 'currentColor'}\n                            viewBox=\"0 0 24 24\"\n                          >\n                            <path\n                              strokeLinecap=\"round\"\n                              strokeLinejoin=\"round\"\n                              strokeWidth={2}\n                              d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"\n                            />\n                          </svg>\n                        </button>\n                      )}\n                    </div>\n                    <h3 className=\"home-product-card__title\">{product.name}</h3>\n                    <div className=\"home-product-card__price\">\n                      â‚¹{(product.priceToUser || product.price || 0).toLocaleString('en-IN')}\n                    </div>\n                    <button\n                      className=\"home-product-card__button\"\n                      onClick={(e) => handleAddToCart(e, productId)}\n                      disabled={!inStock}\n                    >\n                      {inStock ? 'Add to Cart' : 'Out of Stock'}\n                    </button>\n                  </div>\n                )\n              })\n            )}\n          </div>\n        </Container>\n      </Section>\n\n      {/* Deals/Highlights Section */}\n      {specialOffers.length > 0 && (\n        <Section className=\"home-deals\">\n          <Container>\n            <div className=\"home-section__header\">\n              <div>\n                <h2 className=\"home-section__title\">Special Offers</h2>\n                <p className=\"home-section__subtitle\">Limited time deals</p>\n              </div>\n            </div>\n            <div className=\"home-deals__container\">\n              {specialOffers.slice(0, 3).map((offer) => (\n                <div key={offer.id} className=\"home-deal-card\">\n                  {offer.image && (\n                    <div className=\"home-deal-card__image\">\n                      <img src={offer.image} alt={offer.title} />\n                      {offer.specialTag && (\n                        <div className=\"home-deal-card__badge\">{offer.specialTag}</div>\n                      )}\n                    </div>\n                  )}\n                  <div className=\"home-deal-card__content\">\n                    <h4 className=\"home-deal-card__title\">{offer.title}</h4>\n                    {offer.description && (\n                      <p className=\"home-deal-card__description\">{offer.description}</p>\n                    )}\n                    {offer.specialValue && (\n                      <div className=\"home-deal-card__price\">\n                        <span className=\"home-deal-card__price-current\">{offer.specialValue}</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </Container>\n        </Section>\n      )}\n    </Layout>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\LoginPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":111,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\nimport { useWebsiteDispatch } from '../context/WebsiteContext'\nimport * as websiteApi from '../services/websiteApi'\n\nexport function LoginPage() {\n  const navigate = useNavigate()\n  const dispatch = useWebsiteDispatch()\n  const [step, setStep] = useState('phone') // 'phone' | 'otp'\n  const [form, setForm] = useState({ phone: '' })\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setForm((prev) => ({ ...prev, [name]: value }))\n    setError(null)\n  }\n\n  const handleRequestOtp = async (e) => {\n    e.preventDefault()\n    setError(null)\n    setLoading(true)\n\n    try {\n      if (!form.phone.trim()) {\n        setError('Contact number is required')\n        setLoading(false)\n        return\n      }\n      if (form.phone.length < 10) {\n        setError('Please enter a valid contact number')\n        setLoading(false)\n        return\n      }\n\n      // Request OTP using websiteApi\n      const result = await websiteApi.requestOTP({ phone: form.phone })\n      \n      if (result.success || result.data) {\n        setStep('otp')\n      } else {\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Failed to send OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleVerifyOtp = async (otpCode) => {\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Login with OTP using websiteApi\n      const result = await websiteApi.loginWithOtp({ phone: form.phone, otp: otpCode })\n\n      if (result.success || result.data) {\n          // Store token if provided (same user_token as User module)\n          if (result.data?.token) {\n            localStorage.setItem('user_token', result.data.token)\n          }\n        \n        // Update WebsiteContext with user data\n        const userData = result.data?.user || { name: 'User', phone: form.phone }\n        dispatch({\n          type: 'AUTH_LOGIN',\n          payload: {\n            name: userData.name || 'User',\n            phone: userData.phone || form.phone,\n            sellerId: userData.sellerId || null,\n            location: userData.location || null,\n          },\n        })\n        \n        // Navigate to website homepage\n        navigate('/')\n      } else {\n        // Check if user needs to register\n        if (result.error?.message?.includes('not found') || result.requiresRegistration) {\n          setError('User not found. Please register first.')\n          setTimeout(() => {\n            navigate('/register')\n          }, 2000)\n        } else {\n          setError(result.error?.message || 'Invalid OTP. Please try again.')\n        }\n      }\n    } catch (err) {\n      // Check if error indicates user doesn't exist\n      if (err.error?.message?.includes('not found') || err.requiresRegistration) {\n        setError('User not found. Redirecting to registration...')\n        setTimeout(() => {\n          navigate('/register')\n        }, 2000)\n      } else {\n        setError(err.error?.message || err.message || 'Verification failed. Please try again.')\n      }\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleResendOtp = async () => {\n    setLoading(true)\n    try {\n      await websiteApi.requestOTP({ phone: form.phone })\n    } catch (err) {\n      setError('Failed to resend OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (step === 'otp') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <OtpVerification\n              phone={form.phone}\n              onVerify={handleVerifyOtp}\n              onResend={handleResendOtp}\n              onBack={() => setStep('phone')}\n              loading={loading}\n              error={error}\n              userType=\"user\"\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4\">\n            <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n            </svg>\n          </div>\n          <p className=\"text-xs uppercase tracking-wide text-green-600 font-semibold\">Welcome Back</p>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Sign in to IRA Sathi</h1>\n          <p className=\"text-sm text-gray-600\">Enter your contact number to continue</p>\n        </div>\n\n        <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\n            {error && (\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\n                <p className=\"text-sm text-red-600\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"login-phone\" className=\"text-xs font-semibold text-gray-700\">\n                Contact Number <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"login-phone\"\n                name=\"phone\"\n                type=\"tel\"\n                required\n                value={form.phone}\n                onChange={handleChange}\n                placeholder=\"+91 90000 00000\"\n                maxLength={15}\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? 'Sending OTP...' : 'Continue'}\n            </button>\n\n            <div className=\"text-center text-sm\">\n              <span className=\"text-gray-600\">Don't have an account? </span>\n              <button\n                type=\"button\"\n                onClick={() => navigate('/register')}\n                className=\"text-green-600 font-semibold hover:underline\"\n              >\n                Sign up\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\OrderConfirmationPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\ProductDetailPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'fetchProducts' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":16,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":74,"suggestions":[{"messageId":"removeVar","data":{"varName":"fetchProducts"},"fix":{"range":[792,807],"text":""},"desc":"Remove unused variable 'fetchProducts'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":110,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":110,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[4236,4237],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'totalVariantPrice' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":276,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":276,"endColumn":26}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect, useRef, useCallback } from 'react'\nimport { useParams, useNavigate, Link } from 'react-router-dom'\nimport { Layout, Container } from '../components/Layout'\nimport { useWebsiteApi } from '../hooks/useWebsiteApi'\nimport { useWebsiteState, useWebsiteDispatch } from '../context/WebsiteContext'\nimport * as websiteApi from '../services/websiteApi'\nimport { getAllImageUrls, getPrimaryImageUrl } from '../utils/productImages'\nimport { cn } from '../../../lib/cn'\nimport '../styles/website.css'\n\nexport function ProductDetailPage() {\n  const { productId } = useParams()\n  const navigate = useNavigate()\n  const dispatch = useWebsiteDispatch()\n  const { favourites, authenticated } = useWebsiteState()\n  const { addToCart, addToFavourites, removeFromFavourites, fetchProducts } = useWebsiteApi()\n  \n  const [product, setProduct] = useState(null)\n  const [similarProducts, setSimilarProducts] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [quantity, setQuantity] = useState(1)\n  const [selectedImage, setSelectedImage] = useState(0)\n  const [isWishlisted, setIsWishlisted] = useState(false)\n  const [selectedAttributes, setSelectedAttributes] = useState({})\n  const [selectedAttributeStock, setSelectedAttributeStock] = useState(null)\n  const [selectedVariants, setSelectedVariants] = useState([])\n  const [variantQuantities, setVariantQuantities] = useState({})\n  const [activeTab, setActiveTab] = useState('description')\n  const [variantError, setVariantError] = useState('')\n  const variantSectionRef = useRef(null)\n  const containerRef = useRef(null)\n\n  // Fetch product details and related products\n  useEffect(() => {\n    const loadProduct = async () => {\n      if (!productId || productId === 'all') {\n        setLoading(false)\n        return\n      }\n      \n      setLoading(true)\n      try {\n        const result = await websiteApi.getProductDetails(productId)\n        if (result.success && result.data?.product) {\n          const productData = result.data.product\n          setProduct(productData)\n          setIsWishlisted(productData.isWishlisted || favourites.includes(productId))\n          \n          // Fetch similar products (same category)\n          if (productData.category) {\n            const similarResult = await websiteApi.getProducts({ \n              category: productData.category, \n              limit: 10 \n            })\n            if (similarResult.success && similarResult.data?.products) {\n              const similar = similarResult.data.products\n                .filter((p) => (p._id || p.id) !== productId)\n                .slice(0, 8)\n              setSimilarProducts(similar)\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error loading product:', error)\n      } finally {\n        setLoading(false)\n      }\n    }\n    \n    if (productId) {\n      loadProduct()\n    }\n  }, [productId, favourites])\n\n  // Smart attribute mapping: Group by attribute name, then show properties\n  const attributeStructure = useMemo(() => {\n    if (!product?.attributeStocks || product.attributeStocks.length === 0) {\n      return { attributeNameKey: null, attributeNames: [], attributeProperties: {} }\n    }\n\n    const allKeys = new Set()\n    product.attributeStocks.forEach(stock => {\n      if (stock.attributes) {\n        Object.keys(stock.attributes).forEach(key => allKeys.add(key))\n      }\n    })\n\n    let attributeNameKey = null\n    const possibleNameKeys = Array.from(allKeys).filter(key => \n      key.toLowerCase().includes('name') || \n      key.toLowerCase().includes('attribute') ||\n      key.toLowerCase() === 'type' && Array.from(allKeys).length > 2\n    )\n\n    if (possibleNameKeys.length > 0) {\n      attributeNameKey = possibleNameKeys[0]\n    } else {\n      const keyValueCounts = {}\n      Array.from(allKeys).forEach(key => {\n        const uniqueValues = new Set()\n        product.attributeStocks.forEach(stock => {\n          if (stock.attributes && stock.attributes[key]) {\n            uniqueValues.add(stock.attributes[key])\n          }\n        })\n        keyValueCounts[key] = uniqueValues.size\n      })\n      const sortedKeys = Object.entries(keyValueCounts)\n        .sort((a, b) => b[1] - a[1])\n        .filter(([_, count]) => count < product.attributeStocks.length)\n      \n      attributeNameKey = sortedKeys.length > 0 ? sortedKeys[0][0] : Array.from(allKeys)[0]\n    }\n\n    const attributeNames = new Set()\n    product.attributeStocks.forEach(stock => {\n      if (stock.attributes && stock.attributes[attributeNameKey]) {\n        attributeNames.add(stock.attributes[attributeNameKey])\n      }\n    })\n\n    const attributeProperties = {}\n    Array.from(attributeNames).forEach(attrName => {\n      attributeProperties[attrName] = {}\n      \n      const relevantStocks = product.attributeStocks.filter(stock => \n        stock.attributes && stock.attributes[attributeNameKey] === attrName\n      )\n\n      relevantStocks.forEach(stock => {\n        Object.keys(stock.attributes).forEach(key => {\n          if (key !== attributeNameKey) {\n            if (!attributeProperties[attrName][key]) {\n              attributeProperties[attrName][key] = new Set()\n            }\n            const value = stock.attributes[key]\n            if (value) {\n              if (Array.isArray(value)) {\n                value.forEach(v => attributeProperties[attrName][key].add(v))\n              } else {\n                attributeProperties[attrName][key].add(value)\n              }\n            }\n          }\n        })\n      })\n\n      Object.keys(attributeProperties[attrName]).forEach(propKey => {\n        attributeProperties[attrName][propKey] = Array.from(attributeProperties[attrName][propKey]).sort()\n      })\n    })\n\n    return {\n      attributeNameKey,\n      attributeNames: Array.from(attributeNames).sort(),\n      attributeProperties\n    }\n  }, [product])\n\n  const availableProperties = useMemo(() => {\n    if (!selectedAttributes[attributeStructure.attributeNameKey]) {\n      return {}\n    }\n    const selectedAttrName = selectedAttributes[attributeStructure.attributeNameKey]\n    return attributeStructure.attributeProperties[selectedAttrName] || {}\n  }, [selectedAttributes, attributeStructure])\n\n  const findMatchingAttributeStock = useMemo(() => {\n    if (!product?.attributeStocks || product.attributeStocks.length === 0) {\n      return null\n    }\n\n    if (Object.keys(selectedAttributes).length === 0) {\n      return null\n    }\n\n    return product.attributeStocks.find(stock => {\n      if (!stock.attributes) return false\n      return Object.keys(selectedAttributes).every(key => {\n        const stockValue = stock.attributes[key]\n        const selectedValue = selectedAttributes[key]\n        \n        if (Array.isArray(stockValue)) {\n          return stockValue.includes(selectedValue)\n        }\n        if (Array.isArray(selectedValue)) {\n          return selectedValue.includes(stockValue)\n        }\n        return stockValue === selectedValue\n      })\n    }) || null\n  }, [product, selectedAttributes])\n\n  useEffect(() => {\n    setSelectedAttributeStock(findMatchingAttributeStock)\n    if (findMatchingAttributeStock) {\n      setQuantity(1)\n    }\n  }, [findMatchingAttributeStock])\n\n  useEffect(() => {\n    if (product) {\n      setQuantity(1)\n      setSelectedImage(0)\n      setSelectedAttributes({})\n      setSelectedAttributeStock(null)\n      setSelectedVariants([])\n      setVariantError('')\n      setIsWishlisted(product.isWishlisted || favourites.includes(productId))\n      if (containerRef.current) {\n        containerRef.current.scrollIntoView({ behavior: 'smooth', block: 'start' })\n      }\n    }\n  }, [productId, product, favourites])\n\n  const images = useMemo(() => {\n    if (!product) {\n      return ['https://via.placeholder.com/400']\n    }\n    const allImages = getAllImageUrls(product)\n    return allImages.length > 0 ? allImages : ['https://via.placeholder.com/400']\n  }, [product])\n\n  const currentStock = useMemo(() => {\n    if (!product) return 0\n    if (selectedAttributeStock) {\n      return selectedAttributeStock.displayStock || 0\n    }\n    return product.displayStock || product.stock || 0\n  }, [product, selectedAttributeStock])\n\n  const currentPrice = useMemo(() => {\n    if (!product) return 0\n    if (selectedAttributeStock) {\n      return selectedAttributeStock.userPrice || 0\n    }\n    return product.priceToUser || product.price || 0\n  }, [product, selectedAttributeStock])\n\n  const originalPrice = useMemo(() => {\n    if (!product) return 0\n    if (selectedAttributeStock && selectedAttributeStock.originalPrice) {\n      return selectedAttributeStock.originalPrice\n    }\n    return product.originalPrice || product.priceToUser || product.price || 0\n  }, [product, selectedAttributeStock])\n\n  const currentStockUnit = useMemo(() => {\n    if (!product) return 'kg'\n    if (selectedAttributeStock) {\n      return selectedAttributeStock.stockUnit || 'kg'\n    }\n    return product.stockUnit || 'kg'\n  }, [product, selectedAttributeStock])\n\n  const hasAttributes = useMemo(() => {\n    if (!product) return false\n    if (product.attributeStocks && Array.isArray(product.attributeStocks) && product.attributeStocks.length > 0) {\n      return product.attributeStocks.some(stock => \n        stock && \n        stock.attributes && \n        typeof stock.attributes === 'object' && \n        Object.keys(stock.attributes).length > 0\n      )\n    }\n    return false\n  }, [product])\n\n  const getVariantKey = useCallback((variantStock) => {\n    const stockAttrs = variantStock.attributes instanceof Map \n      ? Object.fromEntries(variantStock.attributes)\n      : variantStock.attributes || {}\n    return JSON.stringify(stockAttrs)\n  }, [])\n\n  const totalVariantPrice = useMemo(() => {\n    return selectedVariants.reduce((total, variant) => {\n      const variantKey = getVariantKey(variant)\n      const variantQty = variantQuantities[variantKey] || 1\n      return total + ((variant.userPrice || variant.priceToUser || 0) * variantQty)\n    }, 0)\n  }, [selectedVariants, variantQuantities, getVariantKey])\n\n  useEffect(() => {\n    if (selectedVariants.length === 1) {\n      setSelectedAttributeStock(selectedVariants[0])\n    } else if (selectedVariants.length === 0) {\n      setSelectedAttributeStock(null)\n    }\n  }, [selectedVariants])\n\n  const inStock = currentStock > 0\n  const stockStatus = currentStock > 10 ? 'In Stock' : currentStock > 0 ? 'Low Stock' : 'Out of Stock'\n  const maxQuantity = currentStock\n\n  const handleProductClick = (clickedProductId) => {\n    navigate(`/product/${clickedProductId}`)\n  }\n\n  if (loading) {\n    return (\n      <Layout>\n        <Container className=\"product-detail\">\n          <div className=\"text-center py-12\">\n            <p className=\"text-lg font-semibold text-gray-600\">Loading product...</p>\n          </div>\n        </Container>\n      </Layout>\n    )\n  }\n\n  if (!product) {\n    return (\n      <Layout>\n        <Container className=\"product-detail\">\n          <div className=\"text-center py-12\">\n            <p className=\"text-lg font-semibold text-gray-600 mb-4\">Product not found</p>\n            <button\n              type=\"button\"\n              className=\"px-6 py-3 rounded-lg bg-gradient-to-r from-green-500 to-green-600 text-white font-semibold\"\n              onClick={() => navigate(-1)}\n            >\n              Go Back\n            </button>\n          </div>\n        </Container>\n      </Layout>\n    )\n  }\n\n  const handleAttributeChange = (attributeKey, value) => {\n    setSelectedAttributes(prev => {\n      const newSelection = { ...prev, [attributeKey]: value }\n      if (attributeKey === attributeStructure.attributeNameKey) {\n        return { [attributeKey]: value }\n      }\n      return newSelection\n    })\n    setVariantError('')\n  }\n\n  const handleVariantToggle = (variantStock) => {\n    const variantKey = getVariantKey(variantStock)\n    \n    setSelectedVariants(prev => {\n      const stockAttrs = variantStock.attributes instanceof Map \n        ? Object.fromEntries(variantStock.attributes)\n        : variantStock.attributes || {}\n      \n      const exists = prev.find(v => {\n        const vAttrs = v.attributes instanceof Map \n          ? Object.fromEntries(v.attributes)\n          : v.attributes || {}\n        return JSON.stringify(vAttrs) === JSON.stringify(stockAttrs)\n      })\n      \n      if (exists) {\n        setVariantQuantities(prevQty => {\n          const newQty = { ...prevQty }\n          delete newQty[variantKey]\n          return newQty\n        })\n        return prev.filter(v => {\n          const vAttrs = v.attributes instanceof Map \n            ? Object.fromEntries(v.attributes)\n            : v.attributes || {}\n          return JSON.stringify(vAttrs) !== JSON.stringify(stockAttrs)\n        })\n      } else {\n        setVariantQuantities(prevQty => ({\n          ...prevQty,\n          [variantKey]: 1\n        }))\n        return [...prev, variantStock]\n      }\n    })\n    setVariantError('')\n  }\n\n  const handleVariantQuantityChange = (variantStock, delta) => {\n    const variantKey = getVariantKey(variantStock)\n    const currentQty = variantQuantities[variantKey] || 1\n    const maxQty = variantStock.displayStock || variantStock.actualStock || 999\n    \n    const newQty = Math.max(1, Math.min(maxQty, currentQty + delta))\n    setVariantQuantities(prev => ({\n      ...prev,\n      [variantKey]: newQty\n    }))\n  }\n\n  const formatAttributeLabel = (key) => {\n    return key\n      .replace(/([A-Z])/g, ' $1')\n      .replace(/^./, str => str.toUpperCase())\n      .trim()\n  }\n\n  const handleAddToCart = async () => {\n    if (!inStock) {\n      return\n    }\n\n    if (!authenticated) {\n      navigate('/login')\n      return\n    }\n\n    if (hasAttributes && attributeStructure.attributeNames.length > 0) {\n      if (selectedVariants.length === 0) {\n        setVariantError('Please select at least one variant to proceed')\n        setTimeout(() => {\n          if (variantSectionRef.current) {\n            variantSectionRef.current.scrollIntoView({ behavior: 'smooth', block: 'center' })\n          }\n        }, 100)\n        return\n      }\n    }\n\n    setVariantError('')\n    \n    try {\n      if (selectedVariants.length > 0) {\n        for (const variant of selectedVariants) {\n          const variantAttrs = variant.attributes instanceof Map\n            ? Object.fromEntries(variant.attributes)\n            : variant.attributes || {}\n          const variantKey = getVariantKey(variant)\n          const variantQty = variantQuantities[variantKey] || 1\n          await addToCart(productId, variantQty, variantAttrs)\n        }\n      } else {\n        await addToCart(productId, quantity)\n      }\n    } catch (error) {\n      console.error('Failed to add to cart:', error)\n    }\n  }\n\n  const handleBuyNow = async () => {\n    await handleAddToCart()\n    navigate('/cart')\n  }\n\n  const handleToggleWishlist = async () => {\n    if (!authenticated) {\n      navigate('/login')\n      return\n    }\n    \n    try {\n      if (isWishlisted) {\n        await removeFromFavourites(productId)\n        dispatch({ type: 'REMOVE_FROM_FAVOURITES', payload: { productId } })\n        setIsWishlisted(false)\n      } else {\n        await addToFavourites(productId)\n        dispatch({ type: 'ADD_TO_FAVOURITES', payload: { productId } })\n        setIsWishlisted(true)\n      }\n    } catch (error) {\n      console.error('Failed to toggle wishlist:', error)\n    }\n  }\n\n  const discount = originalPrice > currentPrice \n    ? Math.round(((originalPrice - currentPrice) / originalPrice) * 100)\n    : 0\n\n  return (\n    <Layout>\n      <Container className=\"product-detail\" ref={containerRef}>\n        <div className=\"product-detail__layout\">\n          {/* Left Column: Image Gallery */}\n          <div className=\"product-detail__gallery\">\n            <div className=\"product-detail__main-image\">\n              <img src={images[selectedImage] || images[0]} alt={product.name} />\n            </div>\n            \n            {images.length > 1 && (\n              <div className=\"product-detail__thumbnails\">\n                {images.map((img, index) => (\n                  <button\n                    key={index}\n                    type=\"button\"\n                    className={cn(\n                      'product-detail__thumbnail',\n                      selectedImage === index && 'product-detail__thumbnail--active'\n                    )}\n                    onClick={() => setSelectedImage(index)}\n                  >\n                    <img src={img} alt={`${product.name} view ${index + 1}`} />\n                  </button>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {/* Right Column: Product Info */}\n          <div className=\"product-detail__info\">\n            <div className=\"flex items-start justify-between gap-4 mb-4\">\n              <h1 className=\"product-detail__title\">{product.name}</h1>\n              {authenticated && (\n                <button\n                  type=\"button\"\n                  onClick={handleToggleWishlist}\n                  className=\"p-2 rounded-lg border-2 transition-all\"\n                  style={{\n                    borderColor: isWishlisted ? '#ef4444' : '#e5e7eb',\n                    backgroundColor: isWishlisted ? '#fef2f2' : 'transparent'\n                  }}\n                >\n                  <svg\n                    className=\"h-6 w-6\"\n                    fill={isWishlisted ? '#ef4444' : 'none'}\n                    stroke={isWishlisted ? '#ef4444' : 'currentColor'}\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"\n                    />\n                  </svg>\n                </button>\n              )}\n            </div>\n            \n            {/* Rating */}\n            <div className=\"product-detail__rating\">\n              <div className=\"product-detail__rating-stars\">\n                {[1, 2, 3, 4, 5].map((star) => (\n                  <svg\n                    key={star}\n                    className=\"h-5 w-5\"\n                    fill={star <= Math.round(product.rating || 0) ? '#fbbf24' : 'none'}\n                    stroke={star <= Math.round(product.rating || 0) ? '#fbbf24' : '#d1d5db'}\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z\"\n                    />\n                  </svg>\n                ))}\n              </div>\n              <span className=\"product-detail__rating-text\">\n                {product.rating || 0} ({product.reviews || 0} reviews)\n              </span>\n            </div>\n            \n            {/* Price */}\n            <div className=\"product-detail__price\">\n              <span className=\"product-detail__price-current\">\n                â‚¹{currentPrice.toLocaleString('en-IN')}\n              </span>\n              {originalPrice > currentPrice && (\n                <>\n                  <span className=\"product-detail__price-original\">\n                    â‚¹{originalPrice.toLocaleString('en-IN')}\n                  </span>\n                  {discount > 0 && (\n                    <span className=\"product-detail__price-discount\">\n                      {discount}% OFF\n                    </span>\n                  )}\n                </>\n              )}\n            </div>\n\n            {/* Variant Selection */}\n            {hasAttributes && attributeStructure.attributeNames.length > 0 && (\n              <div ref={variantSectionRef} className=\"product-detail__variants\">\n                {variantError && (\n                  <div className=\"mb-4 p-3 rounded-lg bg-red-50 border-2 border-red-300\">\n                    <p className=\"text-sm font-semibold text-red-600\">{variantError}</p>\n                  </div>\n                )}\n                \n                {/* Step 1: Select Attribute Name */}\n                {attributeStructure.attributeNameKey && (\n                  <div className=\"product-detail__variant-group\">\n                    <label className=\"product-detail__variant-label\">\n                      {formatAttributeLabel(attributeStructure.attributeNameKey)}\n                    </label>\n                    <div className=\"product-detail__variant-options\">\n                      {attributeStructure.attributeNames.map((attrName) => {\n                        const isSelected = selectedAttributes[attributeStructure.attributeNameKey] === attrName\n                        return (\n                          <button\n                            key={attrName}\n                            type=\"button\"\n                            onClick={() => handleAttributeChange(attributeStructure.attributeNameKey, attrName)}\n                            className={cn(\n                              'product-detail__variant-option',\n                              isSelected && 'product-detail__variant-option--selected'\n                            )}\n                          >\n                            {attrName}\n                          </button>\n                        )\n                      })}\n                    </div>\n                  </div>\n                )}\n\n                {/* Step 2: Show Properties for selected Attribute Name */}\n                {selectedAttributes[attributeStructure.attributeNameKey] && Object.keys(availableProperties).length > 0 && (\n                  <div className=\"product-detail__variant-group\">\n                    {Object.keys(availableProperties).map((propKey) => (\n                      <div key={propKey} className=\"mb-4\">\n                        <label className=\"product-detail__variant-label\">\n                          {formatAttributeLabel(propKey)}\n                        </label>\n                        <div className=\"product-detail__variant-options\">\n                          {availableProperties[propKey].map((value) => {\n                            const isSelected = selectedAttributes[propKey] === value\n                            return (\n                              <button\n                                key={value}\n                                type=\"button\"\n                                onClick={() => handleAttributeChange(propKey, value)}\n                                className={cn(\n                                  'product-detail__variant-option',\n                                  isSelected && 'product-detail__variant-option--selected'\n                                )}\n                              >\n                                {value}\n                              </button>\n                            )\n                          })}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                {/* Show all available variants for selection */}\n                {selectedAttributes[attributeStructure.attributeNameKey] && (\n                  <div className=\"mt-4 space-y-2\">\n                    <p className=\"text-sm font-semibold text-gray-700 mb-2\">\n                      Available Variants (Select one or more):\n                    </p>\n                    {product.attributeStocks\n                      .filter(stock => {\n                        if (!stock.attributes || !stock.attributes[attributeStructure.attributeNameKey]) return false\n                        const stockAttrs = stock.attributes instanceof Map \n                          ? Object.fromEntries(stock.attributes)\n                          : stock.attributes\n                        return stockAttrs[attributeStructure.attributeNameKey] === selectedAttributes[attributeStructure.attributeNameKey]\n                      })\n                      .map((variantStock, idx) => {\n                        const stockAttrs = variantStock.attributes instanceof Map \n                          ? Object.fromEntries(variantStock.attributes)\n                          : variantStock.attributes || {}\n                        \n                        const isSelected = selectedVariants.some(v => {\n                          const vAttrs = v.attributes instanceof Map \n                            ? Object.fromEntries(v.attributes)\n                            : v.attributes || {}\n                          return JSON.stringify(vAttrs) === JSON.stringify(stockAttrs)\n                        })\n                        \n                        const variantAttributes = Object.entries(stockAttrs)\n                          .filter(([key]) => key !== attributeStructure.attributeNameKey)\n                          .map(([key, value]) => `${key}: ${value}`)\n                          .join(', ')\n                        \n                        const variantKey = getVariantKey(variantStock)\n                        const variantQty = variantQuantities[variantKey] || 1\n                        const maxQty = variantStock.displayStock || variantStock.actualStock || 999\n                        const variantPrice = variantStock.userPrice || variantStock.priceToUser || 0\n                        \n                        return (\n                          <div\n                            key={idx}\n                            className={cn(\n                              'p-3 rounded-lg border-2 transition-all',\n                              isSelected\n                                ? 'bg-green-50 border-green-500'\n                                : 'bg-white border-gray-200'\n                            )}\n                          >\n                            <div className=\"flex items-start justify-between gap-2 mb-2\">\n                              <div className=\"flex-1\">\n                                <p className=\"text-xs font-semibold text-gray-700 mb-1\">\n                                  Variant {idx + 1}: {variantAttributes || 'No additional attributes'}\n                                </p>\n                                <div className=\"flex items-center gap-4 text-xs\">\n                                  <span className=\"text-gray-600\">\n                                    Stock: <span className=\"font-semibold\">{variantStock.displayStock || 0} {variantStock.stockUnit || 'kg'}</span>\n                                  </span>\n                                  <span className=\"text-green-600 font-bold\">\n                                    â‚¹{variantPrice.toLocaleString('en-IN')}\n                                  </span>\n                                </div>\n                              </div>\n                              <button\n                                type=\"button\"\n                                onClick={() => handleVariantToggle(variantStock)}\n                                className={cn(\n                                  'w-5 h-5 rounded border-2 flex items-center justify-center',\n                                  isSelected\n                                    ? 'bg-green-500 border-green-500'\n                                    : 'bg-white border-gray-300'\n                                )}\n                              >\n                                {isSelected && (\n                                  <svg className=\"h-3 w-3 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                    <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                                  </svg>\n                                )}\n                              </button>\n                            </div>\n                            \n                            {isSelected && (\n                              <div className=\"mt-3 pt-3 border-t border-gray-200\">\n                                <label className=\"block text-xs font-semibold text-gray-700 mb-2\">Quantity</label>\n                                <div className=\"flex items-center justify-between gap-3\">\n                                  <div className=\"flex items-center gap-2 border border-gray-200 rounded-lg bg-white p-1.5\">\n                                    <button\n                                      type=\"button\"\n                                      className=\"w-7 h-7 rounded-md border border-gray-200 bg-white hover:bg-gray-50 transition-all disabled:opacity-50\"\n                                      onClick={(e) => {\n                                        e.stopPropagation()\n                                        handleVariantQuantityChange(variantStock, -1)\n                                      }}\n                                      disabled={variantQty <= 1}\n                                    >\n                                      <span className=\"text-gray-700\">âˆ’</span>\n                                    </button>\n                                    <span className=\"px-2 text-sm font-semibold text-gray-900 min-w-[2rem] text-center\">{variantQty}</span>\n                                    <button\n                                      type=\"button\"\n                                      className=\"w-7 h-7 rounded-md border border-gray-200 bg-white hover:bg-gray-50 transition-all disabled:opacity-50\"\n                                      onClick={(e) => {\n                                        e.stopPropagation()\n                                        handleVariantQuantityChange(variantStock, 1)\n                                      }}\n                                      disabled={variantQty >= maxQty}\n                                    >\n                                      <span className=\"text-gray-700\">+</span>\n                                    </button>\n                                  </div>\n                                  <div className=\"text-right\">\n                                    <p className=\"text-xs text-gray-600\">Available: {maxQty}</p>\n                                    <p className=\"text-xs font-bold text-green-600\">\n                                      Total: â‚¹{(variantPrice * variantQty).toLocaleString('en-IN')}\n                                    </p>\n                                  </div>\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                        )\n                      })}\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Quantity - Only show if no variants selected */}\n            {(!hasAttributes || selectedVariants.length === 0) && (\n              <div className=\"product-detail__quantity\">\n                <label>Quantity</label>\n                <div className=\"product-detail__quantity-controls\">\n                  <button \n                    onClick={() => setQuantity(q => Math.max(1, q - 1))}\n                    disabled={quantity <= 1}\n                  >\n                    âˆ’\n                  </button>\n                  <span>{quantity}</span>\n                  <button \n                    onClick={() => setQuantity(q => Math.min(maxQuantity || 999, q + 1))}\n                    disabled={quantity >= maxQuantity}\n                  >\n                    +\n                  </button>\n                </div>\n                {maxQuantity > 0 && (\n                  <p className=\"text-sm text-gray-600 mt-2\">\n                    Available: {maxQuantity} {currentStockUnit}\n                  </p>\n                )}\n              </div>\n            )}\n\n            {/* Actions */}\n            <div className=\"product-detail__actions\">\n              <button \n                className=\"product-detail__button-add\"\n                onClick={handleAddToCart}\n                disabled={!inStock || (hasAttributes && selectedVariants.length === 0)}\n              >\n                Add to Cart\n              </button>\n              <button \n                className=\"product-detail__button-buy\"\n                onClick={handleBuyNow}\n                disabled={!inStock || (hasAttributes && selectedVariants.length === 0)}\n              >\n                Buy Now\n              </button>\n            </div>\n\n            {/* Vendor Info */}\n            {product.vendor && (\n              <div className=\"product-detail__vendor\">\n                <p className=\"product-detail__vendor-name\">{product.vendor.name}</p>\n                {product.vendor.location && (\n                  <p className=\"product-detail__vendor-location\">\n                    <svg className=\"h-4 w-4 inline mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" />\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" />\n                    </svg>\n                    {product.vendor.location}\n                  </p>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Tabs Section */}\n        <div className=\"product-detail__tabs\">\n          <div className=\"product-detail__tabs-nav\">\n            <button \n              className={activeTab === 'description' ? 'active' : ''}\n              onClick={() => setActiveTab('description')}\n            >\n              Description\n            </button>\n            <button \n              className={activeTab === 'stock' ? 'active' : ''}\n              onClick={() => setActiveTab('stock')}\n            >\n              Stock\n            </button>\n            <button \n              className={activeTab === 'delivery' ? 'active' : ''}\n              onClick={() => setActiveTab('delivery')}\n            >\n              Delivery\n            </button>\n          </div>\n          \n          <div className=\"product-detail__tabs-content\">\n            {activeTab === 'description' && (\n              <div className=\"product-detail__description\">\n                {product.longDescription || product.description ? (\n                  <div className=\"prose prose-sm max-w-none\">\n                    {(product.longDescription || product.description)\n                      .split(/\\n\\n+/)\n                      .flatMap(p => p.split(/\\n/))\n                      .map(p => p.trim())\n                      .filter(p => p.length > 0)\n                      .map((paragraph, idx) => (\n                        <p key={idx} className=\"mb-4\">{paragraph}</p>\n                      ))}\n                  </div>\n                ) : (\n                  <p className=\"text-gray-500\">No description available for this product.</p>\n                )}\n              </div>\n            )}\n            {activeTab === 'stock' && (\n              <div className=\"product-detail__stock\">\n                <div className={cn(\n                  'p-4 rounded-lg border-2',\n                  inStock ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'\n                )}>\n                  <div className=\"flex items-center gap-2 mb-3\">\n                    <div className={cn(\n                      'w-4 h-4 rounded-full',\n                      inStock ? 'bg-green-500' : 'bg-red-500'\n                    )} />\n                    <h3 className=\"text-lg font-bold text-gray-900\">Stock Availability</h3>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm font-semibold text-gray-700\">Status:</span>\n                      <span className={cn(\n                        'text-sm font-bold',\n                        inStock ? 'text-green-600' : 'text-red-600'\n                      )}>\n                        {stockStatus}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm font-semibold text-gray-700\">Available Quantity:</span>\n                      <span className=\"text-sm font-bold text-gray-900\">\n                        {currentStock.toLocaleString('en-IN')} {currentStockUnit}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n            {activeTab === 'delivery' && (\n              <div className=\"product-detail__delivery\">\n                <div className=\"p-4 rounded-lg border-2 border-blue-200 bg-blue-50\">\n                  <div className=\"flex items-center gap-2 mb-3\">\n                    <svg className=\"h-5 w-5 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                    <h3 className=\"text-lg font-bold text-gray-900\">Delivery Information</h3>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div>\n                      <span className=\"text-sm font-semibold text-gray-700\">Estimated Delivery Time:</span>\n                      <p className=\"text-base font-bold text-gray-900\">\n                        {product.deliveryTime || 'Within 24 hours'}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Similar Products */}\n        {similarProducts.length > 0 && (\n          <div className=\"product-detail__similar\">\n            <h2>Similar Products</h2>\n            <div className=\"product-detail__similar-grid\">\n              {similarProducts.map((similarProduct) => {\n                const similarProductId = similarProduct._id || similarProduct.id\n                const similarImage = getPrimaryImageUrl(similarProduct)\n                const similarInStock = (similarProduct.stock || 0) > 0\n                const similarIsWishlisted = favourites.includes(similarProductId)\n                \n                return (\n                  <div\n                    key={similarProductId}\n                    className=\"home-product-card\"\n                    onClick={() => handleProductClick(similarProductId)}\n                  >\n                    <div className=\"home-product-card__image-wrapper\">\n                      <img\n                        src={similarImage}\n                        alt={similarProduct.name}\n                        className=\"home-product-card__image\"\n                      />\n                      {authenticated && (\n                        <button\n                          type=\"button\"\n                          className=\"home-product-card__wishlist\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            if (similarIsWishlisted) {\n                              removeFromFavourites(similarProductId)\n                              dispatch({ type: 'REMOVE_FROM_FAVOURITES', payload: { productId: similarProductId } })\n                            } else {\n                              addToFavourites(similarProductId)\n                              dispatch({ type: 'ADD_TO_FAVOURITES', payload: { productId: similarProductId } })\n                            }\n                          }}\n                        >\n                          <svg\n                            className=\"h-5 w-5\"\n                            fill={similarIsWishlisted ? '#ef4444' : 'none'}\n                            stroke={similarIsWishlisted ? '#ef4444' : 'currentColor'}\n                            viewBox=\"0 0 24 24\"\n                          >\n                            <path\n                              strokeLinecap=\"round\"\n                              strokeLinejoin=\"round\"\n                              strokeWidth={2}\n                              d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"\n                            />\n                          </svg>\n                        </button>\n                      )}\n                    </div>\n                    <h3 className=\"home-product-card__title\">{similarProduct.name}</h3>\n                    <div className=\"home-product-card__price\">\n                      â‚¹{(similarProduct.priceToUser || similarProduct.price || 0).toLocaleString('en-IN')}\n                    </div>\n                    <button\n                      className=\"home-product-card__button\"\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        if (authenticated) {\n                          addToCart(similarProductId, 1)\n                        } else {\n                          navigate('/login')\n                        }\n                      }}\n                      disabled={!similarInStock}\n                    >\n                      {similarInStock ? 'Add to Cart' : 'Out of Stock'}\n                    </button>\n                  </div>\n                )\n              })}\n            </div>\n          </div>\n        )}\n      </Container>\n    </Layout>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\ProductListingPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useMemo' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"useMemo"},"fix":{"range":[28,37],"text":""},"desc":"Remove unused variable 'useMemo'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'useRef' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"useRef"},"fix":{"range":[37,45],"text":""},"desc":"Remove unused variable 'useRef'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'websiteApi' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"websiteApi"},"fix":{"range":[330,351],"text":""},"desc":"Remove unused variable 'websiteApi'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'cn' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"cn"},"fix":{"range":[436,472],"text":""},"desc":"Remove unused variable 'cn'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchCategories'. Either include it or remove the dependency array.","line":44,"column":6,"nodeType":"ArrayExpression","endLine":44,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCategories]","fix":{"range":[1838,1840],"text":"[fetchCategories]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchProducts'. Either include it or remove the dependency array.","line":113,"column":6,"nodeType":"ArrayExpression","endLine":113,"endColumn":89,"suggestions":[{"desc":"Update the dependencies array to be: [searchQuery, selectedCategory, sortBy, priceRange, availabilityFilter, carouselId, fetchProducts]","fix":{"range":[3876,3959],"text":"[searchQuery, selectedCategory, sortBy, priceRange, availabilityFilter, carouselId, fetchProducts]"}}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo, useRef } from 'react'\nimport { useSearchParams, useNavigate, Link } from 'react-router-dom'\nimport { Layout, Container } from '../components/Layout'\nimport { useWebsiteApi } from '../hooks/useWebsiteApi'\nimport { useWebsiteState, useWebsiteDispatch } from '../context/WebsiteContext'\nimport * as websiteApi from '../services/websiteApi'\nimport { getPrimaryImageUrl } from '../utils/productImages'\nimport { cn } from '../../../lib/cn'\nimport '../styles/website.css'\n\nexport function ProductListingPage() {\n  const navigate = useNavigate()\n  const dispatch = useWebsiteDispatch()\n  const { favourites, authenticated } = useWebsiteState()\n  const [searchParams] = useSearchParams()\n  const searchQuery = searchParams.get('search') || ''\n  const categoryId = searchParams.get('category') || ''\n  const carouselId = searchParams.get('carousel') || ''\n  \n  const { fetchCategories, fetchProducts, addToCart, addToFavourites, removeFromFavourites } = useWebsiteApi()\n  \n  const [filtersOpen, setFiltersOpen] = useState(false)\n  const [sortBy, setSortBy] = useState('popular')\n  const [priceRange, setPriceRange] = useState({ min: 0, max: 10000 })\n  const [selectedCategory, setSelectedCategory] = useState(categoryId || 'all')\n  const [availabilityFilter, setAvailabilityFilter] = useState('all')\n  const [products, setProducts] = useState([])\n  const [categories, setCategories] = useState([])\n  const [loading, setLoading] = useState(true)\n  \n  // Fetch categories\n  useEffect(() => {\n    const loadCategories = async () => {\n      try {\n        const result = await fetchCategories()\n        if (result.data?.categories) {\n          setCategories(result.data.categories)\n        }\n      } catch (error) {\n        console.error('Error loading categories:', error)\n      }\n    }\n    loadCategories()\n  }, [])\n\n  // Fetch products based on filters\n  useEffect(() => {\n    const loadProducts = async () => {\n      setLoading(true)\n      try {\n        const params = {\n          limit: 100,\n          maxPrice: priceRange.max,\n        }\n        \n        if (searchQuery.trim()) {\n          params.search = searchQuery.trim()\n        }\n        \n        if (selectedCategory !== 'all') {\n          params.category = selectedCategory\n        }\n        \n        if (carouselId) {\n          // Handle carousel products if needed\n          // This might need a separate API endpoint\n        }\n        \n        // Map sortBy to API sort parameter\n        if (sortBy === 'price-low') {\n          params.sort = 'price_asc'\n        } else if (sortBy === 'price-high') {\n          params.sort = 'price_desc'\n        } else if (sortBy === 'rating') {\n          params.sort = 'rating_desc'\n        } else {\n          params.sort = 'popular'\n        }\n        \n        const result = await fetchProducts(params)\n        if (result.data?.products) {\n          let filteredProducts = result.data.products\n\n          // Apply availability filter client-side\n          if (availabilityFilter !== 'all') {\n            filteredProducts = filteredProducts.filter((product) => {\n              const stock = product.stock || 0\n              if (availabilityFilter === 'in-stock') {\n                return stock > 10\n              } else if (availabilityFilter === 'low-stock') {\n                return stock > 0 && stock <= 10\n              }\n              return true\n            })\n          }\n\n          // Filter by price range\n          filteredProducts = filteredProducts.filter((product) => {\n            const price = product.priceToUser || product.price || 0\n            return price >= priceRange.min && price <= priceRange.max\n          })\n\n          setProducts(filteredProducts)\n        }\n      } catch (error) {\n        console.error('Error loading products:', error)\n      } finally {\n        setLoading(false)\n      }\n    }\n    \n    loadProducts()\n  }, [searchQuery, selectedCategory, sortBy, priceRange, availabilityFilter, carouselId])\n\n  // Update selected category when URL param changes\n  useEffect(() => {\n    if (categoryId) {\n      setSelectedCategory(categoryId)\n    }\n  }, [categoryId])\n\n  const handleProductClick = (productId) => {\n    navigate(`/product/${productId}`)\n  }\n\n  const handleAddToCart = async (e, productId) => {\n    e.stopPropagation()\n    if (!authenticated) {\n      navigate('/login')\n      return\n    }\n    try {\n      await addToCart(productId, 1)\n    } catch (error) {\n      console.error('Failed to add to cart:', error)\n    }\n  }\n\n  const handleToggleFavourite = async (e, productId) => {\n    e.stopPropagation()\n    if (!authenticated) {\n      navigate('/login')\n      return\n    }\n    try {\n      if (favourites.includes(productId)) {\n        await removeFromFavourites(productId)\n        dispatch({ type: 'REMOVE_FROM_FAVOURITES', payload: { productId } })\n      } else {\n        await addToFavourites(productId)\n        dispatch({ type: 'ADD_TO_FAVOURITES', payload: { productId } })\n      }\n    } catch (error) {\n      console.error('Failed to toggle favourite:', error)\n    }\n  }\n\n  const handleClearFilters = () => {\n    setSelectedCategory('all')\n    setPriceRange({ min: 0, max: 10000 })\n    setAvailabilityFilter('all')\n    setSortBy('popular')\n  }\n\n  // Filter content component (reusable)\n  const FilterContent = () => (\n    <>\n      {/* Category Filter */}\n      <div className=\"product-listing__filter-group\">\n        <h4>Category</h4>\n        <div className=\"product-listing__filter-options\">\n          <label className=\"product-listing__filter-checkbox\">\n            <input\n              type=\"radio\"\n              name=\"category\"\n              value=\"all\"\n              checked={selectedCategory === 'all'}\n              onChange={(e) => setSelectedCategory(e.target.value)}\n            />\n            <span>All Categories</span>\n          </label>\n          {categories.map((category) => (\n            <label key={category.id || category._id} className=\"product-listing__filter-checkbox\">\n              <input\n                type=\"radio\"\n                name=\"category\"\n                value={category.id || category._id}\n                checked={selectedCategory === (category.id || category._id)}\n                onChange={(e) => setSelectedCategory(e.target.value)}\n              />\n              <span>{category.name}</span>\n            </label>\n          ))}\n        </div>\n      </div>\n\n      {/* Price Range */}\n      <div className=\"product-listing__filter-group\">\n        <h4>Price Range</h4>\n        <div className=\"product-listing__filter-options\">\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"10000\"\n            step=\"100\"\n            value={priceRange.max}\n            onChange={(e) => setPriceRange({ ...priceRange, max: parseInt(e.target.value) })}\n            className=\"product-listing__price-slider\"\n          />\n          <div className=\"product-listing__price-display\">\n            â‚¹{priceRange.min.toLocaleString('en-IN')} - â‚¹{priceRange.max.toLocaleString('en-IN')}\n          </div>\n        </div>\n      </div>\n      \n      {/* Availability */}\n      <div className=\"product-listing__filter-group\">\n        <h4>Availability</h4>\n        <div className=\"product-listing__filter-options\">\n          <label className=\"product-listing__filter-checkbox\">\n            <input\n              type=\"radio\"\n              name=\"availability\"\n              value=\"all\"\n              checked={availabilityFilter === 'all'}\n              onChange={(e) => setAvailabilityFilter(e.target.value)}\n            />\n            <span>All</span>\n          </label>\n          <label className=\"product-listing__filter-checkbox\">\n            <input\n              type=\"radio\"\n              name=\"availability\"\n              value=\"in-stock\"\n              checked={availabilityFilter === 'in-stock'}\n              onChange={(e) => setAvailabilityFilter(e.target.value)}\n            />\n            <span>In Stock</span>\n          </label>\n          <label className=\"product-listing__filter-checkbox\">\n            <input\n              type=\"radio\"\n              name=\"availability\"\n              value=\"low-stock\"\n              checked={availabilityFilter === 'low-stock'}\n              onChange={(e) => setAvailabilityFilter(e.target.value)}\n            />\n            <span>Low Stock</span>\n          </label>\n        </div>\n      </div>\n    </>\n  )\n\n  return (\n    <Layout>\n      <Container className=\"product-listing\">\n        {/* Filter Button - Mobile (sticky below header) */}\n        <button \n          className=\"product-listing__filter-button-mobile\"\n          onClick={() => setFiltersOpen(true)}\n        >\n          Filters\n        </button>\n\n        {/* Top Bar */}\n        <div className=\"product-listing__topbar\">\n          <div className=\"product-listing__count\">\n            <span>\n              {searchQuery ? `Search: \"${searchQuery}\"` : 'All Products'} - {products.length} {products.length === 1 ? 'product' : 'products'}\n            </span>\n          </div>\n          <div className=\"product-listing__sort\">\n            <select \n              value={sortBy} \n              onChange={(e) => setSortBy(e.target.value)}\n              className=\"product-listing__sort-select\"\n            >\n              <option value=\"popular\">Most Popular</option>\n              <option value=\"price-low\">Price: Low to High</option>\n              <option value=\"price-high\">Price: High to Low</option>\n              <option value=\"rating\">Highest Rated</option>\n            </select>\n          </div>\n        </div>\n\n        <div className=\"product-listing__layout\">\n          {/* Filters Sidebar - Desktop */}\n          <aside className=\"product-listing__filters-desktop\">\n            <div className=\"product-listing__filters-header\">\n              <h3>Filters</h3>\n              <button onClick={handleClearFilters}>Clear All</button>\n            </div>\n            <div className=\"product-listing__filters-content\">\n              <FilterContent />\n            </div>\n          </aside>\n\n          {/* Products Grid */}\n          <div className=\"product-listing__products\">\n            {loading ? (\n              <div className=\"text-center py-12\">\n                <p className=\"text-gray-500\">Loading products...</p>\n              </div>\n            ) : products.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <p className=\"text-lg font-semibold text-gray-700 mb-2\">No products found</p>\n                <p className=\"text-sm text-gray-500\">Try adjusting your filters or search query</p>\n              </div>\n            ) : (\n              <div className=\"product-listing__grid\">\n                {products.map((product) => {\n                  const productId = product._id || product.id\n                  const inStock = (product.stock || 0) > 0\n                  const productImage = getPrimaryImageUrl(product)\n                  const isWishlisted = favourites.includes(productId)\n                  \n                  return (\n                    <div\n                      key={productId}\n                      className=\"product-listing-card\"\n                      onClick={() => handleProductClick(productId)}\n                    >\n                      <div className=\"product-listing-card__image-wrapper\">\n                        <img\n                          src={productImage}\n                          alt={product.name}\n                          className=\"product-listing-card__image\"\n                        />\n                        {authenticated && (\n                          <button\n                            type=\"button\"\n                            className=\"product-listing-card__wishlist\"\n                            onClick={(e) => handleToggleFavourite(e, productId)}\n                          >\n                            <svg\n                              className=\"h-5 w-5\"\n                              fill={isWishlisted ? '#ef4444' : 'none'}\n                              stroke={isWishlisted ? '#ef4444' : 'currentColor'}\n                              viewBox=\"0 0 24 24\"\n                            >\n                              <path\n                                strokeLinecap=\"round\"\n                                strokeLinejoin=\"round\"\n                                strokeWidth={2}\n                                d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"\n                              />\n                            </svg>\n                          </button>\n                        )}\n                      </div>\n                      <h3 className=\"product-listing-card__title\">{product.name}</h3>\n                      <div className=\"product-listing-card__price\">\n                        â‚¹{(product.priceToUser || product.price || 0).toLocaleString('en-IN')}\n                      </div>\n                      <button\n                        className=\"product-listing-card__button\"\n                        onClick={(e) => handleAddToCart(e, productId)}\n                        disabled={!inStock}\n                      >\n                        {inStock ? 'Add to Cart' : 'Out of Stock'}\n                      </button>\n                    </div>\n                  )\n                })}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Filters Drawer - Mobile */}\n        {filtersOpen && (\n          <div \n            className=\"product-listing__filters-mobile-drawer\"\n            onClick={(e) => {\n              if (e.target === e.currentTarget) {\n                setFiltersOpen(false)\n              }\n            }}\n          >\n            <div className=\"product-listing__filters-mobile-content\">\n              <div className=\"product-listing__filters-mobile-header\">\n                <h3>Filters</h3>\n                <button onClick={() => setFiltersOpen(false)}>Close</button>\n              </div>\n              <div className=\"product-listing__filters-mobile-body\">\n                <FilterContent />\n              </div>\n            </div>\n          </div>\n        )}\n      </Container>\n    </Layout>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\pages\\RegisterPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'otp' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"otp"},"fix":{"range":[736,739],"text":""},"desc":"Remove unused variable 'otp'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setOtp' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":18,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"setOtp"},"fix":{"range":[739,747],"text":""},"desc":"Remove unused variable 'setOtp'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":146,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":146,"endColumn":17}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { OtpVerification } from '../../../components/auth/OtpVerification'\nimport { useWebsiteDispatch } from '../context/WebsiteContext'\nimport { GoogleMapsLocationPicker } from '../../../components/GoogleMapsLocationPicker'\nimport * as websiteApi from '../services/websiteApi'\n\nexport function RegisterPage() {\n  const navigate = useNavigate()\n  const dispatch = useWebsiteDispatch()\n  const [step, setStep] = useState('register') // 'register' | 'otp'\n  const [form, setForm] = useState({\n    fullName: '',\n    contact: '',\n    sellerId: '',\n    location: null, // Will contain { address, city, state, pincode, coordinates: { lat, lng } }\n  })\n  const [otp, setOtp] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n  const [showSellerId, setShowSellerId] = useState(false)\n\n  const handleChange = (e) => {\n    const { name, value } = e.target\n    setForm((prev) => ({ ...prev, [name]: value }))\n    setError(null)\n  }\n\n  const handleRequestOtp = async (e) => {\n    e.preventDefault()\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Validate form\n      if (!form.fullName.trim()) {\n        setError('Full name is required')\n        setLoading(false)\n        return\n      }\n      if (!form.contact.trim()) {\n        setError('Contact number is required')\n        setLoading(false)\n        return\n      }\n      if (form.contact.length < 10) {\n        setError('Please enter a valid contact number')\n        setLoading(false)\n        return\n      }\n      // Validate location - coordinates are required (Google Maps provides this)\n      if (!form.location || !form.location.coordinates) {\n        setError('Please select your location using the map or live location button')\n        setLoading(false)\n        return\n      }\n      // Validate coordinates are valid (not 0,0)\n      if (!form.location.coordinates.lat || !form.location.coordinates.lng || \n          form.location.coordinates.lat === 0 || form.location.coordinates.lng === 0) {\n        setError('Please select a valid location. Coordinates are required.')\n        setLoading(false)\n        return\n      }\n      // Address is required (Google Maps provides formatted_address)\n      if (!form.location.address || !form.location.address.trim()) {\n        setError('Please select a valid address from the location picker')\n        setLoading(false)\n        return\n      }\n\n      // Request OTP using websiteApi\n      const result = await websiteApi.requestOTP({ phone: form.contact })\n      \n      if (result.success || result.data) {\n        setStep('otp')\n      } else {\n        setError(result.error?.message || 'Failed to send OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Failed to send OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleVerifyOtp = async (otpCode) => {\n    setError(null)\n    setLoading(true)\n\n    try {\n      // Prepare location object\n      const location = {\n        address: form.location.address,\n        city: form.location.city,\n        state: form.location.state,\n        pincode: form.location.pincode,\n        coordinates: {\n          lat: form.location.coordinates.lat,\n          lng: form.location.coordinates.lng,\n        },\n      }\n\n      // Register user with OTP using websiteApi\n      const result = await websiteApi.register({\n        fullName: form.fullName,\n        phone: form.contact,\n        otp: otpCode,\n        sellerId: form.sellerId || undefined,\n        location: location,\n      })\n\n      if (result.success || result.data) {\n          // Store token if provided (same user_token as User module)\n          if (result.data?.token) {\n            localStorage.setItem('user_token', result.data.token)\n          }\n        \n        // Update WebsiteContext with user data\n        const userData = result.data?.user || { name: form.fullName, phone: form.contact }\n        dispatch({\n          type: 'AUTH_LOGIN',\n          payload: {\n            name: userData.name || form.fullName,\n            phone: userData.phone || form.contact,\n            sellerId: userData.sellerId || null,\n            location: userData.location || location,\n          },\n        })\n        \n        // Navigate to website homepage\n        navigate('/')\n      } else {\n        setError(result.error?.message || 'Invalid OTP. Please try again.')\n      }\n    } catch (err) {\n      setError(err.message || 'Verification failed. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleResendOtp = async () => {\n    setLoading(true)\n    try {\n      await websiteApi.requestOTP({ phone: form.contact })\n    } catch (err) {\n      setError('Failed to resend OTP. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (step === 'otp') {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n        <div className=\"w-full max-w-md space-y-6\">\n          <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n            <OtpVerification\n              phone={form.contact}\n              onVerify={handleVerifyOtp}\n              onResend={handleResendOtp}\n              onBack={() => setStep('register')}\n              loading={loading}\n              error={error}\n              userType=\"user\"\n            />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-50 px-6 py-12\">\n      <div className=\"w-full max-w-md space-y-6\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4\">\n            <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n            </svg>\n          </div>\n          <p className=\"text-xs uppercase tracking-wide text-green-600 font-semibold\">Create Account</p>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Join IRA Sathi</h1>\n          <p className=\"text-sm text-gray-600\">Start your journey to better farming</p>\n        </div>\n\n        <div className=\"rounded-3xl border border-green-200/60 bg-white/90 p-8 shadow-xl backdrop-blur-sm\">\n          <form onSubmit={handleRequestOtp} className=\"space-y-5\">\n            {error && (\n              <div className=\"rounded-2xl bg-red-50 border border-red-200 p-4\">\n                <p className=\"text-sm text-red-600\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"register-fullName\" className=\"text-xs font-semibold text-gray-700\">\n                Full Name <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"register-fullName\"\n                name=\"fullName\"\n                type=\"text\"\n                required\n                value={form.fullName}\n                onChange={handleChange}\n                placeholder=\"Enter your full name\"\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <div className=\"space-y-1.5\">\n              <label htmlFor=\"register-contact\" className=\"text-xs font-semibold text-gray-700\">\n                Contact Number <span className=\"text-red-500\">*</span>\n              </label>\n              <input\n                id=\"register-contact\"\n                name=\"contact\"\n                type=\"tel\"\n                required\n                value={form.contact}\n                onChange={handleChange}\n                placeholder=\"+91 90000 00000\"\n                maxLength={15}\n                className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n              />\n            </div>\n\n            <div className=\"space-y-1.5\">\n              <div className=\"flex items-center justify-between\">\n                <label htmlFor=\"register-sellerId\" className=\"text-xs font-semibold text-gray-700\">\n                  IRA Partner ID <span className=\"text-gray-400 text-xs\">(Optional)</span>\n                </label>\n                <button\n                  type=\"button\"\n                  onClick={() => setShowSellerId(!showSellerId)}\n                  className=\"text-xs text-green-600 hover:underline font-medium\"\n                >\n                  {showSellerId ? 'Hide' : 'Have one?'}\n                </button>\n              </div>\n              {showSellerId && (\n                <input\n                  id=\"register-sellerId\"\n                  name=\"sellerId\"\n                  type=\"text\"\n                  value={form.sellerId}\n                  onChange={handleChange}\n                  placeholder=\"Enter IRA Partner ID (e.g., SLR-1001)\"\n                  className=\"w-full rounded-2xl border border-gray-200 bg-white px-4 py-3.5 text-sm focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20 transition-all\"\n                />\n              )}\n              {showSellerId && (\n                <p className=\"text-xs text-gray-500\">\n                  Link your purchases to an IRA Partner for cashback benefits\n                </p>\n              )}\n            </div>\n\n            <div className=\"border-t border-gray-200 pt-5 mt-5\">\n              <h3 className=\"text-sm font-semibold text-gray-900 mb-4\">Address & Location</h3>\n              \n              <div className=\"space-y-4\">\n                <GoogleMapsLocationPicker\n                  onLocationSelect={(location) => {\n                    setForm((prev) => ({ ...prev, location }))\n                    setError(null)\n                  }}\n                  initialLocation={form.location}\n                  required={true}\n                  label=\"Select Your Location\"\n                />\n              </div>\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full rounded-full bg-gradient-to-r from-green-600 to-green-700 px-5 py-3.5 text-sm font-semibold text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? 'Sending OTP...' : 'Continue'}\n            </button>\n\n            <div className=\"text-center text-sm\">\n              <span className=\"text-gray-600\">Already have an account? </span>\n              <button\n                type=\"button\"\n                onClick={() => navigate('/login')}\n                className=\"text-green-600 font-semibold hover:underline\"\n              >\n                Sign in\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\routes\\WebsiteRoutes.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\services\\websiteApi.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'onMessage' is defined but never used.","line":805,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":805,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"onMessage"},"fix":{"range":[22176,22185],"text":""},"desc":"Remove unused variable 'onMessage'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Website API Service\n * \n * This file contains all API endpoints for the Website application.\n * All endpoints are backend-ready and will work once the backend is implemented.\n * \n * This is completely separate from the User module - uses same 'user_token' (same backend, same user)\n * \n * Base URL should be configured in environment variables:\n * - Development: http://localhost:3000/api\n * - Production: https://api.irasathi.com/api\n */\n\nconst API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000/api'\n\n/**\n * API Response Handler\n */\nasync function handleResponse(response) {\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ message: 'An error occurred' }))\n    // Ensure error response always has a 'success: false' and 'error' object\n    throw { success: false, error: { message: error.message || `HTTP error! status: ${response.status}` } }\n  }\n  return response.json()\n}\n\n/**\n * API Request Helper\n */\nasync function apiRequest(endpoint, options = {}) {\n  const token = localStorage.getItem('user_token') // Same token as User module (same backend, same user)\n  \n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n      ...(token && { Authorization: `Bearer ${token}` }),\n      ...options.headers,\n    },\n    ...options,\n  }\n\n  const response = await fetch(`${API_BASE_URL}${endpoint}`, config)\n  return handleResponse(response)\n}\n\n// ============================================================================\n// AUTHENTICATION & ONBOARDING APIs\n// ============================================================================\n\n/**\n * Request OTP\n * POST /users/auth/request-otp\n * \n * @param {Object} data - { phone, language }\n * @returns {Promise<Object>} - { message: 'OTP sent successfully', expiresIn: 300 }\n */\nexport async function requestOTP(data) {\n  return apiRequest('/users/auth/request-otp', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Register User with OTP\n * POST /users/auth/register\n * \n * @param {Object} data - { fullName, phone, otp, sellerId? }\n * @returns {Promise<Object>} - { token, user: { id, name, phone, sellerId } }\n */\nexport async function register(data) {\n  return apiRequest('/users/auth/register', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Login with OTP\n * POST /users/auth/login\n * \n * @param {Object} data - { phone, otp }\n * @returns {Promise<Object>} - { token, user: { id, name, phone, sellerId, location } }\n */\nexport async function loginWithOtp(data) {\n  return apiRequest('/users/auth/login', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Verify OTP and Login (Legacy - use loginWithOtp)\n * POST /users/auth/verify-otp\n * \n * @param {Object} data - { phone, otp, sellerId? }\n * @returns {Promise<Object>} - { token, user: { id, name, phone, email, sellerId, location } }\n */\nexport async function verifyOTP(data) {\n  return apiRequest('/users/auth/verify-otp', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Get Seller ID (Read-only - Seller ID is locked for lifetime after first registration)\n * GET /users/profile/seller-id\n * \n * @returns {Promise<Object>} - Seller ID information\n * @note Seller ID can only be set during first-time registration and cannot be changed afterwards\n */\nexport async function getSellerID() {\n  return apiRequest('/users/profile/seller-id')\n}\n\n/**\n * Get User Profile\n * GET /users/profile\n * \n * @returns {Promise<Object>} - User profile data\n */\nexport async function getUserProfile() {\n  return apiRequest('/users/profile')\n}\n\n/**\n * Update User Profile\n * PUT /users/profile\n * \n * @param {Object} profileData - { name, email, phone, location }\n * @returns {Promise<Object>} - Updated user profile\n */\nexport async function updateUserProfile(profileData) {\n  return apiRequest('/users/profile', {\n    method: 'PUT',\n    body: JSON.stringify(profileData),\n  })\n}\n\n/**\n * Request OTP for current phone (for phone update)\n * POST /users/profile/phone/request-otp-current\n * \n * @returns {Promise<Object>} - { message, expiresIn, testOTP? }\n */\nexport async function requestOTPForCurrentPhone() {\n  return apiRequest('/users/profile/phone/request-otp-current', {\n    method: 'POST',\n  })\n}\n\n/**\n * Verify OTP for current phone (for phone update)\n * POST /users/profile/phone/verify-otp-current\n * \n * @param {Object} data - { otp }\n * @returns {Promise<Object>} - { message, verified }\n */\nexport async function verifyOTPForCurrentPhone(data) {\n  return apiRequest('/users/profile/phone/verify-otp-current', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Request OTP for new phone (for phone update)\n * POST /users/profile/phone/request-otp-new\n * \n * @param {Object} data - { newPhone }\n * @returns {Promise<Object>} - { message, expiresIn, testOTP? }\n */\nexport async function requestOTPForNewPhone(data) {\n  return apiRequest('/users/profile/phone/request-otp-new', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Verify OTP for new phone and update phone number\n * POST /users/profile/phone/verify-otp-new\n * \n * @param {Object} data - { otp }\n * @returns {Promise<Object>} - Updated user profile\n */\nexport async function verifyOTPForNewPhone(data) {\n  return apiRequest('/users/profile/phone/verify-otp-new', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Logout\n * POST /users/auth/logout\n * \n * @returns {Promise<Object>} - { message: 'Logged out successfully' }\n */\nexport async function websiteLogout() {\n  return apiRequest('/users/auth/logout', {\n    method: 'POST',\n  })\n}\n\n// ============================================================================\n// PRODUCT & CATALOG APIs\n// ============================================================================\n\n/**\n * Get Categories\n * GET /users/products/categories\n * \n * @returns {Promise<Array>} - Array of categories\n */\nexport async function getCategories() {\n  return apiRequest('/users/products/categories')\n}\n\n/**\n * Get Products\n * GET /users/products\n * \n * @param {Object} params - { category, search, minPrice, maxPrice, sort, limit, offset }\n * @returns {Promise<Object>} - { products: Array, total: number }\n */\nexport async function getProducts(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/products?${queryParams}`)\n}\n\n/**\n * Get Product Details\n * GET /users/products/:productId\n * \n * @param {string} productId - Product ID\n * @returns {Promise<Object>} - Product details with stock, delivery timeline, vendor info\n */\nexport async function getProductDetails(productId) {\n  return apiRequest(`/users/products/${productId}`)\n}\n\n/**\n * Get Popular Products\n * GET /users/products/popular\n * \n * @param {Object} params - { limit }\n * @returns {Promise<Array>} - Array of popular products\n */\nexport async function getPopularProducts(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/products/popular?${queryParams}`)\n}\n\n/**\n * Get Offers/Banners\n * GET /users/offers\n * \n * @returns {Promise<Object>} - { carousels: Array, specialOffers: Array }\n */\nexport async function getOffers() {\n  return apiRequest('/users/offers')\n}\n\n/**\n * Search Products\n * GET /users/products/search\n * \n * @param {Object} params - { query, category, limit, offset }\n * @returns {Promise<Object>} - { products: Array, total: number }\n */\nexport async function searchProducts(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/products/search?${queryParams}`)\n}\n\n// ============================================================================\n// CART APIs\n// ============================================================================\n\n/**\n * Get Cart\n * GET /users/cart\n * \n * @returns {Promise<Object>} - { items: Array, total: number }\n */\nexport async function getCart() {\n  return apiRequest('/users/cart')\n}\n\n/**\n * Add to Cart\n * POST /users/cart\n * \n * @param {Object} data - { productId, quantity, attributes? }\n * @returns {Promise<Object>} - Updated cart\n */\nexport async function addToCart(data) {\n  return apiRequest('/users/cart', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Update Cart Item\n * PUT /users/cart/:itemId\n * \n * @param {string} itemId - Cart item ID\n * @param {Object} data - { quantity }\n * @returns {Promise<Object>} - Updated cart\n */\nexport async function updateCartItem(itemId, data) {\n  return apiRequest(`/users/cart/${itemId}`, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Remove from Cart\n * DELETE /users/cart/:itemId\n * \n * @param {string} itemId - Cart item ID\n * @returns {Promise<Object>} - Updated cart\n */\nexport async function removeFromCart(itemId) {\n  return apiRequest(`/users/cart/${itemId}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Clear Cart\n * DELETE /users/cart\n * \n * @returns {Promise<Object>} - { message: 'Cart cleared' }\n */\nexport async function clearCart() {\n  return apiRequest('/users/cart', {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Validate Cart (Check minimum order value)\n * POST /users/cart/validate\n * \n * @returns {Promise<Object>} - { valid: boolean, total: number, meetsMinimum: boolean, shortfall: number }\n */\nexport async function validateCart() {\n  return apiRequest('/users/cart/validate', {\n    method: 'POST',\n  })\n}\n\n// ============================================================================\n// VENDOR ASSIGNMENT APIs\n// ============================================================================\n\n/**\n * Get Assigned Vendor\n * POST /users/vendors/assign\n * \n * @param {Object} data - { location: { lat, lng, address, city, state, pincode } }\n * @returns {Promise<Object>} - { vendor: Object, distance: number, hasStock: boolean }\n */\nexport async function getAssignedVendor(data) {\n  return apiRequest('/users/vendors/assign', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Check Vendor Stock\n * POST /users/vendors/check-stock\n * \n * @param {Object} data - { vendorId, productIds: Array }\n * @returns {Promise<Object>} - { available: Array, unavailable: Array }\n */\nexport async function checkVendorStock(data) {\n  return apiRequest('/users/vendors/check-stock', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n// ============================================================================\n// CHECKOUT & ORDER APIs\n// ============================================================================\n\n/**\n * Create Order\n * POST /users/orders\n * \n * IMPORTANT: The backend should handle partial fulfillment scenarios:\n * - When vendor has some items but not all, the order should be split:\n *   - Items in stock â†’ Vendor fulfills\n *   - Items out of stock/insufficient â†’ Escalated to Admin\n * - The response should indicate if order is split and provide details\n * \n * @param {Object} orderData - {\n *   items: Array<{ productId: string, quantity: number, attributes?: Object }>,\n *   addressId: string,\n *   shippingMethod: string,\n *   vendorId: string,\n *   paymentMethod: string,\n *   paymentPreference: 'partial' | 'full',\n *   payInFull: boolean,\n *   upfrontAmount: number,\n *   deliveryChargeWaived?: boolean\n * }\n * @returns {Promise<Object>} - { \n *   order: Object,\n *   paymentIntent: Object,\n *   splitOrder?: { vendorOrder: Object, adminOrder: Object } // If partial fulfillment\n * }\n */\nexport async function createOrder(orderData) {\n  return apiRequest('/users/orders', {\n    method: 'POST',\n    body: JSON.stringify(orderData),\n  })\n}\n\n/**\n * Get Orders\n * GET /users/orders\n * \n * IMPORTANT: Orders returned should include the latest status updates from vendors.\n * Each order should have:\n * - status: 'awaiting' | 'dispatched' | 'delivered'\n * - statusTimeline: Array of { status: string, timestamp: ISO string }\n * \n * @param {Object} params - { status, limit, offset }\n * @returns {Promise<Object>} - { orders: Array with status and statusTimeline, total: number }\n */\nexport async function getOrders(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/orders?${queryParams}`)\n}\n\n/**\n * Get Order Details\n * GET /users/orders/:orderId\n * \n * @param {string} orderId - Order ID\n * @returns {Promise<Object>} - Order details with items, payment, delivery status\n */\nexport async function getOrderDetails(orderId) {\n  return apiRequest(`/users/orders/${orderId}`)\n}\n\n/**\n * Track Order\n * GET /users/orders/:orderId/track\n * \n * @param {string} orderId - Order ID\n * @returns {Promise<Object>} - Order tracking information\n */\nexport async function trackOrder(orderId) {\n  return apiRequest(`/users/orders/${orderId}/track`)\n}\n\n/**\n * Cancel Order\n * PUT /users/orders/:orderId/cancel\n * \n * @param {string} orderId - Order ID\n * @param {Object} data - { reason }\n * @returns {Promise<Object>} - Updated order\n */\nexport async function cancelOrder(orderId, data = {}) {\n  return apiRequest(`/users/orders/${orderId}/cancel`, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n  })\n}\n\n// ============================================================================\n// PAYMENT APIs\n// ============================================================================\n\n/**\n * Create Payment Intent (Advance Payment)\n * POST /users/payments/create-intent\n * \n * @param {Object} data - { orderId, amount, paymentMethod }\n * @returns {Promise<Object>} - { paymentIntentId, clientSecret, paymentGateway: 'razorpay'|'paytm'|'stripe' }\n */\nexport async function createPaymentIntent(data) {\n  return apiRequest('/users/payments/create-intent', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Confirm Payment (Advance Payment)\n * POST /users/payments/confirm\n * \n * @param {Object} data - { \n *   orderId: string (required),\n *   paymentIntentId?: string,\n *   gatewayPaymentId: string (required - dummy for now),\n *   gatewayOrderId?: string (dummy for now),\n *   gatewaySignature?: string (dummy for now),\n *   paymentMethod: string\n * }\n * @returns {Promise<Object>} - { success: boolean, transactionId, orderId }\n */\nexport async function confirmPayment(data) {\n  return apiRequest('/users/payments/confirm', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Create Remaining Payment Intent\n * POST /users/payments/create-remaining\n * \n * @param {Object} data - { orderId, paymentMethod }\n * @returns {Promise<Object>} - { paymentIntentId, clientSecret, amount }\n */\nexport async function createRemainingPaymentIntent(data) {\n  return apiRequest('/users/payments/create-remaining', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Confirm Remaining Payment\n * POST /users/payments/confirm-remaining\n * \n * @param {Object} data - { orderId, paymentIntentId, paymentMethod, paymentDetails }\n * @returns {Promise<Object>} - { success: boolean, transactionId }\n */\nexport async function confirmRemainingPayment(data) {\n  return apiRequest('/users/payments/confirm-remaining', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Get Payment Status\n * GET /users/payments/:paymentId\n * \n * @param {string} paymentId - Payment ID\n * @returns {Promise<Object>} - Payment status and details\n */\nexport async function getPaymentStatus(paymentId) {\n  return apiRequest(`/users/payments/${paymentId}`)\n}\n\n/**\n * Get Order Payments\n * GET /users/orders/:orderId/payments\n * \n * @param {string} orderId - Order ID\n * @returns {Promise<Object>} - { advance: Object, remaining: Object }\n */\nexport async function getOrderPayments(orderId) {\n  return apiRequest(`/users/orders/${orderId}/payments`)\n}\n\n// ============================================================================\n// ADDRESS APIs\n// ============================================================================\n\n/**\n * Get Addresses\n * GET /users/addresses\n * \n * @returns {Promise<Array>} - Array of addresses\n */\nexport async function getAddresses() {\n  return apiRequest('/users/addresses')\n}\n\n/**\n * Add Address\n * POST /users/addresses\n * \n * @param {Object} addressData - { name, address, city, state, pincode, phone, isDefault, coordinates? }\n * @returns {Promise<Object>} - Created address\n */\nexport async function addAddress(addressData) {\n  return apiRequest('/users/addresses', {\n    method: 'POST',\n    body: JSON.stringify(addressData),\n  })\n}\n\n/**\n * Update Address\n * PUT /users/addresses/:addressId\n * \n * @param {string} addressId - Address ID\n * @param {Object} addressData - Address fields to update\n * @returns {Promise<Object>} - Updated address\n */\nexport async function updateAddress(addressId, addressData) {\n  return apiRequest(`/users/addresses/${addressId}`, {\n    method: 'PUT',\n    body: JSON.stringify(addressData),\n  })\n}\n\n/**\n * Delete Address\n * DELETE /users/addresses/:addressId\n * \n * @param {string} addressId - Address ID\n * @returns {Promise<Object>} - { message: 'Address deleted' }\n */\nexport async function deleteAddress(addressId) {\n  return apiRequest(`/users/addresses/${addressId}`, {\n    method: 'DELETE',\n  })\n}\n\n/**\n * Set Default Address\n * PUT /users/addresses/:addressId/default\n * \n * @param {string} addressId - Address ID\n * @returns {Promise<Object>} - Updated address\n */\nexport async function setDefaultAddress(addressId) {\n  return apiRequest(`/users/addresses/${addressId}/default`, {\n    method: 'PUT',\n  })\n}\n\n// ============================================================================\n// FAVOURITES/WISHLIST APIs\n// ============================================================================\n\n/**\n * Get Favourites\n * GET /users/favourites\n * \n * @returns {Promise<Array>} - Array of favourite product IDs\n */\nexport async function getFavourites() {\n  return apiRequest('/users/favourites')\n}\n\n/**\n * Add to Favourites\n * POST /users/favourites\n * \n * @param {Object} data - { productId }\n * @returns {Promise<Object>} - { message: 'Added to favourites' }\n */\nexport async function addToFavourites(data) {\n  return apiRequest('/users/favourites', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Remove from Favourites\n * DELETE /users/favourites/:productId\n * \n * @param {string} productId - Product ID\n * @returns {Promise<Object>} - { message: 'Removed from favourites' }\n */\nexport async function removeFromFavourites(productId) {\n  return apiRequest(`/users/favourites/${productId}`, {\n    method: 'DELETE',\n  })\n}\n\n// ============================================================================\n// NOTIFICATIONS APIs\n// ============================================================================\n\n/**\n * Get Notifications\n * GET /users/notifications\n * \n * @param {Object} params - { read, type, limit, offset }\n * @returns {Promise<Object>} - { notifications: Array, unreadCount: number }\n */\nexport async function getNotifications(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/notifications?${queryParams}`)\n}\n\n/**\n * Mark Notification as Read\n * PUT /users/notifications/:notificationId/read\n * \n * @param {string} notificationId - Notification ID\n * @returns {Promise<Object>} - { message: 'Marked as read' }\n */\nexport async function markNotificationRead(notificationId) {\n  return apiRequest(`/users/notifications/${notificationId}/read`, {\n    method: 'PUT',\n  })\n}\n\n/**\n * Mark All Notifications as Read\n * PUT /users/notifications/read-all\n * \n * @returns {Promise<Object>} - { message: 'All notifications marked as read' }\n */\nexport async function markAllNotificationsRead() {\n  return apiRequest('/users/notifications/read-all', {\n    method: 'PUT',\n  })\n}\n\n// ============================================================================\n// SUPPORT APIs\n// ============================================================================\n\n/**\n * Create Support Ticket\n * POST /users/support/tickets\n * \n * @param {Object} data - { subject, description, category, orderId? }\n * @returns {Promise<Object>} - { ticketId, message: 'Ticket created successfully' }\n */\nexport async function createSupportTicket(data) {\n  return apiRequest('/users/support/tickets', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Get Support Tickets\n * GET /users/support/tickets\n * \n * @param {Object} params - { status, limit, offset }\n * @returns {Promise<Object>} - { tickets: Array, total: number }\n */\nexport async function getSupportTickets(params = {}) {\n  const queryParams = new URLSearchParams(params).toString()\n  return apiRequest(`/users/support/tickets?${queryParams}`)\n}\n\n/**\n * Get Support Ticket Details\n * GET /users/support/tickets/:ticketId\n * \n * @param {string} ticketId - Support ticket ID\n * @returns {Promise<Object>} - Ticket details with messages\n */\nexport async function getSupportTicketDetails(ticketId) {\n  return apiRequest(`/users/support/tickets/${ticketId}`)\n}\n\n/**\n * Send Support Message\n * POST /users/support/tickets/:ticketId/messages\n * \n * @param {string} ticketId - Support ticket ID\n * @param {Object} data - { message }\n * @returns {Promise<Object>} - { messageId, message: 'Message sent' }\n */\nexport async function sendSupportMessage(ticketId, data) {\n  return apiRequest(`/users/support/tickets/${ticketId}/messages`, {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n/**\n * Initiate Support Call\n * POST /users/support/call\n * \n * @param {Object} data - { orderId?, issue }\n * @returns {Promise<Object>} - { callId, phoneNumber, message: 'Call initiated' }\n */\nexport async function initiateSupportCall(data) {\n  return apiRequest('/users/support/call', {\n    method: 'POST',\n    body: JSON.stringify(data),\n  })\n}\n\n// ============================================================================\n// REAL-TIME UPDATES (WebSocket/SSE)\n// ============================================================================\n\n/**\n * Initialize Real-time Connection\n * This would typically use WebSocket or Server-Sent Events\n * For now, this is a placeholder for the implementation\n * \n * @param {Function} onMessage - Callback for receiving messages\n * @returns {Function} - Cleanup function to close connection\n */\nexport function initializeRealtimeConnection(onMessage) {\n  // This would be implemented with WebSocket or SSE\n  // Example:\n  // const ws = new WebSocket(`${WS_BASE_URL}/users/realtime`)\n  // ws.onmessage = (event) => {\n  //   const data = JSON.parse(event.data)\n  //   onMessage(data)\n  // }\n  // return () => ws.close()\n  \n  // For now, return a no-op cleanup function\n  return () => {}\n}\n\n/**\n * Handle Real-time Notification\n * Processes incoming real-time notifications (payment reminders, delivery updates, etc.)\n * \n * @param {Object} notification - Notification data from real-time connection\n */\nexport function handleRealtimeNotification(notification) {\n  // This would process different types of notifications:\n  // - 'payment_reminder': When remaining payment is due\n  // - 'delivery_update': When order status changes\n  // - 'order_assigned': When order is assigned to vendor\n  // - 'order_delivered': When order is delivered\n  // - 'offer': When new offers are available\n  // - 'announcement': When admin posts announcements\n  \n  return notification\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\services\\websiteData.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\modules\\website\\utils\\productImages.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\utils\\loadGoogleMaps.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\utils\\maskSensitiveData.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\utils\\razorpay.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'keyId' is defined but never used.","line":12,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"keyId"},"fix":{"range":[233,238],"text":""},"desc":"Remove unused variable 'keyId'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Razorpay Payment Utility\n * \n * Handles Razorpay Checkout integration\n */\n\n/**\n * Initialize Razorpay Checkout\n * @param {string} keyId - Razorpay Key ID\n * @returns {Object} Razorpay instance\n */\nexport function loadRazorpay(keyId) {\n  return new Promise((resolve, reject) => {\n    if (window.Razorpay) {\n      resolve(window.Razorpay);\n      return;\n    }\n\n    const script = document.createElement('script');\n    script.src = 'https://checkout.razorpay.com/v1/checkout.js';\n    script.onload = () => {\n      if (window.Razorpay) {\n        resolve(window.Razorpay);\n      } else {\n        reject(new Error('Razorpay SDK failed to load'));\n      }\n    };\n    script.onerror = () => {\n      reject(new Error('Failed to load Razorpay SDK'));\n    };\n    document.body.appendChild(script);\n  });\n}\n\n/**\n * Open Razorpay Checkout\n * @param {Object} options - Razorpay options\n * @param {string} options.key - Razorpay Key ID\n * @param {number} options.amount - Amount in rupees\n * @param {string} options.currency - Currency (default: INR)\n * @param {string} options.order_id - Razorpay Order ID\n * @param {string} options.name - Company/App name\n * @param {string} options.description - Payment description\n * @param {string} options.prefill.name - Customer name\n * @param {string} options.prefill.email - Customer email\n * @param {string} options.prefill.contact - Customer phone\n * @param {Object} options.handler - Success handler\n * @param {Object} options.modal - Modal options\n * @returns {Promise<Object>} Payment response\n */\nexport async function openRazorpayCheckout(options) {\n  try {\n    // CHECK FOR TEST MODE BYPASS\n    if (options.order_id && options.order_id.startsWith('order_test_')) {\n      console.log('ðŸ§ª [Razorpay Bypass] Test order detected. Simulating successful payment...');\n\n      return new Promise((resolve) => {\n        setTimeout(() => {\n          console.log('âœ… [Razorpay Bypass] Payment simulated.');\n          resolve({\n            success: true,\n            paymentId: `pay_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            orderId: options.order_id,\n            signature: `sig_test_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          });\n        }, 1500); // 1.5s delay to feel \"real\"\n      });\n    }\n\n    const Razorpay = await loadRazorpay(options.key);\n\n    // Validate required fields\n    if (!options.order_id) {\n      throw new Error('Razorpay order ID is required');\n    }\n    if (!options.amount || options.amount <= 0) {\n      throw new Error('Payment amount must be greater than 0');\n    }\n\n    return new Promise((resolve, reject) => {\n      const razorpayOptions = {\n        key: options.key,\n        amount: Math.round(options.amount * 100), // Convert to paise (Razorpay expects amount in smallest currency unit)\n        currency: options.currency || 'INR',\n        order_id: options.order_id,\n        name: options.name || 'IRA SATHI',\n        description: options.description || 'Order Payment',\n        prefill: {\n          name: options.prefill?.name || '',\n          email: options.prefill?.email || '',\n          contact: options.prefill?.contact || '',\n        },\n        theme: {\n          color: '#1b8f5b', // Match app theme\n        },\n        handler: function (response) {\n          // Payment successful\n          resolve({\n            success: true,\n            paymentId: response.razorpay_payment_id,\n            orderId: response.razorpay_order_id,\n            signature: response.razorpay_signature,\n          });\n        },\n        modal: {\n          ondismiss: function () {\n            // User closed the modal\n            reject({\n              success: false,\n              error: 'Payment cancelled by user',\n            });\n          },\n        },\n      };\n\n      console.log('ðŸ’³ Razorpay Checkout Options:', {\n        key: razorpayOptions.key ? 'Present' : 'Missing',\n        amount: razorpayOptions.amount,\n        currency: razorpayOptions.currency,\n        order_id: razorpayOptions.order_id,\n        name: razorpayOptions.name,\n        description: razorpayOptions.description,\n        prefill: razorpayOptions.prefill,\n      });\n\n      const razorpayInstance = new Razorpay(razorpayOptions);\n\n      razorpayInstance.on('payment.failed', function (response) {\n        console.error('ðŸ’³ Razorpay Payment Failed:', response);\n        reject({\n          success: false,\n          error: response.error?.description || 'Payment failed',\n          errorCode: response.error?.code,\n          errorDetails: response.error,\n        });\n      });\n\n      razorpayInstance.open();\n    });\n  } catch (error) {\n    console.error('ðŸ’³ Razorpay Checkout Error:', error);\n    throw {\n      success: false,\n      error: error.message || 'Failed to initialize payment',\n    };\n  }\n}\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\utils\\translateCommonStrings.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'isEnglish' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":13,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"isEnglish"},"fix":{"range":[338,376],"text":""},"desc":"Remove unused variable 'isEnglish'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Common strings translation helper\r\n * Provides translated versions of common UI strings\r\n */\r\n\r\nimport { useTranslation } from '../context/TranslationContext'\r\nimport { useTranslatedArray } from '../hooks/useTranslatedArray'\r\n\r\n/**\r\n * Hook to get translated common strings\r\n */\r\nexport function useTranslatedCommonStrings() {\r\n  const { isEnglish } = useTranslation()\r\n  \r\n  // Common strings that appear frequently\r\n  const commonStrings = {\r\n    // Cart\r\n    'Your cart is empty': 'Your cart is empty',\r\n    'Add some products to get started': 'Add some products to get started',\r\n    'Shopping Cart': 'Shopping Cart',\r\n    'item': 'item',\r\n    'items': 'items',\r\n    'Subtotal': 'Subtotal',\r\n    'Delivery': 'Delivery',\r\n    'Free': 'Free',\r\n    'Total': 'Total',\r\n    'Proceed to Checkout': 'Proceed to Checkout',\r\n    'Variant': 'Variant',\r\n    'properties': 'properties',\r\n    'per unit': 'per unit',\r\n    'Standard variant': 'Standard variant',\r\n    'Variant Properties': 'Variant Properties',\r\n    'No variant properties available': 'No variant properties available',\r\n    \r\n    // Orders\r\n    'My Orders': 'My Orders',\r\n    'All': 'All',\r\n    'Awaiting': 'Awaiting',\r\n    'Dispatched': 'Dispatched',\r\n    'Delivered': 'Delivered',\r\n    'In Cart': 'In Cart',\r\n    'No orders found': 'No orders found',\r\n    \"You haven't placed any orders yet\": \"You haven't placed any orders yet\",\r\n    'Cart': 'Cart',\r\n    'Order #': 'Order #',\r\n    'Qty': 'Qty',\r\n    'Payment Status': 'Payment Status',\r\n    'Partial Paid': 'Partial Paid',\r\n    'Pending': 'Pending',\r\n    'Advance (30%)': 'Advance (30%)',\r\n    'Remaining (70%)': 'Remaining (70%)',\r\n    'Pay Remaining': 'Pay Remaining',\r\n    'Processing...': 'Processing...',\r\n    \r\n    // Favourites\r\n    'My Favourites': 'My Favourites',\r\n    'item saved': 'item saved',\r\n    'items saved': 'items saved',\r\n    'Loading favourites...': 'Loading favourites...',\r\n    'No favourites yet': 'No favourites yet',\r\n    'Start adding products to your favourites by tapping the heart icon on any product': 'Start adding products to your favourites by tapping the heart icon on any product',\r\n    \r\n    // Home\r\n    'Categories': 'Categories',\r\n    'See all': 'See all',\r\n    'Loading categories...': 'Loading categories...',\r\n    'No categories available': 'No categories available',\r\n    'Popular Products': 'Popular Products',\r\n    'Best sellers this week': 'Best sellers this week',\r\n    'View All': 'View All',\r\n    'Loading products...': 'Loading products...',\r\n    'No popular products available': 'No popular products available',\r\n    'Featured Products': 'Featured Products',\r\n    'From different categories': 'From different categories',\r\n    'Special Offers': 'Special Offers',\r\n    'Limited time deals': 'Limited time deals',\r\n    'Fast Delivery': 'Fast Delivery',\r\n    '3-4 Hours': '3-4 Hours',\r\n    'Easy Payment': 'Easy Payment',\r\n    '30% Advance': '30% Advance',\r\n    'Quality Assured': 'Quality Assured',\r\n    '100% Genuine': '100% Genuine',\r\n    \r\n    // Status descriptions\r\n    'Vendor is confirming stock and assigning a delivery partner.': 'Vendor is confirming stock and assigning a delivery partner.',\r\n    'Order handed over for delivery. Track updates in real time.': 'Order handed over for delivery. Track updates in real time.',\r\n    'Order delivered. Complete remaining payment if pending.': 'Order delivered. Complete remaining payment if pending.',\r\n  }\r\n  \r\n  const stringsArray = Object.values(commonStrings)\r\n  const translatedArray = useTranslatedArray(stringsArray)\r\n  \r\n  // Create translated object\r\n  const translated = {}\r\n  let index = 0\r\n  Object.keys(commonStrings).forEach((key) => {\r\n    translated[key] = translatedArray[index++] || key\r\n  })\r\n  \r\n  return translated\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\utils\\translateNavItems.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\src\\utils\\translation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\OneDrive\\Desktop\\IRA SATHI New\\FarmCommerce\\Frontend\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]